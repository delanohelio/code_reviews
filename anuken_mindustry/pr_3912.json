{"pr_number": 3912, "pr_title": "Conveyor upgrade system", "pr_author": "Slava0135", "pr_createdAt": "2020-12-10T19:08:40Z", "pr_url": "https://github.com/Anuken/Mindustry/pull/3912", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDQzMDg0Nw==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r540430847", "body": "these don't seem to be used anywhere other than the if right below it`:\r\n\r\n```suggestion\r\n                if(world.tile(startX, startY).block() instanceof Conveyor && world.tile(endX, endY).block() instanceof Conveyor){\r\n                    points = Placement.upgradeConveyorLine(startX, startY, endX, endY);\r\n                }else{\r\n                    points = Placement.pathfindLine(true, startX, startY, endX, endY);\r\n                }\r\n```", "bodyText": "these don't seem to be used anywhere other than the if right below it`:\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            Tile start = world.tile(startX, startY);\n          \n          \n            \n                            Tile end = world.tile(endX, endY);\n          \n          \n            \n                            if(start.block() instanceof Conveyor && end.block() instanceof Conveyor){\n          \n          \n            \n                                points = Placement.upgradeConveyorLine(startX, startY, endX, endY);\n          \n          \n            \n                            }else{\n          \n          \n            \n                                points = Placement.pathfindLine(true, startX, startY, endX, endY);\n          \n          \n            \n                            }\n          \n          \n            \n                            if(world.tile(startX, startY).block() instanceof Conveyor && world.tile(endX, endY).block() instanceof Conveyor){\n          \n          \n            \n                                points = Placement.upgradeConveyorLine(startX, startY, endX, endY);\n          \n          \n            \n                            }else{\n          \n          \n            \n                                points = Placement.pathfindLine(true, startX, startY, endX, endY);\n          \n          \n            \n                            }", "bodyHTML": "<p dir=\"auto\">these don't seem to be used anywhere other than the if right below it`:</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-smi\">Tile</span> start <span class=\"pl-k\">=</span> world<span class=\"pl-k\">.</span>tile(startX, startY);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-smi\">Tile</span> end <span class=\"pl-k\">=</span> world<span class=\"pl-k\">.</span>tile(endX, endY);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-k\">if</span>(start<span class=\"pl-k\">.</span>block() <span class=\"pl-k\">instanceof</span> <span class=\"pl-smi\">Conveyor</span> <span class=\"pl-k\">&amp;&amp;</span> end<span class=\"pl-k\">.</span>block() <span class=\"pl-k\">instanceof</span> <span class=\"pl-smi\">Conveyor</span>){</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    points <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Placement</span><span class=\"pl-k\">.</span>upgradeConveyorLine(startX, startY, endX, endY);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                }<span class=\"pl-k\">else</span>{</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    points <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Placement</span><span class=\"pl-k\">.</span>pathfindLine(<span class=\"pl-c1\">true</span>, startX, startY, endX, endY);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">if</span>(world<span class=\"pl-k\">.</span>tile(startX, startY)<span class=\"pl-k\">.</span>block() <span class=\"pl-k\">instanceof</span> <span class=\"pl-smi\">Conveyor</span> <span class=\"pl-k\">&amp;&amp;</span> world<span class=\"pl-k\">.</span>tile(endX, endY)<span class=\"pl-k\">.</span>block() <span class=\"pl-k\">instanceof</span> <span class=\"pl-smi\">Conveyor</span>){</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    points <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Placement</span><span class=\"pl-k\">.</span>upgradeConveyorLine(startX, startY, endX, endY);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                }<span class=\"pl-k\">else</span>{</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    points <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Placement</span><span class=\"pl-k\">.</span>pathfindLine(<span class=\"pl-c1\">true</span>, startX, startY, endX, endY);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                }</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Quezler", "createdAt": "2020-12-10T19:16:46Z", "path": "core/src/mindustry/input/InputHandler.java", "diffHunk": "@@ -1161,7 +1162,17 @@ void iterateLine(int startX, int startY, int endX, int endY, Cons<PlaceLine> con\n         }\n \n         if(diagonal){\n-            points = Placement.pathfindLine(block != null && block.conveyorPlacement, startX, startY, endX, endY);\n+            if(block != null && block instanceof Conveyor){\n+                Tile start = world.tile(startX, startY);\n+                Tile end = world.tile(endX, endY);\n+                if(start.block() instanceof Conveyor && end.block() instanceof Conveyor){\n+                    points = Placement.upgradeConveyorLine(startX, startY, endX, endY);\n+                }else{\n+                    points = Placement.pathfindLine(true, startX, startY, endX, endY);\n+                }", "originalCommit": "4f8338d9f3e97f27f4774f59dec2ff6fa335406e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY1NDE5Nw==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r541654197", "body": "These two functions are nearly the same, and use conduit/conveyor-specific implementation details. This isn't acceptable.", "bodyText": "These two functions are nearly the same, and use conduit/conveyor-specific implementation details. This isn't acceptable.", "bodyHTML": "<p dir=\"auto\">These two functions are nearly the same, and use conduit/conveyor-specific implementation details. This isn't acceptable.</p>", "author": "Anuken", "createdAt": "2020-12-12T16:33:28Z", "path": "core/src/mindustry/input/Placement.java", "diffHunk": "@@ -54,6 +55,32 @@\n         return points;\n     }\n \n+    public static Seq<Point2> upgradeConveyorLine(int startX, int startY, int endX, int endY){", "originalCommit": "4245d5900c0290af7f1df038c82638a805311020", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY1OTY1OQ==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r541659659", "bodyText": "Yeah but Conduit and Conveyor is not the same thing. And also there won't be any new such blocks.", "author": "Slava0135", "createdAt": "2020-12-12T16:44:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY1NDE5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY1NDQ5Nw==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r541654497", "body": "Conduits/conveyors should not be hardcoded into the system with special functions to handle them. The logic for each type of block is practically identical.", "bodyText": "Conduits/conveyors should not be hardcoded into the system with special functions to handle them. The logic for each type of block is practically identical.", "bodyHTML": "<p dir=\"auto\">Conduits/conveyors should not be hardcoded into the system with special functions to handle them. The logic for each type of block is practically identical.</p>", "author": "Anuken", "createdAt": "2020-12-12T16:34:08Z", "path": "core/src/mindustry/input/InputHandler.java", "diffHunk": "@@ -1161,7 +1163,15 @@ void iterateLine(int startX, int startY, int endX, int endY, Cons<PlaceLine> con\n         }\n \n         if(diagonal){\n-            points = Placement.pathfindLine(block != null && block.conveyorPlacement, startX, startY, endX, endY);\n+            Tile start = world.tile(startX, startY);\n+            Tile end = world.tile(endX, endY);\n+            if(block != null && block instanceof Conveyor && start.block() instanceof Conveyor && end.block() instanceof Conveyor && start.block() != block){", "originalCommit": "4245d5900c0290af7f1df038c82638a805311020", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY2MDA4Nw==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r541660087", "bodyText": "I really don't know how to put them under one roof. Perhaps do something with AutoTiler?", "author": "Slava0135", "createdAt": "2020-12-12T16:45:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY1NDQ5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY2OTg0OQ==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r541669849", "bodyText": "add it to an interface", "author": "DeltaNedas", "createdAt": "2020-12-12T17:04:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY1NDQ5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY3MTQ4Mw==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r541671483", "body": "All this could be shortened by using ternary:\r\n\r\n`return next != null && next.build instanceof ConduitBuild ? (ConduitBuild) next.build : null;`", "bodyText": "All this could be shortened by using ternary:\nreturn next != null && next.build instanceof ConduitBuild ? (ConduitBuild) next.build : null;", "bodyHTML": "<p dir=\"auto\">All this could be shortened by using ternary:</p>\n<p dir=\"auto\"><code>return next != null &amp;&amp; next.build instanceof ConduitBuild ? (ConduitBuild) next.build : null;</code></p>", "author": "joshuaptfan", "createdAt": "2020-12-12T17:07:31Z", "path": "core/src/mindustry/world/blocks/liquid/Conduit.java", "diffHunk": "@@ -119,6 +119,16 @@ public void onProximityUpdate(){\n             blending = bits[4];\n         }\n \n+        @Nullable\n+        public ConduitBuild nextConduit(){\n+            Tile next = tile.nearby(rotation);\n+            if(next != null && next.build instanceof ConduitBuild){\n+                return (ConduitBuild) next.build;\n+            }else{\n+                return null;\n+            }", "originalCommit": "4245d5900c0290af7f1df038c82638a805311020", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTc2MDk0Mg==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r541760942", "body": "Actually this line is kinda redundant but idk if's good for performance or not. (start.block() != block)", "bodyText": "Actually this line is kinda redundant but idk if's good for performance or not. (start.block() != block)", "bodyHTML": "<p dir=\"auto\">Actually this line is kinda redundant but idk if's good for performance or not. (start.block() != block)</p>", "author": "Slava0135", "createdAt": "2020-12-12T19:50:11Z", "path": "core/src/mindustry/input/InputHandler.java", "diffHunk": "@@ -1165,10 +1164,13 @@ void iterateLine(int startX, int startY, int endX, int endY, Cons<PlaceLine> con\n         if(diagonal){\n             Tile start = world.tile(startX, startY);\n             Tile end = world.tile(endX, endY);\n-            if(block != null && block instanceof Conveyor && start.block() instanceof Conveyor && end.block() instanceof Conveyor && start.block() != block){\n-                points = Placement.upgradeConveyorLine(startX, startY, endX, endY);\n-            }else if(block != null && block instanceof Conduit && start.block() instanceof Conduit && end.block() instanceof Conduit && start.block() != block){\n-                points = Placement.upgradeConduitLine(startX, startY, endX, endY);\n+            if(block != null && block instanceof Autotiler\n+                    && start.block() != block", "originalCommit": "faf638a11f6b154854d0a6524e8cb751d2ca56c6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c2518acf0aa90251d751102fe222ff238fbdb4ef", "url": "https://github.com/Anuken/Mindustry/commit/c2518acf0aa90251d751102fe222ff238fbdb4ef", "message": "conveyor/conduit upgrading system", "committedDate": "2020-12-13T15:22:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjEwODQ5Mw==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r542108493", "body": "Why is this called `AutotilerBuilding` when it has nothing to do with tiling itself...?", "bodyText": "Why is this called AutotilerBuilding when it has nothing to do with tiling itself...?", "bodyHTML": "<p dir=\"auto\">Why is this called <code>AutotilerBuilding</code> when it has nothing to do with tiling itself...?</p>", "author": "Anuken", "createdAt": "2020-12-14T04:45:06Z", "path": "core/src/mindustry/world/blocks/distribution/AutotilerBuilding.java", "diffHunk": "@@ -0,0 +1,9 @@\n+package mindustry.world.blocks.distribution;\n+\n+import mindustry.gen.Building;\n+import mindustry.world.Block;\n+\n+public interface AutotilerBuilding{", "originalCommit": "c2518acf0aa90251d751102fe222ff238fbdb4ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjE2NDI5OA==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r542164298", "bodyText": "Because I check if block is Autotiler in InputHandler. Both conduits and conveyors are inherited from it.", "author": "Slava0135", "createdAt": "2020-12-14T07:28:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjEwODQ5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjEwODU1Nw==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r542108557", "body": "Why not just use `build.block`?", "bodyText": "Why not just use build.block?", "bodyHTML": "<p dir=\"auto\">Why not just use <code>build.block</code>?</p>", "author": "Anuken", "createdAt": "2020-12-14T04:45:19Z", "path": "core/src/mindustry/world/blocks/distribution/AutotilerBuilding.java", "diffHunk": "@@ -0,0 +1,9 @@\n+package mindustry.world.blocks.distribution;\n+\n+import mindustry.gen.Building;\n+import mindustry.world.Block;\n+\n+public interface AutotilerBuilding{\n+    Building next();\n+    Block getBlockBasedOn();", "originalCommit": "c2518acf0aa90251d751102fe222ff238fbdb4ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjEwODY1OQ==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r542108659", "body": "unnecessary space before cast", "bodyText": "unnecessary space before cast", "bodyHTML": "<p dir=\"auto\">unnecessary space before cast</p>", "author": "Anuken", "createdAt": "2020-12-14T04:45:42Z", "path": "core/src/mindustry/input/Placement.java", "diffHunk": "@@ -54,6 +55,20 @@\n         return points;\n     }\n \n+    public static Seq<Point2> upgradeLine(int startX, int startY, int endX, int endY){\n+        Pools.freeAll(points);\n+        points.clear();\n+        Building building = world.tile(startX, startY).build;\n+        points.add(Pools.obtain(Point2.class, Point2::new).set(startX, startY));\n+        while((building.tile.x != endX || building.tile.y != endY)){\n+            AutotilerBuilding autotiler = (AutotilerBuilding) building;", "originalCommit": "c2518acf0aa90251d751102fe222ff238fbdb4ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjEwODcwOA==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r542108708", "body": "imports should be *", "bodyText": "imports should be *", "bodyHTML": "<p dir=\"auto\">imports should be *</p>", "author": "Anuken", "createdAt": "2020-12-14T04:45:53Z", "path": "core/src/mindustry/input/Placement.java", "diffHunk": "@@ -5,7 +5,9 @@\n import arc.math.geom.*;\n import arc.struct.*;\n import arc.util.pooling.*;\n+import mindustry.gen.Building;\n import mindustry.world.*;\n+import mindustry.world.blocks.distribution.AutotilerBuilding;", "originalCommit": "c2518acf0aa90251d751102fe222ff238fbdb4ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjEwODc0Ng==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r542108746", "body": "unnecessary spaces before cast, line below too", "bodyText": "unnecessary spaces before cast, line below too", "bodyHTML": "<p dir=\"auto\">unnecessary spaces before cast, line below too</p>", "author": "Anuken", "createdAt": "2020-12-14T04:46:01Z", "path": "core/src/mindustry/input/InputHandler.java", "diffHunk": "@@ -1161,7 +1162,18 @@ void iterateLine(int startX, int startY, int endX, int endY, Cons<PlaceLine> con\n         }\n \n         if(diagonal){\n-            points = Placement.pathfindLine(block != null && block.conveyorPlacement, startX, startY, endX, endY);\n+            Tile start = world.tile(startX, startY);\n+            Tile end = world.tile(endX, endY);\n+            if(block != null && block instanceof Autotiler\n+                    && start.block() != block\n+                    && start.build instanceof AutotilerBuilding\n+                    && end.build instanceof AutotilerBuilding\n+                    && block.canReplace(((AutotilerBuilding) end.build).getBlockBasedOn())", "originalCommit": "c2518acf0aa90251d751102fe222ff238fbdb4ef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1e5b1c2ac0f1513684999ce7ceacbe35cdcf0875", "url": "https://github.com/Anuken/Mindustry/commit/1e5b1c2ac0f1513684999ce7ceacbe35cdcf0875", "message": "conveyor/conduit upgrading system", "committedDate": "2020-12-14T09:21:04Z", "type": "commit"}, {"oid": "1e5b1c2ac0f1513684999ce7ceacbe35cdcf0875", "url": "https://github.com/Anuken/Mindustry/commit/1e5b1c2ac0f1513684999ce7ceacbe35cdcf0875", "message": "conveyor/conduit upgrading system", "committedDate": "2020-12-14T09:21:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjMwNjY5Mg==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r542306692", "body": "why place double brackets here?\n\n```suggestion\n        while(building.tile.x != endX || building.tile.y != endY){\n```\n", "bodyText": "why place double brackets here?\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    while((building.tile.x != endX || building.tile.y != endY)){\n          \n          \n            \n                    while(building.tile.x != endX || building.tile.y != endY){", "bodyHTML": "<p dir=\"auto\">why place double brackets here?</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">while</span>(<span class=\"x x-first x-last\">(</span>building<span class=\"pl-k\">.</span>tile<span class=\"pl-k\">.</span>x <span class=\"pl-k\">!=</span> endX <span class=\"pl-k\">||</span> building<span class=\"pl-k\">.</span>tile<span class=\"pl-k\">.</span>y <span class=\"pl-k\">!=</span> endY<span class=\"x x-first x-last\">)</span>){</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">while</span>(building<span class=\"pl-k\">.</span>tile<span class=\"pl-k\">.</span>x <span class=\"pl-k\">!=</span> endX <span class=\"pl-k\">||</span> building<span class=\"pl-k\">.</span>tile<span class=\"pl-k\">.</span>y <span class=\"pl-k\">!=</span> endY){</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "summetdev", "createdAt": "2020-12-14T11:18:31Z", "path": "core/src/mindustry/input/Placement.java", "diffHunk": "@@ -54,6 +55,20 @@\n         return points;\n     }\n \n+    public static Seq<Point2> upgradeLine(int startX, int startY, int endX, int endY){\n+        Pools.freeAll(points);\n+        points.clear();\n+        Building building = world.tile(startX, startY).build;\n+        points.add(Pools.obtain(Point2.class, Point2::new).set(startX, startY));\n+        while((building.tile.x != endX || building.tile.y != endY)){", "originalCommit": "1e5b1c2ac0f1513684999ce7ceacbe35cdcf0875", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjMwNzAyMA==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r542307020", "body": "```suggestion\nimport mindustry.gen.*;\n```\n", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import mindustry.gen.Building;\n          \n          \n            \n            import mindustry.gen.*;", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"><span class=\"pl-k\">import</span> <span class=\"pl-smi\">mindustry.gen.<span class=\"x x-first x-last\">Building</span></span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\"><span class=\"pl-k\">import</span> <span class=\"pl-smi\">mindustry.gen.<span class=\"x x-first x-last\">*</span></span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "summetdev", "createdAt": "2020-12-14T11:19:05Z", "path": "core/src/mindustry/input/Placement.java", "diffHunk": "@@ -5,7 +5,9 @@\n import arc.math.geom.*;\n import arc.struct.*;\n import arc.util.pooling.*;\n+import mindustry.gen.Building;", "originalCommit": "1e5b1c2ac0f1513684999ce7ceacbe35cdcf0875", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjMwNzIwMg==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r542307202", "body": "imports should be *\n\n```suggestion\nimport mindustry.world.blocks.distribution.*;\n```\n", "bodyText": "imports should be *\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import mindustry.world.blocks.distribution.ChainedBuilding;\n          \n          \n            \n            import mindustry.world.blocks.distribution.*;", "bodyHTML": "<p dir=\"auto\">imports should be *</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"><span class=\"pl-k\">import</span> <span class=\"pl-smi\">mindustry.world.blocks.distribution.<span class=\"x x-first x-last\">ChainedBuilding</span></span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\"><span class=\"pl-k\">import</span> <span class=\"pl-smi\">mindustry.world.blocks.distribution.<span class=\"x x-first x-last\">*</span></span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "summetdev", "createdAt": "2020-12-14T11:19:24Z", "path": "core/src/mindustry/input/InputHandler.java", "diffHunk": "@@ -32,6 +32,7 @@\n import mindustry.world.*;\n import mindustry.world.blocks.*;\n import mindustry.world.blocks.ConstructBlock.*;\n+import mindustry.world.blocks.distribution.ChainedBuilding;", "originalCommit": "1e5b1c2ac0f1513684999ce7ceacbe35cdcf0875", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjMwNzY3MQ==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r542307671", "body": "\n```suggestion\nimport mindustry.gen.*;\n```\n", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import mindustry.gen.Building;\n          \n          \n            \n            import mindustry.gen.*;", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"><span class=\"pl-k\">import</span> <span class=\"pl-smi\">mindustry.gen.<span class=\"x x-first x-last\">Building</span></span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\"><span class=\"pl-k\">import</span> <span class=\"pl-smi\">mindustry.gen.<span class=\"x x-first x-last\">*</span></span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "summetdev", "createdAt": "2020-12-14T11:20:07Z", "path": "core/src/mindustry/world/blocks/distribution/ChainedBuilding.java", "diffHunk": "@@ -0,0 +1,7 @@\n+package mindustry.world.blocks.distribution;\n+\n+import mindustry.gen.Building;", "originalCommit": "1e5b1c2ac0f1513684999ce7ceacbe35cdcf0875", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjMwNzk3Nw==", "url": "https://github.com/Anuken/Mindustry/pull/3912#discussion_r542307977", "body": "\n```suggestion\nimport mindustry.world.blocks.distribution.*;\n```\n", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import mindustry.world.blocks.distribution.ChainedBuilding;\n          \n          \n            \n            import mindustry.world.blocks.distribution.*;", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"><span class=\"pl-k\">import</span> <span class=\"pl-smi\">mindustry.world.blocks.distribution.<span class=\"x x-first x-last\">ChainedBuilding</span></span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\"><span class=\"pl-k\">import</span> <span class=\"pl-smi\">mindustry.world.blocks.distribution.<span class=\"x x-first x-last\">*</span></span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "summetdev", "createdAt": "2020-12-14T11:20:38Z", "path": "core/src/mindustry/world/blocks/liquid/Conduit.java", "diffHunk": "@@ -16,6 +16,7 @@\n import mindustry.type.*;\n import mindustry.world.*;\n import mindustry.world.blocks.*;\n+import mindustry.world.blocks.distribution.ChainedBuilding;", "originalCommit": "1e5b1c2ac0f1513684999ce7ceacbe35cdcf0875", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "43a97a8e365309bde787f6314b8fd3cb54e74273", "url": "https://github.com/Anuken/Mindustry/commit/43a97a8e365309bde787f6314b8fd3cb54e74273", "message": "style", "committedDate": "2020-12-14T14:11:13Z", "type": "commit"}]}