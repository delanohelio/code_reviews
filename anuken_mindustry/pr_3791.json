{"pr_number": 3791, "pr_title": "Enable double-click to play sector", "pr_author": "joshuaptfan", "pr_createdAt": "2020-12-05T09:10:59Z", "pr_url": "https://github.com/Anuken/Mindustry/pull/3791", "merge_commit": "e636ceb317b09c2a9a954b808cf5989142dab0aa", "timeline": [{"oid": "6ececea004a2b8459d92b089e678b82f0dc60b07", "url": "https://github.com/Anuken/Mindustry/commit/6ececea004a2b8459d92b089e678b82f0dc60b07", "message": "Enable double-click to play sector", "committedDate": "2020-12-05T08:58:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjkzMTU4OQ==", "url": "https://github.com/Anuken/Mindustry/pull/3791#discussion_r536931589", "body": "This should check for a double-tap. If I click a sector once, then click it once again later, it should not send me there.", "bodyText": "This should check for a double-tap. If I click a sector once, then click it once again later, it should not send me there.", "bodyHTML": "<p dir=\"auto\">This should check for a double-tap. If I click a sector once, then click it once again later, it should not send me there.</p>", "author": "Anuken", "createdAt": "2020-12-06T01:45:59Z", "path": "core/src/mindustry/ui/dialogs/PlanetDialog.java", "diffHunk": "@@ -412,6 +412,10 @@ void setup(){\n                     public void tap(InputEvent event, float x, float y, int count, KeyCode button){\n                         if(showing()) return;\n \n+                        if(selected == hovered){", "originalCommit": "6ececea004a2b8459d92b089e678b82f0dc60b07", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "58c1718d01e438aab503837d12d110954edc9696", "changed_code": [{"header": "diff --git a/core/src/mindustry/ui/dialogs/PlanetDialog.java b/core/src/mindustry/ui/dialogs/PlanetDialog.java\nindex 84fd58cc5..2e84352f5 100644\n--- a/core/src/mindustry/ui/dialogs/PlanetDialog.java\n+++ b/core/src/mindustry/ui/dialogs/PlanetDialog.java\n", "chunk": "@@ -405,6 +405,8 @@ public class PlanetDialog extends BaseDialog implements PlanetInterfaceRenderer{\n \n         stack(\n         new Element(){\n+            long tapMillis;\n+\n             {\n                 //add listener to the background rect, so it doesn't get unnecessary touch input\n                 addListener(new ElementGestureListener(){\n", "next_change": {"commit": "70cc6d07b09e7f3138f61a15be23ebd2629c28ec", "changed_code": [{"header": "diff --git a/core/src/mindustry/ui/dialogs/PlanetDialog.java b/core/src/mindustry/ui/dialogs/PlanetDialog.java\nindex 2e84352f5..7074c89a7 100644\n--- a/core/src/mindustry/ui/dialogs/PlanetDialog.java\n+++ b/core/src/mindustry/ui/dialogs/PlanetDialog.java\n", "chunk": "@@ -405,8 +406,6 @@ public class PlanetDialog extends BaseDialog implements PlanetInterfaceRenderer{\n \n         stack(\n         new Element(){\n-            long tapMillis;\n-\n             {\n                 //add listener to the background rect, so it doesn't get unnecessary touch input\n                 addListener(new ElementGestureListener(){\n", "next_change": null}, {"header": "diff --git a/core/src/mindustry/ui/dialogs/PlanetDialog.java b/core/src/mindustry/ui/dialogs/PlanetDialog.java\nindex 2e84352f5..7074c89a7 100644\n--- a/core/src/mindustry/ui/dialogs/PlanetDialog.java\n+++ b/core/src/mindustry/ui/dialogs/PlanetDialog.java\n", "chunk": "@@ -414,13 +413,12 @@ public class PlanetDialog extends BaseDialog implements PlanetInterfaceRenderer{\n                     public void tap(InputEvent event, float x, float y, int count, KeyCode button){\n                         if(showing()) return;\n \n-                        if(selected == hovered && Time.timeSinceMillis(tapMillis) < 500){\n+                        if(selected == hovered && count == 2){\n                             playSelected();\n                         }\n \n                         if(hovered != null && (canSelect(hovered) || debugSelect)){\n                             selected = hovered;\n-                            tapMillis = Time.millis();\n                         }\n \n                         if(selected != null){\n", "next_change": null}]}}, {"header": "diff --git a/core/src/mindustry/ui/dialogs/PlanetDialog.java b/core/src/mindustry/ui/dialogs/PlanetDialog.java\nindex 84fd58cc5..2e84352f5 100644\n--- a/core/src/mindustry/ui/dialogs/PlanetDialog.java\n+++ b/core/src/mindustry/ui/dialogs/PlanetDialog.java\n", "chunk": "@@ -412,12 +414,13 @@ public class PlanetDialog extends BaseDialog implements PlanetInterfaceRenderer{\n                     public void tap(InputEvent event, float x, float y, int count, KeyCode button){\n                         if(showing()) return;\n \n-                        if(selected == hovered){\n+                        if(selected == hovered && Time.timeSinceMillis(tapMillis) < 500){\n                             playSelected();\n                         }\n \n                         if(hovered != null && (canSelect(hovered) || debugSelect)){\n                             selected = hovered;\n+                            tapMillis = Time.millis();\n                         }\n \n                         if(selected != null){\n", "next_change": {"commit": "70cc6d07b09e7f3138f61a15be23ebd2629c28ec", "changed_code": [{"header": "diff --git a/core/src/mindustry/ui/dialogs/PlanetDialog.java b/core/src/mindustry/ui/dialogs/PlanetDialog.java\nindex 2e84352f5..7074c89a7 100644\n--- a/core/src/mindustry/ui/dialogs/PlanetDialog.java\n+++ b/core/src/mindustry/ui/dialogs/PlanetDialog.java\n", "chunk": "@@ -414,13 +413,12 @@ public class PlanetDialog extends BaseDialog implements PlanetInterfaceRenderer{\n                     public void tap(InputEvent event, float x, float y, int count, KeyCode button){\n                         if(showing()) return;\n \n-                        if(selected == hovered && Time.timeSinceMillis(tapMillis) < 500){\n+                        if(selected == hovered && count == 2){\n                             playSelected();\n                         }\n \n                         if(hovered != null && (canSelect(hovered) || debugSelect)){\n                             selected = hovered;\n-                            tapMillis = Time.millis();\n                         }\n \n                         if(selected != null){\n", "next_change": null}]}}]}}, {"oid": "58c1718d01e438aab503837d12d110954edc9696", "url": "https://github.com/Anuken/Mindustry/commit/58c1718d01e438aab503837d12d110954edc9696", "message": "Detect double-tap", "committedDate": "2020-12-06T06:07:09Z", "type": "commit"}, {"oid": "dd6ae80817279e890fc0dbe933ef01ef58fef059", "url": "https://github.com/Anuken/Mindustry/commit/dd6ae80817279e890fc0dbe933ef01ef58fef059", "message": "Merge remote-tracking branch 'origin/master'", "committedDate": "2020-12-06T06:56:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzA0OTkzNA==", "url": "https://github.com/Anuken/Mindustry/pull/3791#discussion_r537049934", "body": "`int count` already stored the amount of taps done, you shouldn't need to do your own calculations.", "bodyText": "int count already stored the amount of taps done, you shouldn't need to do your own calculations.", "bodyHTML": "<p dir=\"auto\"><code>int count</code> already stored the amount of taps done, you shouldn't need to do your own calculations.</p>", "author": "Anuken", "createdAt": "2020-12-06T14:28:40Z", "path": "core/src/mindustry/ui/dialogs/PlanetDialog.java", "diffHunk": "@@ -405,19 +405,22 @@ void setup(){\n \n         stack(\n         new Element(){\n+            long tapMillis;\n+\n             {\n                 //add listener to the background rect, so it doesn't get unnecessary touch input\n                 addListener(new ElementGestureListener(){\n                     @Override\n                     public void tap(InputEvent event, float x, float y, int count, KeyCode button){\n                         if(showing()) return;\n \n-                        if(selected == hovered){\n+                        if(selected == hovered && Time.timeSinceMillis(tapMillis) < 500){", "originalCommit": "58c1718d01e438aab503837d12d110954edc9696", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "70cc6d07b09e7f3138f61a15be23ebd2629c28ec", "changed_code": [{"header": "diff --git a/core/src/mindustry/ui/dialogs/PlanetDialog.java b/core/src/mindustry/ui/dialogs/PlanetDialog.java\nindex 2e84352f5..7074c89a7 100644\n--- a/core/src/mindustry/ui/dialogs/PlanetDialog.java\n+++ b/core/src/mindustry/ui/dialogs/PlanetDialog.java\n", "chunk": "@@ -405,8 +406,6 @@ public class PlanetDialog extends BaseDialog implements PlanetInterfaceRenderer{\n \n         stack(\n         new Element(){\n-            long tapMillis;\n-\n             {\n                 //add listener to the background rect, so it doesn't get unnecessary touch input\n                 addListener(new ElementGestureListener(){\n", "next_change": null}, {"header": "diff --git a/core/src/mindustry/ui/dialogs/PlanetDialog.java b/core/src/mindustry/ui/dialogs/PlanetDialog.java\nindex 2e84352f5..7074c89a7 100644\n--- a/core/src/mindustry/ui/dialogs/PlanetDialog.java\n+++ b/core/src/mindustry/ui/dialogs/PlanetDialog.java\n", "chunk": "@@ -414,13 +413,12 @@ public class PlanetDialog extends BaseDialog implements PlanetInterfaceRenderer{\n                     public void tap(InputEvent event, float x, float y, int count, KeyCode button){\n                         if(showing()) return;\n \n-                        if(selected == hovered && Time.timeSinceMillis(tapMillis) < 500){\n+                        if(selected == hovered && count == 2){\n                             playSelected();\n                         }\n \n                         if(hovered != null && (canSelect(hovered) || debugSelect)){\n                             selected = hovered;\n-                            tapMillis = Time.millis();\n                         }\n \n                         if(selected != null){\n", "next_change": null}]}}, {"oid": "70cc6d07b09e7f3138f61a15be23ebd2629c28ec", "url": "https://github.com/Anuken/Mindustry/commit/70cc6d07b09e7f3138f61a15be23ebd2629c28ec", "message": "Detect double-tap using count", "committedDate": "2020-12-06T15:52:50Z", "type": "commit"}]}