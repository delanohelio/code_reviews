{"pr_number": 15809, "pr_title": "Redact sensitive information from response body in test recordings", "pr_author": "samvaity", "pr_createdAt": "2020-09-29T21:29:59Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/15809", "timeline": [{"oid": "4eac7fb6911b45b4f3771edce446ef75620be6f2", "url": "https://github.com/Azure/azure-sdk-for-java/commit/4eac7fb6911b45b4f3771edce446ef75620be6f2", "message": "redact json key patterns from test recordings", "committedDate": "2020-09-29T21:26:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzA3NTMwNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15809#discussion_r497075305", "body": "Given that many of these patterns are simply looking for a JSON property should we combine them into a single pattern?\r\n\r\n```java\r\nprivate static final Pattern JSON_PROPERTY_PATTERN = Pattern.compile(\"(?:\\\"(?:<JSPNSP>)\\\")(.*?)(?:\\\",|\\\"})\");\r\n```\r\n\r\nWhere JSPNSP means JSON property name separated by pipe.", "bodyText": "Given that many of these patterns are simply looking for a JSON property should we combine them into a single pattern?\nprivate static final Pattern JSON_PROPERTY_PATTERN = Pattern.compile(\"(?:\\\"(?:<JSPNSP>)\\\")(.*?)(?:\\\",|\\\"})\");\nWhere JSPNSP means JSON property name separated by pipe.", "bodyHTML": "<p dir=\"auto\">Given that many of these patterns are simply looking for a JSON property should we combine them into a single pattern?</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"private static final Pattern JSON_PROPERTY_PATTERN = Pattern.compile(&quot;(?:\\&quot;(?:&lt;JSPNSP&gt;)\\&quot;)(.*?)(?:\\&quot;,|\\&quot;})&quot;);\n\"><pre><span class=\"pl-k\">private</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">final</span> <span class=\"pl-smi\">Pattern</span> <span class=\"pl-c1\">JSON_PROPERTY_PATTERN</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Pattern</span><span class=\"pl-k\">.</span>compile(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>(?:<span class=\"pl-cce\">\\\"</span>(?:&lt;JSPNSP&gt;)<span class=\"pl-cce\">\\\"</span>)(.*?)(?:<span class=\"pl-cce\">\\\"</span>,|<span class=\"pl-cce\">\\\"</span>})<span class=\"pl-pds\">\"</span></span>);</pre></div>\n<p dir=\"auto\">Where JSPNSP means JSON property name separated by pipe.</p>", "author": "alzimmermsft", "createdAt": "2020-09-29T21:37:55Z", "path": "sdk/core/azure-core-test/src/main/java/com/azure/core/test/models/RecordingRedactor.java", "diffHunk": "@@ -20,9 +20,21 @@\n     private static final String REDACTED_UTF_8 = Base64.getEncoder().encodeToString(REDACTED.getBytes(StandardCharsets.UTF_8));\n \n     private static final Pattern ACCESS_TOKEN_KEY_PATTERN = Pattern.compile(\"(?:\\\"accessToken\\\":\\\")(.*?)(?:\\\",|\\\"})\");\n+    private static final Pattern AUTH_HEADER_KEY_PATTERN = Pattern.compile(\"(?:\\\"authHeader\\\":\\\")(.*?)(?:\\\",|\\\"})\");", "originalCommit": "4eac7fb6911b45b4f3771edce446ef75620be6f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzA3NTc1NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15809#discussion_r497075754", "bodyText": "Another option is moving these into a static constructor and maintaining a list/array of JSON property names to redact and generated the pattern at construction time.", "author": "alzimmermsft", "createdAt": "2020-09-29T21:38:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzA3NTMwNQ=="}], "type": "inlineReview"}, {"oid": "79a631d58baed213cbb9a03174947b4ef32d675b", "url": "https://github.com/Azure/azure-sdk-for-java/commit/79a631d58baed213cbb9a03174947b4ef32d675b", "message": "update opens to commons", "committedDate": "2020-09-29T21:47:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzU5NzMyNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15809#discussion_r497597327", "body": "Shouldn't require an opens to JUnit in the `module-info`, should only be required in the POM where you made your other change.", "bodyText": "Shouldn't require an opens to JUnit in the module-info, should only be required in the POM where you made your other change.", "bodyHTML": "<p dir=\"auto\">Shouldn't require an opens to JUnit in the <code>module-info</code>, should only be required in the POM where you made your other change.</p>", "author": "alzimmermsft", "createdAt": "2020-09-30T15:21:42Z", "path": "sdk/core/azure-core-test/src/main/java/module-info.java", "diffHunk": "@@ -16,7 +16,7 @@\n \n     opens com.azure.core.test.implementation to com.fasterxml.jackson.databind, com.azure.core;\n     opens com.azure.core.test.implementation.entities to com.fasterxml.jackson.databind, com.azure.core;\n-    opens com.azure.core.test to com.fasterxml.jackson.databind;\n+    opens com.azure.core.test to com.fasterxml.jackson.databind, org.junit.platform.commons;", "originalCommit": "79a631d58baed213cbb9a03174947b4ef32d675b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "34a2e518ba9eb23e046183dace5a56ac859e71eb", "url": "https://github.com/Azure/azure-sdk-for-java/commit/34a2e518ba9eb23e046183dace5a56ac859e71eb", "message": "add json key pattern list", "committedDate": "2020-10-01T09:11:14Z", "type": "commit"}, {"oid": "34a2e518ba9eb23e046183dace5a56ac859e71eb", "url": "https://github.com/Azure/azure-sdk-for-java/commit/34a2e518ba9eb23e046183dace5a56ac859e71eb", "message": "add json key pattern list", "committedDate": "2020-10-01T09:11:14Z", "type": "forcePushed"}, {"oid": "d86628a8a86efe0aa6a60ba33df77d3535f0bc88", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d86628a8a86efe0aa6a60ba33df77d3535f0bc88", "message": "opens update", "committedDate": "2020-10-01T17:19:50Z", "type": "commit"}, {"oid": "fd49df379a8e825205ae8980accd71d12f65e0d5", "url": "https://github.com/Azure/azure-sdk-for-java/commit/fd49df379a8e825205ae8980accd71d12f65e0d5", "message": "update opens", "committedDate": "2020-10-01T18:32:41Z", "type": "commit"}]}