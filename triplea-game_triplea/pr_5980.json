{"pr_number": 5980, "pr_title": "Add username and password fields to PBF selection screen", "pr_author": "DanVanAtta", "pr_createdAt": "2020-02-25T06:52:18Z", "pr_url": "https://github.com/triplea-game/triplea/pull/5980", "timeline": [{"oid": "4c47978aa077ac1e26ff014e677202679aef2e63", "url": "https://github.com/triplea-game/triplea/commit/4c47978aa077ac1e26ff014e677202679aef2e63", "message": "Add username and password fields to PBF selection screen\n\nThe two fields are required in order to do a test posting or\nto start a PBF game. This update places the two required fields\non the same screen where we have the 'play' button.\n\nThis update adds similar 'highlight field label red if invalid'\nfor the username and password field.\n\nOf note, to avoid circular event callbacks between view and\nview-model, the view updates its own state after firing an\nevent on the view-model. For example, the username field\nsets the view-model username value, the view then queries\nand updates to see if any labels or buttons are updated and\nenabled. The view model could invoke the view to update all\nfields, this can then trigger another callback though to the\nview when fields are updated and action listeners fire to\nupdate the view model which can then again trigger a view\nrefresh and so-on.", "committedDate": "2020-02-25T06:46:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgxMjMxOQ==", "url": "https://github.com/triplea-game/triplea/pull/5980#discussion_r384812319", "body": "Just noticed this: It should be easily removable now that guava's `Predicates#not` can be replaced with [`Predicate#not`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Predicate.html#not(java.util.function.Predicate)) from the standard library", "bodyText": "Just noticed this: It should be easily removable now that guava's Predicates#not can be replaced with Predicate#not from the standard library", "bodyHTML": "<p dir=\"auto\">Just noticed this: It should be easily removable now that guava's <code>Predicates#not</code> can be replaced with <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Predicate.html#not(java.util.function.Predicate)\" rel=\"nofollow\"><code>Predicate#not</code></a> from the standard library</p>", "author": "RoiEXLab", "createdAt": "2020-02-26T22:41:58Z", "path": "game-core/src/main/java/games/strategy/engine/framework/startup/ui/posted/game/pbf/ForumPosterEditorViewModel.java", "diffHunk": "@@ -48,6 +48,28 @@\n     populateFromGameProperties(properties);\n   }\n \n+  void setForumPassword(final char[] password) {\n+    final ClientSetting<char[]> passwordSetting =\n+        forumSelection.equals(NodeBbForumPoster.TRIPLEA_FORUM_DISPLAY_NAME)\n+            ? ClientSetting.tripleaForumPassword\n+            : ClientSetting.aaForumPassword;\n+\n+    passwordSetting.setValueAndFlush(password);\n+    forumPassword = password;\n+    readyCallback.run();\n+  }\n+\n+  void setForumUsername(final String username) {\n+    final ClientSetting<char[]> usernameSetting =\n+        forumSelection.equals(NodeBbForumPoster.TRIPLEA_FORUM_DISPLAY_NAME)\n+            ? ClientSetting.tripleaForumUsername\n+            : ClientSetting.aaForumUsername;\n+\n+    usernameSetting.setValueAndFlush(username.toCharArray());\n+    forumUsername = username;\n+    readyCallback.run();\n+  }\n+\n   @SuppressWarnings(\"Guava\")", "originalCommit": "4c47978aa077ac1e26ff014e677202679aef2e63", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDkwMDEyMQ==", "url": "https://github.com/triplea-game/triplea/pull/5980#discussion_r384900121", "bodyText": "Ah, indeed, thanks. The auto-correct for the warning was giving a nasty \".negation()\"\nUpdated in: 668a0df", "author": "DanVanAtta", "createdAt": "2020-02-27T03:50:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgxMjMxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgxMzIxNw==", "url": "https://github.com/triplea-game/triplea/pull/5980#discussion_r384813217", "body": "```suggestion\r\n            ? ClientSetting.tripleaForumPassword.getValue().orElse(new char[0])\r\n            : ClientSetting.aaForumPassword.getValue().orElse(new char[0]);\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        ? ClientSetting.tripleaForumPassword.getValue().orElse(new char[] {})\n          \n          \n            \n                        : ClientSetting.aaForumPassword.getValue().orElse(new char[] {});\n          \n          \n            \n                        ? ClientSetting.tripleaForumPassword.getValue().orElse(new char[0])\n          \n          \n            \n                        : ClientSetting.aaForumPassword.getValue().orElse(new char[0]);", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">?</span> <span class=\"pl-smi\">ClientSetting</span><span class=\"pl-k\">.</span>tripleaForumPassword<span class=\"pl-k\">.</span>getValue()<span class=\"pl-k\">.</span>orElse(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">char</span>[<span class=\"x x-first x-last\">] {}</span>)</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">:</span> <span class=\"pl-smi\">ClientSetting</span><span class=\"pl-k\">.</span>aaForumPassword<span class=\"pl-k\">.</span>getValue()<span class=\"pl-k\">.</span>orElse(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">char</span>[<span class=\"x x-first x-last\">] {}</span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">?</span> <span class=\"pl-smi\">ClientSetting</span><span class=\"pl-k\">.</span>tripleaForumPassword<span class=\"pl-k\">.</span>getValue()<span class=\"pl-k\">.</span>orElse(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">char</span>[<span class=\"pl-c1 x x-first\">0</span><span class=\"x x-last\">]</span>)</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">:</span> <span class=\"pl-smi\">ClientSetting</span><span class=\"pl-k\">.</span>aaForumPassword<span class=\"pl-k\">.</span>getValue()<span class=\"pl-k\">.</span>orElse(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">char</span>[<span class=\"pl-c1 x x-first\">0</span><span class=\"x x-last\">]</span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "RoiEXLab", "createdAt": "2020-02-26T22:44:12Z", "path": "game-core/src/main/java/games/strategy/engine/framework/startup/ui/posted/game/pbf/ForumPosterEditorViewModel.java", "diffHunk": "@@ -60,8 +82,14 @@ synchronized void setForumSelection(final String forumSelection) {\n         \"Forum selection is driven by a drop-down to ensure user can never set it to null, \"\n             + \"if setting to null from a game properties, we default to the first available \"\n             + \"selection entry, forum selection should never be null or empty.\");\n-    viewForumPostButtonEnabled = areFieldsValid();\n-    testForumPostButtonEnabled = areFieldsValid();\n+    forumUsername =\n+        this.forumSelection.equals(NodeBbForumPoster.TRIPLEA_FORUM_DISPLAY_NAME)\n+            ? ClientSetting.tripleaForumUsername.getValue().map(String::valueOf).orElse(\"\")\n+            : ClientSetting.aaForumUsername.getValue().map(String::valueOf).orElse(\"\");\n+    forumPassword =\n+        this.forumSelection.equals(NodeBbForumPoster.TRIPLEA_FORUM_DISPLAY_NAME)\n+            ? ClientSetting.tripleaForumPassword.getValue().orElse(new char[] {})\n+            : ClientSetting.aaForumPassword.getValue().orElse(new char[] {});", "originalCommit": "4c47978aa077ac1e26ff014e677202679aef2e63", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDg5OTYxMA==", "url": "https://github.com/triplea-game/triplea/pull/5980#discussion_r384899610", "bodyText": "Is this just personal preference @RoiEXLab ?", "author": "DanVanAtta", "createdAt": "2020-02-27T03:48:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgxMzIxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDk1MTkwNg==", "url": "https://github.com/triplea-game/triplea/pull/5980#discussion_r384951906", "bodyText": "Well yes, it's shorter and tbh I'm not really a fan of empty curly braces anywhere.\nJust a weird thing of mine", "author": "RoiEXLab", "createdAt": "2020-02-27T07:28:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgxMzIxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDgxNTU0NA==", "url": "https://github.com/triplea-game/triplea/pull/5980#discussion_r384815544", "body": "```suggestion\r\n        Arguments.of(\"1\", \"\", new char[0]));\r\n```\r\n\r\nBut in this scenario I would be ok with keeping the initializer curly braces because of consistency", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    Arguments.of(\"1\", \"\", new char[] {}));\n          \n          \n            \n                    Arguments.of(\"1\", \"\", new char[0]));\n          \n      \n    \n    \n  \n\nBut in this scenario I would be ok with keeping the initializer curly braces because of consistency", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"154\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-smi\">Arguments</span><span class=\"pl-k\">.</span>of(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>1<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>, <span class=\"pl-k\">new</span> <span class=\"pl-smi\">char</span>[<span class=\"x x-first x-last\">] {}</span>));</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"154\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-smi\">Arguments</span><span class=\"pl-k\">.</span>of(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>1<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>, <span class=\"pl-k\">new</span> <span class=\"pl-smi\">char</span>[<span class=\"pl-c1 x x-first\">0</span><span class=\"x x-last\">]</span>));</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n\n<p dir=\"auto\">But in this scenario I would be ok with keeping the initializer curly braces because of consistency</p>", "author": "RoiEXLab", "createdAt": "2020-02-26T22:49:53Z", "path": "game-core/src/test/java/games/strategy/engine/framework/startup/ui/posted/game/pbf/ForumPosterEditorViewModelTest.java", "diffHunk": "@@ -129,45 +131,49 @@ void viewForumPostNoOpOnInvalidData(final String forumSelection, final String to\n   }\n \n   private ForumPosterEditorViewModel givenViewModelWithInvalidFieldSettings(\n-      final String forumSelection, final String topicId) {\n+      final String topicId, final String username, final char[] password) {\n     final ForumPosterEditorViewModel viewModel = new ForumPosterEditorViewModel(() -> {});\n-    viewModel.setForumSelection(forumSelection);\n     viewModel.setTopicId(topicId);\n-    Preconditions.checkState(\n-        !viewModel.isTopicIdValid(), \"Test makes sense only if topic id is invalid\");\n+    viewModel.setForumUsername(username);\n+    viewModel.setForumPassword(password);\n     return viewModel;\n   }\n \n   @SuppressWarnings(\"unused\")\n   private static List<Arguments> invalidForumSettings() {\n     return List.of(\n-        Arguments.of(\"forumSelection\", \"not a number\"),\n-        Arguments.of(\"forumSelection\", \"\"),\n-        Arguments.of(\"forumSelection\", \"0.0\"),\n-        Arguments.of(\"forumSelection\", \"0\"),\n-        Arguments.of(\"forumSelection\", \"-1\"));\n+        // invalid topic IDs\n+        Arguments.of(\"not a number\", \"user\", new char[] {'a'}),\n+        Arguments.of(\"\", \"user\", new char[] {'a'}),\n+        Arguments.of(\"0.0\", \"user\", new char[] {'a'}),\n+        Arguments.of(\"0\", \"user\", new char[] {'a'}),\n+        Arguments.of(\"-1\", \"user\", new char[] {'a'}),\n+        // missing user\n+        Arguments.of(\"1\", \"\", new char[] {'a'}),\n+        // missing password\n+        Arguments.of(\"1\", \"\", new char[] {}));", "originalCommit": "4c47978aa077ac1e26ff014e677202679aef2e63", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "668a0dfd1ff1e93caaa44d21c2a1c39932ee72b1", "url": "https://github.com/triplea-game/triplea/commit/668a0dfd1ff1e93caaa44d21c2a1c39932ee72b1", "message": "Use non-guava for predicate", "committedDate": "2020-02-27T03:50:11Z", "type": "commit"}, {"oid": "7281536d833aa5e07881c8e3dd618cd4be2fd794", "url": "https://github.com/triplea-game/triplea/commit/7281536d833aa5e07881c8e3dd618cd4be2fd794", "message": "Update game-core/src/main/java/games/strategy/engine/framework/startup/ui/posted/game/pbf/ForumPosterEditorViewModel.java\n\nCo-Authored-By: RoiEX <8350879+RoiEXLab@users.noreply.github.com>", "committedDate": "2020-02-27T04:13:01Z", "type": "commit"}]}