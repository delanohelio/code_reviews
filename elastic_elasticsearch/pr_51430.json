{"pr_number": 51430, "pr_title": "Avoid unnecessary setup and teardown in docs tests", "pr_author": "ywelsch", "pr_createdAt": "2020-01-24T16:16:57Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/51430", "timeline": [{"oid": "6dae41f96947e24b33c264a3c9268b7ce381fba8", "url": "https://github.com/elastic/elasticsearch/commit/6dae41f96947e24b33c264a3c9268b7ce381fba8", "message": "avoid unnecessary setup and teardown", "committedDate": "2020-01-24T15:33:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDcyMTQyMw==", "url": "https://github.com/elastic/elasticsearch/pull/51430#discussion_r370721423", "body": "This one does not really contribute to the slowdown, but I found this one when I was investigating things and was repeatedly seeing  `install-token-metadata` cluster state updates (which become NOOPs) because the condition here is checking the wrong customs. /cc: @jkakavas ", "bodyText": "This one does not really contribute to the slowdown, but I found this one when I was investigating things and was repeatedly seeing  install-token-metadata cluster state updates (which become NOOPs) because the condition here is checking the wrong customs. /cc: @jkakavas", "bodyHTML": "<p dir=\"auto\">This one does not really contribute to the slowdown, but I found this one when I was investigating things and was repeatedly seeing  <code>install-token-metadata</code> cluster state updates (which become NOOPs) because the condition here is checking the wrong customs. /cc: <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/jkakavas/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/jkakavas\">@jkakavas</a></p>", "author": "ywelsch", "createdAt": "2020-01-24T16:24:02Z", "path": "x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/TokenService.java", "diffHunk": "@@ -2044,8 +2044,8 @@ private void initialize(ClusterService clusterService) {\n     // to prevent too many cluster state update tasks to be queued for doing the same update\n     private final AtomicBoolean installTokenMetadataInProgress = new AtomicBoolean(false);\n \n-    private void installTokenMetadata(MetaData metaData) {\n-        if (metaData.custom(TokenMetaData.TYPE) == null) {\n+    private void installTokenMetadata(ClusterState state) {\n+        if (state.custom(TokenMetaData.TYPE) == null) {", "originalCommit": "6dae41f96947e24b33c264a3c9268b7ce381fba8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "61b44309f20ea224d9132cbcbf5dec090a2f39e5", "url": "https://github.com/elastic/elasticsearch/commit/61b44309f20ea224d9132cbcbf5dec090a2f39e5", "message": "checkstyle bla", "committedDate": "2020-01-24T16:34:32Z", "type": "commit"}, {"oid": "18483d63d77d314c4e91b309b196928fa09f55d0", "url": "https://github.com/elastic/elasticsearch/commit/18483d63d77d314c4e91b309b196928fa09f55d0", "message": "another checkstyle", "committedDate": "2020-01-24T16:58:23Z", "type": "commit"}]}