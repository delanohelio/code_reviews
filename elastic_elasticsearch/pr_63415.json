{"pr_number": 63415, "pr_title": "EQL: Avoid filtering on tiebreakers", "pr_author": "costin", "pr_createdAt": "2020-10-07T15:08:10Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/63415", "timeline": [{"oid": "de295de23ce795a30162958f7ee1c4f38676f72a", "url": "https://github.com/elastic/elasticsearch/commit/de295de23ce795a30162958f7ee1c4f38676f72a", "message": "EQL: Avoid filtering on tiebreakers\n\nDo not filter by tiebreaker while searching sequence matches as\nit's not monotonic and thus can filter out valid data.\nAdd handling for data 'near' the boundary that has the same timestamp\nbut different tie-breaker and thus can be just outside the window.\n\nFix #62781\nRelates #63215", "committedDate": "2020-10-07T15:40:04Z", "type": "commit"}, {"oid": "de295de23ce795a30162958f7ee1c4f38676f72a", "url": "https://github.com/elastic/elasticsearch/commit/de295de23ce795a30162958f7ee1c4f38676f72a", "message": "EQL: Avoid filtering on tiebreakers\n\nDo not filter by tiebreaker while searching sequence matches as\nit's not monotonic and thus can filter out valid data.\nAdd handling for data 'near' the boundary that has the same timestamp\nbut different tie-breaker and thus can be just outside the window.\n\nFix #62781\nRelates #63215", "committedDate": "2020-10-07T15:40:04Z", "type": "forcePushed"}, {"oid": "1ff4fd125de499f05058a59a5026c3906908252c", "url": "https://github.com/elastic/elasticsearch/commit/1ff4fd125de499f05058a59a5026c3906908252c", "message": "Update test specs", "committedDate": "2020-10-07T16:57:28Z", "type": "commit"}, {"oid": "f7f8af6e6fc420dd63a5d236d646cd3d73662254", "url": "https://github.com/elastic/elasticsearch/commit/f7f8af6e6fc420dd63a5d236d646cd3d73662254", "message": "More docs", "committedDate": "2020-10-07T17:54:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTUxNTQzOA==", "url": "https://github.com/elastic/elasticsearch/pull/63415#discussion_r501515438", "body": "```suggestion\r\n            // however check if the window has been fully consumed\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        // however check if the window has been fully consumed consumed\n          \n          \n            \n                        // however check if the window has been fully consumed", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-c\"><span class=\"pl-c\">//</span> however check if the window has been fully consumed<span class=\"x x-first x-last\"> consumed</span></span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-c\"><span class=\"pl-c\">//</span> however check if the window has been fully consumed</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "matriv", "createdAt": "2020-10-08T07:49:56Z", "path": "x-pack/plugin/eql/src/main/java/org/elasticsearch/xpack/eql/execution/sequence/TumblingWindow.java", "diffHunk": "@@ -245,7 +264,8 @@ private void secondaryCriterion(WindowInfo window, int currentStage, ActionListe\n             }\n \n             // keep running the query runs out of the results (essentially returns less than what we want)\n-            if (hits.size() == windowSize) {\n+            // however check if the window has been fully consumed consumed", "originalCommit": "f7f8af6e6fc420dd63a5d236d646cd3d73662254", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "eaf18c2d9ead41604ef6dbb8dec782b40a97248a", "url": "https://github.com/elastic/elasticsearch/commit/eaf18c2d9ead41604ef6dbb8dec782b40a97248a", "message": "fix comment", "committedDate": "2020-10-08T09:16:30Z", "type": "commit"}]}