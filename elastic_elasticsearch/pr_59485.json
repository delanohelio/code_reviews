{"pr_number": 59485, "pr_title": "Allow null name when deserialising API key document", "pr_author": "ywangd", "pr_createdAt": "2020-07-14T01:15:57Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/59485", "timeline": [{"oid": "2749a115435e338531c37f25a668d1a063e66cef", "url": "https://github.com/elastic/elasticsearch/commit/2749a115435e338531c37f25a668d1a063e66cef", "message": "Allow null name when deserialising API key document", "committedDate": "2020-07-14T01:00:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDA0MTgyNw==", "url": "https://github.com/elastic/elasticsearch/pull/59485#discussion_r454041827", "body": "Removed `Nullable` and replaced `optionalConstructorArg()` with `constructorArg()` for `hash` and `roleDescriptorsBytes` fields for clarity:\r\n* The parser does not allow them to be null without something like `builder.declareStringOrNull(...)`. Therefore the `Nullable` etc does not have any effects anyway. In another word, the overall code logic is not impacted.\r\n* Based on the logic in `ApiKeyService#newDocument`, these two fields can never be null.\r\n", "bodyText": "Removed Nullable and replaced optionalConstructorArg() with constructorArg() for hash and roleDescriptorsBytes fields for clarity:\n\nThe parser does not allow them to be null without something like builder.declareStringOrNull(...). Therefore the Nullable etc does not have any effects anyway. In another word, the overall code logic is not impacted.\nBased on the logic in ApiKeyService#newDocument, these two fields can never be null.", "bodyHTML": "<p dir=\"auto\">Removed <code>Nullable</code> and replaced <code>optionalConstructorArg()</code> with <code>constructorArg()</code> for <code>hash</code> and <code>roleDescriptorsBytes</code> fields for clarity:</p>\n<ul dir=\"auto\">\n<li>The parser does not allow them to be null without something like <code>builder.declareStringOrNull(...)</code>. Therefore the <code>Nullable</code> etc does not have any effects anyway. In another word, the overall code logic is not impacted.</li>\n<li>Based on the logic in <code>ApiKeyService#newDocument</code>, these two fields can never be null.</li>\n</ul>", "author": "ywangd", "createdAt": "2020-07-14T01:23:10Z", "path": "x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/ApiKeyService.java", "diffHunk": "@@ -1058,10 +1057,10 @@ public ApiKeyDoc(\n             long creationTime,\n             long expirationTime,\n             Boolean invalidated,\n-            @Nullable String hash,\n-            String name,\n+            String hash,\n+            @Nullable String name,\n             int version,\n-            @Nullable BytesReference roleDescriptorsBytes,\n+            BytesReference roleDescriptorsBytes,", "originalCommit": "2749a115435e338531c37f25a668d1a063e66cef", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}