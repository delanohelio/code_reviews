{"pr_number": 64867, "pr_title": "Remove the deprecated local parameter for _cat/shards", "pr_author": "danhermann", "pr_createdAt": "2020-11-10T13:51:48Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/64867", "timeline": [{"oid": "a809e4ad7b7f89856859eb52cdf32e52dec25037", "url": "https://github.com/elastic/elasticsearch/commit/a809e4ad7b7f89856859eb52cdf32e52dec25037", "message": "Remove the deprecated local parameter for _cat/shards", "committedDate": "2020-11-10T13:46:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDcwMzc2NQ==", "url": "https://github.com/elastic/elasticsearch/pull/64867#discussion_r520703765", "body": "You don't need to add this I believe, we automatically throw exceptions on unrecognized parameters:\r\n\r\n```\r\n{\r\n  \"error\" : {\r\n    \"root_cause\" : [\r\n      {\r\n        \"type\" : \"illegal_argument_exception\",\r\n        \"reason\" : \"request [/_cat/shards] contains unrecognized parameter: [aoeu]\"\r\n      }\r\n    ],\r\n    \"type\" : \"illegal_argument_exception\",\r\n    \"reason\" : \"request [/_cat/shards] contains unrecognized parameter: [aoeu]\"\r\n  },\r\n  \"status\" : 400\r\n}\r\n```", "bodyText": "You don't need to add this I believe, we automatically throw exceptions on unrecognized parameters:\n{\n  \"error\" : {\n    \"root_cause\" : [\n      {\n        \"type\" : \"illegal_argument_exception\",\n        \"reason\" : \"request [/_cat/shards] contains unrecognized parameter: [aoeu]\"\n      }\n    ],\n    \"type\" : \"illegal_argument_exception\",\n    \"reason\" : \"request [/_cat/shards] contains unrecognized parameter: [aoeu]\"\n  },\n  \"status\" : 400\n}", "bodyHTML": "<p dir=\"auto\">You don't need to add this I believe, we automatically throw exceptions on unrecognized parameters:</p>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n  &quot;error&quot; : {\n    &quot;root_cause&quot; : [\n      {\n        &quot;type&quot; : &quot;illegal_argument_exception&quot;,\n        &quot;reason&quot; : &quot;request [/_cat/shards] contains unrecognized parameter: [aoeu]&quot;\n      }\n    ],\n    &quot;type&quot; : &quot;illegal_argument_exception&quot;,\n    &quot;reason&quot; : &quot;request [/_cat/shards] contains unrecognized parameter: [aoeu]&quot;\n  },\n  &quot;status&quot; : 400\n}\"><pre><code>{\n  \"error\" : {\n    \"root_cause\" : [\n      {\n        \"type\" : \"illegal_argument_exception\",\n        \"reason\" : \"request [/_cat/shards] contains unrecognized parameter: [aoeu]\"\n      }\n    ],\n    \"type\" : \"illegal_argument_exception\",\n    \"reason\" : \"request [/_cat/shards] contains unrecognized parameter: [aoeu]\"\n  },\n  \"status\" : 400\n}\n</code></pre></div>", "author": "dakrone", "createdAt": "2020-11-10T16:36:17Z", "path": "server/src/main/java/org/elasticsearch/rest/action/cat/RestShardsAction.java", "diffHunk": "@@ -90,10 +88,10 @@ protected void documentation(StringBuilder sb) {\n     public RestChannelConsumer doCatRequest(final RestRequest request, final NodeClient client) {\n         final String[] indices = Strings.splitStringByCommaToArray(request.param(\"index\"));\n         final ClusterStateRequest clusterStateRequest = new ClusterStateRequest();\n-        if (request.hasParam(\"local\")) {\n-            DEPRECATION_LOGGER.deprecate(\"local\", LOCAL_DEPRECATED_MESSAGE);\n+        // needed only in v8 to catch breaking usages and can be removed in v9\n+        if (request.hasParam(\"local\")  && Version.CURRENT.major == Version.V_7_0_0.major + 1) {\n+            throw new IllegalArgumentException(\"parameter [local] is not supported\");", "originalCommit": "a809e4ad7b7f89856859eb52cdf32e52dec25037", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "26384068e89f06a84183e98d5e9ead4cf5628a18", "url": "https://github.com/elastic/elasticsearch/commit/26384068e89f06a84183e98d5e9ead4cf5628a18", "message": "remove redundant check", "committedDate": "2020-11-11T17:04:26Z", "type": "commit"}, {"oid": "490011895ad0da61cc049ac901150cebc06d129e", "url": "https://github.com/elastic/elasticsearch/commit/490011895ad0da61cc049ac901150cebc06d129e", "message": "Merge branch 'master' into remove_local_for_cat_shards", "committedDate": "2020-11-11T17:25:07Z", "type": "commit"}]}