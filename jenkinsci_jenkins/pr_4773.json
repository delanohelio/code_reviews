{"pr_number": 4773, "pr_title": "JENKINS-62572: Extend Downloadable API slightly", "pr_author": "Zastai", "pr_createdAt": "2020-06-05T17:15:12Z", "pr_url": "https://github.com/jenkinsci/jenkins/pull/4773", "timeline": [{"oid": "565c91d21970f51822ef0c1de18b120217246275", "url": "https://github.com/jenkinsci/jenkins/commit/565c91d21970f51822ef0c1de18b120217246275", "message": "JENKINS-62572: Extend Downloadable API slightly\n\nThis mainly adds:\n- a static Downloadable.idFor(Class) method, which returns the ID to\n  use for a given class\n  - existing code using a class now uses this method to do the mapping\n    to an ID value\n- an overload of the static Downloadable.get() method taking a Class\n  - applies idFor() and forwards to the existing String-based get()\n\nIt also adds a bit more JavaDoc to existing methods, and adds a few\n@NonNull annotations.", "committedDate": "2020-06-05T16:59:43Z", "type": "commit"}, {"oid": "712a9c4ee100b213c48f54658f1ed788dfb5c79b", "url": "https://github.com/jenkinsci/jenkins/commit/712a9c4ee100b213c48f54658f1ed788dfb5c79b", "message": "Use TODO, not FIXME, for @since.", "committedDate": "2020-06-06T20:41:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjkyODQyMg==", "url": "https://github.com/jenkinsci/jenkins/pull/4773#discussion_r442928422", "body": "```suggestion\r\n         */\r\n         @CheckForNull\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                     */\n          \n          \n            \n                     */\n          \n          \n            \n                     @CheckForNull", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"474\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">         <span class=\"pl-k\">*/</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"474\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">         <span class=\"pl-k\">*/</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"475\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">         <span class=\"pl-k\">@CheckForNull</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "oleg-nenashev", "createdAt": "2020-06-19T16:11:41Z", "path": "core/src/main/java/hudson/model/DownloadService.java", "diffHunk": "@@ -410,8 +450,21 @@ public JSONObject reduce(List<JSONObject> jsonList) {\n             return ExtensionList.lookup(Downloadable.class);\n         }\n \n+        /**\n+         * Returns the {@link Downloadable} that has an ID associated with the specified class.\n+         *\n+         * @param clazz The class to use to determine the downloadable's ID.\n+         *\n+         * @since TODO\n+         */\n+        public static Downloadable get(@NonNull Class<?> clazz) {\n+            return Downloadable.get(Downloadable.idFor(clazz));\n+        }\n+\n         /**\n          * Returns the {@link Downloadable} that has the given ID.\n+         *\n+         * @param id The ID to look for.\n          */", "originalCommit": "712a9c4ee100b213c48f54658f1ed788dfb5c79b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjkyODg3MA==", "url": "https://github.com/jenkinsci/jenkins/pull/4773#discussion_r442928870", "body": "```suggestion\r\n        @CheckForNull\r\n        public static Downloadable get(@NonNull Class<?> clazz) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    public static Downloadable get(@NonNull Class<?> clazz) {\n          \n          \n            \n                    @CheckForNull\n          \n          \n            \n                    public static Downloadable get(@NonNull Class<?> clazz) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"466\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k x x-first\">public</span><span class=\"x\"> </span><span class=\"pl-k x\">static</span><span class=\"x\"> </span><span class=\"pl-smi x\">Downloadable</span><span class=\"x\"> get(</span><span class=\"pl-k x\">@NonNull</span><span class=\"x\"> </span><span class=\"pl-k x\">Class&lt;?&gt;</span><span class=\"x x-last\"> clazz) {</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"466\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k x x-first x-last\">@CheckForNull</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"467\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-smi\">Downloadable</span> get(<span class=\"pl-k\">@NonNull</span> <span class=\"pl-k\">Class&lt;?&gt;</span> clazz) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "oleg-nenashev", "createdAt": "2020-06-19T16:12:42Z", "path": "core/src/main/java/hudson/model/DownloadService.java", "diffHunk": "@@ -410,8 +450,21 @@ public JSONObject reduce(List<JSONObject> jsonList) {\n             return ExtensionList.lookup(Downloadable.class);\n         }\n \n+        /**\n+         * Returns the {@link Downloadable} that has an ID associated with the specified class.\n+         *\n+         * @param clazz The class to use to determine the downloadable's ID.\n+         *\n+         * @since TODO\n+         */\n+        public static Downloadable get(@NonNull Class<?> clazz) {", "originalCommit": "712a9c4ee100b213c48f54658f1ed788dfb5c79b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "88fe0c733ca7113e2976c04adb664dcac4d049f6", "url": "https://github.com/jenkinsci/jenkins/commit/88fe0c733ca7113e2976c04adb664dcac4d049f6", "message": "Add nullability annotations.", "committedDate": "2020-06-19T18:25:36Z", "type": "commit"}, {"oid": "84c94c5ff5433ef91abd521e9125367ea5436c43", "url": "https://github.com/jenkinsci/jenkins/commit/84c94c5ff5433ef91abd521e9125367ea5436c43", "message": "Merge branch 'master' into JENKINS-62572", "committedDate": "2020-06-19T18:27:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTEzNzIxMg==", "url": "https://github.com/jenkinsci/jenkins/pull/4773#discussion_r445137212", "body": "This seems to lack an explanation of the ways this can go wrong. I don't think _ID associated with the specified class_ to someone unfamiliar with internals will make sense without more context.\r\n\r\nAlso e.g. `{@see #idFor(Class)}` could help.", "bodyText": "This seems to lack an explanation of the ways this can go wrong. I don't think ID associated with the specified class to someone unfamiliar with internals will make sense without more context.\nAlso e.g. {@see #idFor(Class)} could help.", "bodyHTML": "<p dir=\"auto\">This seems to lack an explanation of the ways this can go wrong. I don't think <em>ID associated with the specified class</em> to someone unfamiliar with internals will make sense without more context.</p>\n<p dir=\"auto\">Also e.g. <code>{@see #idFor(Class)}</code> could help.</p>", "author": "daniel-beck", "createdAt": "2020-06-24T19:58:32Z", "path": "core/src/main/java/hudson/model/DownloadService.java", "diffHunk": "@@ -406,13 +449,29 @@ public JSONObject reduce(List<JSONObject> jsonList) {\n         /**\n          * Returns all the registered {@link Downloadable}s.\n          */\n+        @NonNull\n         public static ExtensionList<Downloadable> all() {\n             return ExtensionList.lookup(Downloadable.class);\n         }\n \n+        /**\n+         * Returns the {@link Downloadable} that has an ID associated with the specified class.", "originalCommit": "84c94c5ff5433ef91abd521e9125367ea5436c43", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTE4ODg4Mg==", "url": "https://github.com/jenkinsci/jenkins/pull/4773#discussion_r445188882", "bodyText": "Fair. I added a link to idFor from the JavaDoc of the relevant constructors too.", "author": "Zastai", "createdAt": "2020-06-24T21:43:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTEzNzIxMg=="}], "type": "inlineReview"}, {"oid": "a9d65652a543c265390b8d842c52ceda40360802", "url": "https://github.com/jenkinsci/jenkins/commit/a9d65652a543c265390b8d842c52ceda40360802", "message": "Improve JavaDoc.\n\nNow the methods (constructors + get()) that generate an ID based on a\nclass, explicitly state that they use idFor() for that.", "committedDate": "2020-06-24T21:42:28Z", "type": "commit"}]}