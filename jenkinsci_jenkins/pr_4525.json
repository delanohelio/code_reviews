{"pr_number": 4525, "pr_title": "[JENKINS-55070, 59992, 60454, 61192] Correct symptom of missing instance", "pr_author": "Wadeck", "pr_createdAt": "2020-02-25T13:10:19Z", "pr_url": "https://github.com/jenkinsci/jenkins/pull/4525", "timeline": [{"oid": "fc3a505245cd0d7fc8e4a4f937233d9204cb5f7c", "url": "https://github.com/jenkinsci/jenkins/commit/fc3a505245cd0d7fc8e4a4f937233d9204cb5f7c", "message": "[JENKINS-55070] Correct symptom of missing instance", "committedDate": "2020-02-25T13:07:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA3NTIzMw==", "url": "https://github.com/jenkinsci/jenkins/pull/4525#discussion_r384075233", "body": "It seems doubtful that without the `Jenkins` singleton, we have enough working that ending up in `retrieveAuthFromCookie` will ultimately be successful (`User#getById`?).\r\n\r\nJust return `null` when `jenkins == null`, and return?", "bodyText": "It seems doubtful that without the Jenkins singleton, we have enough working that ending up in retrieveAuthFromCookie will ultimately be successful (User#getById?).\nJust return null when jenkins == null, and return?", "bodyHTML": "<p dir=\"auto\">It seems doubtful that without the <code>Jenkins</code> singleton, we have enough working that ending up in <code>retrieveAuthFromCookie</code> will ultimately be successful (<code>User#getById</code>?).</p>\n<p dir=\"auto\">Just return <code>null</code> when <code>jenkins == null</code>, and return?</p>", "author": "daniel-beck", "createdAt": "2020-02-25T19:25:00Z", "path": "core/src/main/java/hudson/security/TokenBasedRememberMeServices2.java", "diffHunk": "@@ -161,10 +161,12 @@ public void loginSuccess(HttpServletRequest request, HttpServletResponse respons\n \n     @Override\n     public Authentication autoLogin(HttpServletRequest request, HttpServletResponse response) {\n-        if(Jenkins.get().isDisableRememberMe()){\n+        // as this filter could be called during restart, this corrects at least the symptoms\n+        Jenkins j = Jenkins.getInstanceOrNull();\n+        if (j != null && j.isDisableRememberMe()) {", "originalCommit": "fc3a505245cd0d7fc8e4a4f937233d9204cb5f7c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTE2NTk4Ng==", "url": "https://github.com/jenkinsci/jenkins/pull/4525#discussion_r385165986", "bodyText": "Very good point, some implementation of the userDetailsService (like for the embedded SecurityRealm) are calling such mechanisms.", "author": "Wadeck", "createdAt": "2020-02-27T14:45:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDA3NTIzMw=="}], "type": "inlineReview"}, {"oid": "457d62cb2f6281ae49978398fedcd48e605cf26e", "url": "https://github.com/jenkinsci/jenkins/commit/457d62cb2f6281ae49978398fedcd48e605cf26e", "message": "Apply Daniel's proposal", "committedDate": "2020-02-27T14:44:08Z", "type": "commit"}]}