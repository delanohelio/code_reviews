{"pr_number": 1910, "pr_title": "retain force structure in destination campaign", "pr_author": "NickAragua", "pr_createdAt": "2020-08-07T18:55:12Z", "pr_url": "https://github.com/MegaMek/mekhq/pull/1910", "timeline": [{"oid": "0d46ca431c51a32a93d109fba41029a283d90a24", "url": "https://github.com/MegaMek/mekhq/commit/0d46ca431c51a32a93d109fba41029a283d90a24", "message": "retain force structure in destination campaign", "committedDate": "2020-08-07T18:52:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIxNjA1Ng==", "url": "https://github.com/MegaMek/mekhq/pull/1910#discussion_r467216056", "body": "```suggestion\r\n        if (sourceForce == null) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(sourceForce == null) {\n          \n          \n            \n                    if (sourceForce == null) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span>(sourceForce <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(sourceForce <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-08-07T18:57:50Z", "path": "MekHQ/src/mekhq/gui/dialog/CampaignExportWizard.java", "diffHunk": "@@ -633,7 +641,89 @@ private boolean exportToCampaign(File file) {\n \n         return saved;\n     }\n+    \n+    private void attemptToAssignToForce(Unit unit, int sourceForceID, Campaign sourceCampaign, Campaign destinationCampaign) {\n+        Force sourceForce = sourceCampaign.getForce(sourceForceID);\n+        if(sourceForce == null) {", "originalCommit": "0d46ca431c51a32a93d109fba41029a283d90a24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIxNjEwNA==", "url": "https://github.com/MegaMek/mekhq/pull/1910#discussion_r467216104", "body": "```suggestion\r\n        if (sourceForce.getParentForce() == null) {\r\n            destinationCampaign.getForces().addUnit(unit.getId());\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(sourceForce.getParentForce() == null) {\n          \n          \n            \n                        destinationCampaign.getForces().addUnit(unit.getId());\n          \n          \n            \n                    if (sourceForce.getParentForce() == null) {\n          \n          \n            \n                        destinationCampaign.getForces().addUnit(unit.getId());", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"657\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span>(sourceForce<span class=\"pl-k\">.</span>getParentForce() <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"658\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            destinationCampaign<span class=\"pl-k\">.</span>getForces()<span class=\"pl-k\">.</span>addUnit(unit<span class=\"pl-k\">.</span>getId());</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"657\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(sourceForce<span class=\"pl-k\">.</span>getParentForce() <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"658\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            destinationCampaign<span class=\"pl-k\">.</span>getForces()<span class=\"pl-k\">.</span>addUnit(unit<span class=\"pl-k\">.</span>getId());</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-08-07T18:57:57Z", "path": "MekHQ/src/mekhq/gui/dialog/CampaignExportWizard.java", "diffHunk": "@@ -633,7 +641,89 @@ private boolean exportToCampaign(File file) {\n \n         return saved;\n     }\n+    \n+    private void attemptToAssignToForce(Unit unit, int sourceForceID, Campaign sourceCampaign, Campaign destinationCampaign) {\n+        Force sourceForce = sourceCampaign.getForce(sourceForceID);\n+        if(sourceForce == null) {\n+            return;\n+        }\n+        \n+        // this indicates a unit assigned to the root-level force\n+        if(sourceForce.getParentForce() == null) {\n+            destinationCampaign.getForces().addUnit(unit.getId());", "originalCommit": "0d46ca431c51a32a93d109fba41029a283d90a24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIxNjE2Ng==", "url": "https://github.com/MegaMek/mekhq/pull/1910#discussion_r467216166", "body": "```suggestion\r\n        if (destForce != null) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(destForce != null) {\n          \n          \n            \n                    if (destForce != null) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span>(destForce <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(destForce <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-08-07T18:58:05Z", "path": "MekHQ/src/mekhq/gui/dialog/CampaignExportWizard.java", "diffHunk": "@@ -633,7 +641,89 @@ private boolean exportToCampaign(File file) {\n \n         return saved;\n     }\n+    \n+    private void attemptToAssignToForce(Unit unit, int sourceForceID, Campaign sourceCampaign, Campaign destinationCampaign) {\n+        Force sourceForce = sourceCampaign.getForce(sourceForceID);\n+        if(sourceForce == null) {\n+            return;\n+        }\n+        \n+        // this indicates a unit assigned to the root-level force\n+        if(sourceForce.getParentForce() == null) {\n+            destinationCampaign.getForces().addUnit(unit.getId());\n+        }\n+        \n+        // first thing we will try is to identify a force with the same name and tree structure in the destination campaign\n+        // if we find one, add the unit to it\n+        // otherwise,\n+        Force destForce = findForce(sourceForce.getFullName(), destinationCampaign.getForces());\n+        if(destForce != null) {", "originalCommit": "0d46ca431c51a32a93d109fba41029a283d90a24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIxNjM0Nw==", "url": "https://github.com/MegaMek/mekhq/pull/1910#discussion_r467216347", "body": "```suggestion\r\n            for (int x = parentForces.size() - 1; x >= 0; x--) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        for(int x = parentForces.size() - 1; x >= 0; x--) {\n          \n          \n            \n                        for (int x = parentForces.size() - 1; x >= 0; x--) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">for</span>(<span class=\"pl-k\">int</span> x <span class=\"pl-k\">=</span> parentForces<span class=\"pl-k\">.</span>size() <span class=\"pl-k\">-</span> <span class=\"pl-c1\">1</span>; x <span class=\"pl-k\">&gt;=</span> <span class=\"pl-c1\">0</span>; x<span class=\"pl-k\">--</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">for</span><span class=\"x x-first x-last\"> </span>(<span class=\"pl-k\">int</span> x <span class=\"pl-k\">=</span> parentForces<span class=\"pl-k\">.</span>size() <span class=\"pl-k\">-</span> <span class=\"pl-c1\">1</span>; x <span class=\"pl-k\">&gt;=</span> <span class=\"pl-c1\">0</span>; x<span class=\"pl-k\">--</span>) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-08-07T18:58:26Z", "path": "MekHQ/src/mekhq/gui/dialog/CampaignExportWizard.java", "diffHunk": "@@ -633,7 +641,89 @@ private boolean exportToCampaign(File file) {\n \n         return saved;\n     }\n+    \n+    private void attemptToAssignToForce(Unit unit, int sourceForceID, Campaign sourceCampaign, Campaign destinationCampaign) {\n+        Force sourceForce = sourceCampaign.getForce(sourceForceID);\n+        if(sourceForce == null) {\n+            return;\n+        }\n+        \n+        // this indicates a unit assigned to the root-level force\n+        if(sourceForce.getParentForce() == null) {\n+            destinationCampaign.getForces().addUnit(unit.getId());\n+        }\n+        \n+        // first thing we will try is to identify a force with the same name and tree structure in the destination campaign\n+        // if we find one, add the unit to it\n+        // otherwise,\n+        Force destForce = findForce(sourceForce.getFullName(), destinationCampaign.getForces());\n+        if(destForce != null) {\n+            destForce.addUnit(unit.getId());\n+        } else {\n+            List<Force> parentForces = getForceAndParents(sourceForce);\n+            Force currentDestinationForce = destinationCampaign.getForces();\n+            \n+            for(int x = parentForces.size() - 1; x >= 0; x--) {", "originalCommit": "0d46ca431c51a32a93d109fba41029a283d90a24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIxNjQ4Mg==", "url": "https://github.com/MegaMek/mekhq/pull/1910#discussion_r467216482", "body": "```suggestion\r\n                if (nextDestinationForce == null) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if(nextDestinationForce == null) {\n          \n          \n            \n                            if (nextDestinationForce == null) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-k\">if</span>(nextDestinationForce <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(nextDestinationForce <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-08-07T18:58:43Z", "path": "MekHQ/src/mekhq/gui/dialog/CampaignExportWizard.java", "diffHunk": "@@ -633,7 +641,89 @@ private boolean exportToCampaign(File file) {\n \n         return saved;\n     }\n+    \n+    private void attemptToAssignToForce(Unit unit, int sourceForceID, Campaign sourceCampaign, Campaign destinationCampaign) {\n+        Force sourceForce = sourceCampaign.getForce(sourceForceID);\n+        if(sourceForce == null) {\n+            return;\n+        }\n+        \n+        // this indicates a unit assigned to the root-level force\n+        if(sourceForce.getParentForce() == null) {\n+            destinationCampaign.getForces().addUnit(unit.getId());\n+        }\n+        \n+        // first thing we will try is to identify a force with the same name and tree structure in the destination campaign\n+        // if we find one, add the unit to it\n+        // otherwise,\n+        Force destForce = findForce(sourceForce.getFullName(), destinationCampaign.getForces());\n+        if(destForce != null) {\n+            destForce.addUnit(unit.getId());\n+        } else {\n+            List<Force> parentForces = getForceAndParents(sourceForce);\n+            Force currentDestinationForce = destinationCampaign.getForces();\n+            \n+            for(int x = parentForces.size() - 1; x >= 0; x--) {\n+                Force nextSourceForce = parentForces.get(x);\n+                Force nextDestinationForce = findForce(nextSourceForce.getFullName(), currentDestinationForce);\n+                \n+                // if this level doesn't exist yet, add it to where we currently are\n+                if(nextDestinationForce == null) {", "originalCommit": "0d46ca431c51a32a93d109fba41029a283d90a24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIxNjU0Ng==", "url": "https://github.com/MegaMek/mekhq/pull/1910#discussion_r467216546", "body": "```suggestion\r\n        if (force.getFullName().equals(forceName)) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(force.getFullName().equals(forceName)) {\n          \n          \n            \n                    if (force.getFullName().equals(forceName)) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span>(force<span class=\"pl-k\">.</span>getFullName()<span class=\"pl-k\">.</span>equals(forceName)) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(force<span class=\"pl-k\">.</span>getFullName()<span class=\"pl-k\">.</span>equals(forceName)) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-08-07T18:58:52Z", "path": "MekHQ/src/mekhq/gui/dialog/CampaignExportWizard.java", "diffHunk": "@@ -633,7 +641,89 @@ private boolean exportToCampaign(File file) {\n \n         return saved;\n     }\n+    \n+    private void attemptToAssignToForce(Unit unit, int sourceForceID, Campaign sourceCampaign, Campaign destinationCampaign) {\n+        Force sourceForce = sourceCampaign.getForce(sourceForceID);\n+        if(sourceForce == null) {\n+            return;\n+        }\n+        \n+        // this indicates a unit assigned to the root-level force\n+        if(sourceForce.getParentForce() == null) {\n+            destinationCampaign.getForces().addUnit(unit.getId());\n+        }\n+        \n+        // first thing we will try is to identify a force with the same name and tree structure in the destination campaign\n+        // if we find one, add the unit to it\n+        // otherwise,\n+        Force destForce = findForce(sourceForce.getFullName(), destinationCampaign.getForces());\n+        if(destForce != null) {\n+            destForce.addUnit(unit.getId());\n+        } else {\n+            List<Force> parentForces = getForceAndParents(sourceForce);\n+            Force currentDestinationForce = destinationCampaign.getForces();\n+            \n+            for(int x = parentForces.size() - 1; x >= 0; x--) {\n+                Force nextSourceForce = parentForces.get(x);\n+                Force nextDestinationForce = findForce(nextSourceForce.getFullName(), currentDestinationForce);\n+                \n+                // if this level doesn't exist yet, add it to where we currently are\n+                if(nextDestinationForce == null) {\n+                    Force forceCopy = new Force(nextSourceForce.getName());\n+                    destinationCampaign.addForce(forceCopy, currentDestinationForce);\n+                    currentDestinationForce = forceCopy;\n+                // otherwise, update current location and move to next level\n+                } else {\n+                    currentDestinationForce = nextDestinationForce;\n+                }\n+            }\n+            \n+            currentDestinationForce.addUnit(unit.getId());\n+        }\n+    }\n+    \n+    /**\n+     * Recurses through a Force structure to look for a force with the given \"full force name\"\n+     */\n+    private Force findForce(String forceName, Force force) {\n+        if(force.getFullName().equals(forceName)) {", "originalCommit": "0d46ca431c51a32a93d109fba41029a283d90a24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIxNjYyNw==", "url": "https://github.com/MegaMek/mekhq/pull/1910#discussion_r467216627", "body": "```suggestion\r\n            for (Force subForce : force.getSubForces()) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        for(Force subForce : force.getSubForces()) {\n          \n          \n            \n                        for (Force subForce : force.getSubForces()) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">for</span>(<span class=\"pl-smi\">Force</span> subForce <span class=\"pl-k\">:</span> force<span class=\"pl-k\">.</span>getSubForces()) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">for</span><span class=\"x x-first x-last\"> </span>(<span class=\"pl-smi\">Force</span> subForce <span class=\"pl-k\">:</span> force<span class=\"pl-k\">.</span>getSubForces()) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-08-07T18:59:00Z", "path": "MekHQ/src/mekhq/gui/dialog/CampaignExportWizard.java", "diffHunk": "@@ -633,7 +641,89 @@ private boolean exportToCampaign(File file) {\n \n         return saved;\n     }\n+    \n+    private void attemptToAssignToForce(Unit unit, int sourceForceID, Campaign sourceCampaign, Campaign destinationCampaign) {\n+        Force sourceForce = sourceCampaign.getForce(sourceForceID);\n+        if(sourceForce == null) {\n+            return;\n+        }\n+        \n+        // this indicates a unit assigned to the root-level force\n+        if(sourceForce.getParentForce() == null) {\n+            destinationCampaign.getForces().addUnit(unit.getId());\n+        }\n+        \n+        // first thing we will try is to identify a force with the same name and tree structure in the destination campaign\n+        // if we find one, add the unit to it\n+        // otherwise,\n+        Force destForce = findForce(sourceForce.getFullName(), destinationCampaign.getForces());\n+        if(destForce != null) {\n+            destForce.addUnit(unit.getId());\n+        } else {\n+            List<Force> parentForces = getForceAndParents(sourceForce);\n+            Force currentDestinationForce = destinationCampaign.getForces();\n+            \n+            for(int x = parentForces.size() - 1; x >= 0; x--) {\n+                Force nextSourceForce = parentForces.get(x);\n+                Force nextDestinationForce = findForce(nextSourceForce.getFullName(), currentDestinationForce);\n+                \n+                // if this level doesn't exist yet, add it to where we currently are\n+                if(nextDestinationForce == null) {\n+                    Force forceCopy = new Force(nextSourceForce.getName());\n+                    destinationCampaign.addForce(forceCopy, currentDestinationForce);\n+                    currentDestinationForce = forceCopy;\n+                // otherwise, update current location and move to next level\n+                } else {\n+                    currentDestinationForce = nextDestinationForce;\n+                }\n+            }\n+            \n+            currentDestinationForce.addUnit(unit.getId());\n+        }\n+    }\n+    \n+    /**\n+     * Recurses through a Force structure to look for a force with the given \"full force name\"\n+     */\n+    private Force findForce(String forceName, Force force) {\n+        if(force.getFullName().equals(forceName)) {\n+            return force;\n+        } else {\n+            for(Force subForce : force.getSubForces()) {", "originalCommit": "0d46ca431c51a32a93d109fba41029a283d90a24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIxNjY2NQ==", "url": "https://github.com/MegaMek/mekhq/pull/1910#discussion_r467216665", "body": "```suggestion\r\n                if (foundForce != null) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if(foundForce != null) {\n          \n          \n            \n                            if (foundForce != null) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-k\">if</span>(foundForce <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(foundForce <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-08-07T18:59:05Z", "path": "MekHQ/src/mekhq/gui/dialog/CampaignExportWizard.java", "diffHunk": "@@ -633,7 +641,89 @@ private boolean exportToCampaign(File file) {\n \n         return saved;\n     }\n+    \n+    private void attemptToAssignToForce(Unit unit, int sourceForceID, Campaign sourceCampaign, Campaign destinationCampaign) {\n+        Force sourceForce = sourceCampaign.getForce(sourceForceID);\n+        if(sourceForce == null) {\n+            return;\n+        }\n+        \n+        // this indicates a unit assigned to the root-level force\n+        if(sourceForce.getParentForce() == null) {\n+            destinationCampaign.getForces().addUnit(unit.getId());\n+        }\n+        \n+        // first thing we will try is to identify a force with the same name and tree structure in the destination campaign\n+        // if we find one, add the unit to it\n+        // otherwise,\n+        Force destForce = findForce(sourceForce.getFullName(), destinationCampaign.getForces());\n+        if(destForce != null) {\n+            destForce.addUnit(unit.getId());\n+        } else {\n+            List<Force> parentForces = getForceAndParents(sourceForce);\n+            Force currentDestinationForce = destinationCampaign.getForces();\n+            \n+            for(int x = parentForces.size() - 1; x >= 0; x--) {\n+                Force nextSourceForce = parentForces.get(x);\n+                Force nextDestinationForce = findForce(nextSourceForce.getFullName(), currentDestinationForce);\n+                \n+                // if this level doesn't exist yet, add it to where we currently are\n+                if(nextDestinationForce == null) {\n+                    Force forceCopy = new Force(nextSourceForce.getName());\n+                    destinationCampaign.addForce(forceCopy, currentDestinationForce);\n+                    currentDestinationForce = forceCopy;\n+                // otherwise, update current location and move to next level\n+                } else {\n+                    currentDestinationForce = nextDestinationForce;\n+                }\n+            }\n+            \n+            currentDestinationForce.addUnit(unit.getId());\n+        }\n+    }\n+    \n+    /**\n+     * Recurses through a Force structure to look for a force with the given \"full force name\"\n+     */\n+    private Force findForce(String forceName, Force force) {\n+        if(force.getFullName().equals(forceName)) {\n+            return force;\n+        } else {\n+            for(Force subForce : force.getSubForces()) {\n+                Force foundForce = findForce(forceName, subForce);\n+                \n+                if(foundForce != null) {", "originalCommit": "0d46ca431c51a32a93d109fba41029a283d90a24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIxNjczMw==", "url": "https://github.com/MegaMek/mekhq/pull/1910#discussion_r467216733", "body": "```suggestion\r\n        while (force.getParentForce() != null) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    while(force.getParentForce() != null) {\n          \n          \n            \n                    while (force.getParentForce() != null) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">while</span>(force<span class=\"pl-k\">.</span>getParentForce() <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">while</span><span class=\"x x-first x-last\"> </span>(force<span class=\"pl-k\">.</span>getParentForce() <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-08-07T18:59:13Z", "path": "MekHQ/src/mekhq/gui/dialog/CampaignExportWizard.java", "diffHunk": "@@ -633,7 +641,89 @@ private boolean exportToCampaign(File file) {\n \n         return saved;\n     }\n+    \n+    private void attemptToAssignToForce(Unit unit, int sourceForceID, Campaign sourceCampaign, Campaign destinationCampaign) {\n+        Force sourceForce = sourceCampaign.getForce(sourceForceID);\n+        if(sourceForce == null) {\n+            return;\n+        }\n+        \n+        // this indicates a unit assigned to the root-level force\n+        if(sourceForce.getParentForce() == null) {\n+            destinationCampaign.getForces().addUnit(unit.getId());\n+        }\n+        \n+        // first thing we will try is to identify a force with the same name and tree structure in the destination campaign\n+        // if we find one, add the unit to it\n+        // otherwise,\n+        Force destForce = findForce(sourceForce.getFullName(), destinationCampaign.getForces());\n+        if(destForce != null) {\n+            destForce.addUnit(unit.getId());\n+        } else {\n+            List<Force> parentForces = getForceAndParents(sourceForce);\n+            Force currentDestinationForce = destinationCampaign.getForces();\n+            \n+            for(int x = parentForces.size() - 1; x >= 0; x--) {\n+                Force nextSourceForce = parentForces.get(x);\n+                Force nextDestinationForce = findForce(nextSourceForce.getFullName(), currentDestinationForce);\n+                \n+                // if this level doesn't exist yet, add it to where we currently are\n+                if(nextDestinationForce == null) {\n+                    Force forceCopy = new Force(nextSourceForce.getName());\n+                    destinationCampaign.addForce(forceCopy, currentDestinationForce);\n+                    currentDestinationForce = forceCopy;\n+                // otherwise, update current location and move to next level\n+                } else {\n+                    currentDestinationForce = nextDestinationForce;\n+                }\n+            }\n+            \n+            currentDestinationForce.addUnit(unit.getId());\n+        }\n+    }\n+    \n+    /**\n+     * Recurses through a Force structure to look for a force with the given \"full force name\"\n+     */\n+    private Force findForce(String forceName, Force force) {\n+        if(force.getFullName().equals(forceName)) {\n+            return force;\n+        } else {\n+            for(Force subForce : force.getSubForces()) {\n+                Force foundForce = findForce(forceName, subForce);\n+                \n+                if(foundForce != null) {\n+                    return foundForce;\n+                }\n+            }\n+            \n+            return null;\n+        }\n+    }\n \n+    /** \n+     * Moves through a force's ancestors and returns a flattened list of force names in order\n+     * from me to furtherst ancestor.\n+     */\n+    private List<Force> getForceAndParents(Force force) {\n+        List<Force> retval = new ArrayList<>();\n+        retval.add(force);\n+        \n+        Force ancestorForce;\n+        while(force.getParentForce() != null) {", "originalCommit": "0d46ca431c51a32a93d109fba41029a283d90a24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIxNjc5Nw==", "url": "https://github.com/MegaMek/mekhq/pull/1910#discussion_r467216797", "body": "```suggestion\r\n            if (ancestorForce.getParentForce() != null) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if(ancestorForce.getParentForce() != null) {\n          \n          \n            \n                        if (ancestorForce.getParentForce() != null) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">if</span>(ancestorForce<span class=\"pl-k\">.</span>getParentForce() <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(ancestorForce<span class=\"pl-k\">.</span>getParentForce() <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-08-07T18:59:22Z", "path": "MekHQ/src/mekhq/gui/dialog/CampaignExportWizard.java", "diffHunk": "@@ -633,7 +641,89 @@ private boolean exportToCampaign(File file) {\n \n         return saved;\n     }\n+    \n+    private void attemptToAssignToForce(Unit unit, int sourceForceID, Campaign sourceCampaign, Campaign destinationCampaign) {\n+        Force sourceForce = sourceCampaign.getForce(sourceForceID);\n+        if(sourceForce == null) {\n+            return;\n+        }\n+        \n+        // this indicates a unit assigned to the root-level force\n+        if(sourceForce.getParentForce() == null) {\n+            destinationCampaign.getForces().addUnit(unit.getId());\n+        }\n+        \n+        // first thing we will try is to identify a force with the same name and tree structure in the destination campaign\n+        // if we find one, add the unit to it\n+        // otherwise,\n+        Force destForce = findForce(sourceForce.getFullName(), destinationCampaign.getForces());\n+        if(destForce != null) {\n+            destForce.addUnit(unit.getId());\n+        } else {\n+            List<Force> parentForces = getForceAndParents(sourceForce);\n+            Force currentDestinationForce = destinationCampaign.getForces();\n+            \n+            for(int x = parentForces.size() - 1; x >= 0; x--) {\n+                Force nextSourceForce = parentForces.get(x);\n+                Force nextDestinationForce = findForce(nextSourceForce.getFullName(), currentDestinationForce);\n+                \n+                // if this level doesn't exist yet, add it to where we currently are\n+                if(nextDestinationForce == null) {\n+                    Force forceCopy = new Force(nextSourceForce.getName());\n+                    destinationCampaign.addForce(forceCopy, currentDestinationForce);\n+                    currentDestinationForce = forceCopy;\n+                // otherwise, update current location and move to next level\n+                } else {\n+                    currentDestinationForce = nextDestinationForce;\n+                }\n+            }\n+            \n+            currentDestinationForce.addUnit(unit.getId());\n+        }\n+    }\n+    \n+    /**\n+     * Recurses through a Force structure to look for a force with the given \"full force name\"\n+     */\n+    private Force findForce(String forceName, Force force) {\n+        if(force.getFullName().equals(forceName)) {\n+            return force;\n+        } else {\n+            for(Force subForce : force.getSubForces()) {\n+                Force foundForce = findForce(forceName, subForce);\n+                \n+                if(foundForce != null) {\n+                    return foundForce;\n+                }\n+            }\n+            \n+            return null;\n+        }\n+    }\n \n+    /** \n+     * Moves through a force's ancestors and returns a flattened list of force names in order\n+     * from me to furtherst ancestor.\n+     */\n+    private List<Force> getForceAndParents(Force force) {\n+        List<Force> retval = new ArrayList<>();\n+        retval.add(force);\n+        \n+        Force ancestorForce;\n+        while(force.getParentForce() != null) {\n+            ancestorForce = force.getParentForce();\n+            \n+            // we don't want the top-level force\n+            if(ancestorForce.getParentForce() != null) {", "originalCommit": "0d46ca431c51a32a93d109fba41029a283d90a24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzIxNjkxMA==", "url": "https://github.com/MegaMek/mekhq/pull/1910#discussion_r467216910", "body": "```suggestion\r\n            if ((person.getCallsign() != null) && (person.getCallsign().trim().length() > 0)) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if((person.getCallsign() != null) && (person.getCallsign().trim().length() > 0)) {\n          \n          \n            \n                        if ((person.getCallsign() != null) && (person.getCallsign().trim().length() > 0)) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">if</span>((person<span class=\"pl-k\">.</span>getCallsign() <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) <span class=\"pl-k\">&amp;&amp;</span> (person<span class=\"pl-k\">.</span>getCallsign()<span class=\"pl-k\">.</span>trim()<span class=\"pl-k\">.</span>length() <span class=\"pl-k\">&gt;</span> <span class=\"pl-c1\">0</span>)) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>((person<span class=\"pl-k\">.</span>getCallsign() <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) <span class=\"pl-k\">&amp;&amp;</span> (person<span class=\"pl-k\">.</span>getCallsign()<span class=\"pl-k\">.</span>trim()<span class=\"pl-k\">.</span>length() <span class=\"pl-k\">&gt;</span> <span class=\"pl-c1\">0</span>)) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-08-07T18:59:37Z", "path": "MekHQ/src/mekhq/gui/dialog/CampaignExportWizard.java", "diffHunk": "@@ -704,7 +794,15 @@ public Component getListCellRendererComponent(JList<?> list, Object value, int i\n                                                       boolean isSelected, boolean cellHasFocus) {\n             Component cmp = super.getListCellRendererComponent(list, value, index, isSelected, cellHasFocus);\n             Person person = (Person) value;\n-            String cellValue = String.format(\"%s (%s)\", person.getFullName(), person.getPrimaryRoleDesc());\n+            String callsign = \"\";\n+            if((person.getCallsign() != null) && (person.getCallsign().trim().length() > 0)) {", "originalCommit": "0d46ca431c51a32a93d109fba41029a283d90a24", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5db636f63ec34e60bbf05f4acb87cc086a452077", "url": "https://github.com/MegaMek/mekhq/commit/5db636f63ec34e60bbf05f4acb87cc086a452077", "message": "fix export issue when root campaign names don't match", "committedDate": "2020-08-08T03:15:59Z", "type": "commit"}, {"oid": "91fa9b8b62cdc9dffbb3cdb5a32099a462f7dc9b", "url": "https://github.com/MegaMek/mekhq/commit/91fa9b8b62cdc9dffbb3cdb5a32099a462f7dc9b", "message": "whitespace", "committedDate": "2020-08-08T03:18:39Z", "type": "commit"}, {"oid": "2265642c1403c06e6698d4e7c921e0be64481c62", "url": "https://github.com/MegaMek/mekhq/commit/2265642c1403c06e6698d4e7c921e0be64481c62", "message": "whitespace", "committedDate": "2020-08-08T03:20:12Z", "type": "commit"}, {"oid": "6e72155460f1711af9115ecd735b86cacf245806", "url": "https://github.com/MegaMek/mekhq/commit/6e72155460f1711af9115ecd735b86cacf245806", "message": "whitespace", "committedDate": "2020-08-08T03:21:09Z", "type": "commit"}, {"oid": "e0d61d5719942ef1b63f420f27bdb7d71408363f", "url": "https://github.com/MegaMek/mekhq/commit/e0d61d5719942ef1b63f420f27bdb7d71408363f", "message": "merge from upstream", "committedDate": "2020-08-09T03:06:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzY2MDE2Mg==", "url": "https://github.com/MegaMek/mekhq/pull/1910#discussion_r467660162", "body": "```suggestion\r\n        String sourceForceFullName = getDestinationFullName(sourceForce, sourceCampaign, destinationCampaign);\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    String sourceForceFullName = getDestinationFullName (sourceForce, sourceCampaign, destinationCampaign);\n          \n          \n            \n                    String sourceForceFullName = getDestinationFullName(sourceForce, sourceCampaign, destinationCampaign);", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-smi\">String</span> sourceForceFullName <span class=\"pl-k\">=</span> getDestinationFullName<span class=\"x x-first x-last\"> </span>(sourceForce, sourceCampaign, destinationCampaign);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-smi\">String</span> sourceForceFullName <span class=\"pl-k\">=</span> getDestinationFullName(sourceForce, sourceCampaign, destinationCampaign);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-08-10T02:04:37Z", "path": "MekHQ/src/mekhq/gui/dialog/CampaignExportWizard.java", "diffHunk": "@@ -644,31 +648,36 @@ private boolean exportToCampaign(File file) {\n     \n     private void attemptToAssignToForce(Unit unit, int sourceForceID, Campaign sourceCampaign, Campaign destinationCampaign) {\n         Force sourceForce = sourceCampaign.getForce(sourceForceID);\n-        if(sourceForce == null) {\n+        if (sourceForce == null) {\n             return;\n         }\n         \n         // this indicates a unit assigned to the root-level force\n-        if(sourceForce.getParentForce() == null) {\n+        if (sourceForce.getParentForce() == null) {\n             destinationCampaign.getForces().addUnit(unit.getId());\n         }\n         \n         // first thing we will try is to identify a force with the same name and tree structure in the destination campaign\n         // if we find one, add the unit to it\n-        // otherwise,\n-        Force destForce = findForce(sourceForce.getFullName(), destinationCampaign.getForces());\n-        if(destForce != null) {\n+        // otherwise, chain-add forces\n+\n+        // hack: the root forces are irrelevant, so we replace the source root force name with the destination root force name\n+        String sourceForceFullName = getDestinationFullName (sourceForce, sourceCampaign, destinationCampaign);", "originalCommit": "e0d61d5719942ef1b63f420f27bdb7d71408363f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9d023a67b1e6c873eda558df5aee389ad802363e", "url": "https://github.com/MegaMek/mekhq/commit/9d023a67b1e6c873eda558df5aee389ad802363e", "message": "Update MekHQ/src/mekhq/gui/dialog/CampaignExportWizard.java\n\nCo-authored-by: Justin Bowen <39067288+Windchild292@users.noreply.github.com>", "committedDate": "2020-08-10T04:08:58Z", "type": "commit"}]}