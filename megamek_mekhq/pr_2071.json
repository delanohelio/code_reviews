{"pr_number": 2071, "pr_title": "Dev vulpzor campaign ops dropship maintenance cost fix", "pr_author": "vulpzor", "pr_createdAt": "2020-09-29T11:57:54Z", "pr_url": "https://github.com/MegaMek/mekhq/pull/2071", "timeline": [{"oid": "55eecc272f77a8fe0b71dcec9b992ff40b43d3a4", "url": "https://github.com/MegaMek/mekhq/commit/55eecc272f77a8fe0b71dcec9b992ff40b43d3a4", "message": "Fix for dropship ammo costs not matching campaign ops rules", "committedDate": "2020-09-29T10:53:50Z", "type": "commit"}, {"oid": "6c09f084c0c931dc0fd0d0369ab7bbeae618cc1f", "url": "https://github.com/MegaMek/mekhq/commit/6c09f084c0c931dc0fd0d0369ab7bbeae618cc1f", "message": "Remove LargeCraftAmmoBin override with same code as base class", "committedDate": "2020-09-29T11:20:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjcwOTg5Mg==", "url": "https://github.com/MegaMek/mekhq/pull/2071#discussion_r496709892", "body": "The real fix here is to just delete the `.multipliedBy(size)` line, which looks like a copy-paste error from `getValueNeeded`.\r\n\r\nCompare this to AmmoBin.java:\r\nhttps://github.com/MegaMek/mekhq/blob/785d0a3158866f7fdb8106c517d6899efc13bcc2/MekHQ/src/mekhq/campaign/parts/equipment/AmmoBin.java#L186-L195", "bodyText": "The real fix here is to just delete the .multipliedBy(size) line, which looks like a copy-paste error from getValueNeeded.\nCompare this to AmmoBin.java:\n\n  \n    \n      mekhq/MekHQ/src/mekhq/campaign/parts/equipment/AmmoBin.java\n    \n    \n        Lines 186 to 195\n      in\n      785d0a3\n    \n    \n    \n    \n\n        \n          \n           @Override \n        \n\n        \n          \n           public Money getStickerPrice() { \n        \n\n        \n          \n               if (getShotsPerTon() <= 0) { \n        \n\n        \n          \n                   return Money.zero(); \n        \n\n        \n          \n               } \n        \n\n        \n          \n            \n        \n\n        \n          \n               return getPricePerTon() \n        \n\n        \n          \n                       .multipliedBy(getCurrentShots()) \n        \n\n        \n          \n                       .dividedBy(getShotsPerTon()); \n        \n\n        \n          \n           }", "bodyHTML": "<p dir=\"auto\">The real fix here is to just delete the <code>.multipliedBy(size)</code> line, which looks like a copy-paste error from <code>getValueNeeded</code>.</p>\n<p dir=\"auto\">Compare this to AmmoBin.java:<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom color-bg-subtle\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/MegaMek/mekhq/blob/785d0a3158866f7fdb8106c517d6899efc13bcc2/MekHQ/src/mekhq/campaign/parts/equipment/AmmoBin.java#L186-L195\">mekhq/MekHQ/src/mekhq/campaign/parts/equipment/AmmoBin.java</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 186 to 195\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/MegaMek/mekhq/commit/785d0a3158866f7fdb8106c517d6899efc13bcc2\">785d0a3</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L186\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"186\"></td>\n          <td id=\"LC186\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">@Override</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L187\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"187\"></td>\n          <td id=\"LC187\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">public</span> <span class=\"pl-smi\">Money</span> <span class=\"pl-en\">getStickerPrice</span>() { </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L188\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"188\"></td>\n          <td id=\"LC188\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-k\">if</span> (getShotsPerTon() <span class=\"pl-k\">&lt;=</span> <span class=\"pl-c1\">0</span>) { </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L189\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"189\"></td>\n          <td id=\"LC189\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">         <span class=\"pl-k\">return</span> <span class=\"pl-smi\">Money</span><span class=\"pl-k\">.</span>zero(); </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L190\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"190\"></td>\n          <td id=\"LC190\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     } </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L191\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"191\"></td>\n          <td id=\"LC191\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L192\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"192\"></td>\n          <td id=\"LC192\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-k\">return</span> getPricePerTon() </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L193\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"193\"></td>\n          <td id=\"LC193\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">             .multipliedBy(getCurrentShots()) </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L194\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"194\"></td>\n          <td id=\"LC194\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">             .dividedBy(getShotsPerTon()); </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L195\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"195\"></td>\n          <td id=\"LC195\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> } </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>", "author": "sixlettervariables", "createdAt": "2020-09-29T13:20:03Z", "path": "MekHQ/src/mekhq/campaign/parts/equipment/LargeCraftAmmoBin.java", "diffHunk": "@@ -169,18 +169,6 @@ protected Money getPricePerTon() {\n         return Money.of(getType().getRawCost());\n     }\n \n-    @Override\n-    public Money getStickerPrice() {\n-        if (getShotsPerTon() <= 0) {\n-            return Money.zero();\n-        }\n-\n-        return getPricePerTon()\n-                .multipliedBy(size)\n-                .multipliedBy(getCurrentShots())\n-                .dividedBy(getShotsPerTon());\n-    }\n-", "originalCommit": "6c09f084c0c931dc0fd0d0369ab7bbeae618cc1f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njc0MTg2Nw==", "url": "https://github.com/MegaMek/mekhq/pull/2071#discussion_r496741867", "bodyText": "That would make the two methods the exact same, hence the deletion of the override.", "author": "Windchild292", "createdAt": "2020-09-29T14:00:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjcwOTg5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Njc2NDA4Nw==", "url": "https://github.com/MegaMek/mekhq/pull/2071#discussion_r496764087", "bodyText": "I missed it derived from AmmoBin in this case! Been playing with GitHub's code navigation features. Took me to EquipmentPart.", "author": "sixlettervariables", "createdAt": "2020-09-29T14:28:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjcwOTg5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzIxMDkwNw==", "url": "https://github.com/MegaMek/mekhq/pull/2071#discussion_r497210907", "bodyText": "@sixlettervariables No worries, my first version of the fix was exactly that, removing the line.  I cleaned up the override prior to opening the PR when I realized they would be the same.  Thanks for the review and merge, will try to package up some other changes I have lying around locally.", "author": "vulpzor", "createdAt": "2020-09-30T02:40:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjcwOTg5Mg=="}], "type": "inlineReview"}]}