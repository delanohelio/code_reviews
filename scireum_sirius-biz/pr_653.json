{"pr_number": 653, "pr_title": "Uses createNowOrUpdateInBatch as default way of updating entities.", "pr_author": "andyHa", "pr_createdAt": "2020-01-02T08:51:38Z", "pr_url": "https://github.com/scireum/sirius-biz/pull/653", "timeline": [{"oid": "bbcf20238618c88fa196c17872a296c94660b5f7", "url": "https://github.com/scireum/sirius-biz/commit/bbcf20238618c88fa196c17872a296c94660b5f7", "message": "Uses createNowOrUpdateInBatch as default way of updating entities.\n\nOtherwise \"unique\" checks might fail (at the database level) as the inserts are queued in the batch\nand therefore not enforced by the framework. This adds too much trouble for outweight the performance improvements\nof a batched insert.\n\nIf an entity is known to not have any unique constraints / such conflicts - which is probably very rare - this method\ncan be overwritten and changed back to a batched insert.", "committedDate": "2020-01-02T08:49:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQyNTgyNA==", "url": "https://github.com/scireum/sirius-biz/pull/653#discussion_r362425824", "body": "```suggestion\r\n     * Creates the entity immediately or updates the given entity in the underlying database using a batch update.\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Creates the entity immediatelly or updates the given entity in the underlying database using a batch update.\n          \n          \n            \n                 * Creates the entity immediately or updates the given entity in the underlying database using a batch update.", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">     <span class=\"pl-k\">*</span> <span class=\"pl-smi\">Creates</span> the entity <span class=\"x x-first x-last\">immediatelly</span> or updates the given entity in the underlying database using a batch update.</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-smi\">Creates</span> the entity <span class=\"x x-first x-last\">immediately</span> or updates the given entity in the underlying database using a batch update.</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "meg1502", "createdAt": "2020-01-02T10:21:48Z", "path": "src/main/java/sirius/biz/importer/Importer.java", "diffHunk": "@@ -219,15 +222,39 @@ public ImportDictionary getExportDictionary(Class<? extends BaseEntity<?>> type)\n      * <p>\n      * Using a batch update will most probably yield substantial performance benefits with the downside, that the updated\n      * entity cannot be returned by this method.\n+     * <p>\n+     * Note that {@link #createNowOrUpdateInBatch(BaseEntity)} is most probably a better choice, as it makes the entity\n+     * immediatelly visible to the database and all internal consistency checks and still provides optimal performance\n+     * when updating many objects.\n      *\n      * @param entity the entity to update or create\n      * @param <E>    the generic type of the entity\n+     * @see #createNowOrUpdateInBatch(BaseEntity)\n+     * @see ImportHandler#createOrUpdateInBatch(BaseEntity)\n      */\n     @SuppressWarnings(\"unchecked\")\n     public <E extends BaseEntity<?>> void createOrUpdateInBatch(E entity) {\n         context.findHandler((Class<E>) entity.getClass()).createOrUpdateInBatch(entity);\n     }\n \n+    /**\n+     * Creates the entity immediatelly or updates the given entity in the underlying database using a batch update.", "originalCommit": "bbcf20238618c88fa196c17872a296c94660b5f7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "af44657ede9ae49a0e00da4499ab26e9c5e80e7d", "url": "https://github.com/scireum/sirius-biz/commit/af44657ede9ae49a0e00da4499ab26e9c5e80e7d", "message": "Update src/main/java/sirius/biz/importer/Importer.java\n\nCo-Authored-By: meg1502 <meg@scireum.de>", "committedDate": "2020-01-02T10:43:19Z", "type": "commit"}]}