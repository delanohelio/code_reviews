{"pr_number": 4090, "pr_title": "feat(FlowLayout): Add option for horizontal spacing", "pr_author": "stefaniamak", "pr_createdAt": "2020-07-20T20:35:46Z", "pr_url": "https://github.com/MovingBlocks/Terasology/pull/4090", "timeline": [{"oid": "a9c1459b956296847534c63a2a7f01ce13f5ffaa", "url": "https://github.com/MovingBlocks/Terasology/commit/a9c1459b956296847534c63a2a7f01ce13f5ffaa", "message": "feat: adds horizontal space in quickslot (but with issues)", "committedDate": "2020-07-20T20:18:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY5MDIzMQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/4090#discussion_r457690231", "body": "I think this check also needs to take the spacing into account. If we add both the spacing and the size of the next element to the currently filled width, do we exceed the canvas size?", "bodyText": "I think this check also needs to take the spacing into account. If we add both the spacing and the size of the next element to the currently filled width, do we exceed the canvas size?", "bodyHTML": "<p dir=\"auto\">I think this check also needs to take the spacing into account. If we add both the spacing and the size of the next element to the currently filled width, do we exceed the canvas size?</p>", "author": "skaldarnar", "createdAt": "2020-07-20T21:03:04Z", "path": "engine/src/main/java/org/terasology/rendering/nui/layouts/FlowLayout.java", "diffHunk": "@@ -51,16 +58,17 @@ public void removeAllWidgets() {\n     public void onDraw(Canvas canvas) {\n         int filledWidth = 0;\n         int filledHeight = 0;\n+        int widthOffset = 0;\n         int heightOffset = 0;\n         for (UIWidget widget : contents) {\n             Vector2i size = canvas.calculatePreferredSize(widget);\n-            if (filledWidth != 0 && filledWidth + size.x  > canvas.size().x) {\n+            if (filledWidth != 0 && filledWidth + size.x > canvas.size().x) {", "originalCommit": "a9c1459b956296847534c63a2a7f01ce13f5ffaa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODI4Mjk0OQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/4090#discussion_r458282949", "bodyText": "Considering we add the spacing right afterwards, yes that probably should include the spacing as well. Generally though, wouldn't we want for the item to be added if it fits to the row, no matter the spacing we set in between the other items?\nSo what my understanding of the code is that it adds the item and the spacing (to its right) in one loop, and then go to the next item. Is that how it works? Because I still feel like there is a detail within the two methods that I still haven't understood yet.", "author": "stefaniamak", "createdAt": "2020-07-21T17:53:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY5MDIzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMzNzcyMQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/4090#discussion_r458337721", "bodyText": "Yeah, you're probably right - that's also where \"remove from last element\" comes from \ud83e\udd14  so this check is indeed correct, because the \"previous\" gap is already contained in filledWidth... \ud83d\udc4d", "author": "skaldarnar", "createdAt": "2020-07-21T19:30:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY5MDIzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY5MDM4NA==", "url": "https://github.com/MovingBlocks/Terasology/pull/4090#discussion_r457690384", "body": "Same here.", "bodyText": "Same here.", "bodyHTML": "<p dir=\"auto\">Same here.</p>", "author": "skaldarnar", "createdAt": "2020-07-20T21:03:26Z", "path": "engine/src/main/java/org/terasology/rendering/nui/layouts/FlowLayout.java", "diffHunk": "@@ -72,13 +80,13 @@ public Vector2i getPreferredContentSize(Canvas canvas, Vector2i sizeHint) {\n         int filledHeight = 0;\n         for (UIWidget widget : contents) {\n             Vector2i size = canvas.calculatePreferredSize(widget);\n-            if (filledWidth != 0 && filledWidth + size.x  > sizeHint.x) {\n+            if (filledWidth != 0 && filledWidth + size.x > sizeHint.x) {", "originalCommit": "a9c1459b956296847534c63a2a7f01ce13f5ffaa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f459f62ed5fcc2cd8155aaf25b4f7a3f820f732a", "url": "https://github.com/MovingBlocks/Terasology/commit/f459f62ed5fcc2cd8155aaf25b4f7a3f820f732a", "message": "fix: issue for extra spacing at end of row & issue about hidden row", "committedDate": "2020-07-21T17:39:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODI3OTk3NQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/4090#discussion_r458279975", "body": "This worked at first with 2 test, but the rest tests proven for this not being the correct solution.", "bodyText": "This worked at first with 2 test, but the rest tests proven for this not being the correct solution.", "bodyHTML": "<p dir=\"auto\">This worked at first with 2 test, but the rest tests proven for this not being the correct solution.</p>", "author": "stefaniamak", "createdAt": "2020-07-21T17:48:29Z", "path": "engine/src/main/java/org/terasology/rendering/nui/layouts/FlowLayout.java", "diffHunk": "@@ -72,10 +80,10 @@ public Vector2i getPreferredContentSize(Canvas canvas, Vector2i sizeHint) {\n         int filledHeight = 0;\n         for (UIWidget widget : contents) {\n             Vector2i size = canvas.calculatePreferredSize(widget);\n-            if (filledWidth != 0 && filledWidth + size.x  > sizeHint.x) {\n+            if (filledWidth != 0 && filledWidth + size.x > sizeHint.x) {\n                 result.x = Math.max(result.x, filledWidth);\n                 result.y += filledHeight;\n-                filledWidth = size.x;\n+                filledWidth = size.x + horizontalSpacing * (contents.size() - 1);", "originalCommit": "f459f62ed5fcc2cd8155aaf25b4f7a3f820f732a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMzNjU5Mg==", "url": "https://github.com/MovingBlocks/Terasology/pull/4090#discussion_r458336592", "bodyText": "I think the solution for this is similar to the vertical case - just add the horizontalSpacing each time when adding size.x somewhere.", "author": "skaldarnar", "createdAt": "2020-07-21T19:28:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODI3OTk3NQ=="}], "type": "inlineReview"}, {"oid": "2db9ae8d10cf37b0c397fe7e2daffa1e49d152bd", "url": "https://github.com/MovingBlocks/Terasology/commit/2db9ae8d10cf37b0c397fe7e2daffa1e49d152bd", "message": "Merge branch 'develop-upstream' into FlowLayoutHorizontalSpacing", "committedDate": "2020-07-21T19:06:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMzNTM2OQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/4090#discussion_r458335369", "body": "I think the docstrings are now flipped for `setHorizontalSpacing` and `setVerticalSpacing` \ud83d\ude05 ", "bodyText": "I think the docstrings are now flipped for setHorizontalSpacing and setVerticalSpacing \ud83d\ude05", "bodyHTML": "<p dir=\"auto\">I think the docstrings are now flipped for <code>setHorizontalSpacing</code> and <code>setVerticalSpacing</code> <g-emoji class=\"g-emoji\" alias=\"sweat_smile\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/1f605.png\">\ud83d\ude05</g-emoji></p>", "author": "skaldarnar", "createdAt": "2020-07-21T19:26:05Z", "path": "engine/src/main/java/org/terasology/rendering/nui/layouts/FlowLayout.java", "diffHunk": "@@ -121,6 +138,17 @@ public int getVerticalSpacing() {\n      * @param spacing The spacing, in pixels\n      * @return This {@code FlowLayout}\n      */\n+    public FlowLayout setHorizontalSpacing(int spacing) {\n+        this.horizontalSpacing = spacing;\n+        return this;\n+    }\n+\n+    /**\n+     * Sets the horizontal spacing between adjacent widgets in this {@code FlowLayout}.", "originalCommit": "2db9ae8d10cf37b0c397fe7e2daffa1e49d152bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM0NDEwOA==", "url": "https://github.com/MovingBlocks/Terasology/pull/4090#discussion_r458344108", "bodyText": "And I did double check... On it \ud83d\udc4d", "author": "stefaniamak", "createdAt": "2020-07-21T19:43:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODMzNTM2OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM0NDU4Mg==", "url": "https://github.com/MovingBlocks/Terasology/pull/4090#discussion_r458344582", "body": "Also this changed to double `SpacingSpacing` for some reason \ud83d\ude06 ", "bodyText": "Also this changed to double SpacingSpacing for some reason \ud83d\ude06", "bodyHTML": "<p dir=\"auto\">Also this changed to double <code>SpacingSpacing</code> for some reason <g-emoji class=\"g-emoji\" alias=\"laughing\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/1f606.png\">\ud83d\ude06</g-emoji></p>", "author": "stefaniamak", "createdAt": "2020-07-21T19:44:03Z", "path": "engine/src/main/java/org/terasology/rendering/nui/layouts/FlowLayout.java", "diffHunk": "@@ -107,6 +115,15 @@ public Vector2i getMaxContentSize(Canvas canvas) {\n     }\n \n     /**\n+     * Retrieves the horizontal spacing between adjacent widgets in this {@code FlowLayout}.\n+     *\n+     * @return The spacing, in pixels\n+     */\n+    public int getHorizontalSpacingSpacing() {", "originalCommit": "2db9ae8d10cf37b0c397fe7e2daffa1e49d152bd", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e97a8801431bd54d3b020de300bd3c80b48ecec8", "url": "https://github.com/MovingBlocks/Terasology/commit/e97a8801431bd54d3b020de300bd3c80b48ecec8", "message": "fix: merging errors", "committedDate": "2020-07-21T19:44:55Z", "type": "commit"}, {"oid": "30e8a11950ce83a556c21a400e422360e8cd568c", "url": "https://github.com/MovingBlocks/Terasology/commit/30e8a11950ce83a556c21a400e422360e8cd568c", "message": "Merge branch 'develop' into FlowLayoutHorizontalSpacing", "committedDate": "2020-07-29T17:46:20Z", "type": "commit"}, {"oid": "f6fb4f7509113ae0f55bc0598f97c1f4b0f90629", "url": "https://github.com/MovingBlocks/Terasology/commit/f6fb4f7509113ae0f55bc0598f97c1f4b0f90629", "message": "fix: quicklot doesn't move around the screen anymore", "committedDate": "2020-07-29T18:55:47Z", "type": "commit"}, {"oid": "5ace7f79c82ae8f076eafa0f2a6a35a8dd20afe0", "url": "https://github.com/MovingBlocks/Terasology/commit/5ace7f79c82ae8f076eafa0f2a6a35a8dd20afe0", "message": "\"overflowing\" error fixed (?)", "committedDate": "2020-07-29T19:48:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjU1MTkyNA==", "url": "https://github.com/MovingBlocks/Terasology/pull/4090#discussion_r462551924", "body": "unused, can be removed\r\n```suggestion\r\n```", "bodyText": "unused, can be removed\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    int widthOffset = 0;", "bodyHTML": "<p dir=\"auto\">unused, can be removed</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"><span class=\"x x-first\">        </span><span class=\"pl-k x\">int</span><span class=\"x\"> widthOffset </span><span class=\"pl-k x\">=</span><span class=\"x\"> </span><span class=\"pl-c1 x\">0</span><span class=\"x x-last\">;</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "skaldarnar", "createdAt": "2020-07-29T19:58:34Z", "path": "engine/src/main/java/org/terasology/rendering/nui/layouts/FlowLayout.java", "diffHunk": "@@ -59,6 +65,7 @@ public void removeAllWidgets() {\n     public void onDraw(Canvas canvas) {\n         int filledWidth = 0;\n         int filledHeight = 0;\n+        int widthOffset = 0;", "originalCommit": "5ace7f79c82ae8f076eafa0f2a6a35a8dd20afe0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "93acf8e457884987c2de4eaa5250f6282982140d", "url": "https://github.com/MovingBlocks/Terasology/commit/93acf8e457884987c2de4eaa5250f6282982140d", "message": "remove unused field", "committedDate": "2020-07-29T20:07:23Z", "type": "commit"}]}