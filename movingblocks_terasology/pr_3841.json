{"pr_number": 3841, "pr_title": "feat: improve 'playerHeight' command", "pr_author": "godfather2", "pr_createdAt": "2020-03-03T13:30:36Z", "pr_url": "https://github.com/MovingBlocks/Terasology/pull/3841", "timeline": [{"oid": "5212bad83f1437d495cd77a2cf826c3d84ff14cd", "url": "https://github.com/MovingBlocks/Terasology/commit/5212bad83f1437d495cd77a2cf826c3d84ff14cd", "message": "implements height change extras and fixes bugs", "committedDate": "2020-03-03T05:54:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTUzNzg3MQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r395537871", "body": "See: https://github.com/MovingBlocks/Terasology/wiki/Common-Style-Points#starred-imports", "bodyText": "See: https://github.com/MovingBlocks/Terasology/wiki/Common-Style-Points#starred-imports", "bodyHTML": "<p dir=\"auto\">See: <a href=\"https://github.com/MovingBlocks/Terasology/wiki/Common-Style-Points#starred-imports\">https://github.com/MovingBlocks/Terasology/wiki/Common-Style-Points#starred-imports</a></p>", "author": "syntaxi", "createdAt": "2020-03-20T10:05:21Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -18,12 +18,8 @@\n import org.terasology.entitySystem.entity.EntityManager;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n-import org.terasology.logic.characters.CharacterImpulseEvent;\n+import org.terasology.logic.characters.*;", "originalCommit": "5212bad83f1437d495cd77a2cf826c3d84ff14cd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f94718fa1643fd18991bb1f478d2f0c57ff2e8b1", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 752d5a413..39ab99e47 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -18,7 +18,12 @@\n import org.terasology.entitySystem.entity.EntityManager;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n-import org.terasology.logic.characters.*;\n+import org.terasology.logic.characters.CharacterComponent;\n+import org.terasology.logic.characters.GazeMountPointComponent;\n+import org.terasology.logic.characters.CharacterMovementComponent;\n+import org.terasology.logic.characters.CharacterTeleportEvent;\n+import org.terasology.logic.characters.CharacterImpulseEvent;\n+import org.terasology.logic.characters.MovementMode;\n import org.terasology.logic.common.DisplayNameComponent;\n import org.terasology.logic.location.Location;\n import org.terasology.logic.location.LocationComponent;\n", "next_change": null}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTUzODE0Mw==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r395538143", "body": "See: https://github.com/MovingBlocks/Terasology/wiki/Common-Style-Points#descriptive-variable-names", "bodyText": "See: https://github.com/MovingBlocks/Terasology/wiki/Common-Style-Points#descriptive-variable-names", "bodyHTML": "<p dir=\"auto\">See: <a href=\"https://github.com/MovingBlocks/Terasology/wiki/Common-Style-Points#descriptive-variable-names\">https://github.com/MovingBlocks/Terasology/wiki/Common-Style-Points#descriptive-variable-names</a></p>", "author": "syntaxi", "createdAt": "2020-03-20T10:05:51Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +231,44 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float function1(float parameter){", "originalCommit": "5212bad83f1437d495cd77a2cf826c3d84ff14cd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ4MTkyMA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r400481920", "bodyText": "Indeed, please use a descriptive name here. What is this function doing? What to the numbers mean?", "author": "skaldarnar", "createdAt": "2020-03-30T20:44:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTUzODE0Mw=="}], "type": "inlineReview", "revised_code": {"commit": "1e21cc6b3ab6b65411594e49a24aeebe744db54a", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 752d5a413..bb929cacc 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -231,13 +236,18 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float function1(float parameter){\n-        double p = (double)parameter;\n-        return (float) pow(p,0.6) * 0.78f ;\n+    private float getJumpSpeed(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 9.36f ;\n+    }\n+    \n+    private float getInteractionRange(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 3.9f ;\n     }\n \n-    private float function2(float parameter){\n-       return 0.15f + (0.64f * parameter) - (0.006f * parameter * parameter);\n+    private float getRunfactor(float amount){\n+       return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "6b915eff7bfc6b30a5ae9a1bbf41f66a9bc3b301", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex bb929cacc..9d8b21bf4 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -246,7 +246,7 @@ private float getInteractionRange(float amount){\n         return (float) pow(d,0.6) * 3.9f ;\n     }\n \n-    private float getRunfactor(float amount){\n+    private float getRunFactor(float amount){\n        return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n     }\n \n", "next_change": {"commit": "851d6b66eba64fa6000a7f92118aef06c05d2a7c", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 9d8b21bf4..0303f59b5 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return (float) pow(d,0.6) * 9.36f ;\n+        return Math.round(pow(d,0.55) * 8.45f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return (float) pow(d,0.6) * 3.9f ;\n+        return Math.round(pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n+       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "9de2a0b0df45386c5488b9ac8be37ff2a2c165b4", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 0303f59b5..c71a75169 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+        return Math.round(Math.pow(d,0.5) * 8.3f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+        return Math.round(Math.pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex c71a75169..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.5) * 8.3f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = 1.6f;\n-            float defaultStepHeight = 0.35f;\n-            float defaultFootSteps = 1f;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ4MjgzOQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r400482839", "body": "What's the reason to cast between float and doubles here? Wouldn't the following work?\r\n\r\n```java\r\nprivate double calculateSomething(double p) {\r\n    return pow(p, 0.6) * 0.78;\r\n}\r\n```\r\n\r\nI guess this could even be inlined.", "bodyText": "What's the reason to cast between float and doubles here? Wouldn't the following work?\nprivate double calculateSomething(double p) {\n    return pow(p, 0.6) * 0.78;\n}\nI guess this could even be inlined.", "bodyHTML": "<p dir=\"auto\">What's the reason to cast between float and doubles here? Wouldn't the following work?</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"private double calculateSomething(double p) {\n    return pow(p, 0.6) * 0.78;\n}\"><pre><span class=\"pl-k\">private</span> <span class=\"pl-k\">double</span> calculateSomething(<span class=\"pl-k\">double</span> p) {\n    <span class=\"pl-k\">return</span> pow(p, <span class=\"pl-c1\">0.6</span>) <span class=\"pl-k\">*</span> <span class=\"pl-c1\">0.78</span>;\n}</pre></div>\n<p dir=\"auto\">I guess this could even be inlined.</p>", "author": "skaldarnar", "createdAt": "2020-03-30T20:45:55Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +231,44 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float function1(float parameter){\n+        double p = (double)parameter;\n+        return (float) pow(p,0.6) * 0.78f ;", "originalCommit": "5212bad83f1437d495cd77a2cf826c3d84ff14cd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjA3NTU4MA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r402075580", "bodyText": "The values returned from the functions are assigned to float variables.Hence the cast", "author": "godfather2", "createdAt": "2020-04-02T06:20:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ4MjgzOQ=="}], "type": "inlineReview", "revised_code": {"commit": "1e21cc6b3ab6b65411594e49a24aeebe744db54a", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 752d5a413..bb929cacc 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -231,13 +236,18 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float function1(float parameter){\n-        double p = (double)parameter;\n-        return (float) pow(p,0.6) * 0.78f ;\n+    private float getJumpSpeed(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 9.36f ;\n+    }\n+    \n+    private float getInteractionRange(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 3.9f ;\n     }\n \n-    private float function2(float parameter){\n-       return 0.15f + (0.64f * parameter) - (0.006f * parameter * parameter);\n+    private float getRunfactor(float amount){\n+       return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "6b915eff7bfc6b30a5ae9a1bbf41f66a9bc3b301", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex bb929cacc..9d8b21bf4 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -246,7 +246,7 @@ private float getInteractionRange(float amount){\n         return (float) pow(d,0.6) * 3.9f ;\n     }\n \n-    private float getRunfactor(float amount){\n+    private float getRunFactor(float amount){\n        return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n     }\n \n", "next_change": {"commit": "851d6b66eba64fa6000a7f92118aef06c05d2a7c", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 9d8b21bf4..0303f59b5 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return (float) pow(d,0.6) * 9.36f ;\n+        return Math.round(pow(d,0.55) * 8.45f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return (float) pow(d,0.6) * 3.9f ;\n+        return Math.round(pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n+       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "9de2a0b0df45386c5488b9ac8be37ff2a2c165b4", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 0303f59b5..c71a75169 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+        return Math.round(Math.pow(d,0.5) * 8.3f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+        return Math.round(Math.pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex c71a75169..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.5) * 8.3f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = 1.6f;\n-            float defaultStepHeight = 0.35f;\n-            float defaultFootSteps = 1f;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ4MzE4MA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r400483180", "body": "Same here, please use a better name for the method.", "bodyText": "Same here, please use a better name for the method.", "bodyHTML": "<p dir=\"auto\">Same here, please use a better name for the method.</p>", "author": "skaldarnar", "createdAt": "2020-03-30T20:46:31Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +231,44 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float function1(float parameter){\n+        double p = (double)parameter;\n+        return (float) pow(p,0.6) * 0.78f ;\n+    }\n+\n+    private float function2(float parameter){", "originalCommit": "5212bad83f1437d495cd77a2cf826c3d84ff14cd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1e21cc6b3ab6b65411594e49a24aeebe744db54a", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 752d5a413..bb929cacc 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -231,13 +236,18 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float function1(float parameter){\n-        double p = (double)parameter;\n-        return (float) pow(p,0.6) * 0.78f ;\n+    private float getJumpSpeed(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 9.36f ;\n+    }\n+    \n+    private float getInteractionRange(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 3.9f ;\n     }\n \n-    private float function2(float parameter){\n-       return 0.15f + (0.64f * parameter) - (0.006f * parameter * parameter);\n+    private float getRunfactor(float amount){\n+       return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "6b915eff7bfc6b30a5ae9a1bbf41f66a9bc3b301", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex bb929cacc..9d8b21bf4 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -246,7 +246,7 @@ private float getInteractionRange(float amount){\n         return (float) pow(d,0.6) * 3.9f ;\n     }\n \n-    private float getRunfactor(float amount){\n+    private float getRunFactor(float amount){\n        return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n     }\n \n", "next_change": {"commit": "851d6b66eba64fa6000a7f92118aef06c05d2a7c", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 9d8b21bf4..0303f59b5 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return (float) pow(d,0.6) * 9.36f ;\n+        return Math.round(pow(d,0.55) * 8.45f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return (float) pow(d,0.6) * 3.9f ;\n+        return Math.round(pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n+       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "9de2a0b0df45386c5488b9ac8be37ff2a2c165b4", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 0303f59b5..c71a75169 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+        return Math.round(Math.pow(d,0.5) * 8.3f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+        return Math.round(Math.pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex c71a75169..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.5) * 8.3f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = 1.6f;\n-            float defaultStepHeight = 0.35f;\n-            float defaultFootSteps = 1f;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ4NDE5OQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r400484199", "body": "This can be replaced by a reference to `clientComp` which is retrieved in the first line of this try-catch block.\r\n\r\n```suggestion\r\n            EntityRef player = clientComp.character;\r\n```", "bodyText": "This can be replaced by a reference to clientComp which is retrieved in the first line of this try-catch block.\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        EntityRef player = client.getComponent(ClientComponent.class).character;\n          \n          \n            \n                        EntityRef player = clientComp.character;", "bodyHTML": "<p dir=\"auto\">This can be replaced by a reference to <code>clientComp</code> which is retrieved in the first line of this try-catch block.</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-smi\">EntityRef</span> player <span class=\"pl-k\">=</span> <span class=\"x x-first\">client</span><span class=\"pl-k x\">.</span><span class=\"x\">getComponent(</span><span class=\"pl-smi x\">ClientComponent</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">class)</span><span class=\"pl-k\">.</span>character;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-smi\">EntityRef</span> player <span class=\"pl-k\">=</span> <span class=\"x x-first x-last\">clientComp</span><span class=\"pl-k\">.</span>character;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "skaldarnar", "createdAt": "2020-03-30T20:48:25Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +231,44 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float function1(float parameter){\n+        double p = (double)parameter;\n+        return (float) pow(p,0.6) * 0.78f ;\n+    }\n+\n+    private float function2(float parameter){\n+       return 0.15f + (0.64f * parameter) - (0.006f * parameter * parameter);\n+    }\n+\n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n         try {\n             ClientComponent clientComp = client.getComponent(ClientComponent.class);\n             CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            if (move != null) {\n+            CharacterComponent charComp=clientComp.character.getComponent(CharacterComponent.class);\n+            EntityRef player = client.getComponent(ClientComponent.class).character;", "originalCommit": "5212bad83f1437d495cd77a2cf826c3d84ff14cd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "26f8f9833ab999d4f519842c8d009a87b5214b53", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 752d5a413..b2deb90e6 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -247,7 +252,7 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n             ClientComponent clientComp = client.getComponent(ClientComponent.class);\n             CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n             CharacterComponent charComp=clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = client.getComponent(ClientComponent.class).character;\n+            EntityRef player = clientComp.character;\n             GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n \n             float ratio = amount / 1.6f;\n", "next_change": {"commit": "1e21cc6b3ab6b65411594e49a24aeebe744db54a", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex b2deb90e6..bb929cacc 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -251,23 +256,22 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n         try {\n             ClientComponent clientComp = client.getComponent(ClientComponent.class);\n             CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp=clientComp.character.getComponent(CharacterComponent.class);\n+            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n             EntityRef player = clientComp.character;\n             GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n \n             float ratio = amount / 1.6f;\n-            float constant= function1(amount);\n \n             if (move != null && gazeMountPointComponent != null) {\n                 float prevHeight = move.height;\n \n                 move.height = amount;\n                 gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = 12 * constant;\n+                move.jumpSpeed = getJumpSpeed(amount);\n                 move.stepHeight = 0.35f * ratio;\n                 move.distanceBetweenFootsteps = ratio;\n-                move.runFactor = function2(amount);\n-                charComp.interactionRange = 5 * constant;\n+                move.runFactor = getRunFactor(amount);\n+                charComp.interactionRange = getInteractionRange(amount);\n \n                 Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n                 Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n", "next_change": {"commit": "851d6b66eba64fa6000a7f92118aef06c05d2a7c", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex bb929cacc..0303f59b5 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -268,8 +272,8 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n                 move.height = amount;\n                 gazeMountPointComponent.translate.y = amount;\n                 move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = 0.35f * ratio;\n-                move.distanceBetweenFootsteps = ratio;\n+                move.stepHeight = defaultStepHeight * ratio;\n+                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n                 move.runFactor = getRunFactor(amount);\n                 charComp.interactionRange = getInteractionRange(amount);\n \n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 0303f59b5..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = move.height;\n-            float defaultStepHeight = move.stepHeight;\n-            float defaultFootSteps = move.distanceBetweenFootsteps;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ4NDc5Ng==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r400484796", "body": "What constant is calculated based off the height (amount)? Is it the eye level or something like that?", "bodyText": "What constant is calculated based off the height (amount)? Is it the eye level or something like that?", "bodyHTML": "<p dir=\"auto\">What constant is calculated based off the height (amount)? Is it the eye level or something like that?</p>", "author": "skaldarnar", "createdAt": "2020-03-30T20:49:22Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +231,44 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float function1(float parameter){\n+        double p = (double)parameter;\n+        return (float) pow(p,0.6) * 0.78f ;\n+    }\n+\n+    private float function2(float parameter){\n+       return 0.15f + (0.64f * parameter) - (0.006f * parameter * parameter);\n+    }\n+\n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n         try {\n             ClientComponent clientComp = client.getComponent(ClientComponent.class);\n             CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            if (move != null) {\n+            CharacterComponent charComp=clientComp.character.getComponent(CharacterComponent.class);\n+            EntityRef player = client.getComponent(ClientComponent.class).character;\n+            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+\n+            float ratio = amount / 1.6f;\n+            float constant= function1(amount);", "originalCommit": "5212bad83f1437d495cd77a2cf826c3d84ff14cd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "26f8f9833ab999d4f519842c8d009a87b5214b53", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 752d5a413..b2deb90e6 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -247,7 +252,7 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n             ClientComponent clientComp = client.getComponent(ClientComponent.class);\n             CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n             CharacterComponent charComp=clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = client.getComponent(ClientComponent.class).character;\n+            EntityRef player = clientComp.character;\n             GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n \n             float ratio = amount / 1.6f;\n", "next_change": {"commit": "1e21cc6b3ab6b65411594e49a24aeebe744db54a", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex b2deb90e6..bb929cacc 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -251,23 +256,22 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n         try {\n             ClientComponent clientComp = client.getComponent(ClientComponent.class);\n             CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp=clientComp.character.getComponent(CharacterComponent.class);\n+            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n             EntityRef player = clientComp.character;\n             GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n \n             float ratio = amount / 1.6f;\n-            float constant= function1(amount);\n \n             if (move != null && gazeMountPointComponent != null) {\n                 float prevHeight = move.height;\n \n                 move.height = amount;\n                 gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = 12 * constant;\n+                move.jumpSpeed = getJumpSpeed(amount);\n                 move.stepHeight = 0.35f * ratio;\n                 move.distanceBetweenFootsteps = ratio;\n-                move.runFactor = function2(amount);\n-                charComp.interactionRange = 5 * constant;\n+                move.runFactor = getRunFactor(amount);\n+                charComp.interactionRange = getInteractionRange(amount);\n \n                 Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n                 Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n", "next_change": {"commit": "851d6b66eba64fa6000a7f92118aef06c05d2a7c", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex bb929cacc..0303f59b5 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -268,8 +272,8 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n                 move.height = amount;\n                 gazeMountPointComponent.translate.y = amount;\n                 move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = 0.35f * ratio;\n-                move.distanceBetweenFootsteps = ratio;\n+                move.stepHeight = defaultStepHeight * ratio;\n+                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n                 move.runFactor = getRunFactor(amount);\n                 charComp.interactionRange = getInteractionRange(amount);\n \n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 0303f59b5..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = move.height;\n-            float defaultStepHeight = move.stepHeight;\n-            float defaultFootSteps = move.distanceBetweenFootsteps;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDQ4NjQwMA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r400486400", "body": "If `function2` computes the run factor (whatever that is) you could call it `getRunFactor` instead.", "bodyText": "If function2 computes the run factor (whatever that is) you could call it getRunFactor instead.", "bodyHTML": "<p dir=\"auto\">If <code>function2</code> computes the run factor (whatever that is) you could call it <code>getRunFactor</code> instead.</p>", "author": "skaldarnar", "createdAt": "2020-03-30T20:52:23Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +231,44 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float function1(float parameter){\n+        double p = (double)parameter;\n+        return (float) pow(p,0.6) * 0.78f ;\n+    }\n+\n+    private float function2(float parameter){\n+       return 0.15f + (0.64f * parameter) - (0.006f * parameter * parameter);\n+    }\n+\n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n         try {\n             ClientComponent clientComp = client.getComponent(ClientComponent.class);\n             CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            if (move != null) {\n+            CharacterComponent charComp=clientComp.character.getComponent(CharacterComponent.class);\n+            EntityRef player = client.getComponent(ClientComponent.class).character;\n+            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+\n+            float ratio = amount / 1.6f;\n+            float constant= function1(amount);\n+\n+            if (move != null && gazeMountPointComponent != null) {\n                 float prevHeight = move.height;\n+\n                 move.height = amount;\n+                gazeMountPointComponent.translate.y = amount;\n+                move.jumpSpeed = 12 * constant;\n+                move.stepHeight = 0.35f * ratio;\n+                move.distanceBetweenFootsteps = ratio;\n+                move.runFactor = function2(amount);", "originalCommit": "5212bad83f1437d495cd77a2cf826c3d84ff14cd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1e21cc6b3ab6b65411594e49a24aeebe744db54a", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 752d5a413..bb929cacc 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -246,23 +256,22 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n         try {\n             ClientComponent clientComp = client.getComponent(ClientComponent.class);\n             CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp=clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = client.getComponent(ClientComponent.class).character;\n+            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+            EntityRef player = clientComp.character;\n             GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n \n             float ratio = amount / 1.6f;\n-            float constant= function1(amount);\n \n             if (move != null && gazeMountPointComponent != null) {\n                 float prevHeight = move.height;\n \n                 move.height = amount;\n                 gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = 12 * constant;\n+                move.jumpSpeed = getJumpSpeed(amount);\n                 move.stepHeight = 0.35f * ratio;\n                 move.distanceBetweenFootsteps = ratio;\n-                move.runFactor = function2(amount);\n-                charComp.interactionRange = 5 * constant;\n+                move.runFactor = getRunFactor(amount);\n+                charComp.interactionRange = getInteractionRange(amount);\n \n                 Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n                 Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n", "next_change": {"commit": "851d6b66eba64fa6000a7f92118aef06c05d2a7c", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex bb929cacc..0303f59b5 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -268,8 +272,8 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n                 move.height = amount;\n                 gazeMountPointComponent.translate.y = amount;\n                 move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = 0.35f * ratio;\n-                move.distanceBetweenFootsteps = ratio;\n+                move.stepHeight = defaultStepHeight * ratio;\n+                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n                 move.runFactor = getRunFactor(amount);\n                 charComp.interactionRange = getInteractionRange(amount);\n \n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 0303f59b5..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = move.height;\n-            float defaultStepHeight = move.stepHeight;\n-            float defaultFootSteps = move.distanceBetweenFootsteps;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}]}}, {"oid": "f94718fa1643fd18991bb1f478d2f0c57ff2e8b1", "url": "https://github.com/MovingBlocks/Terasology/commit/f94718fa1643fd18991bb1f478d2f0c57ff2e8b1", "message": "Expanded star import", "committedDate": "2020-04-02T05:57:55Z", "type": "commit"}, {"oid": "26f8f9833ab999d4f519842c8d009a87b5214b53", "url": "https://github.com/MovingBlocks/Terasology/commit/26f8f9833ab999d4f519842c8d009a87b5214b53", "message": "Update engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n\nCo-Authored-By: Tobias Nett <skaldarnar@googlemail.com>", "committedDate": "2020-04-02T06:00:00Z", "type": "commit"}, {"oid": "1e21cc6b3ab6b65411594e49a24aeebe744db54a", "url": "https://github.com/MovingBlocks/Terasology/commit/1e21cc6b3ab6b65411594e49a24aeebe744db54a", "message": "Assigned more meaningful names and cleaned up code", "committedDate": "2020-04-02T06:43:25Z", "type": "commit"}, {"oid": "6b915eff7bfc6b30a5ae9a1bbf41f66a9bc3b301", "url": "https://github.com/MovingBlocks/Terasology/commit/6b915eff7bfc6b30a5ae9a1bbf41f66a9bc3b301", "message": "Fixed small mistake", "committedDate": "2020-04-02T07:04:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQxODIxMA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r402418210", "body": "The member `height` is `public` in `CharacterMovementComponent`, so there should be no need for this getter method. \r\n\r\nSee [CharacterMovementComponent.java#L39](https://github.com/godfather2/Terasology/blob/6b915eff7bfc6b30a5ae9a1bbf41f66a9bc3b301/engine/src/main/java/org/terasology/logic/characters/CharacterMovementComponent.java#L39)", "bodyText": "The member height is public in CharacterMovementComponent, so there should be no need for this getter method.\nSee CharacterMovementComponent.java#L39", "bodyHTML": "<p dir=\"auto\">The member <code>height</code> is <code>public</code> in <code>CharacterMovementComponent</code>, so there should be no need for this getter method.</p>\n<p dir=\"auto\">See <a href=\"https://github.com/godfather2/Terasology/blob/6b915eff7bfc6b30a5ae9a1bbf41f66a9bc3b301/engine/src/main/java/org/terasology/logic/characters/CharacterMovementComponent.java#L39\">CharacterMovementComponent.java#L39</a></p>", "author": "skaldarnar", "createdAt": "2020-04-02T15:47:31Z", "path": "engine/src/main/java/org/terasology/logic/characters/CharacterMovementComponent.java", "diffHunk": "@@ -91,6 +91,8 @@ public Vector3f getVelocity() {\n         return velocity;\n     }\n \n+    public float getPlayerHeight(){ return height; }", "originalCommit": "6b915eff7bfc6b30a5ae9a1bbf41f66a9bc3b301", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "87596cf7deffa6cd8a93d3b5221d35d6d54a8c9e", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/characters/CharacterMovementComponent.java b/engine/src/main/java/org/terasology/logic/characters/CharacterMovementComponent.java\nindex 33911aba9..b25356ebf 100644\n--- a/engine/src/main/java/org/terasology/logic/characters/CharacterMovementComponent.java\n+++ b/engine/src/main/java/org/terasology/logic/characters/CharacterMovementComponent.java\n", "chunk": "@@ -91,8 +91,6 @@ public Vector3f getVelocity() {\n         return velocity;\n     }\n \n-    public float getPlayerHeight(){ return height; }\n-\n     public void setVelocity(Vector3f newVelocity) {\n         velocity.set(newVelocity);\n     }\n", "next_change": null}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQyMjc1NQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r402422755", "body": "I believe `1.6f` is the default height of the player? Ideally, we don't have to copy around these [magic numbers](https://en.wikipedia.org/wiki/Magic_number_(programming)) and loose track of where they came from.\r\n\r\nThe best shot could be to define constants in `CharacterMovementComponent` which can be reused here.", "bodyText": "I believe 1.6f is the default height of the player? Ideally, we don't have to copy around these magic numbers and loose track of where they came from.\nThe best shot could be to define constants in CharacterMovementComponent which can be reused here.", "bodyHTML": "<p dir=\"auto\">I believe <code>1.6f</code> is the default height of the player? Ideally, we don't have to copy around these <a href=\"https://en.wikipedia.org/wiki/Magic_number_(programming)\" rel=\"nofollow\">magic numbers</a> and loose track of where they came from.</p>\n<p dir=\"auto\">The best shot could be to define constants in <code>CharacterMovementComponent</code> which can be reused here.</p>", "author": "skaldarnar", "createdAt": "2020-04-02T15:53:39Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +236,48 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 9.36f ;\n+    }\n+    \n+    private float getInteractionRange(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 3.9f ;\n+    }\n+\n+    private float getRunFactor(float amount){\n+       return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n+    }\n+\n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n         try {\n             ClientComponent clientComp = client.getComponent(ClientComponent.class);\n             CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            if (move != null) {\n+            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+            EntityRef player = clientComp.character;\n+            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+\n+            float ratio = amount / 1.6f;", "originalCommit": "6b915eff7bfc6b30a5ae9a1bbf41f66a9bc3b301", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "851d6b66eba64fa6000a7f92118aef06c05d2a7c", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 9d8b21bf4..0303f59b5 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -260,7 +260,11 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n             EntityRef player = clientComp.character;\n             GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n \n-            float ratio = amount / 1.6f;\n+            float defaultHeight = move.height;\n+            float defaultStepHeight = move.stepHeight;\n+            float defaultFootSteps = move.distanceBetweenFootsteps;\n+            \n+            float ratio = amount / defaultHeight;\n \n             if (move != null && gazeMountPointComponent != null) {\n                 float prevHeight = move.height;\n", "next_change": {"commit": "944bc1ea00d812eca22b6234a956d580f4b11000", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 0303f59b5..dee7f2ad1 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -260,9 +260,9 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n             EntityRef player = clientComp.character;\n             GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n \n-            float defaultHeight = move.height;\n-            float defaultStepHeight = move.stepHeight;\n-            float defaultFootSteps = move.distanceBetweenFootsteps;\n+            float defaultHeight = 1.6f;\n+            float defaultStepHeight = 0.35f;\n+            float defaultFootSteps = 1f;\n             \n             float ratio = amount / defaultHeight;\n \n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex dee7f2ad1..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = 1.6f;\n-            float defaultStepHeight = 0.35f;\n-            float defaultFootSteps = 1f;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQyODA2MA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r402428060", "body": "Height has a limitation of `@Range(min = 0, max = 5)` in `CharacterMovementComponent`, that should probably also be checked here...", "bodyText": "Height has a limitation of @Range(min = 0, max = 5) in CharacterMovementComponent, that should probably also be checked here...", "bodyHTML": "<p dir=\"auto\">Height has a limitation of <code>@Range(min = 0, max = 5)</code> in <code>CharacterMovementComponent</code>, that should probably also be checked here...</p>", "author": "skaldarnar", "createdAt": "2020-04-02T16:00:51Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +236,48 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 9.36f ;\n+    }\n+    \n+    private float getInteractionRange(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 3.9f ;\n+    }\n+\n+    private float getRunFactor(float amount){\n+       return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n+    }\n+\n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {", "originalCommit": "6b915eff7bfc6b30a5ae9a1bbf41f66a9bc3b301", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "851d6b66eba64fa6000a7f92118aef06c05d2a7c", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 9d8b21bf4..0303f59b5 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return (float) pow(d,0.6) * 9.36f ;\n+        return Math.round(pow(d,0.55) * 8.45f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return (float) pow(d,0.6) * 3.9f ;\n+        return Math.round(pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n+       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "9de2a0b0df45386c5488b9ac8be37ff2a2c165b4", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 0303f59b5..c71a75169 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+        return Math.round(Math.pow(d,0.5) * 8.3f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+        return Math.round(Math.pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex c71a75169..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.5) * 8.3f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = 1.6f;\n-            float defaultStepHeight = 0.35f;\n-            float defaultFootSteps = 1f;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQ1MjM3NA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r402452374", "body": "The default `jumpSpeed` seems to be 10 (and that's the maximum at the same time o.O ). thus, I would assume that setting the player height to the default should result in the default jump speed, but substituting `amount` by 1.6 yiels a value ~12.4 (\u226010).\r\n\r\nThis is how the jump speed is adjusted according to this function, for `amount` in the interval from 0 to 5:\r\n![image](https://user-images.githubusercontent.com/1448874/78274288-470a3800-7510-11ea-881c-092fc9242763.png)\r\nsee [Wolfram Alpha](https://www.wolframalpha.com/input/?i=pow%28x%2C+0.6%29+*+9.36%2C+x+in+%5B0%2C5%5D)\r\n\r\n\r\nsee [CharacterMovementComponent.java#L53-L54](https://github.com/godfather2/Terasology/blob/heightExtras/engine/src/main/java/org/terasology/logic/characters/CharacterMovementComponent.java#L53-L54)", "bodyText": "The default jumpSpeed seems to be 10 (and that's the maximum at the same time o.O ). thus, I would assume that setting the player height to the default should result in the default jump speed, but substituting amount by 1.6 yiels a value ~12.4 (\u226010).\nThis is how the jump speed is adjusted according to this function, for amount in the interval from 0 to 5:\n\nsee Wolfram Alpha\nsee CharacterMovementComponent.java#L53-L54", "bodyHTML": "<p dir=\"auto\">The default <code>jumpSpeed</code> seems to be 10 (and that's the maximum at the same time o.O ). thus, I would assume that setting the player height to the default should result in the default jump speed, but substituting <code>amount</code> by 1.6 yiels a value ~12.4 (\u226010).</p>\n<p dir=\"auto\">This is how the jump speed is adjusted according to this function, for <code>amount</code> in the interval from 0 to 5:<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/1448874/78274288-470a3800-7510-11ea-881c-092fc9242763.png\"><img src=\"https://user-images.githubusercontent.com/1448874/78274288-470a3800-7510-11ea-881c-092fc9242763.png\" alt=\"image\" style=\"max-width: 100%;\"></a><br>\nsee <a href=\"https://www.wolframalpha.com/input/?i=pow%28x%2C+0.6%29+*+9.36%2C+x+in+%5B0%2C5%5D\" rel=\"nofollow\">Wolfram Alpha</a></p>\n<p dir=\"auto\">see <a href=\"https://github.com/godfather2/Terasology/blob/heightExtras/engine/src/main/java/org/terasology/logic/characters/CharacterMovementComponent.java#L53-L54\">CharacterMovementComponent.java#L53-L54</a></p>", "author": "skaldarnar", "createdAt": "2020-04-02T16:36:52Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +236,48 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 9.36f ;", "originalCommit": "6b915eff7bfc6b30a5ae9a1bbf41f66a9bc3b301", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "851d6b66eba64fa6000a7f92118aef06c05d2a7c", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 9d8b21bf4..0303f59b5 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return (float) pow(d,0.6) * 9.36f ;\n+        return Math.round(pow(d,0.55) * 8.45f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return (float) pow(d,0.6) * 3.9f ;\n+        return Math.round(pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n+       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "9de2a0b0df45386c5488b9ac8be37ff2a2c165b4", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 0303f59b5..c71a75169 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+        return Math.round(Math.pow(d,0.5) * 8.3f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+        return Math.round(Math.pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex c71a75169..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.5) * 8.3f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = 1.6f;\n-            float defaultStepHeight = 0.35f;\n-            float defaultFootSteps = 1f;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQ1NTkxMw==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r402455913", "body": "The run factor seems to be a value in the range from 0 to 10, with 1.5 being the default. \r\n\r\nAgain, calculating the new run factor with the default height of 1.6 yields a value of 1.15864 (\u22601.5).\r\n\r\nThis is how the run factor scales with the given function for `amount` between 0 and 5. The curve looks almost linear, to be hones:\r\n![image](https://user-images.githubusercontent.com/1448874/78275222-98ff8d80-7511-11ea-9c71-f48586f3fe47.png)\r\nsee [Wolfram Alpha](https://www.wolframalpha.com/input/?i=0.15+%2B+%280.64+*+x%29+-+%280.006+*+x%5E2%29+%2C+x+in+%5B0%2C5%5D)", "bodyText": "The run factor seems to be a value in the range from 0 to 10, with 1.5 being the default.\nAgain, calculating the new run factor with the default height of 1.6 yields a value of 1.15864 (\u22601.5).\nThis is how the run factor scales with the given function for amount between 0 and 5. The curve looks almost linear, to be hones:\n\nsee Wolfram Alpha", "bodyHTML": "<p dir=\"auto\">The run factor seems to be a value in the range from 0 to 10, with 1.5 being the default.</p>\n<p dir=\"auto\">Again, calculating the new run factor with the default height of 1.6 yields a value of 1.15864 (\u22601.5).</p>\n<p dir=\"auto\">This is how the run factor scales with the given function for <code>amount</code> between 0 and 5. The curve looks almost linear, to be hones:<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/1448874/78275222-98ff8d80-7511-11ea-9c71-f48586f3fe47.png\"><img src=\"https://user-images.githubusercontent.com/1448874/78275222-98ff8d80-7511-11ea-9c71-f48586f3fe47.png\" alt=\"image\" style=\"max-width: 100%;\"></a><br>\nsee <a href=\"https://www.wolframalpha.com/input/?i=0.15+%2B+%280.64+*+x%29+-+%280.006+*+x%5E2%29+%2C+x+in+%5B0%2C5%5D\" rel=\"nofollow\">Wolfram Alpha</a></p>", "author": "skaldarnar", "createdAt": "2020-04-02T16:42:16Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +236,48 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 9.36f ;\n+    }\n+    \n+    private float getInteractionRange(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 3.9f ;\n+    }\n+\n+    private float getRunFactor(float amount){\n+       return 0.15f + (0.64f * amount) - (0.006f * amount * amount);", "originalCommit": "6b915eff7bfc6b30a5ae9a1bbf41f66a9bc3b301", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "851d6b66eba64fa6000a7f92118aef06c05d2a7c", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 9d8b21bf4..0303f59b5 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return (float) pow(d,0.6) * 9.36f ;\n+        return Math.round(pow(d,0.55) * 8.45f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return (float) pow(d,0.6) * 3.9f ;\n+        return Math.round(pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n+       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "9de2a0b0df45386c5488b9ac8be37ff2a2c165b4", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 0303f59b5..c71a75169 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+        return Math.round(Math.pow(d,0.5) * 8.3f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+        return Math.round(Math.pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex c71a75169..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.5) * 8.3f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = 1.6f;\n-            float defaultStepHeight = 0.35f;\n-            float defaultFootSteps = 1f;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQ2NTE4MQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r402465181", "body": "The default interaction range seems to be 5 (see [CharacterComponent.java#L37](https://github.com/MovingBlocks/Terasology/blob/develop/engine/src/main/java/org/terasology/logic/characters/CharacterComponent.java#L37)). With this formula the interaction range for height of 1.6 is 5.17055 (\u2260 5).\r\n\r\nThis is what the plot looks like:\r\n![image](https://user-images.githubusercontent.com/1448874/78276579-84bc9000-7513-11ea-8600-1694149e43b6.png)\r\nsee [Wolfram Alpha](https://www.wolframalpha.com/input/?i=pow%28x%2C0.6%29+*+3.9%2C+x+in+%5B0%2C5%5D)", "bodyText": "The default interaction range seems to be 5 (see CharacterComponent.java#L37). With this formula the interaction range for height of 1.6 is 5.17055 (\u2260 5).\nThis is what the plot looks like:\n\nsee Wolfram Alpha", "bodyHTML": "<p dir=\"auto\">The default interaction range seems to be 5 (see <a href=\"https://github.com/MovingBlocks/Terasology/blob/develop/engine/src/main/java/org/terasology/logic/characters/CharacterComponent.java#L37\">CharacterComponent.java#L37</a>). With this formula the interaction range for height of 1.6 is 5.17055 (\u2260 5).</p>\n<p dir=\"auto\">This is what the plot looks like:<br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/1448874/78276579-84bc9000-7513-11ea-8600-1694149e43b6.png\"><img src=\"https://user-images.githubusercontent.com/1448874/78276579-84bc9000-7513-11ea-8600-1694149e43b6.png\" alt=\"image\" style=\"max-width: 100%;\"></a><br>\nsee <a href=\"https://www.wolframalpha.com/input/?i=pow%28x%2C0.6%29+*+3.9%2C+x+in+%5B0%2C5%5D\" rel=\"nofollow\">Wolfram Alpha</a></p>", "author": "skaldarnar", "createdAt": "2020-04-02T16:56:27Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +236,48 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 9.36f ;\n+    }\n+    \n+    private float getInteractionRange(float amount){\n+        double d = (double)amount;\n+        return (float) pow(d,0.6) * 3.9f ;", "originalCommit": "6b915eff7bfc6b30a5ae9a1bbf41f66a9bc3b301", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "851d6b66eba64fa6000a7f92118aef06c05d2a7c", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 9d8b21bf4..0303f59b5 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return (float) pow(d,0.6) * 9.36f ;\n+        return Math.round(pow(d,0.55) * 8.45f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return (float) pow(d,0.6) * 3.9f ;\n+        return Math.round(pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return 0.15f + (0.64f * amount) - (0.006f * amount * amount);\n+       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "9de2a0b0df45386c5488b9ac8be37ff2a2c165b4", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 0303f59b5..c71a75169 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+        return Math.round(Math.pow(d,0.5) * 8.3f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+        return Math.round(Math.pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex c71a75169..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.5) * 8.3f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = 1.6f;\n-            float defaultStepHeight = 0.35f;\n-            float defaultFootSteps = 1f;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}]}}, {"oid": "87596cf7deffa6cd8a93d3b5221d35d6d54a8c9e", "url": "https://github.com/MovingBlocks/Terasology/commit/87596cf7deffa6cd8a93d3b5221d35d6d54a8c9e", "message": "Got rid of unnecessary getter", "committedDate": "2020-04-04T07:27:25Z", "type": "commit"}, {"oid": "851d6b66eba64fa6000a7f92118aef06c05d2a7c", "url": "https://github.com/MovingBlocks/Terasology/commit/851d6b66eba64fa6000a7f92118aef06c05d2a7c", "message": "Made necessary changes", "committedDate": "2020-04-04T16:39:52Z", "type": "commit"}, {"oid": "fa8d3ed2baba237f5a9a417eb277e02740949e7d", "url": "https://github.com/MovingBlocks/Terasology/commit/fa8d3ed2baba237f5a9a417eb277e02740949e7d", "message": "Changed the height range", "committedDate": "2020-04-04T16:43:06Z", "type": "commit"}, {"oid": "944bc1ea00d812eca22b6234a956d580f4b11000", "url": "https://github.com/MovingBlocks/Terasology/commit/944bc1ea00d812eca22b6234a956d580f4b11000", "message": "corrected small mistake", "committedDate": "2020-04-04T17:36:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ5NjI5Ng==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r403496296", "body": "This does not take the default values, but the _current values_ for the CharacterMovementComponent.", "bodyText": "This does not take the default values, but the current values for the CharacterMovementComponent.", "bodyHTML": "<p dir=\"auto\">This does not take the default values, but the <em>current values</em> for the CharacterMovementComponent.</p>", "author": "skaldarnar", "createdAt": "2020-04-04T17:43:54Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +236,52 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float amount){\n+        double d = (double)amount;\n+        return Math.round(pow(d,0.55) * 8.45f);\n+    }\n+    \n+    private float getInteractionRange(float amount){\n+        double d = (double)amount;\n+        return Math.round(pow(d,0.6) * 3.9f);\n+    }\n+\n+    private float getRunFactor(float amount){\n+       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    }\n+\n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n         try {\n             ClientComponent clientComp = client.getComponent(ClientComponent.class);\n             CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            if (move != null) {\n+            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+            EntityRef player = clientComp.character;\n+            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+\n+            float defaultHeight = move.height;\n+            float defaultStepHeight = move.stepHeight;\n+            float defaultFootSteps = move.distanceBetweenFootsteps;", "originalCommit": "fa8d3ed2baba237f5a9a417eb277e02740949e7d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "9de2a0b0df45386c5488b9ac8be37ff2a2c165b4", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex 0303f59b5..c71a75169 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -260,9 +260,9 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n             EntityRef player = clientComp.character;\n             GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n \n-            float defaultHeight = move.height;\n-            float defaultStepHeight = move.stepHeight;\n-            float defaultFootSteps = move.distanceBetweenFootsteps;\n+            float defaultHeight = 1.6f;\n+            float defaultStepHeight = 0.35f;\n+            float defaultFootSteps = 1f;\n             \n             float ratio = amount / defaultHeight;\n \n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex c71a75169..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.5) * 8.3f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = 1.6f;\n-            float defaultStepHeight = 0.35f;\n-            float defaultFootSteps = 1f;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ5ODQ2OQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r403498469", "body": "```suggestion\r\n    private float getJumpSpeed(float height) {\r\n        return Math.round(Math.pow(height/DEFAULT_HEIGHT, 0.55f) * DEFAULT_JUMP_SPEED);\r\n    }\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private float getJumpSpeed(float amount){\n          \n          \n            \n                    double d = (double)amount;\n          \n          \n            \n                    return Math.round(pow(d,0.55) * 8.45f);\n          \n          \n            \n                }\n          \n          \n            \n                private float getJumpSpeed(float height) {\n          \n          \n            \n                    return Math.round(Math.pow(height/DEFAULT_HEIGHT, 0.55f) * DEFAULT_JUMP_SPEED);\n          \n          \n            \n                }", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"243\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">float</span> getJumpSpeed(<span class=\"pl-k\">float</span> amount){</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"244\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">double</span> d <span class=\"pl-k\">=</span> (<span class=\"pl-k\">double</span>)amount;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"245\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">return</span> <span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>round(pow(d,<span class=\"pl-c1\">0.55</span>) <span class=\"pl-k\">*</span> <span class=\"pl-c1\">8.45f</span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"246\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"243\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">float</span> getJumpSpeed(<span class=\"pl-k\">float</span> height) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"244\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">return</span> <span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>round(<span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>pow(height<span class=\"pl-k\">/</span><span class=\"pl-c1\">DEFAULT_HEIGHT</span>, <span class=\"pl-c1\">0.55f</span>) <span class=\"pl-k\">*</span> <span class=\"pl-c1\">DEFAULT_JUMP_SPEED</span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"245\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    }</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "skaldarnar", "createdAt": "2020-04-04T18:04:45Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +236,52 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float amount){\n+        double d = (double)amount;\n+        return Math.round(pow(d,0.55) * 8.45f);\n+    }", "originalCommit": "944bc1ea00d812eca22b6234a956d580f4b11000", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "9de2a0b0df45386c5488b9ac8be37ff2a2c165b4", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex dee7f2ad1..c71a75169 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+        return Math.round(Math.pow(d,0.5) * 8.3f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+        return Math.round(Math.pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex c71a75169..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.5) * 8.3f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = 1.6f;\n-            float defaultStepHeight = 0.35f;\n-            float defaultFootSteps = 1f;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ5ODc0Ng==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r403498746", "body": "```suggestion\r\n    private float getInteractionRange(float height){\r\n        return Math.round(pow(height/DEFAULT_HEIGHT, 0.6) * DEFAULT_INTERACTION_RANGE);\r\n    }\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private float getInteractionRange(float amount){\n          \n          \n            \n                    double d = (double)amount;\n          \n          \n            \n                    return Math.round(pow(d,0.6) * 3.9f);\n          \n          \n            \n                }\n          \n          \n            \n                private float getInteractionRange(float height){\n          \n          \n            \n                    return Math.round(pow(height/DEFAULT_HEIGHT, 0.6) * DEFAULT_INTERACTION_RANGE);\n          \n          \n            \n                }", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"247\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">float</span> getInteractionRange(<span class=\"pl-k\">float</span> amount){</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"248\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">double</span> d <span class=\"pl-k\">=</span> (<span class=\"pl-k\">double</span>)amount;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"249\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">return</span> <span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>round(pow(d,<span class=\"pl-c1\">0.6</span>) <span class=\"pl-k\">*</span> <span class=\"pl-c1\">3.9f</span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"250\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"247\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">float</span> getInteractionRange(<span class=\"pl-k\">float</span> height){</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"248\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">return</span> <span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>round(pow(height<span class=\"pl-k\">/</span><span class=\"pl-c1\">DEFAULT_HEIGHT</span>, <span class=\"pl-c1\">0.6</span>) <span class=\"pl-k\">*</span> <span class=\"pl-c1\">DEFAULT_INTERACTION_RANGE</span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"249\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    }</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "skaldarnar", "createdAt": "2020-04-04T18:06:44Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +236,52 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float amount){\n+        double d = (double)amount;\n+        return Math.round(pow(d,0.55) * 8.45f);\n+    }\n+    \n+    private float getInteractionRange(float amount){\n+        double d = (double)amount;\n+        return Math.round(pow(d,0.6) * 3.9f);\n+    }", "originalCommit": "944bc1ea00d812eca22b6234a956d580f4b11000", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "9de2a0b0df45386c5488b9ac8be37ff2a2c165b4", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex dee7f2ad1..c71a75169 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+        return Math.round(Math.pow(d,0.5) * 8.3f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+        return Math.round(Math.pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex c71a75169..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.5) * 8.3f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = 1.6f;\n-            float defaultStepHeight = 0.35f;\n-            float defaultFootSteps = 1f;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ5OTU5Nw==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r403499597", "body": "Maybe use a similar formular to the ones you use above? Is there any reason this should be quadratic?\r\n```suggestion\r\n    private float getRunFactor(float height){\r\n       return Math.round(Math.pow(height/DEFAULT_HEIGHT, 0.5) * DEFAULT_RUN_FACTOR);;\r\n    }\r\n```", "bodyText": "Maybe use a similar formular to the ones you use above? Is there any reason this should be quadratic?\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private float getRunFactor(float amount){\n          \n          \n            \n                   return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n          \n          \n            \n                }\n          \n          \n            \n                private float getRunFactor(float height){\n          \n          \n            \n                   return Math.round(Math.pow(height/DEFAULT_HEIGHT, 0.5) * DEFAULT_RUN_FACTOR);;\n          \n          \n            \n                }", "bodyHTML": "<p dir=\"auto\">Maybe use a similar formular to the ones you use above? Is there any reason this should be quadratic?</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"251\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">float</span> getRunFactor(<span class=\"pl-k\">float</span> <span class=\"x x-first x-last\">amount</span>){</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"252\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">       <span class=\"pl-k\">return</span> <span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>round(<span class=\"pl-c1 x x-first\">5.5f</span><span class=\"x\"> </span><span class=\"pl-k x\">+</span><span class=\"x\"> (</span><span class=\"pl-c1 x\">6.4f</span><span class=\"x\"> </span><span class=\"pl-k x\">*</span><span class=\"x\"> amount) </span><span class=\"pl-k x\">-</span><span class=\"x\"> (</span><span class=\"pl-c1 x x-last\">0.06f</span> <span class=\"pl-k\">*</span> <span class=\"x x-first\">amount </span><span class=\"pl-k x\">*</span><span class=\"x\"> amount)) </span><span class=\"pl-k x\">/</span><span class=\"x\"> </span><span class=\"pl-c1 x x-last\">10f</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"253\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"251\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">float</span> getRunFactor(<span class=\"pl-k\">float</span> <span class=\"x x-first x-last\">height</span>){</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"252\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">       <span class=\"pl-k\">return</span> <span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>round(<span class=\"pl-smi x x-first\">Math</span><span class=\"pl-k x\">.</span><span class=\"x\">pow(height</span><span class=\"pl-k x\">/</span><span class=\"pl-c1 x\">DEFAULT_HEIGHT</span><span class=\"x\">, </span><span class=\"pl-c1 x\">0.5</span><span class=\"x x-last\">)</span> <span class=\"pl-k\">*</span> <span class=\"pl-c1 x x-first\">DEFAULT_RUN_FACTOR</span><span class=\"x x-last\">);</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"253\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    }</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "skaldarnar", "createdAt": "2020-04-04T18:14:05Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +236,52 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float amount){\n+        double d = (double)amount;\n+        return Math.round(pow(d,0.55) * 8.45f);\n+    }\n+    \n+    private float getInteractionRange(float amount){\n+        double d = (double)amount;\n+        return Math.round(pow(d,0.6) * 3.9f);\n+    }\n+\n+    private float getRunFactor(float amount){\n+       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    }", "originalCommit": "944bc1ea00d812eca22b6234a956d580f4b11000", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzUwOTAzMA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r403509030", "bodyText": "well....its just that i painstakingly constructing the other 2 functions manually,before i realized that it is much easier to arrive at them through regression,and that is how i acquired the third function.I must admit @skaldarnar you are really thorough", "author": "godfather2", "createdAt": "2020-04-04T19:43:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ5OTU5Nw=="}], "type": "inlineReview", "revised_code": {"commit": "9de2a0b0df45386c5488b9ac8be37ff2a2c165b4", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex dee7f2ad1..c71a75169 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n \n     private float getJumpSpeed(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+        return Math.round(Math.pow(d,0.5) * 8.3f);\n     }\n     \n     private float getInteractionRange(float amount){\n         double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+        return Math.round(Math.pow(d,0.6) * 3.9f);\n     }\n \n     private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex c71a75169..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.5) * 8.3f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(Math.pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.4f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = 1.6f;\n-            float defaultStepHeight = 0.35f;\n-            float defaultFootSteps = 1f;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ5OTc1MQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r403499751", "body": "These should not be re-defined here. When the default values in CharacterMovementComponent are changed these will be outdated, and will likely cause some weird behavior and bugs.\r\n\r\nInstead, `CharacterMovementComponent` should expose \r\n\r\n```java\r\n    public  static final float DEFAULT_HEIGHT = 1.6f;\r\n    public  static final float DEFAULT_JUMP_SPEED = 10.f;\r\n```", "bodyText": "These should not be re-defined here. When the default values in CharacterMovementComponent are changed these will be outdated, and will likely cause some weird behavior and bugs.\nInstead, CharacterMovementComponent should expose\n    public  static final float DEFAULT_HEIGHT = 1.6f;\n    public  static final float DEFAULT_JUMP_SPEED = 10.f;", "bodyHTML": "<p dir=\"auto\">These should not be re-defined here. When the default values in CharacterMovementComponent are changed these will be outdated, and will likely cause some weird behavior and bugs.</p>\n<p dir=\"auto\">Instead, <code>CharacterMovementComponent</code> should expose</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"    public  static final float DEFAULT_HEIGHT = 1.6f;\n    public  static final float DEFAULT_JUMP_SPEED = 10.f;\"><pre>    <span class=\"pl-k\">public</span>  <span class=\"pl-k\">static</span> <span class=\"pl-k\">final</span> <span class=\"pl-k\">float</span> <span class=\"pl-c1\">DEFAULT_HEIGHT</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">1.6f</span>;\n    <span class=\"pl-k\">public</span>  <span class=\"pl-k\">static</span> <span class=\"pl-k\">final</span> <span class=\"pl-k\">float</span> <span class=\"pl-c1\">DEFAULT_JUMP_SPEED</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">10.f</span>;</pre></div>", "author": "skaldarnar", "createdAt": "2020-04-04T18:15:20Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,22 +236,52 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float amount){\n+        double d = (double)amount;\n+        return Math.round(pow(d,0.55) * 8.45f);\n+    }\n+    \n+    private float getInteractionRange(float amount){\n+        double d = (double)amount;\n+        return Math.round(pow(d,0.6) * 3.9f);\n+    }\n+\n+    private float getRunFactor(float amount){\n+       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    }\n+\n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n         try {\n             ClientComponent clientComp = client.getComponent(ClientComponent.class);\n             CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            if (move != null) {\n+            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+            EntityRef player = clientComp.character;\n+            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+\n+            float defaultHeight = 1.6f;", "originalCommit": "944bc1ea00d812eca22b6234a956d580f4b11000", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzUwNDc5MA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r403504790", "bodyText": "i just looked at the restoreSpeed command. This is how it accesses default values CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class); for instance  move.jumpSpeed = moveDefault.jumpSpeed; Should i do this?", "author": "godfather2", "createdAt": "2020-04-04T19:03:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQ5OTc1MQ=="}], "type": "inlineReview", "revised_code": {"commit": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex dee7f2ad1..cb8dd132e 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -236,58 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float amount){\n-        double d = (double)amount;\n-        return Math.round(pow(d,0.55) * 8.45f);\n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n     }\n-    \n-    private float getInteractionRange(float amount){\n-        double d = (double)amount;\n-        return Math.round(pow(d,0.6) * 3.9f);\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n     }\n \n-    private float getRunFactor(float amount){\n-       return Math.round(5.5f + (6.4f * amount) - (0.06f * amount * amount)) / 10f;\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n-            EntityRef player = clientComp.character;\n-            GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-\n-            float defaultHeight = 1.6f;\n-            float defaultStepHeight = 0.35f;\n-            float defaultFootSteps = 1f;\n-            \n-            float ratio = amount / defaultHeight;\n-\n-            if (move != null && gazeMountPointComponent != null) {\n-                float prevHeight = move.height;\n-\n-                move.height = amount;\n-                gazeMountPointComponent.translate.y = amount;\n-                move.jumpSpeed = getJumpSpeed(amount);\n-                move.stepHeight = defaultStepHeight * ratio;\n-                move.distanceBetweenFootsteps = defaultFootSteps * ratio;\n-                move.runFactor = getRunFactor(amount);\n-                charComp.interactionRange = getInteractionRange(amount);\n-\n-                Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n-                Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n-                player.saveComponent(gazeMountPointComponent);\n-                clientComp.character.saveComponent(move);\n-\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {\n+                e.printStackTrace();\n+                return \"\";\n             }\n-            return \"\";\n-        } catch (NullPointerException e) {\n-            e.printStackTrace();\n-            return \"\";\n+        } else {\n+            return \"Invalid input. Accepted values: [1 to 25]\";\n         }\n     }\n \n", "next_change": null}]}}, {"oid": "9de2a0b0df45386c5488b9ac8be37ff2a2c165b4", "url": "https://github.com/MovingBlocks/Terasology/commit/9de2a0b0df45386c5488b9ac8be37ff2a2c165b4", "message": "Update MovementDebugCommands.java", "committedDate": "2020-04-04T18:24:35Z", "type": "commit"}, {"oid": "f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "url": "https://github.com/MovingBlocks/Terasology/commit/f29f7847f0329b75c3d55f14ce8c83d1c2d2b3cd", "message": "Cleaned up formulae", "committedDate": "2020-04-18T20:17:31Z", "type": "commit"}, {"oid": "0b002b9752840b6ad026fafbda909f418dd9d141", "url": "https://github.com/MovingBlocks/Terasology/commit/0b002b9752840b6ad026fafbda909f418dd9d141", "message": "Corrected the default height and height range", "committedDate": "2020-04-18T20:20:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg0OTYyMQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r410849621", "body": "Why did you change the default height here?\r\n```suggestion\r\n    public float height = 1.6f;\r\n```", "bodyText": "Why did you change the default height here?\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public float height = 1.8f;\n          \n          \n            \n                public float height = 1.6f;", "bodyHTML": "<p dir=\"auto\">Why did you change the default height here?</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">float</span> height <span class=\"pl-k\">=</span> <span class=\"pl-c1\">1.<span class=\"x x-first x-last\">8f</span></span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">float</span> height <span class=\"pl-k\">=</span> <span class=\"pl-c1\">1.<span class=\"x x-first x-last\">6f</span></span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "skaldarnar", "createdAt": "2020-04-19T08:22:40Z", "path": "engine/src/main/java/org/terasology/logic/characters/CharacterMovementComponent.java", "diffHunk": "@@ -35,8 +35,8 @@\n public final class CharacterMovementComponent implements Component {\n \n     // Collision settings\n-    @Range(min = 0, max = 5)\n-    public float height = 1.6f;\n+    @Range(min = 1, max = 25)\n+    public float height = 1.8f;", "originalCommit": "0b002b9752840b6ad026fafbda909f418dd9d141", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg2NTM4OA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r410865388", "bodyText": "Now I saw that the values in CharacterMovementComponent are not the same as the ones in player.prefab. That should not be a problem as you are loading the default values from the prefab anyways. Thus, I would like to keep this default value as it is.", "author": "skaldarnar", "createdAt": "2020-04-19T09:48:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg0OTYyMQ=="}], "type": "inlineReview", "revised_code": {"commit": "cb8015cb7a2c0eb669c880100dcb808fdfb111cf", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/characters/CharacterMovementComponent.java b/engine/src/main/java/org/terasology/logic/characters/CharacterMovementComponent.java\nindex 9f6bb1818..5f7f33490 100644\n--- a/engine/src/main/java/org/terasology/logic/characters/CharacterMovementComponent.java\n+++ b/engine/src/main/java/org/terasology/logic/characters/CharacterMovementComponent.java\n", "chunk": "@@ -36,7 +36,7 @@\n \n     // Collision settings\n     @Range(min = 1, max = 25)\n-    public float height = 1.8f;\n+    public float height = 1.6f;\n     @Range(min = 0, max = 5)\n     public float radius = 0.3f;\n     public CollisionGroup collisionGroup = StandardCollisionGroup.CHARACTER;\n", "next_change": null}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg2NTcxMg==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r410865712", "body": "Unfortunately, we cannot assume that the default value for the interaction range is always 5 as it may be changed by a prefab (see default jump speed). Thus, this method should also get the default value to multiply with:\r\n```suggestion\r\n    private float getInteractionRange(float ratio, float defaultValue) {\r\n        return (float) Math.pow(ratio, 0.62f) * defaultValue;\r\n    }\r\n```", "bodyText": "Unfortunately, we cannot assume that the default value for the interaction range is always 5 as it may be changed by a prefab (see default jump speed). Thus, this method should also get the default value to multiply with:\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private float getInteractionRange(float ratio) {\n          \n          \n            \n                    return (float) Math.pow(ratio, 0.62f) * 5f;\n          \n          \n            \n                }\n          \n          \n            \n                private float getInteractionRange(float ratio, float defaultValue) {\n          \n          \n            \n                    return (float) Math.pow(ratio, 0.62f) * defaultValue;\n          \n          \n            \n                }", "bodyHTML": "<p dir=\"auto\">Unfortunately, we cannot assume that the default value for the interaction range is always 5 as it may be changed by a prefab (see default jump speed). Thus, this method should also get the default value to multiply with:</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"247\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">float</span> getInteractionRange(<span class=\"pl-k\">float</span> ratio) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"248\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">return</span> (<span class=\"pl-k\">float</span>) <span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>pow(ratio, <span class=\"pl-c1\">0.62f</span>) <span class=\"pl-k\">*</span> <span class=\"pl-c1 x x-first x-last\">5f</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"249\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"247\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">float</span> getInteractionRange(<span class=\"pl-k\">float</span> ratio<span class=\"x x-first\">, </span><span class=\"pl-k x\">float</span><span class=\"x x-last\"> defaultValue</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"248\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">return</span> (<span class=\"pl-k\">float</span>) <span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>pow(ratio, <span class=\"pl-c1\">0.62f</span>) <span class=\"pl-k\">*</span> <span class=\"x x-first x-last\">defaultValue</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"249\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    }</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "skaldarnar", "createdAt": "2020-04-19T09:50:01Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,28 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n+    }\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n+    }", "originalCommit": "0b002b9752840b6ad026fafbda909f418dd9d141", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "cb8015cb7a2c0eb669c880100dcb808fdfb111cf", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex cb8dd132e..b97d41142 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float ratio) {\n-        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n+    private float getJumpSpeed(float ratio, float defaultValue) {\n+        return (float) Math.pow(ratio, 0.74f) * 0.4f * defaultValue + 0.6f * defaultValue;\n     }\n \n-    private float getInteractionRange(float ratio) {\n-        return (float) Math.pow(ratio, 0.62f) * 5f;\n+    private float getInteractionRange(float ratio, float defaultValue) {\n+        return (float) Math.pow(ratio, 0.62f) * defaultValue;\n     }\n \n-    private float getRunFactor(float ratio) {\n-        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n+    private float getRunFactor(float ratio, float defaultValue) {\n+        return (float) Math.pow(ratio, 0.68f) * defaultValue;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": null}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg2NTc5NQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r410865795", "body": "Same applies here for the run factor:\r\n```suggestion\r\n    private float getRunFactor(float ratio, float defaultValue) {\r\n        return (float) Math.pow(ratio, 0.68f) * defaultValue;\r\n    }\r\n```", "bodyText": "Same applies here for the run factor:\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private float getRunFactor(float ratio) {\n          \n          \n            \n                    return (float) Math.pow(ratio, 0.68f) * 1.5f;\n          \n          \n            \n                }\n          \n          \n            \n                private float getRunFactor(float ratio, float defaultValue) {\n          \n          \n            \n                    return (float) Math.pow(ratio, 0.68f) * defaultValue;\n          \n          \n            \n                }", "bodyHTML": "<p dir=\"auto\">Same applies here for the run factor:</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"251\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">float</span> getRunFactor(<span class=\"pl-k\">float</span> ratio) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"252\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">return</span> (<span class=\"pl-k\">float</span>) <span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>pow(ratio, <span class=\"pl-c1\">0.68f</span>) <span class=\"pl-k\">*</span> <span class=\"pl-c1 x x-first x-last\">1.5f</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"253\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"251\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">float</span> getRunFactor(<span class=\"pl-k\">float</span> ratio<span class=\"x x-first\">, </span><span class=\"pl-k x\">float</span><span class=\"x x-last\"> defaultValue</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"252\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">return</span> (<span class=\"pl-k\">float</span>) <span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>pow(ratio, <span class=\"pl-c1\">0.68f</span>) <span class=\"pl-k\">*</span> <span class=\"x x-first x-last\">defaultValue</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"253\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    }</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "skaldarnar", "createdAt": "2020-04-19T09:50:24Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,28 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n+    }\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n+    }\n+\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n+    }", "originalCommit": "0b002b9752840b6ad026fafbda909f418dd9d141", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "cb8015cb7a2c0eb669c880100dcb808fdfb111cf", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex cb8dd132e..b97d41142 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float ratio) {\n-        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n+    private float getJumpSpeed(float ratio, float defaultValue) {\n+        return (float) Math.pow(ratio, 0.74f) * 0.4f * defaultValue + 0.6f * defaultValue;\n     }\n \n-    private float getInteractionRange(float ratio) {\n-        return (float) Math.pow(ratio, 0.62f) * 5f;\n+    private float getInteractionRange(float ratio, float defaultValue) {\n+        return (float) Math.pow(ratio, 0.62f) * defaultValue;\n     }\n \n-    private float getRunFactor(float ratio) {\n-        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n+    private float getRunFactor(float ratio, float defaultValue) {\n+        return (float) Math.pow(ratio, 0.68f) * defaultValue;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": null}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg2ODA2NA==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r410868064", "body": "The default jump speed for the player is set in the prefab to 12, thus calculating with 10 here sets the default values off (sorry for not catching this earlier). I like the fact the we have a constant value here to ensure that the player can always jump some minimum height. \r\nWhen deriving this from the default jump speed I would also increase the influence of the constant and reduce the influence of the first part:\r\n```suggestion\r\n    private float getJumpSpeed(float ratio, float defaultValue) {\r\n        return (float) Math.pow(ratio, 0.74f) * 0.4f * defaultValue + 0.6f * defaultValue;\r\n    }\r\n```", "bodyText": "The default jump speed for the player is set in the prefab to 12, thus calculating with 10 here sets the default values off (sorry for not catching this earlier). I like the fact the we have a constant value here to ensure that the player can always jump some minimum height.\nWhen deriving this from the default jump speed I would also increase the influence of the constant and reduce the influence of the first part:\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private float getJumpSpeed(float ratio) {\n          \n          \n            \n                    return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n          \n          \n            \n                }\n          \n          \n            \n                private float getJumpSpeed(float ratio, float defaultValue) {\n          \n          \n            \n                    return (float) Math.pow(ratio, 0.74f) * 0.4f * defaultValue + 0.6f * defaultValue;\n          \n          \n            \n                }", "bodyHTML": "<p dir=\"auto\">The default jump speed for the player is set in the prefab to 12, thus calculating with 10 here sets the default values off (sorry for not catching this earlier). I like the fact the we have a constant value here to ensure that the player can always jump some minimum height.<br>\nWhen deriving this from the default jump speed I would also increase the influence of the constant and reduce the influence of the first part:</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"243\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">float</span> getJumpSpeed(<span class=\"pl-k\">float</span> ratio) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"244\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">return</span> (<span class=\"pl-k\">float</span>) <span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>pow(ratio, <span class=\"pl-c1\">0.74f</span>) <span class=\"pl-k\">*</span> <span class=\"pl-c1 x x-first\">6f</span><span class=\"x\"> </span><span class=\"pl-k x\">+</span><span class=\"x\"> </span><span class=\"pl-c1 x x-last\">4f</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"245\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"243\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">float</span> getJumpSpeed(<span class=\"pl-k\">float</span> ratio<span class=\"x x-first\">, </span><span class=\"pl-k x\">float</span><span class=\"x x-last\"> defaultValue</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"244\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">return</span> (<span class=\"pl-k\">float</span>) <span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>pow(ratio, <span class=\"pl-c1\">0.74f</span>) <span class=\"pl-k\">*</span> <span class=\"pl-c1 x x-first\">0.4f</span><span class=\"x\"> </span><span class=\"pl-k x\">*</span><span class=\"x\"> defaultValue </span><span class=\"pl-k x\">+</span><span class=\"x\"> </span><span class=\"pl-c1 x\">0.6f</span><span class=\"x\"> </span><span class=\"pl-k x\">*</span><span class=\"x x-last\"> defaultValue</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"245\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    }</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "skaldarnar", "createdAt": "2020-04-19T10:02:07Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,28 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n+    }", "originalCommit": "0b002b9752840b6ad026fafbda909f418dd9d141", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "cb8015cb7a2c0eb669c880100dcb808fdfb111cf", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex cb8dd132e..b97d41142 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -238,16 +238,16 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n-    private float getJumpSpeed(float ratio) {\n-        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n+    private float getJumpSpeed(float ratio, float defaultValue) {\n+        return (float) Math.pow(ratio, 0.74f) * 0.4f * defaultValue + 0.6f * defaultValue;\n     }\n \n-    private float getInteractionRange(float ratio) {\n-        return (float) Math.pow(ratio, 0.62f) * 5f;\n+    private float getInteractionRange(float ratio, float defaultValue) {\n+        return (float) Math.pow(ratio, 0.62f) * defaultValue;\n     }\n \n-    private float getRunFactor(float ratio) {\n-        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n+    private float getRunFactor(float ratio, float defaultValue) {\n+        return (float) Math.pow(ratio, 0.68f) * defaultValue;\n     }\n \n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n", "next_change": null}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg2OTM0MQ==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r410869341", "body": "As we'll need both the default movement component and the default character component later I'll fetch both here:\r\n```suggestion\r\n\r\n                Prefab playerDefaults = Assets.getPrefab(\"engine:player\").get();\r\n                CharacterMovementComponent moveDefault = playerDefaults.getComponent(CharacterMovementComponent.class);\r\n                CharacterComponent characterDefault = playerDefaults.getComponent(CharacterComponent.class)\r\n```", "bodyText": "As we'll need both the default movement component and the default character component later I'll fetch both here:\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n          \n          \n            \n                            CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n          \n          \n            \n            \n          \n          \n            \n                            Prefab playerDefaults = Assets.getPrefab(\"engine:player\").get();\n          \n          \n            \n                            CharacterMovementComponent moveDefault = playerDefaults.getComponent(CharacterMovementComponent.class);\n          \n          \n            \n                            CharacterComponent characterDefault = playerDefaults.getComponent(CharacterComponent.class)", "bodyHTML": "<p dir=\"auto\">As we'll need both the default movement component and the default character component later I'll fetch both here:</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-k\">Optional&lt;<span class=\"pl-smi\">Prefab</span>&gt;</span> prefab <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Assets</span><span class=\"pl-k\">.</span>get(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">ResourceUrn</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>engine:player<span class=\"pl-pds\">\"</span></span>), <span class=\"pl-smi\">Prefab</span><span class=\"pl-k\">.</span>class);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-smi\">CharacterMovementComponent</span> moveDefault <span class=\"pl-k\">=</span> prefab<span class=\"pl-k\">.</span>get()<span class=\"pl-k\">.</span>getComponent(<span class=\"pl-smi\">CharacterMovementComponent</span><span class=\"pl-k\">.</span>class);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\"></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-smi\">Prefab</span> playerDefaults <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Assets</span><span class=\"pl-k\">.</span>getPrefab(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>engine:player<span class=\"pl-pds\">\"</span></span>)<span class=\"pl-k\">.</span>get();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-smi\">CharacterMovementComponent</span> moveDefault <span class=\"pl-k\">=</span> playerDefaults<span class=\"pl-k\">.</span>getComponent(<span class=\"pl-smi\">CharacterMovementComponent</span><span class=\"pl-k\">.</span>class);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-smi\">CharacterComponent</span> characterDefault <span class=\"pl-k\">=</span> playerDefaults<span class=\"pl-k\">.</span>getComponent(<span class=\"pl-smi\">CharacterComponent</span><span class=\"pl-k\">.</span>class)</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "skaldarnar", "createdAt": "2020-04-19T10:09:46Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,28 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n+    }\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n+    }\n+\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n+    }\n+\n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            if (move != null) {\n-                float prevHeight = move.height;\n-                move.height = amount;\n-                clientComp.character.saveComponent(move);\n-                LocationComponent loc = client.getComponent(LocationComponent.class);\n-                Vector3f currentPosition = loc.getWorldPosition();\n-                clientComp.character\n-                        .send(new CharacterTeleportEvent(new Vector3f(currentPosition.getX(), currentPosition.getY() + (amount - prevHeight) / 2, currentPosition.getZ())));\n-                physics.removeCharacterCollider(clientComp.character);\n-                physics.getCharacterCollider(clientComp.character);\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);", "originalCommit": "0b002b9752840b6ad026fafbda909f418dd9d141", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "cb8015cb7a2c0eb669c880100dcb808fdfb111cf", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex cb8dd132e..b97d41142 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -260,8 +260,10 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n                 CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n                 EntityRef player = clientComp.character;\n                 GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n-                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                Prefab playerDefaults = Assets.getPrefab(\"engine:player\").get();\n+                CharacterMovementComponent moveDefault = playerDefaults.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent characterDefault = playerDefaults.getComponent(CharacterComponent.class)\n \n                 if (move != null && gazeMountPointComponent != null) {\n                     float prevHeight = move.height;\n", "next_change": {"commit": "3acd3877d481d49142a3c121f19923f03d4f96f1", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex b97d41142..1c2d0dea1 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -263,7 +263,7 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n \n                 Prefab playerDefaults = Assets.getPrefab(\"engine:player\").get();\n                 CharacterMovementComponent moveDefault = playerDefaults.getComponent(CharacterMovementComponent.class);\n-                CharacterComponent characterDefault = playerDefaults.getComponent(CharacterComponent.class)\n+                CharacterComponent characterDefault = playerDefaults.getComponent(CharacterComponent.class);\n \n                 if (move != null && gazeMountPointComponent != null) {\n                     float prevHeight = move.height;\n", "next_change": null}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg3MDEzNw==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r410870137", "body": "Ideally we'll need a lot more null checks here (for all the components). I'll refactor that part after this PR is merged, though.", "bodyText": "Ideally we'll need a lot more null checks here (for all the components). I'll refactor that part after this PR is merged, though.", "bodyHTML": "<p dir=\"auto\">Ideally we'll need a lot more null checks here (for all the components). I'll refactor that part after this PR is merged, though.</p>", "author": "skaldarnar", "createdAt": "2020-04-19T10:14:19Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,28 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n+    }\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n+    }\n+\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n+    }\n+\n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            if (move != null) {\n-                float prevHeight = move.height;\n-                move.height = amount;\n-                clientComp.character.saveComponent(move);\n-                LocationComponent loc = client.getComponent(LocationComponent.class);\n-                Vector3f currentPosition = loc.getWorldPosition();\n-                clientComp.character\n-                        .send(new CharacterTeleportEvent(new Vector3f(currentPosition.getX(), currentPosition.getY() + (amount - prevHeight) / 2, currentPosition.getZ())));\n-                physics.removeCharacterCollider(clientComp.character);\n-                physics.getCharacterCollider(clientComp.character);\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {", "originalCommit": "0b002b9752840b6ad026fafbda909f418dd9d141", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "cb8015cb7a2c0eb669c880100dcb808fdfb111cf", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex cb8dd132e..b97d41142 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -260,8 +260,10 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n                 CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n                 EntityRef player = clientComp.character;\n                 GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n-                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n-                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                Prefab playerDefaults = Assets.getPrefab(\"engine:player\").get();\n+                CharacterMovementComponent moveDefault = playerDefaults.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent characterDefault = playerDefaults.getComponent(CharacterComponent.class)\n \n                 if (move != null && gazeMountPointComponent != null) {\n                     float prevHeight = move.height;\n", "next_change": {"commit": "3acd3877d481d49142a3c121f19923f03d4f96f1", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex b97d41142..1c2d0dea1 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -263,7 +263,7 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n \n                 Prefab playerDefaults = Assets.getPrefab(\"engine:player\").get();\n                 CharacterMovementComponent moveDefault = playerDefaults.getComponent(CharacterMovementComponent.class);\n-                CharacterComponent characterDefault = playerDefaults.getComponent(CharacterComponent.class)\n+                CharacterComponent characterDefault = playerDefaults.getComponent(CharacterComponent.class);\n \n                 if (move != null && gazeMountPointComponent != null) {\n                     float prevHeight = move.height;\n", "next_change": null}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg3MDMzMg==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r410870332", "body": "Inline with the method changes above we'll need to pass the default values over now:\r\n```suggestion\r\n                    move.jumpSpeed = getJumpSpeed(ratio, moveDefault.jumpSpeed);\r\n                    move.stepHeight = ratio * moveDefault.stepHeight;\r\n                    move.distanceBetweenFootsteps = ratio * moveDefault.distanceBetweenFootsteps;\r\n                    move.runFactor = getRunFactor(ratio, moveDefault.runFactor);\r\n                    charComp.interactionRange = getInteractionRange(ratio, characterDefault.interactionRange);\r\n```", "bodyText": "Inline with the method changes above we'll need to pass the default values over now:\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                move.jumpSpeed = getJumpSpeed(ratio);\n          \n          \n            \n                                move.stepHeight = moveDefault.stepHeight * ratio;\n          \n          \n            \n                                move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n          \n          \n            \n                                move.runFactor = getRunFactor(ratio);\n          \n          \n            \n                                charComp.interactionRange = getInteractionRange(ratio);\n          \n          \n            \n                                move.jumpSpeed = getJumpSpeed(ratio, moveDefault.jumpSpeed);\n          \n          \n            \n                                move.stepHeight = ratio * moveDefault.stepHeight;\n          \n          \n            \n                                move.distanceBetweenFootsteps = ratio * moveDefault.distanceBetweenFootsteps;\n          \n          \n            \n                                move.runFactor = getRunFactor(ratio, moveDefault.runFactor);\n          \n          \n            \n                                charComp.interactionRange = getInteractionRange(ratio, characterDefault.interactionRange);", "bodyHTML": "<p dir=\"auto\">Inline with the method changes above we'll need to pass the default values over now:</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    move<span class=\"pl-k\">.</span>jumpSpeed <span class=\"pl-k\">=</span> getJumpSpeed(ratio);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    move<span class=\"pl-k\">.</span>stepHeight <span class=\"pl-k\">=</span> <span class=\"x x-first\">moveDefault</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">stepHeight</span> <span class=\"pl-k\">*</span> <span class=\"x x-first x-last\">ratio</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    move<span class=\"pl-k\">.</span>distanceBetweenFootsteps <span class=\"pl-k\">=</span> <span class=\"x x-first\">moveDefault</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">distanceBetweenFootsteps</span> <span class=\"pl-k\">*</span> <span class=\"x x-first x-last\">ratio</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    move<span class=\"pl-k\">.</span>runFactor <span class=\"pl-k\">=</span> getRunFactor(ratio);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    charComp<span class=\"pl-k\">.</span>interactionRange <span class=\"pl-k\">=</span> getInteractionRange(ratio);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    move<span class=\"pl-k\">.</span>jumpSpeed <span class=\"pl-k\">=</span> getJumpSpeed(ratio<span class=\"x x-first\">, moveDefault</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">jumpSpeed</span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    move<span class=\"pl-k\">.</span>stepHeight <span class=\"pl-k\">=</span> <span class=\"x x-first x-last\">ratio</span> <span class=\"pl-k\">*</span> <span class=\"x x-first\">moveDefault</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">stepHeight</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    move<span class=\"pl-k\">.</span>distanceBetweenFootsteps <span class=\"pl-k\">=</span> <span class=\"x x-first x-last\">ratio</span> <span class=\"pl-k\">*</span> <span class=\"x x-first\">moveDefault</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">distanceBetweenFootsteps</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    move<span class=\"pl-k\">.</span>runFactor <span class=\"pl-k\">=</span> getRunFactor(ratio<span class=\"x x-first\">, moveDefault</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">runFactor</span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    charComp<span class=\"pl-k\">.</span>interactionRange <span class=\"pl-k\">=</span> getInteractionRange(ratio<span class=\"x x-first\">, characterDefault</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">interactionRange</span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "skaldarnar", "createdAt": "2020-04-19T10:15:30Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,28 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n+    }\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n+    }\n+\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n+    }\n+\n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            if (move != null) {\n-                float prevHeight = move.height;\n-                move.height = amount;\n-                clientComp.character.saveComponent(move);\n-                LocationComponent loc = client.getComponent(LocationComponent.class);\n-                Vector3f currentPosition = loc.getWorldPosition();\n-                clientComp.character\n-                        .send(new CharacterTeleportEvent(new Vector3f(currentPosition.getX(), currentPosition.getY() + (amount - prevHeight) / 2, currentPosition.getZ())));\n-                physics.removeCharacterCollider(clientComp.character);\n-                physics.getCharacterCollider(clientComp.character);\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);", "originalCommit": "0b002b9752840b6ad026fafbda909f418dd9d141", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "cb8015cb7a2c0eb669c880100dcb808fdfb111cf", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex cb8dd132e..b97d41142 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -270,11 +272,11 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n                     float ratio = amount / moveDefault.height;\n \n                     move.height = amount;\n-                    move.jumpSpeed = getJumpSpeed(ratio);\n-                    move.stepHeight = moveDefault.stepHeight * ratio;\n-                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n-                    move.runFactor = getRunFactor(ratio);\n-                    charComp.interactionRange = getInteractionRange(ratio);\n+                    move.jumpSpeed = getJumpSpeed(ratio, moveDefault.jumpSpeed);\n+                    move.stepHeight = ratio * moveDefault.stepHeight;\n+                    move.distanceBetweenFootsteps = ratio * moveDefault.distanceBetweenFootsteps;\n+                    move.runFactor = getRunFactor(ratio, moveDefault.runFactor);\n+                    charComp.interactionRange = getInteractionRange(ratio, characterDefault.interactionRange);\n                     gazeMountPointComponent.translate.y = amount - foreHeadSize;\n                     Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n                     Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n", "next_change": null}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg3MDUzNw==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r410870537", "body": "As this is the same code as for the `playerEyeHeight` command I would refactor this later on to use a common \r\n```java\r\nupdateGazeMountPointHeight(player, amount - foreHeadSize);\r\n```", "bodyText": "As this is the same code as for the playerEyeHeight command I would refactor this later on to use a common\nupdateGazeMountPointHeight(player, amount - foreHeadSize);", "bodyHTML": "<p dir=\"auto\">As this is the same code as for the <code>playerEyeHeight</code> command I would refactor this later on to use a common</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"updateGazeMountPointHeight(player, amount - foreHeadSize);\"><pre>updateGazeMountPointHeight(player, amount <span class=\"pl-k\">-</span> foreHeadSize);</pre></div>", "author": "skaldarnar", "createdAt": "2020-04-19T10:16:48Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,28 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n+    }\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n+    }\n+\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n+    }\n+\n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            if (move != null) {\n-                float prevHeight = move.height;\n-                move.height = amount;\n-                clientComp.character.saveComponent(move);\n-                LocationComponent loc = client.getComponent(LocationComponent.class);\n-                Vector3f currentPosition = loc.getWorldPosition();\n-                clientComp.character\n-                        .send(new CharacterTeleportEvent(new Vector3f(currentPosition.getX(), currentPosition.getY() + (amount - prevHeight) / 2, currentPosition.getZ())));\n-                physics.removeCharacterCollider(clientComp.character);\n-                physics.getCharacterCollider(clientComp.character);\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);", "originalCommit": "0b002b9752840b6ad026fafbda909f418dd9d141", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "cb8015cb7a2c0eb669c880100dcb808fdfb111cf", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex cb8dd132e..b97d41142 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -270,11 +272,11 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n                     float ratio = amount / moveDefault.height;\n \n                     move.height = amount;\n-                    move.jumpSpeed = getJumpSpeed(ratio);\n-                    move.stepHeight = moveDefault.stepHeight * ratio;\n-                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n-                    move.runFactor = getRunFactor(ratio);\n-                    charComp.interactionRange = getInteractionRange(ratio);\n+                    move.jumpSpeed = getJumpSpeed(ratio, moveDefault.jumpSpeed);\n+                    move.stepHeight = ratio * moveDefault.stepHeight;\n+                    move.distanceBetweenFootsteps = ratio * moveDefault.distanceBetweenFootsteps;\n+                    move.runFactor = getRunFactor(ratio, moveDefault.runFactor);\n+                    charComp.interactionRange = getInteractionRange(ratio, characterDefault.interactionRange);\n                     gazeMountPointComponent.translate.y = amount - foreHeadSize;\n                     Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n                     Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n", "next_change": null}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg3MDY1Ng==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r410870656", "body": "If we did proper null checks this try-catch block should not be necessary (in general, catching a NPE is always a code smell as you could have done a null-check before).", "bodyText": "If we did proper null checks this try-catch block should not be necessary (in general, catching a NPE is always a code smell as you could have done a null-check before).", "bodyHTML": "<p dir=\"auto\">If we did proper null checks this try-catch block should not be necessary (in general, catching a NPE is always a code smell as you could have done a null-check before).</p>", "author": "skaldarnar", "createdAt": "2020-04-19T10:17:40Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,28 +238,59 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float ratio) {\n+        return (float) Math.pow(ratio, 0.74f) * 6f + 4f;\n+    }\n+\n+    private float getInteractionRange(float ratio) {\n+        return (float) Math.pow(ratio, 0.62f) * 5f;\n+    }\n+\n+    private float getRunFactor(float ratio) {\n+        return (float) Math.pow(ratio, 0.68f) * 1.5f;\n+    }\n+\n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            if (move != null) {\n-                float prevHeight = move.height;\n-                move.height = amount;\n-                clientComp.character.saveComponent(move);\n-                LocationComponent loc = client.getComponent(LocationComponent.class);\n-                Vector3f currentPosition = loc.getWorldPosition();\n-                clientComp.character\n-                        .send(new CharacterTeleportEvent(new Vector3f(currentPosition.getX(), currentPosition.getY() + (amount - prevHeight) / 2, currentPosition.getZ())));\n-                physics.removeCharacterCollider(clientComp.character);\n-                physics.getCharacterCollider(clientComp.character);\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+                Optional<Prefab> prefab = Assets.get(new ResourceUrn(\"engine:player\"), Prefab.class);\n+                CharacterMovementComponent moveDefault = prefab.get().getComponent(CharacterMovementComponent.class);\n+\n+                if (move != null && gazeMountPointComponent != null) {\n+                    float prevHeight = move.height;\n+                    float defaultEyeHeight = config.getPlayer().getEyeHeight();\n+                    float foreHeadSize = moveDefault.height - defaultEyeHeight;\n+                    float ratio = amount / moveDefault.height;\n+\n+                    move.height = amount;\n+                    move.jumpSpeed = getJumpSpeed(ratio);\n+                    move.stepHeight = moveDefault.stepHeight * ratio;\n+                    move.distanceBetweenFootsteps = moveDefault.distanceBetweenFootsteps * ratio;\n+                    move.runFactor = getRunFactor(ratio);\n+                    charComp.interactionRange = getInteractionRange(ratio);\n+                    gazeMountPointComponent.translate.y = amount - foreHeadSize;\n+                    Location.removeChild(player, gazeMountPointComponent.gazeEntity);\n+                    Location.attachChild(player, gazeMountPointComponent.gazeEntity, gazeMountPointComponent.translate, new Quat4f(Quat4f.IDENTITY));\n+\n+                    player.saveComponent(gazeMountPointComponent);\n+                    clientComp.character.saveComponent(move);\n+\n+                    return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+                }\n+                return \"\";\n+            } catch (NullPointerException e) {", "originalCommit": "0b002b9752840b6ad026fafbda909f418dd9d141", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "cb8015cb7a2c0eb669c880100dcb808fdfb111cf", "url": "https://github.com/MovingBlocks/Terasology/commit/cb8015cb7a2c0eb669c880100dcb808fdfb111cf", "message": "Apply suggestions from code review", "committedDate": "2020-04-19T10:18:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg3Nzk3Ng==", "url": "https://github.com/MovingBlocks/Terasology/pull/3841#discussion_r410877976", "body": "```suggestion\r\n                CharacterComponent characterDefault = playerDefaults.getComponent(CharacterComponent.class);\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            CharacterComponent characterDefault = playerDefaults.getComponent(CharacterComponent.class)\n          \n          \n            \n                            CharacterComponent characterDefault = playerDefaults.getComponent(CharacterComponent.class);", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-smi\">CharacterComponent</span> characterDefault <span class=\"pl-k\">=</span> playerDefaults<span class=\"pl-k\">.</span>getComponent(<span class=\"pl-smi\">CharacterComponent</span><span class=\"pl-k\">.</span>class)</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-smi\">CharacterComponent</span> characterDefault <span class=\"pl-k\">=</span> playerDefaults<span class=\"pl-k\">.</span>getComponent(<span class=\"pl-smi\">CharacterComponent</span><span class=\"pl-k\">.</span>class)<span class=\"x x-first x-last\">;</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "skaldarnar", "createdAt": "2020-04-19T10:59:55Z", "path": "engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java", "diffHunk": "@@ -233,28 +238,61 @@ public String stepHeight(@Sender EntityRef client, @CommandParam(\"height\") float\n         return \"\";\n     }\n \n+    private float getJumpSpeed(float ratio, float defaultValue) {\n+        return (float) Math.pow(ratio, 0.74f) * 0.4f * defaultValue + 0.6f * defaultValue;\n+    }\n+\n+    private float getInteractionRange(float ratio, float defaultValue) {\n+        return (float) Math.pow(ratio, 0.62f) * defaultValue;\n+    }\n+\n+    private float getRunFactor(float ratio, float defaultValue) {\n+        return (float) Math.pow(ratio, 0.68f) * defaultValue;\n+    }\n+\n     @Command(shortDescription = \"Sets the height of the player\", runOnServer = true,\n             requiredPermission = PermissionManager.CHEAT_PERMISSION)\n     public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") float amount) {\n-        try {\n-            ClientComponent clientComp = client.getComponent(ClientComponent.class);\n-            CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n-            if (move != null) {\n-                float prevHeight = move.height;\n-                move.height = amount;\n-                clientComp.character.saveComponent(move);\n-                LocationComponent loc = client.getComponent(LocationComponent.class);\n-                Vector3f currentPosition = loc.getWorldPosition();\n-                clientComp.character\n-                        .send(new CharacterTeleportEvent(new Vector3f(currentPosition.getX(), currentPosition.getY() + (amount - prevHeight) / 2, currentPosition.getZ())));\n-                physics.removeCharacterCollider(clientComp.character);\n-                physics.getCharacterCollider(clientComp.character);\n-                return \"Height of player set to \" + amount + \" (was \" + prevHeight + \")\";\n+        if (amount >= 1 && amount <= 25) {\n+            try {\n+                ClientComponent clientComp = client.getComponent(ClientComponent.class);\n+                CharacterMovementComponent move = clientComp.character.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent charComp = clientComp.character.getComponent(CharacterComponent.class);\n+                EntityRef player = clientComp.character;\n+                GazeMountPointComponent gazeMountPointComponent = player.getComponent(GazeMountPointComponent.class);\n+\n+                Prefab playerDefaults = Assets.getPrefab(\"engine:player\").get();\n+                CharacterMovementComponent moveDefault = playerDefaults.getComponent(CharacterMovementComponent.class);\n+                CharacterComponent characterDefault = playerDefaults.getComponent(CharacterComponent.class)", "originalCommit": "cb8015cb7a2c0eb669c880100dcb808fdfb111cf", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3acd3877d481d49142a3c121f19923f03d4f96f1", "changed_code": [{"header": "diff --git a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\nindex b97d41142..1c2d0dea1 100644\n--- a/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n+++ b/engine/src/main/java/org/terasology/logic/debug/MovementDebugCommands.java\n", "chunk": "@@ -263,7 +263,7 @@ public String playerHeight(@Sender EntityRef client, @CommandParam(\"height\") flo\n \n                 Prefab playerDefaults = Assets.getPrefab(\"engine:player\").get();\n                 CharacterMovementComponent moveDefault = playerDefaults.getComponent(CharacterMovementComponent.class);\n-                CharacterComponent characterDefault = playerDefaults.getComponent(CharacterComponent.class)\n+                CharacterComponent characterDefault = playerDefaults.getComponent(CharacterComponent.class);\n \n                 if (move != null && gazeMountPointComponent != null) {\n                     float prevHeight = move.height;\n", "next_change": null}]}}, {"oid": "3acd3877d481d49142a3c121f19923f03d4f96f1", "url": "https://github.com/MovingBlocks/Terasology/commit/3acd3877d481d49142a3c121f19923f03d4f96f1", "message": "added missed ';'", "committedDate": "2020-04-19T11:00:16Z", "type": "commit"}]}