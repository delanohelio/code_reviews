{"pr_number": 1277, "pr_title": "Update SCM to notify listeners if fresh copy of capability is received", "pr_author": "bilal-alsharifi", "pr_createdAt": "2020-02-17T16:20:40Z", "pr_url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277", "timeline": [{"oid": "96fd89522baae44d64b541909d603dc397b1797c", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/96fd89522baae44d64b541909d603dc397b1797c", "message": "Notify listeners when fresh copy of capability is received", "committedDate": "2020-02-17T16:13:59Z", "type": "commit"}, {"oid": "fc779d67ae1400bfa04d30bcd7faaec6361628ba", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/fc779d67ae1400bfa04d30bcd7faaec6361628ba", "message": "Add more SCM unit tests", "committedDate": "2020-02-17T16:21:43Z", "type": "commit"}, {"oid": "43aa6dbcb5ad817fe5f494655c5badd4ab9e9d11", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/43aa6dbcb5ad817fe5f494655c5badd4ab9e9d11", "message": "Fix an issue in SCM unit tests", "committedDate": "2020-02-17T16:37:04Z", "type": "commit"}, {"oid": "f6a10d835cb5253a9af1f8f54b21ee9a85a081fa", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/f6a10d835cb5253a9af1f8f54b21ee9a85a081fa", "message": "Reformat code in setCapability() method", "committedDate": "2020-02-17T16:47:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTM1OTkyMA==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r381359920", "body": "It doesn't appear that you usually use tabs to align these param comments (e.g. above `retrieveCapability()`). I think this should be consistent. There really should be a project style guide where the correct style for this stuff can be noted.", "bodyText": "It doesn't appear that you usually use tabs to align these param comments (e.g. above retrieveCapability()). I think this should be consistent. There really should be a project style guide where the correct style for this stuff can be noted.", "bodyHTML": "<p dir=\"auto\">It doesn't appear that you usually use tabs to align these param comments (e.g. above <code>retrieveCapability()</code>). I think this should be consistent. There really should be a project style guide where the correct style for this stuff can be noted.</p>", "author": "joeljfischer", "createdAt": "2020-02-19T15:31:06Z", "path": "base/src/main/java/com/smartdevicelink/proxy/SystemCapabilityManager.java", "diffHunk": "@@ -335,11 +335,11 @@ public void onReceived(RPCMessage message) {\n \t * Sets a capability in the cached map. This should only be done when an RPC is received and contains updates to the capability\n \t * that is being cached in the SystemCapabilityManager.\n \t * @param systemCapabilityType the system capability type that will be set\n-\t * @param capability the value of the capability that will be set\n+\t * @param capability           the value of the capability that will be set", "originalCommit": "f6a10d835cb5253a9af1f8f54b21ee9a85a081fa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTUyNDYyNw==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r381524627", "bodyText": "Yes, you are right, we don't usually do that. I used Android Studio Reformatter tool to reformat this method. It looks like the tool adds spaces to align the params. I will remove that for consistency.", "author": "bilal-alsharifi", "createdAt": "2020-02-19T20:26:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTM1OTkyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTM2MDEwNQ==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r381360105", "body": "I think that currently iOS always calls with a cached value even if the value is `null`. This may be a point to be aligned.", "bodyText": "I think that currently iOS always calls with a cached value even if the value is null. This may be a point to be aligned.", "bodyHTML": "<p dir=\"auto\">I think that currently iOS always calls with a cached value even if the value is <code>null</code>. This may be a point to be aligned.</p>", "author": "joeljfischer", "createdAt": "2020-02-19T15:36:28Z", "path": "base/src/main/java/com/smartdevicelink/proxy/SystemCapabilityManager.java", "diffHunk": "@@ -450,16 +450,17 @@ private boolean isSubscribedToSystemCapability(SystemCapabilityType systemCapabi\n \t */\n \tprivate Object getCapabilityPrivate(final SystemCapabilityType systemCapabilityType, final OnSystemCapabilityListener scListener, final Boolean subscribe, final boolean forceUpdate) {\n \t\tObject cachedCapability = cachedSystemCapabilities.get(systemCapabilityType);\n-\t\tOnSystemCapabilityListener listener = scListener;\n \n-\t\tif (!forceUpdate && cachedCapability != null && listener != null) {\n-\t\t\tlistener.onCapabilityRetrieved(cachedCapability);\n-\t\t\tlistener = null;\n+\t\tboolean shouldUpdateSystemCapabilitySubscription = (subscribe != null) && (subscribe != isSubscribedToSystemCapability(systemCapabilityType)) && supportsSubscriptions();\n+\t\tboolean shouldSendGetCapabilityRequest = forceUpdate || (cachedCapability == null) || shouldUpdateSystemCapabilitySubscription;\n+\t\tboolean shouldCallListenerWithCachedValue = (cachedCapability != null) && (scListener != null) && !shouldSendGetCapabilityRequest;", "originalCommit": "f6a10d835cb5253a9af1f8f54b21ee9a85a081fa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTM2ODUwNQ==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r381368505", "body": "```suggestion\r\n\t\t\t\t\t// If the listener is not included in the onSystemCapabilityListeners map (if it's used from getSystemCapability with a force update), then notify it\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\t\t// If the listener is not included in the onSystemCapabilityListeners map, then notify it\n          \n          \n            \n            \t\t\t\t\t// If the listener is not included in the onSystemCapabilityListeners map (if it's used from getSystemCapability with a force update), then notify it", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"570\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t\t\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> If the listener is not included in the onSystemCapabilityListeners map, then notify it</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"570\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t\t\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> If the listener is not included in the onSystemCapabilityListeners map<span class=\"x x-first x-last\"> (if it's used from getSystemCapability with a force update)</span>, then notify it</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "joeljfischer", "createdAt": "2020-02-19T15:59:36Z", "path": "base/src/main/java/com/smartdevicelink/proxy/SystemCapabilityManager.java", "diffHunk": "@@ -549,18 +550,27 @@ private void retrieveCapability(final SystemCapabilityType systemCapabilityType,\n \t\t}\n \t\tfinal GetSystemCapability request = new GetSystemCapability();\n \t\trequest.setSystemCapabilityType(systemCapabilityType);\n-\t\trequest.setSubscribe((subscribe != null) ? subscribe : isSubscribedToSystemCapability(systemCapabilityType)); // If subscribe is null, then don't change the current subscription status\n+\t\t// If subscribe is null, then don't change the current subscription status\n+\t\tfinal boolean shouldSubscribe = ((subscribe != null) ? subscribe : isSubscribedToSystemCapability(systemCapabilityType)) && supportsSubscriptions();\n+\t\trequest.setSubscribe(shouldSubscribe);\n \t\trequest.setOnRPCResponseListener(new OnRPCResponseListener() {\n \t\t\t@Override\n \t\t\tpublic void onResponse(int correlationId, RPCResponse response) {\n \t\t\t\tif (response.getSuccess()) {\n \t\t\t\t\tObject retrievedCapability = ((GetSystemCapabilityResponse) response).getSystemCapability().getCapabilityForType(systemCapabilityType);\n-\t\t\t\t\tcachedSystemCapabilities.put(systemCapabilityType, retrievedCapability);\n+\t\t\t\t\tsetCapability(systemCapabilityType, retrievedCapability);\n+\t\t\t\t\t// If the listener is not included in the onSystemCapabilityListeners map, then notify it", "originalCommit": "f6a10d835cb5253a9af1f8f54b21ee9a85a081fa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjExOTQxNA==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r382119414", "bodyText": "Forcing an update is not the only case that triggers this logic. If forceUpdate=false, and the cap is not cashed, when we call GetCapablity(), this logic will be triggered. But you are right the comment is a little vague. I will update the comment.", "author": "bilal-alsharifi", "createdAt": "2020-02-20T16:38:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTM2ODUwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTM3MDEyMA==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r381370120", "body": "```suggestion\r\n\t\t\t\t\t\t\tboolean listenerAlreadyNotified = (notifiedListeners != null) && notifiedListeners.contains(scListener);\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\t\t\t\tboolean listenerAlreadyNotified = notifiedListeners != null && notifiedListeners.contains(scListener);\n          \n          \n            \n            \t\t\t\t\t\t\tboolean listenerAlreadyNotified = (notifiedListeners != null) && notifiedListeners.contains(scListener);", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t\t\t\t\t\t<span class=\"pl-k\">boolean</span> listenerAlreadyNotified <span class=\"pl-k\">=</span> notifiedListeners <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span> <span class=\"pl-k\">&amp;&amp;</span> notifiedListeners<span class=\"pl-k\">.</span>contains(scListener);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t\t\t\t\t\t<span class=\"pl-k\">boolean</span> listenerAlreadyNotified <span class=\"pl-k\">=</span> <span class=\"x x-first x-last\">(</span>notifiedListeners <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span><span class=\"x x-first x-last\">)</span> <span class=\"pl-k\">&amp;&amp;</span> notifiedListeners<span class=\"pl-k\">.</span>contains(scListener);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "joeljfischer", "createdAt": "2020-02-19T16:01:46Z", "path": "base/src/main/java/com/smartdevicelink/proxy/SystemCapabilityManager.java", "diffHunk": "@@ -549,18 +550,27 @@ private void retrieveCapability(final SystemCapabilityType systemCapabilityType,\n \t\t}\n \t\tfinal GetSystemCapability request = new GetSystemCapability();\n \t\trequest.setSystemCapabilityType(systemCapabilityType);\n-\t\trequest.setSubscribe((subscribe != null) ? subscribe : isSubscribedToSystemCapability(systemCapabilityType)); // If subscribe is null, then don't change the current subscription status\n+\t\t// If subscribe is null, then don't change the current subscription status\n+\t\tfinal boolean shouldSubscribe = ((subscribe != null) ? subscribe : isSubscribedToSystemCapability(systemCapabilityType)) && supportsSubscriptions();\n+\t\trequest.setSubscribe(shouldSubscribe);\n \t\trequest.setOnRPCResponseListener(new OnRPCResponseListener() {\n \t\t\t@Override\n \t\t\tpublic void onResponse(int correlationId, RPCResponse response) {\n \t\t\t\tif (response.getSuccess()) {\n \t\t\t\t\tObject retrievedCapability = ((GetSystemCapabilityResponse) response).getSystemCapability().getCapabilityForType(systemCapabilityType);\n-\t\t\t\t\tcachedSystemCapabilities.put(systemCapabilityType, retrievedCapability);\n+\t\t\t\t\tsetCapability(systemCapabilityType, retrievedCapability);\n+\t\t\t\t\t// If the listener is not included in the onSystemCapabilityListeners map, then notify it\n \t\t\t\t\tif (scListener != null) {\n-\t\t\t\t\t\tscListener.onCapabilityRetrieved(retrievedCapability);\n+\t\t\t\t\t\tsynchronized (LISTENER_LOCK) {\n+\t\t\t\t\t\t\tCopyOnWriteArrayList<OnSystemCapabilityListener> notifiedListeners = onSystemCapabilityListeners.get(systemCapabilityType);\n+\t\t\t\t\t\t\tboolean listenerAlreadyNotified = notifiedListeners != null && notifiedListeners.contains(scListener);", "originalCommit": "f6a10d835cb5253a9af1f8f54b21ee9a85a081fa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTM4MTI4OA==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r381381288", "body": "Based on the change to `retrieveCapability()` I believe this should _not_ send `subscribe=true`, right?\r\n\r\n```java\r\nfinal boolean shouldSubscribe = ((subscribe != null) ? subscribe : isSubscribedToSystemCapability(systemCapabilityType)) && supportsSubscriptions();\r\nrequest.setSubscribe(shouldSubscribe);\r\n```", "bodyText": "Based on the change to retrieveCapability() I believe this should not send subscribe=true, right?\nfinal boolean shouldSubscribe = ((subscribe != null) ? subscribe : isSubscribedToSystemCapability(systemCapabilityType)) && supportsSubscriptions();\nrequest.setSubscribe(shouldSubscribe);", "bodyHTML": "<p dir=\"auto\">Based on the change to <code>retrieveCapability()</code> I believe this should <em>not</em> send <code>subscribe=true</code>, right?</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"final boolean shouldSubscribe = ((subscribe != null) ? subscribe : isSubscribedToSystemCapability(systemCapabilityType)) &amp;&amp; supportsSubscriptions();\nrequest.setSubscribe(shouldSubscribe);\n\"><pre><span class=\"pl-k\">final</span> <span class=\"pl-k\">boolean</span> shouldSubscribe <span class=\"pl-k\">=</span> ((subscribe <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) <span class=\"pl-k\">?</span> subscribe <span class=\"pl-k\">:</span> isSubscribedToSystemCapability(systemCapabilityType)) <span class=\"pl-k\">&amp;&amp;</span> supportsSubscriptions();\nrequest<span class=\"pl-k\">.</span>setSubscribe(shouldSubscribe);</pre></div>", "author": "joeljfischer", "createdAt": "2020-02-19T16:17:00Z", "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/proxy/SystemCapabilityManagerTests.java", "diffHunk": "@@ -490,6 +490,94 @@ public void testAddOnSystemCapabilityListenerWithSubscriptionsNotSupportedAndCap\n \t\tverify(internalInterface, times(1)).sendRPC(any(GetSystemCapability.class));\n \t}\n \n+\tpublic void testAddOnSystemCapabilityListenerThenGetCapability() {\n+\t\tSdlMsgVersion sdlMsgVersion = new SdlMsgVersion(5, 0); // This version doesn't support capability subscriptions\n+\t\tsdlMsgVersion.setPatchVersion(0);\n+\t\tISdl internalInterface = mock(ISdl.class);\n+\t\twhen(internalInterface.getSdlMsgVersion()).thenReturn(sdlMsgVersion);\n+\t\tSystemCapabilityManager scm = new SystemCapabilityManager(internalInterface);\n+\t\tscm.setCapability(SystemCapabilityType.VIDEO_STREAMING, videoStreamingCapability);\n+\n+\n+\t\t// Add listener1\n+\t\t// When the first listener is added, GetSystemCapability request should go out with subscribe=true", "originalCommit": "f6a10d835cb5253a9af1f8f54b21ee9a85a081fa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTU2NzA3MA==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r381567070", "bodyText": "Ah, you are right, the test actually asserts that subscribe=false as you mentioned. The comment is wrong. I will update it.", "author": "bilal-alsharifi", "createdAt": "2020-02-19T21:53:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTM4MTI4OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTM4NzIxNg==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r381387216", "body": "1. Currently, iOS calls the listener with a cached value of `nil`. This may be a point of alignment needed.\r\n2. Why does it not call with the cached value if we are sending a `GetCapability` request? Should the `&&` before `!shouldSendGetCapabilityRequest` be an `||`?", "bodyText": "Currently, iOS calls the listener with a cached value of nil. This may be a point of alignment needed.\nWhy does it not call with the cached value if we are sending a GetCapability request? Should the && before !shouldSendGetCapabilityRequest be an ||?", "bodyHTML": "<ol dir=\"auto\">\n<li>Currently, iOS calls the listener with a cached value of <code>nil</code>. This may be a point of alignment needed.</li>\n<li>Why does it not call with the cached value if we are sending a <code>GetCapability</code> request? Should the <code>&amp;&amp;</code> before <code>!shouldSendGetCapabilityRequest</code> be an <code>||</code>?</li>\n</ol>", "author": "joeljfischer", "createdAt": "2020-02-19T16:25:22Z", "path": "base/src/main/java/com/smartdevicelink/proxy/SystemCapabilityManager.java", "diffHunk": "@@ -450,16 +450,17 @@ private boolean isSubscribedToSystemCapability(SystemCapabilityType systemCapabi\n \t */\n \tprivate Object getCapabilityPrivate(final SystemCapabilityType systemCapabilityType, final OnSystemCapabilityListener scListener, final Boolean subscribe, final boolean forceUpdate) {\n \t\tObject cachedCapability = cachedSystemCapabilities.get(systemCapabilityType);\n-\t\tOnSystemCapabilityListener listener = scListener;\n \n-\t\tif (!forceUpdate && cachedCapability != null && listener != null) {\n-\t\t\tlistener.onCapabilityRetrieved(cachedCapability);\n-\t\t\tlistener = null;\n+\t\tboolean shouldUpdateSystemCapabilitySubscription = (subscribe != null) && (subscribe != isSubscribedToSystemCapability(systemCapabilityType)) && supportsSubscriptions();\n+\t\tboolean shouldSendGetCapabilityRequest = forceUpdate || (cachedCapability == null) || shouldUpdateSystemCapabilitySubscription;\n+\t\tboolean shouldCallListenerWithCachedValue = (cachedCapability != null) && (scListener != null) && !shouldSendGetCapabilityRequest;", "originalCommit": "f6a10d835cb5253a9af1f8f54b21ee9a85a081fa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTM5MDYyNg==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r381390626", "body": "```suggestion\r\n\t\tfinal boolean shouldSubscribe = ((subscribe != null) ? subscribe : (isSubscribedToSystemCapability(systemCapabilityType)) && supportsSubscriptions());\r\n```\r\n\r\nI think the name of this is a bit misleading, because if it's `false`, it `shouldUnsubscribe()`. I almost think you need an enum with values `subscribe`, `unsubscribe`, and `keepCurrentState`. Or at least the documentation needs to be improved here.\r\n\r\nI also need clarification on a point here. If `subscribe` is `false` and we are currently subscribed, and we support subscriptions, then `shouldSubscribe` will be `true`, right? And that's the opposite of what we want, since we want to unsubscribe?", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tfinal boolean shouldSubscribe = ((subscribe != null) ? subscribe : isSubscribedToSystemCapability(systemCapabilityType)) && supportsSubscriptions();\n          \n          \n            \n            \t\tfinal boolean shouldSubscribe = ((subscribe != null) ? subscribe : (isSubscribedToSystemCapability(systemCapabilityType)) && supportsSubscriptions());\n          \n      \n    \n    \n  \n\nI think the name of this is a bit misleading, because if it's false, it shouldUnsubscribe(). I almost think you need an enum with values subscribe, unsubscribe, and keepCurrentState. Or at least the documentation needs to be improved here.\nI also need clarification on a point here. If subscribe is false and we are currently subscribed, and we support subscriptions, then shouldSubscribe will be true, right? And that's the opposite of what we want, since we want to unsubscribe?", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t<span class=\"pl-k\">final</span> <span class=\"pl-k\">boolean</span> shouldSubscribe <span class=\"pl-k\">=</span> ((subscribe <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) <span class=\"pl-k\">?</span> subscribe <span class=\"pl-k\">:</span> isSubscribedToSystemCapability(systemCapabilityType)) <span class=\"pl-k\">&amp;&amp;</span> supportsSubscriptions();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t<span class=\"pl-k\">final</span> <span class=\"pl-k\">boolean</span> shouldSubscribe <span class=\"pl-k\">=</span> ((subscribe <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) <span class=\"pl-k\">?</span> subscribe <span class=\"pl-k\">:</span> <span class=\"x x-first x-last\">(</span>isSubscribedToSystemCapability(systemCapabilityType)) <span class=\"pl-k\">&amp;&amp;</span> supportsSubscriptions(<span class=\"x x-first x-last\">)</span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n\n<p dir=\"auto\">I think the name of this is a bit misleading, because if it's <code>false</code>, it <code>shouldUnsubscribe()</code>. I almost think you need an enum with values <code>subscribe</code>, <code>unsubscribe</code>, and <code>keepCurrentState</code>. Or at least the documentation needs to be improved here.</p>\n<p dir=\"auto\">I also need clarification on a point here. If <code>subscribe</code> is <code>false</code> and we are currently subscribed, and we support subscriptions, then <code>shouldSubscribe</code> will be <code>true</code>, right? And that's the opposite of what we want, since we want to unsubscribe?</p>", "author": "joeljfischer", "createdAt": "2020-02-19T16:30:15Z", "path": "base/src/main/java/com/smartdevicelink/proxy/SystemCapabilityManager.java", "diffHunk": "@@ -549,18 +550,27 @@ private void retrieveCapability(final SystemCapabilityType systemCapabilityType,\n \t\t}\n \t\tfinal GetSystemCapability request = new GetSystemCapability();\n \t\trequest.setSystemCapabilityType(systemCapabilityType);\n-\t\trequest.setSubscribe((subscribe != null) ? subscribe : isSubscribedToSystemCapability(systemCapabilityType)); // If subscribe is null, then don't change the current subscription status\n+\t\t// If subscribe is null, then don't change the current subscription status\n+\t\tfinal boolean shouldSubscribe = ((subscribe != null) ? subscribe : isSubscribedToSystemCapability(systemCapabilityType)) && supportsSubscriptions();", "originalCommit": "f6a10d835cb5253a9af1f8f54b21ee9a85a081fa", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9ec33af2d4c5eef78ea1c6c4b3defaf801af6815", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/9ec33af2d4c5eef78ea1c6c4b3defaf801af6815", "message": "Update formatting in SCM", "committedDate": "2020-02-19T20:32:52Z", "type": "commit"}, {"oid": "b239e724604fceb93581aa4bae1bb35bf83880c4", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/b239e724604fceb93581aa4bae1bb35bf83880c4", "message": "Update comments in retrieveCapability()", "committedDate": "2020-02-19T21:44:32Z", "type": "commit"}, {"oid": "5fa55cf180a3a2e444770dbf4818d6a01d53913c", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/5fa55cf180a3a2e444770dbf4818d6a01d53913c", "message": "Update comments in SystemCapabilityManagerTests", "committedDate": "2020-02-19T21:54:14Z", "type": "commit"}, {"oid": "adfd59364bbeaea67c1e6990e4e13549cc33b7d9", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/adfd59364bbeaea67c1e6990e4e13549cc33b7d9", "message": "Update comments in SCM", "committedDate": "2020-02-20T16:43:47Z", "type": "commit"}, {"oid": "49d20093f838fcc119e1210668281baf33e0d621", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/49d20093f838fcc119e1210668281baf33e0d621", "message": "Prevent sending GetSystemCapability for DISPLAYS", "committedDate": "2020-02-20T19:34:59Z", "type": "commit"}, {"oid": "079d9197e733a3a27dde2ed4543c1f51b5f4e2b7", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/079d9197e733a3a27dde2ed4543c1f51b5f4e2b7", "message": "Add more unit tests for DISPLAYS capability", "committedDate": "2020-02-20T19:36:34Z", "type": "commit"}, {"oid": "11189a63e71bddae0d7fea388b0e98db47e5ec2d", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/11189a63e71bddae0d7fea388b0e98db47e5ec2d", "message": "Update comments in SystemCapabilityManagerTests", "committedDate": "2020-02-20T19:38:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNTcyNQ==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r382605725", "body": "```suggestion\r\n\t\t- if subscribe is true, then shouldSubscribe = true\r\n```\r\n\r\nThis doesn't appear to be true, it's if `subscribe == true`, then `shouldSubscribe = true`.", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t- if subscribe is true and the HU supports subscriptions, then shouldSubscribe = true\n          \n          \n            \n            \t\t- if subscribe is true, then shouldSubscribe = true\n          \n      \n    \n    \n  \n\nThis doesn't appear to be true, it's if subscribe == true, then shouldSubscribe = true.", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"559\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t<span class=\"pl-k\">-</span> <span class=\"pl-k\">if</span> subscribe is <span class=\"pl-c1\">true</span><span class=\"x x-first\"> and the </span><span class=\"pl-c1 x\">HU</span><span class=\"x x-last\"> supports subscriptions</span>, then shouldSubscribe <span class=\"pl-k\">=</span> <span class=\"pl-c1\">true</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"559\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t<span class=\"pl-k\">-</span> <span class=\"pl-k\">if</span> subscribe is <span class=\"pl-c1\">true</span>, then shouldSubscribe <span class=\"pl-k\">=</span> <span class=\"pl-c1\">true</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n\n<p dir=\"auto\">This doesn't appear to be true, it's if <code>subscribe == true</code>, then <code>shouldSubscribe = true</code>.</p>", "author": "joeljfischer", "createdAt": "2020-02-21T14:20:54Z", "path": "base/src/main/java/com/smartdevicelink/proxy/SystemCapabilityManager.java", "diffHunk": "@@ -550,7 +551,13 @@ private void retrieveCapability(final SystemCapabilityType systemCapabilityType,\n \t\t}\n \t\tfinal GetSystemCapability request = new GetSystemCapability();\n \t\trequest.setSystemCapabilityType(systemCapabilityType);\n-\t\t// If subscribe is null, then don't change the current subscription status\n+\n+\t\t/*\n+\t\tThe subscription flag in the request should be set based on multiple variables:\n+\t\t- if subscribe is null (no change), shouldSubscribe = current subscription status\n+\t\t- if subscribe is false, then shouldSubscribe = false\n+\t\t- if subscribe is true and the HU supports subscriptions, then shouldSubscribe = true", "originalCommit": "11189a63e71bddae0d7fea388b0e98db47e5ec2d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY4NTM5Mw==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r382685393", "bodyText": "But if the HU doesn't support subscriptions, shouldSubscribe will be false right? even if subscribe = true? because we are doing && supportsSubscriptions()", "author": "bilal-alsharifi", "createdAt": "2020-02-21T16:40:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNTcyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY4OTIwNQ==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r382689205", "bodyText": "Based on the current code, I don't think that's true.\nif (subscribe != null) {\n    return subscribe;\n} else {\n    return isSubscribedToSystemCapability(systemCapabilityType)) && supportsSubscriptions();\n}\nSo if subscribe == true, then it will always return true.", "author": "joeljfischer", "createdAt": "2020-02-21T16:47:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNTcyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjcwNTk2Nw==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r382705967", "bodyText": "It is actually confusing. I will simplify the condition a bit.", "author": "bilal-alsharifi", "createdAt": "2020-02-21T17:20:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNTcyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYwNTk0Ng==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r382605946", "body": "```suggestion\r\n\t\t- if subscribe is null (no change), shouldSubscribe = current subscription status, or false if the HU does not support subscriptions\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t- if subscribe is null (no change), shouldSubscribe = current subscription status\n          \n          \n            \n            \t\t- if subscribe is null (no change), shouldSubscribe = current subscription status, or false if the HU does not support subscriptions", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t<span class=\"pl-k\">-</span> <span class=\"pl-k\">if</span> subscribe is <span class=\"pl-c1\">null</span> (no change), shouldSubscribe <span class=\"pl-k\">=</span> current subscription status</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t<span class=\"pl-k\">-</span> <span class=\"pl-k\">if</span> subscribe is <span class=\"pl-c1\">null</span> (no change), shouldSubscribe <span class=\"pl-k\">=</span> current subscription status<span class=\"x x-first\">, or </span><span class=\"pl-c1 x\">false</span><span class=\"x\"> </span><span class=\"pl-k x\">if</span><span class=\"x\"> the </span><span class=\"pl-c1 x\">HU</span><span class=\"x x-last\"> does not support subscriptions</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "joeljfischer", "createdAt": "2020-02-21T14:21:21Z", "path": "base/src/main/java/com/smartdevicelink/proxy/SystemCapabilityManager.java", "diffHunk": "@@ -550,7 +551,13 @@ private void retrieveCapability(final SystemCapabilityType systemCapabilityType,\n \t\t}\n \t\tfinal GetSystemCapability request = new GetSystemCapability();\n \t\trequest.setSystemCapabilityType(systemCapabilityType);\n-\t\t// If subscribe is null, then don't change the current subscription status\n+\n+\t\t/*\n+\t\tThe subscription flag in the request should be set based on multiple variables:\n+\t\t- if subscribe is null (no change), shouldSubscribe = current subscription status", "originalCommit": "11189a63e71bddae0d7fea388b0e98db47e5ec2d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY3NDAxNg==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r382674016", "body": "```suggestion\r\n\tpublic void testAddOnSystemCapabilityListenerThenGetCapabilityWhenSubscriptionsAreNotSupported() {\r\n```\r\n\r\nYou may also want to consider underscores to define conditions, like:\r\n\r\n`testAddOnSystemCapabilityListener_thenGetCapability_whenSubscriptionsAreNotSupported()`", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tpublic void testAddOnSystemCapabilityListenerThenGetCapability() {\n          \n          \n            \n            \tpublic void testAddOnSystemCapabilityListenerThenGetCapabilityWhenSubscriptionsAreNotSupported() {\n          \n      \n    \n    \n  \n\nYou may also want to consider underscores to define conditions, like:\ntestAddOnSystemCapabilityListener_thenGetCapability_whenSubscriptionsAreNotSupported()", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t<span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"x x-first x-last\">testAddOnSystemCapabilityListenerThenGetCapability</span>() {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t<span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"x x-first x-last\">testAddOnSystemCapabilityListenerThenGetCapabilityWhenSubscriptionsAreNotSupported</span>() {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n\n<p dir=\"auto\">You may also want to consider underscores to define conditions, like:</p>\n<p dir=\"auto\"><code>testAddOnSystemCapabilityListener_thenGetCapability_whenSubscriptionsAreNotSupported()</code></p>", "author": "joeljfischer", "createdAt": "2020-02-21T16:19:56Z", "path": "android/sdl_android/src/androidTest/java/com/smartdevicelink/test/proxy/SystemCapabilityManagerTests.java", "diffHunk": "@@ -490,6 +490,129 @@ public void testAddOnSystemCapabilityListenerWithSubscriptionsNotSupportedAndCap\n \t\tverify(internalInterface, times(1)).sendRPC(any(GetSystemCapability.class));\n \t}\n \n+\tpublic void testAddOnSystemCapabilityListenerThenGetCapability() {", "originalCommit": "11189a63e71bddae0d7fea388b0e98db47e5ec2d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY4MjYxMg==", "url": "https://github.com/smartdevicelink/sdl_java_suite/pull/1277#discussion_r382682612", "bodyText": "The use of underscores in java is not very common. Except for naming const variables. I prefer the first suggested name as it complies more with Java naming conventions.", "author": "bilal-alsharifi", "createdAt": "2020-02-21T16:35:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY3NDAxNg=="}], "type": "inlineReview"}, {"oid": "029db4ec08e179c44fa169713e6076878358f8a0", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/029db4ec08e179c44fa169713e6076878358f8a0", "message": "Update android/sdl_android/src/androidTest/java/com/smartdevicelink/test/proxy/SystemCapabilityManagerTests.java\n\nCo-Authored-By: Joel Fischer <joeljfischer@gmail.com>", "committedDate": "2020-02-21T16:35:13Z", "type": "commit"}, {"oid": "df73517365f5e3ec8123f1dcb9859054d1f8a967", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/df73517365f5e3ec8123f1dcb9859054d1f8a967", "message": "Update base/src/main/java/com/smartdevicelink/proxy/SystemCapabilityManager.java\n\nCo-Authored-By: Joel Fischer <joeljfischer@gmail.com>", "committedDate": "2020-02-21T16:36:33Z", "type": "commit"}, {"oid": "b1edc68edee81e1c718381f4c25a788ab915bff8", "url": "https://github.com/smartdevicelink/sdl_java_suite/commit/b1edc68edee81e1c718381f4c25a788ab915bff8", "message": "Simplify ternary condition in SCM", "committedDate": "2020-02-21T17:20:55Z", "type": "commit"}]}