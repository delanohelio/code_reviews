{"pr_number": 230, "pr_title": "FM2-221:Add create, update, and delete for Person", "pr_author": "gitcliff", "pr_createdAt": "2020-06-23T19:29:05Z", "pr_url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTUyNDczOQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r445524739", "body": "```java\r\nreturn FhirProviderUtils.buildDelete(person);\r\n```", "bodyText": "return FhirProviderUtils.buildDelete(person);", "bodyHTML": "<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"return FhirProviderUtils.buildDelete(person);\"><pre><span class=\"pl-k\">return</span> <span class=\"pl-smi\">FhirProviderUtils</span><span class=\"pl-k\">.</span>buildDelete(person);</pre></div>", "author": "corneliouzbett", "createdAt": "2020-06-25T12:37:59Z", "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r3/PersonFhirResourceProvider.java", "diffHunk": "@@ -57,6 +61,38 @@ public Person getPersonById(@IdParam @NotNull IdType id) {\n \t\treturn Person30_40.convertPerson(person);\n \t}\n \t\n+\t@Create\n+\tpublic MethodOutcome createPerson(@ResourceParam Person person) {\n+\t\treturn FhirProviderUtils.buildCreate(personService.create(Person30_40.convertPerson(person)));\n+\t} \n+\n+\t@Update\n+\t@SuppressWarnings(\"unused\")\n+\tpublic MethodOutcome updatePerson(@IdParam IdType id, @ResourceParam Person person) {\n+\t\tif (id == null || id.getIdPart() == null) {\n+\t\t\tthrow new InvalidRequestException(\"id must be specified to update\");\n+\t\t}\n+\n+\t\tperson.setId(id.getIdPart());\n+\n+\t\treturn FhirProviderUtils.buildUpdate(personService.update(id.getIdPart(),\n+\t\t    Person30_40.convertPerson(person)));\n+\t}\n+\n+\t@Delete\n+\t@SuppressWarnings(\"unused\")\n+\tpublic OperationOutcome deletePerson(@IdParam @NotNull IdType id) {\n+\t\torg.hl7.fhir.r4.model.Person person = personService.delete(id.getIdPart());\n+\t\tif (person == null) {\n+\t\t\tthrow new ResourceNotFoundException(\"Could not find person to delete with id \" + id.getIdPart());\n+\t\t}\n+\t\tOperationOutcome retVal = new OperationOutcome();\n+\t\tretVal.setId(id.getIdPart());\n+\t\tretVal.getText().setDivAsString(\"Deleted successfully\");\n+\t\treturn retVal;", "originalCommit": "a720d690061df051efc6636409419b156895c164", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTc4MjQ0NQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r445782445", "bodyText": "I have fixed it", "author": "gitcliff", "createdAt": "2020-06-25T19:14:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTUyNDczOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTUzMDk1MA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r445530950", "body": "This the wrong import. It should be;\r\n`import org.hl7.fhir.r4.model.OperationOutcome;`", "bodyText": "This the wrong import. It should be;\nimport org.hl7.fhir.r4.model.OperationOutcome;", "bodyHTML": "<p dir=\"auto\">This the wrong import. It should be;<br>\n<code>import org.hl7.fhir.r4.model.OperationOutcome;</code></p>", "author": "corneliouzbett", "createdAt": "2020-06-25T12:48:31Z", "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProvider.java", "diffHunk": "@@ -13,26 +13,36 @@\n \n import java.util.List;\n \n+import ca.uhn.fhir.rest.annotation.Create;\n+import ca.uhn.fhir.rest.annotation.Delete;\n import ca.uhn.fhir.rest.annotation.History;\n import ca.uhn.fhir.rest.annotation.IdParam;\n import ca.uhn.fhir.rest.annotation.OptionalParam;\n import ca.uhn.fhir.rest.annotation.Read;\n+import ca.uhn.fhir.rest.annotation.ResourceParam;\n import ca.uhn.fhir.rest.annotation.Search;\n import ca.uhn.fhir.rest.annotation.Sort;\n+import ca.uhn.fhir.rest.annotation.Update;\n+import ca.uhn.fhir.rest.api.MethodOutcome;\n import ca.uhn.fhir.rest.api.SortSpec;\n import ca.uhn.fhir.rest.api.server.IBundleProvider;\n import ca.uhn.fhir.rest.param.DateRangeParam;\n import ca.uhn.fhir.rest.param.StringAndListParam;\n import ca.uhn.fhir.rest.param.TokenAndListParam;\n import ca.uhn.fhir.rest.server.IResourceProvider;\n+import ca.uhn.fhir.rest.server.exceptions.InvalidRequestException;\n import ca.uhn.fhir.rest.server.exceptions.ResourceNotFoundException;\n import lombok.AccessLevel;\n import lombok.Setter;\n+\n+import org.hl7.fhir.convertors.conv30_40.Person30_40;\n+import org.hl7.fhir.dstu3.model.OperationOutcome;", "originalCommit": "a720d690061df051efc6636409419b156895c164", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTc4Mjk5Ng==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r445782996", "bodyText": "its done", "author": "gitcliff", "createdAt": "2020-06-25T19:15:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTUzMDk1MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTUzMTY5Nw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r445531697", "body": "It should be `import org.hl7.fhir.r4.model.OperationOutcome;` for R4", "bodyText": "It should be import org.hl7.fhir.r4.model.OperationOutcome; for R4", "bodyHTML": "<p dir=\"auto\">It should be <code>import org.hl7.fhir.r4.model.OperationOutcome;</code> for R4</p>", "author": "corneliouzbett", "createdAt": "2020-06-25T12:49:49Z", "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProviderWebTest.java", "diffHunk": "@@ -34,8 +37,11 @@\n import ca.uhn.fhir.rest.param.TokenAndListParam;\n import lombok.AccessLevel;\n import lombok.Getter;\n+\n+import org.apache.commons.io.IOUtils;\n import org.apache.commons.lang3.time.DateUtils;\n import org.hamcrest.MatcherAssert;\n+import org.hl7.fhir.dstu3.model.OperationOutcome;", "originalCommit": "a720d690061df051efc6636409419b156895c164", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTc4MzE3Mg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r445783172", "bodyText": "i have added it", "author": "gitcliff", "createdAt": "2020-06-25T19:16:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTUzMTY5Nw=="}], "type": "inlineReview"}, {"oid": "9cb1c3db37a5d0b924c0c88afa04f06f817c1c41", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/9cb1c3db37a5d0b924c0c88afa04f06f817c1c41", "message": "FM2-221:Add create, update, and delete for Person", "committedDate": "2020-06-25T19:11:19Z", "type": "forcePushed"}, {"oid": "4b600011433186a24887b42ddfb5c788e0a328be", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/4b600011433186a24887b42ddfb5c788e0a328be", "message": "FM2-221:Add create, update, and delete for Person", "committedDate": "2020-06-26T11:38:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUxMDg2OA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r446510868", "body": "@gitcliff  change the operation outcome to use \r\nreturn FhirProviderUtils.buildDelete(person);", "bodyText": "@gitcliff  change the operation outcome to use\nreturn FhirProviderUtils.buildDelete(person);", "bodyHTML": "<p dir=\"auto\"><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/gitcliff/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/gitcliff\">@gitcliff</a>  change the operation outcome to use<br>\nreturn FhirProviderUtils.buildDelete(person);</p>", "author": "Akayeshmantha", "createdAt": "2020-06-27T10:33:46Z", "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r3/PersonFhirResourceProvider.java", "diffHunk": "@@ -57,6 +61,38 @@ public Person getPersonById(@IdParam @NotNull IdType id) {\n \t\treturn Person30_40.convertPerson(person);\n \t}\n \t\n+\t@Create\n+\tpublic MethodOutcome createPerson(@ResourceParam Person person) {\n+\t\treturn FhirProviderUtils.buildCreate(personService.create(Person30_40.convertPerson(person)));\n+\t} \n+\n+\t@Update\n+\t@SuppressWarnings(\"unused\")\n+\tpublic MethodOutcome updatePerson(@IdParam IdType id, @ResourceParam Person person) {\n+\t\tif (id == null || id.getIdPart() == null) {\n+\t\t\tthrow new InvalidRequestException(\"id must be specified to update\");\n+\t\t}\n+\n+\t\tperson.setId(id.getIdPart());\n+\n+\t\treturn FhirProviderUtils.buildUpdate(personService.update(id.getIdPart(),\n+\t\t    Person30_40.convertPerson(person)));\n+\t}\n+\n+\t@Delete\n+\t@SuppressWarnings(\"unused\")\n+\tpublic org.hl7.fhir.r4.model.OperationOutcome deletePerson(@IdParam @NotNull IdType id) {\n+\t\torg.hl7.fhir.r4.model.Person person = personService.delete(id.getIdPart());\n+\t\tif (person == null) {\n+\t\t\tthrow new ResourceNotFoundException(\"Could not find person to delete with id \" + id.getIdPart());\n+\t\t}\n+\t\tOperationOutcome retVal = new OperationOutcome();\n+\t\tretVal.setId(id.getIdPart());", "originalCommit": "4b600011433186a24887b42ddfb5c788e0a328be", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUxMDkxOA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r446510918", "body": "ditto", "bodyText": "ditto", "bodyHTML": "<p dir=\"auto\">ditto</p>", "author": "Akayeshmantha", "createdAt": "2020-06-27T10:34:14Z", "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProvider.java", "diffHunk": "@@ -60,6 +70,36 @@ public Person getPersonById(@IdParam IdType id) {\n \t\treturn person;\n \t}\n \t\n+\t@Create\n+\tpublic MethodOutcome createPerson(@ResourceParam Person person) {\n+\t\treturn FhirProviderUtils.buildCreate(fhirPersonService.create(person));\n+\t} \n+\n+\t@Update\n+\t@SuppressWarnings(\"unused\")\n+\tpublic MethodOutcome updatePerson(@IdParam IdType id, @ResourceParam Person person) {\n+\t\tif (id == null || id.getIdPart() == null) {\n+\t\t\tthrow new InvalidRequestException(\"id must be specified to update\");\n+\t\t}\n+\n+\t\tperson.setId(id.getIdPart());\n+\n+\t\treturn FhirProviderUtils.buildUpdate(fhirPersonService.update(id.getIdPart(),person));\n+\t}\n+\n+\t@Delete\n+\t@SuppressWarnings(\"unused\")\n+\tpublic OperationOutcome deletePerson(@IdParam @NotNull IdType id) {\n+\t\torg.hl7.fhir.r4.model.Person person = fhirPersonService.delete(id.getIdPart());\n+\t\tif (person == null) {\n+\t\t\tthrow new ResourceNotFoundException(\"Could not find person to delete with id \" + id.getIdPart());\n+\t\t}\n+\t\tOperationOutcome retVal = new OperationOutcome();\n+\t\tretVal.setId(id.getIdPart());", "originalCommit": "4b600011433186a24887b42ddfb5c788e0a328be", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUxMTEzMg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r446511132", "body": "change according to the util method.", "bodyText": "change according to the util method.", "bodyHTML": "<p dir=\"auto\">change according to the util method.</p>", "author": "Akayeshmantha", "createdAt": "2020-06-27T10:37:04Z", "path": "api/src/test/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProviderTest.java", "diffHunk": "@@ -283,4 +287,62 @@ public void getPatientHistoryByWithWrongId_shouldThrowResourceNotFoundException(\n \t\tassertThat(resourceProvider.getPersonHistoryById(idType).size(), equalTo(0));\n \t}\n \t\n+\t@Test\n+\tpublic void updatePerson_shouldUpdatePerson() {\n+\t\tPerson newPerson = person;\n+\t\t\n+\t\twhen(fhirPersonService.update(PERSON_UUID, person)).thenReturn(newPerson);\n+\t\t\n+\t\tMethodOutcome result = resourceProvider.updatePerson(new IdType().setValue(PERSON_UUID), person);\n+\t\tassertThat(result, CoreMatchers.notNullValue());\n+\t\tassertThat(result.getResource(), CoreMatchers.equalTo(newPerson));\n+\t}\n+\t\n+\t@Test(expected = InvalidRequestException.class)\n+\tpublic void updatePerson_shouldThrowInvalidRequestExceptionForWrongPersonUuid() {\n+\t\twhen(fhirPersonService.update(WRONG_PERSON_UUID, person)).thenThrow(InvalidRequestException.class);\n+\t\t\n+\t\tresourceProvider.updatePerson(new IdType().setValue(WRONG_PERSON_UUID), person);\n+\t}\n+\t\n+\t@Test(expected = MethodNotAllowedException.class)\n+\tpublic void updatePersonShouldThrowMethodNotAllowedIfDoesNotExist() {\n+\t\tPerson wrongPerson = new Person();\n+\t\t\n+\t\twrongPerson.setId(WRONG_PERSON_UUID);\n+\t\t\n+\t\twhen(fhirPersonService.update(WRONG_PERSON_UUID, wrongPerson)).thenThrow(MethodNotAllowedException.class);\n+\t\t\n+\t\tresourceProvider.updatePerson(new IdType().setValue(WRONG_PERSON_UUID), wrongPerson);\n+\t}\n+\t\n+\t@Test\n+\tpublic void deletePerson_shouldDeletePerson() {\n+\t\tPerson newPerson = new Person();\n+\t\t\n+\t\twhen(fhirPersonService.delete(PERSON_UUID)).thenReturn(newPerson);\n+\t\t\n+\t\torg.hl7.fhir.r4.model.OperationOutcome result = resourceProvider.deletePerson(new IdType().setValue(PERSON_UUID));\n+\t\tassertThat(result, CoreMatchers.notNullValue());\n+\t\tassertThat(result.getId(), equalTo(PERSON_UUID));", "originalCommit": "4b600011433186a24887b42ddfb5c788e0a328be", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUxNTE4Nw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r446515187", "body": "you can use the same person object no need to create a new one", "bodyText": "you can use the same person object no need to create a new one", "bodyHTML": "<p dir=\"auto\">you can use the same person object no need to create a new one</p>", "author": "Akayeshmantha", "createdAt": "2020-06-27T11:29:05Z", "path": "api/src/test/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProviderTest.java", "diffHunk": "@@ -283,4 +287,62 @@ public void getPatientHistoryByWithWrongId_shouldThrowResourceNotFoundException(\n \t\tassertThat(resourceProvider.getPersonHistoryById(idType).size(), equalTo(0));\n \t}\n \t\n+\t@Test\n+\tpublic void updatePerson_shouldUpdatePerson() {\n+\t\tPerson newPerson = person;\n+\t\t\n+\t\twhen(fhirPersonService.update(PERSON_UUID, person)).thenReturn(newPerson);\n+\t\t\n+\t\tMethodOutcome result = resourceProvider.updatePerson(new IdType().setValue(PERSON_UUID), person);\n+\t\tassertThat(result, CoreMatchers.notNullValue());\n+\t\tassertThat(result.getResource(), CoreMatchers.equalTo(newPerson));\n+\t}\n+\t\n+\t@Test(expected = InvalidRequestException.class)\n+\tpublic void updatePerson_shouldThrowInvalidRequestExceptionForWrongPersonUuid() {\n+\t\twhen(fhirPersonService.update(WRONG_PERSON_UUID, person)).thenThrow(InvalidRequestException.class);\n+\t\t\n+\t\tresourceProvider.updatePerson(new IdType().setValue(WRONG_PERSON_UUID), person);\n+\t}\n+\t\n+\t@Test(expected = MethodNotAllowedException.class)\n+\tpublic void updatePersonShouldThrowMethodNotAllowedIfDoesNotExist() {\n+\t\tPerson wrongPerson = new Person();\n+\t\t\n+\t\twrongPerson.setId(WRONG_PERSON_UUID);\n+\t\t\n+\t\twhen(fhirPersonService.update(WRONG_PERSON_UUID, wrongPerson)).thenThrow(MethodNotAllowedException.class);\n+\t\t\n+\t\tresourceProvider.updatePerson(new IdType().setValue(WRONG_PERSON_UUID), wrongPerson);\n+\t}\n+\t\n+\t@Test\n+\tpublic void deletePerson_shouldDeletePerson() {\n+\t\tPerson newPerson = new Person();", "originalCommit": "4b600011433186a24887b42ddfb5c788e0a328be", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzE3MjU3Mg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r447172572", "bodyText": "thanks ,i have fixed it", "author": "gitcliff", "createdAt": "2020-06-29T18:34:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjUxNTE4Nw=="}], "type": "inlineReview"}, {"oid": "0f375855395333448956a456d72c7b293284c9db", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/0f375855395333448956a456d72c7b293284c9db", "message": "Few changes", "committedDate": "2020-06-29T07:49:47Z", "type": "forcePushed"}, {"oid": "f0b3bab5d3090b6df87d3b9a9650ce53a4ac000d", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/f0b3bab5d3090b6df87d3b9a9650ce53a4ac000d", "message": "FM2-221:Add create, update, and delete for Person", "committedDate": "2020-06-29T18:51:05Z", "type": "forcePushed"}, {"oid": "7b705e484ca827917f8ac8bf62720b87f4c94cae", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/7b705e484ca827917f8ac8bf62720b87f4c94cae", "message": "FM2-221:Add create, update, and delete for Person", "committedDate": "2020-07-01T07:26:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAyMTQ0Mg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r450021442", "body": "```java\r\nreturn FhirProviderUtils.buildDelete(Person30_40.convertPerson(person)));\r\n```", "bodyText": "return FhirProviderUtils.buildDelete(Person30_40.convertPerson(person)));", "bodyHTML": "<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"return FhirProviderUtils.buildDelete(Person30_40.convertPerson(person)));\"><pre><span class=\"pl-k\">return</span> <span class=\"pl-smi\">FhirProviderUtils</span><span class=\"pl-k\">.</span>buildDelete(<span class=\"pl-smi\">Person30_40</span><span class=\"pl-k\">.</span>convertPerson(person)));</pre></div>", "author": "corneliouzbett", "createdAt": "2020-07-06T07:03:08Z", "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r3/PersonFhirResourceProvider.java", "diffHunk": "@@ -62,6 +72,34 @@ public Person getPersonById(@IdParam @NotNull IdType id) {\n \t\treturn Person30_40.convertPerson(person);\n \t}\n \t\n+\t@Create\n+\tpublic MethodOutcome createPerson(@ResourceParam Person person) {\n+\t\treturn FhirProviderUtils.buildCreate(personService.create(Person30_40.convertPerson(person)));\n+\t} \n+\n+\t@Update\n+\t@SuppressWarnings(\"unused\")\n+\tpublic MethodOutcome updatePerson(@IdParam IdType id, @ResourceParam Person person) {\n+\t\tif (id == null || id.getIdPart() == null) {\n+\t\t\tthrow new InvalidRequestException(\"id must be specified to update\");\n+\t\t}\n+\n+\t\tperson.setId(id.getIdPart());\n+\n+\t\treturn FhirProviderUtils.buildUpdate(personService.update(id.getIdPart(), Person30_40.convertPerson(person)));\n+\t}\n+\n+\t@Delete\n+\t@SuppressWarnings(\"unused\")\n+\tpublic OperationOutcome deletePerson(@IdParam @NotNull IdType id) {\n+\t\torg.hl7.fhir.r4.model.Person person = personService.delete(id.getIdPart());\n+\t\tif (person == null) {\n+\t\t\tthrow new ResourceNotFoundException(\"Could not find person to delete with id \" + id.getIdPart());\n+\t\t}\n+\t\treturn OperationOutcome30_40.convertOperationOutcome(FhirProviderUtils.buildDelete(person));", "originalCommit": "7b705e484ca827917f8ac8bf62720b87f4c94cae", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQyNjA4MQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r450426081", "bodyText": "@corneliouzbett i have fixed it ,,,kindly review", "author": "gitcliff", "createdAt": "2020-07-06T19:10:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAyMTQ0Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDE3NzYzMw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r450177633", "body": "Thanks @gitcliff  for this , i know this method does not affect the code however  by following code convention, would suggest something different like Public void updatePerson_shouldReturnErrorForNoId()  you can frase it your way , take a look at that method", "bodyText": "Thanks @gitcliff  for this , i know this method does not affect the code however  by following code convention, would suggest something different like Public void updatePerson_shouldReturnErrorForNoId()  you can frase it your way , take a look at that method", "bodyHTML": "<p dir=\"auto\">Thanks <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/gitcliff/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/gitcliff\">@gitcliff</a>  for this , i know this method does not affect the code however  by following code convention, would suggest something different like Public void updatePerson_shouldReturnErrorForNoId()  you can frase it your way , take a look at that method</p>", "author": "sherrif10", "createdAt": "2020-07-06T12:11:38Z", "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r3/PersonFhirResourceProviderWebTest.java", "diffHunk": "@@ -408,4 +424,89 @@ private MockHttpServletResponse getPersonHistoryByIdRequest() throws IOException\n \t\treturn get(\"/Person/\" + PERSON_UUID + \"/_history\").accept(FhirMediaTypes.JSON).go();\n \t}\n \t\n+\t@Test\n+\tpublic void createPerson_shouldCreatePerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.create(any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\t\t\n+\t\tMockHttpServletResponse response = post(\"/Person\").jsonContent(jsonPerson).accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isCreated());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldUpdateExistingPerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.update(anyString(), any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\n+\t\tMockHttpServletResponse response = put(\"/Person/\" + PERSON_UUID).jsonContent(jsonPerson).accept(FhirMediaTypes.JSON)\n+\t\t        .go();\n+\n+\t\tassertThat(response, isOk());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldErrorForNoId() throws Exception {", "originalCommit": "7b705e484ca827917f8ac8bf62720b87f4c94cae", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "acdae666b91a64935791719f76321e195907ed61", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/acdae666b91a64935791719f76321e195907ed61", "message": "FM2-221:Add create, update, and delete for Person", "committedDate": "2020-07-06T18:54:18Z", "type": "forcePushed"}, {"oid": "c44edc8f54a44da24155ff630c2835c4b1ca3724", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/c44edc8f54a44da24155ff630c2835c4b1ca3724", "message": "FM2-221:removing extra spaces", "committedDate": "2020-07-14T19:24:29Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTAzMzM0OA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455033348", "body": "```suggestion\r\n\t\tPerson person = fhirPersonService.delete(id.getIdPart());\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\torg.hl7.fhir.r4.model.Person person = fhirPersonService.delete(id.getIdPart());\n          \n          \n            \n            \t\tPerson person = fhirPersonService.delete(id.getIdPart());", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t<span class=\"pl-smi\"><span class=\"x x-first\">org.hl7.fhir.r4.model</span><span class=\"pl-k x x-last\">.</span>Person</span> person <span class=\"pl-k\">=</span> fhirPersonService<span class=\"pl-k\">.</span>delete(id<span class=\"pl-k\">.</span>getIdPart());</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t<span class=\"pl-smi\">Person</span> person <span class=\"pl-k\">=</span> fhirPersonService<span class=\"pl-k\">.</span>delete(id<span class=\"pl-k\">.</span>getIdPart());</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "varung-31", "createdAt": "2020-07-15T13:02:47Z", "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProvider.java", "diffHunk": "@@ -60,6 +69,33 @@ public Person getPersonById(@IdParam IdType id) {\n \t\treturn person;\n \t}\n \t\n+\t@Create\n+\tpublic MethodOutcome createPerson(@ResourceParam Person person) {\n+\t\treturn FhirProviderUtils.buildCreate(fhirPersonService.create(person));\n+\t} \n+\n+\t@Update\n+\t@SuppressWarnings(\"unused\")\n+\tpublic MethodOutcome updatePerson(@IdParam IdType id, @ResourceParam Person person) {\n+\t\tif (id == null || id.getIdPart() == null) {\n+\t\t\tthrow new InvalidRequestException(\"id must be specified to update\");\n+\t\t}\n+\n+\t\tperson.setId(id.getIdPart());\n+\n+\t\treturn FhirProviderUtils.buildUpdate(fhirPersonService.update(id.getIdPart(), person));\n+\t}\n+\n+\t@Delete\n+\t@SuppressWarnings(\"unused\")\n+\tpublic OperationOutcome deletePerson(@IdParam @NotNull IdType id) {\n+\t\torg.hl7.fhir.r4.model.Person person = fhirPersonService.delete(id.getIdPart());", "originalCommit": "9e3ffaa6f7722dda94d061c582bcbac37297f1c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTAzNzM1MA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455037350", "body": "We can remove this particular test because the test below is exactly the same.", "bodyText": "We can remove this particular test because the test below is exactly the same.", "bodyHTML": "<p dir=\"auto\">We can remove this particular test because the test below is exactly the same.</p>", "author": "varung-31", "createdAt": "2020-07-15T13:09:08Z", "path": "api/src/test/java/org/openmrs/module/fhir2/providers/r3/PersonFhirResourceProviderTest.java", "diffHunk": "@@ -328,4 +337,71 @@ public void getPatientHistoryByWithWrongId_shouldThrowResourceNotFoundException(\n \t\tassertThat(resourceProvider.getPersonHistoryById(idType).size(), equalTo(0));\n \t}\n \t\n+\t@Test\n+\tpublic void createPerson_shouldCreateNewPerson() {\n+\t\twhen(fhirPersonService.create(any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\n+\t\tMethodOutcome result = resourceProvider.createPerson(Person30_40.convertPerson(person));\n+\t\tassertThat(result, CoreMatchers.notNullValue());\n+\t\tassertThat(result.getCreated(), is(true));\n+\t\tassertThat(result.getResource(), CoreMatchers.equalTo(person));\n+\t}\n+\n+\t@Test\n+\tpublic void deletePerson_shouldDeletePerson() {\n+\n+\t\twhen(fhirPersonService.delete(PERSON_UUID)).thenReturn(person);\n+\n+\t\tOperationOutcome result = resourceProvider.deletePerson(new IdType().setValue(PERSON_UUID));\n+\t\tassertThat(result, notNullValue());\n+\t\tassertThat(result.getIssue(), notNullValue());\n+\t\tassertThat(result.getIssueFirstRep().getSeverity(), equalTo(OperationOutcome.IssueSeverity.INFORMATION));\n+\t\tassertThat(result.getIssueFirstRep().getDetails().getCodingFirstRep().getCode(), equalTo(\"MSG_DELETED\"));\n+\t\tassertThat(result.getIssueFirstRep().getDetails().getCodingFirstRep().getDisplay(),\n+\t\t    equalTo(\"This resource has been deleted\"));\n+\t}\n+\n+\t@Test(expected = ResourceNotFoundException.class)\n+\tpublic void deletePerson_shouldThrowResourceNotFoundException() {", "originalCommit": "9e3ffaa6f7722dda94d061c582bcbac37297f1c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTAzODA4OQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455038089", "body": "```suggestion\r\n\tpublic void updatePerson_shouldThrowMethodNotAllowedIfDoesNotExist() {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tpublic void updatePersonShouldThrowMethodNotAllowedIfDoesNotExist() {\n          \n          \n            \n            \tpublic void updatePerson_shouldThrowMethodNotAllowedIfDoesNotExist() {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t<span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"x x-first x-last\">updatePersonShouldThrowMethodNotAllowedIfDoesNotExist</span>() {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t<span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"x x-first x-last\">updatePerson_shouldThrowMethodNotAllowedIfDoesNotExist</span>() {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "varung-31", "createdAt": "2020-07-15T13:10:10Z", "path": "api/src/test/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProviderTest.java", "diffHunk": "@@ -328,4 +333,62 @@ public void getPatientHistoryByWithWrongId_shouldThrowResourceNotFoundException(\n \t\tassertThat(resourceProvider.getPersonHistoryById(idType).size(), equalTo(0));\n \t}\n \t\n+\t@Test\n+\tpublic void updatePerson_shouldUpdatePerson() {\n+\t\t\n+\t\twhen(fhirPersonService.update(PERSON_UUID, person)).thenReturn(person);\n+\t\t\n+\t\tMethodOutcome result = resourceProvider.updatePerson(new IdType().setValue(PERSON_UUID), person);\n+\t\tassertThat(result, CoreMatchers.notNullValue());\n+\t\tassertThat(result.getResource(), CoreMatchers.equalTo(person));\n+\t}\n+\t\n+\t@Test(expected = InvalidRequestException.class)\n+\tpublic void updatePerson_shouldThrowInvalidRequestExceptionForWrongPersonUuid() {\n+\t\twhen(fhirPersonService.update(WRONG_PERSON_UUID, person)).thenThrow(InvalidRequestException.class);\n+\t\t\n+\t\tresourceProvider.updatePerson(new IdType().setValue(WRONG_PERSON_UUID), person);\n+\t}\n+\t\n+\t@Test(expected = MethodNotAllowedException.class)\n+\tpublic void updatePersonShouldThrowMethodNotAllowedIfDoesNotExist() {", "originalCommit": "9e3ffaa6f7722dda94d061c582bcbac37297f1c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEwMzE1Nw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455103157", "bodyText": "sure,fixed it", "author": "gitcliff", "createdAt": "2020-07-15T14:38:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTAzODA4OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTAzODY5Ng==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455038696", "body": "```suggestion\r\n\t\tOperationOutcome result = resourceProvider.deletePerson(new IdType().setValue(PERSON_UUID));\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\torg.hl7.fhir.r4.model.OperationOutcome result = resourceProvider.deletePerson(new IdType().setValue(PERSON_UUID));\n          \n          \n            \n            \t\tOperationOutcome result = resourceProvider.deletePerson(new IdType().setValue(PERSON_UUID));", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t<span class=\"pl-smi\"><span class=\"x x-first\">org.hl7.fhir.r4.model</span><span class=\"pl-k x x-last\">.</span>OperationOutcome</span> result <span class=\"pl-k\">=</span> resourceProvider<span class=\"pl-k\">.</span>deletePerson(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">IdType</span>()<span class=\"pl-k\">.</span>setValue(<span class=\"pl-c1\">PERSON_UUID</span>));</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t<span class=\"pl-smi\">OperationOutcome</span> result <span class=\"pl-k\">=</span> resourceProvider<span class=\"pl-k\">.</span>deletePerson(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">IdType</span>()<span class=\"pl-k\">.</span>setValue(<span class=\"pl-c1\">PERSON_UUID</span>));</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "varung-31", "createdAt": "2020-07-15T13:11:09Z", "path": "api/src/test/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProviderTest.java", "diffHunk": "@@ -328,4 +333,62 @@ public void getPatientHistoryByWithWrongId_shouldThrowResourceNotFoundException(\n \t\tassertThat(resourceProvider.getPersonHistoryById(idType).size(), equalTo(0));\n \t}\n \t\n+\t@Test\n+\tpublic void updatePerson_shouldUpdatePerson() {\n+\t\t\n+\t\twhen(fhirPersonService.update(PERSON_UUID, person)).thenReturn(person);\n+\t\t\n+\t\tMethodOutcome result = resourceProvider.updatePerson(new IdType().setValue(PERSON_UUID), person);\n+\t\tassertThat(result, CoreMatchers.notNullValue());\n+\t\tassertThat(result.getResource(), CoreMatchers.equalTo(person));\n+\t}\n+\t\n+\t@Test(expected = InvalidRequestException.class)\n+\tpublic void updatePerson_shouldThrowInvalidRequestExceptionForWrongPersonUuid() {\n+\t\twhen(fhirPersonService.update(WRONG_PERSON_UUID, person)).thenThrow(InvalidRequestException.class);\n+\t\t\n+\t\tresourceProvider.updatePerson(new IdType().setValue(WRONG_PERSON_UUID), person);\n+\t}\n+\t\n+\t@Test(expected = MethodNotAllowedException.class)\n+\tpublic void updatePersonShouldThrowMethodNotAllowedIfDoesNotExist() {\n+\t\t\n+\t\tperson.setId(WRONG_PERSON_UUID);\n+\t\t\n+\t\twhen(fhirPersonService.update(WRONG_PERSON_UUID, person)).thenThrow(MethodNotAllowedException.class);\n+\t\t\n+\t\tresourceProvider.updatePerson(new IdType().setValue(WRONG_PERSON_UUID), person);\n+\t}\n+\t\n+\t@Test\n+\tpublic void deletePerson_shouldDeletePerson() {\n+\n+\t\twhen(fhirPersonService.delete(PERSON_UUID)).thenReturn(person);\n+\t\t\n+\t\torg.hl7.fhir.r4.model.OperationOutcome result = resourceProvider.deletePerson(new IdType().setValue(PERSON_UUID));", "originalCommit": "9e3ffaa6f7722dda94d061c582bcbac37297f1c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0MjQ1Mg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455042452", "body": "```suggestion\r\n\t\twhen(fhirPersonService.delete(WRONG_PERSON_UUID)).thenReturn(null);\r\n\t\tresourceProvider.deletePerson(new IdType().setValue(WRONG_PERSON_UUID));\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tIdType id = new IdType();\n          \n          \n            \n            \t\tid.setValue(WRONG_PERSON_UUID);\n          \n          \n            \n            \t\torg.hl7.fhir.r4.model.OperationOutcome person = resourceProvider.deletePerson(id);\n          \n          \n            \n            \t\tassertThat(person, nullValue());\n          \n          \n            \n            \t\twhen(fhirPersonService.delete(WRONG_PERSON_UUID)).thenReturn(null);\n          \n          \n            \n            \t\tresourceProvider.deletePerson(new IdType().setValue(WRONG_PERSON_UUID));", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t<span class=\"pl-smi\">IdType</span> id <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">IdType</span>();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\tid<span class=\"pl-k\">.</span>setValue(<span class=\"pl-c1\">WRONG_PERSON_UUID</span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t<span class=\"pl-smi\">org.hl7.fhir.r4.model<span class=\"pl-k\">.</span>OperationOutcome</span> person <span class=\"pl-k\">=</span> resourceProvider<span class=\"pl-k\">.</span>deletePerson(id);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\tassertThat(person, nullValue());</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\twhen(fhirPersonService<span class=\"pl-k\">.</span>delete(<span class=\"pl-c1\">WRONG_PERSON_UUID</span>))<span class=\"pl-k\">.</span>thenReturn(<span class=\"pl-c1\">null</span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\tresourceProvider<span class=\"pl-k\">.</span>deletePerson(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">IdType</span>()<span class=\"pl-k\">.</span>setValue(<span class=\"pl-c1\">WRONG_PERSON_UUID</span>));</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "varung-31", "createdAt": "2020-07-15T13:16:37Z", "path": "api/src/test/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProviderTest.java", "diffHunk": "@@ -328,4 +333,62 @@ public void getPatientHistoryByWithWrongId_shouldThrowResourceNotFoundException(\n \t\tassertThat(resourceProvider.getPersonHistoryById(idType).size(), equalTo(0));\n \t}\n \t\n+\t@Test\n+\tpublic void updatePerson_shouldUpdatePerson() {\n+\t\t\n+\t\twhen(fhirPersonService.update(PERSON_UUID, person)).thenReturn(person);\n+\t\t\n+\t\tMethodOutcome result = resourceProvider.updatePerson(new IdType().setValue(PERSON_UUID), person);\n+\t\tassertThat(result, CoreMatchers.notNullValue());\n+\t\tassertThat(result.getResource(), CoreMatchers.equalTo(person));\n+\t}\n+\t\n+\t@Test(expected = InvalidRequestException.class)\n+\tpublic void updatePerson_shouldThrowInvalidRequestExceptionForWrongPersonUuid() {\n+\t\twhen(fhirPersonService.update(WRONG_PERSON_UUID, person)).thenThrow(InvalidRequestException.class);\n+\t\t\n+\t\tresourceProvider.updatePerson(new IdType().setValue(WRONG_PERSON_UUID), person);\n+\t}\n+\t\n+\t@Test(expected = MethodNotAllowedException.class)\n+\tpublic void updatePersonShouldThrowMethodNotAllowedIfDoesNotExist() {\n+\t\t\n+\t\tperson.setId(WRONG_PERSON_UUID);\n+\t\t\n+\t\twhen(fhirPersonService.update(WRONG_PERSON_UUID, person)).thenThrow(MethodNotAllowedException.class);\n+\t\t\n+\t\tresourceProvider.updatePerson(new IdType().setValue(WRONG_PERSON_UUID), person);\n+\t}\n+\t\n+\t@Test\n+\tpublic void deletePerson_shouldDeletePerson() {\n+\n+\t\twhen(fhirPersonService.delete(PERSON_UUID)).thenReturn(person);\n+\t\t\n+\t\torg.hl7.fhir.r4.model.OperationOutcome result = resourceProvider.deletePerson(new IdType().setValue(PERSON_UUID));\n+\t\tassertThat(result, notNullValue());\n+\t\tassertThat(result.getIssueFirstRep().getSeverity(), equalTo(OperationOutcome.IssueSeverity.INFORMATION));\n+\t\tassertThat(result.getIssueFirstRep().getDetails().getCodingFirstRep().getCode(), equalTo(\"MSG_DELETED\"));\n+\t\tassertThat(result.getIssueFirstRep().getDetails().getCodingFirstRep().getDisplay(),\n+\t\t    equalTo(\"This resource has been deleted\"));\n+\t}\n+\t\n+\t@Test(expected = ResourceNotFoundException.class)\n+\tpublic void deletePerson_shouldThrowResourceNotFoundException() {\n+\t\tIdType id = new IdType();\n+\t\tid.setValue(WRONG_PERSON_UUID);\n+\t\torg.hl7.fhir.r4.model.OperationOutcome person = resourceProvider.deletePerson(id);\n+\t\tassertThat(person, nullValue());", "originalCommit": "9e3ffaa6f7722dda94d061c582bcbac37297f1c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEwMjMyOQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455102329", "bodyText": "fixed it", "author": "gitcliff", "createdAt": "2020-07-15T14:37:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0MjQ1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0MzE0Mw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455043143", "body": "```suggestion\r\n\tpublic void updatePerson_shouldThrowErrorForNoId() throws Exception {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tpublic void updatePerson_shouldErrorForNoId() throws Exception {\n          \n          \n            \n            \tpublic void updatePerson_shouldThrowErrorForNoId() throws Exception {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t<span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"x x-first x-last\">updatePerson_shouldErrorForNoId</span>() throws <span class=\"pl-smi\">Exception</span> {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t<span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"x x-first x-last\">updatePerson_shouldThrowErrorForNoId</span>() throws <span class=\"pl-smi\">Exception</span> {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "varung-31", "createdAt": "2020-07-15T13:17:38Z", "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r3/PersonFhirResourceProviderWebTest.java", "diffHunk": "@@ -441,4 +457,89 @@ private MockHttpServletResponse getPersonHistoryByIdRequest() throws IOException\n \t\treturn get(\"/Person/\" + PERSON_UUID + \"/_history\").accept(FhirMediaTypes.JSON).go();\n \t}\n \t\n+\t@Test\n+\tpublic void createPerson_shouldCreatePerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.create(any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\t\t\n+\t\tMockHttpServletResponse response = post(\"/Person\").jsonContent(jsonPerson).accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isCreated());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldUpdateExistingPerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.update(anyString(), any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\n+\t\tMockHttpServletResponse response = put(\"/Person/\" + PERSON_UUID).jsonContent(jsonPerson).accept(FhirMediaTypes.JSON)\n+\t\t        .go();\n+\n+\t\tassertThat(response, isOk());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldErrorForNoId() throws Exception {", "originalCommit": "9e3ffaa6f7722dda94d061c582bcbac37297f1c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0MzY2Ng==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455043666", "body": "```suggestion\r\n\tpublic void updatePerson_shouldThrowErrorForIdMisMatch() throws Exception {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tpublic void updatePerson_shouldErrorForIdMissMatch() throws Exception {\n          \n          \n            \n            \tpublic void updatePerson_shouldThrowErrorForIdMisMatch() throws Exception {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t<span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"x x-first x-last\">updatePerson_shouldErrorForIdMissMatch</span>() throws <span class=\"pl-smi\">Exception</span> {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t<span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"x x-first x-last\">updatePerson_shouldThrowErrorForIdMisMatch</span>() throws <span class=\"pl-smi\">Exception</span> {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "varung-31", "createdAt": "2020-07-15T13:18:20Z", "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r3/PersonFhirResourceProviderWebTest.java", "diffHunk": "@@ -441,4 +457,89 @@ private MockHttpServletResponse getPersonHistoryByIdRequest() throws IOException\n \t\treturn get(\"/Person/\" + PERSON_UUID + \"/_history\").accept(FhirMediaTypes.JSON).go();\n \t}\n \t\n+\t@Test\n+\tpublic void createPerson_shouldCreatePerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.create(any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\t\t\n+\t\tMockHttpServletResponse response = post(\"/Person\").jsonContent(jsonPerson).accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isCreated());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldUpdateExistingPerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.update(anyString(), any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\n+\t\tMockHttpServletResponse response = put(\"/Person/\" + PERSON_UUID).jsonContent(jsonPerson).accept(FhirMediaTypes.JSON)\n+\t\t        .go();\n+\n+\t\tassertThat(response, isOk());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldErrorForNoId() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PERSON_NO_ID_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\tMockHttpServletResponse response = put(\"/Person/\" + PERSON_UUID).jsonContent(jsonPerson).accept(FhirMediaTypes.JSON)\n+\t\t        .go();\n+\n+\t\tassertThat(response, isBadRequest());\n+\t\tassertThat(response.getContentAsString(),\n+\t\t\t\tcontainsStringIgnoringCase(\"body must contain an ID element for update\"));\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldErrorForIdMissMatch() throws Exception {", "originalCommit": "9e3ffaa6f7722dda94d061c582bcbac37297f1c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0NDM1MA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455044350", "body": "```suggestion\r\n\t\tPerson person = new Person();\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n          \n          \n            \n            \t\tPerson person = new Person();", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t<span class=\"pl-smi\"><span class=\"x x-first\">org.hl7.fhir.r4.model</span><span class=\"pl-k x x-last\">.</span>Person</span> person <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\"><span class=\"x x-first\">org.hl7.fhir.r4.model</span><span class=\"pl-k x x-last\">.</span>Person</span>();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t<span class=\"pl-smi\">Person</span> person <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">Person</span>();</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "varung-31", "createdAt": "2020-07-15T13:19:17Z", "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProviderWebTest.java", "diffHunk": "@@ -441,4 +457,88 @@ private MockHttpServletResponse getPersonHistoryByIdRequest() throws IOException\n \t\treturn get(\"/Person/\" + PERSON_UUID + \"/_history\").accept(FhirMediaTypes.JSON).go();\n \t}\n \t\n+\t@Test\n+\tpublic void createPerson_shouldCreatePerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();", "originalCommit": "9e3ffaa6f7722dda94d061c582bcbac37297f1c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0NDQ4MA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455044480", "body": "```suggestion\r\n\t\twhen(personService.create(any(Person.class))).thenReturn(person);\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\twhen(personService.create(any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n          \n          \n            \n            \t\twhen(personService.create(any(Person.class))).thenReturn(person);", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\twhen(personService<span class=\"pl-k\">.</span>create(any(<span class=\"pl-smi\"><span class=\"x x-first\">org.hl7.fhir.r4.model</span><span class=\"pl-k x x-last\">.</span>Person</span><span class=\"pl-k\">.</span>class)))<span class=\"pl-k\">.</span>thenReturn(person);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\twhen(personService<span class=\"pl-k\">.</span>create(any(<span class=\"pl-smi\">Person</span><span class=\"pl-k\">.</span>class)))<span class=\"pl-k\">.</span>thenReturn(person);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "varung-31", "createdAt": "2020-07-15T13:19:25Z", "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProviderWebTest.java", "diffHunk": "@@ -441,4 +457,88 @@ private MockHttpServletResponse getPersonHistoryByIdRequest() throws IOException\n \t\treturn get(\"/Person/\" + PERSON_UUID + \"/_history\").accept(FhirMediaTypes.JSON).go();\n \t}\n \t\n+\t@Test\n+\tpublic void createPerson_shouldCreatePerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.create(any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);", "originalCommit": "9e3ffaa6f7722dda94d061c582bcbac37297f1c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0NDY3Mg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455044672", "body": "```suggestion\r\n\t\tPerson person = new Person();\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n          \n          \n            \n            \t\tPerson person = new Person();", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t<span class=\"pl-smi\"><span class=\"x x-first\">org.hl7.fhir.r4.model</span><span class=\"pl-k x x-last\">.</span>Person</span> person <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\"><span class=\"x x-first\">org.hl7.fhir.r4.model</span><span class=\"pl-k x x-last\">.</span>Person</span>();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t<span class=\"pl-smi\">Person</span> person <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">Person</span>();</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "varung-31", "createdAt": "2020-07-15T13:19:39Z", "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProviderWebTest.java", "diffHunk": "@@ -441,4 +457,88 @@ private MockHttpServletResponse getPersonHistoryByIdRequest() throws IOException\n \t\treturn get(\"/Person/\" + PERSON_UUID + \"/_history\").accept(FhirMediaTypes.JSON).go();\n \t}\n \t\n+\t@Test\n+\tpublic void createPerson_shouldCreatePerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.create(any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\n+\t\tMockHttpServletResponse response = post(\"/Person\").jsonContent(jsonPerson).accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isCreated());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldUpdateExistingPerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();", "originalCommit": "9e3ffaa6f7722dda94d061c582bcbac37297f1c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0NDc4Mg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455044782", "body": "```suggestion\r\n\t\twhen(personService.update(anyString(), any(Person.class))).thenReturn(person);\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\twhen(personService.update(anyString(), any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n          \n          \n            \n            \t\twhen(personService.update(anyString(), any(Person.class))).thenReturn(person);", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\twhen(personService<span class=\"pl-k\">.</span>update(anyString(), any(<span class=\"pl-smi\"><span class=\"x x-first\">org.hl7.fhir.r4.model</span><span class=\"pl-k x x-last\">.</span>Person</span><span class=\"pl-k\">.</span>class)))<span class=\"pl-k\">.</span>thenReturn(person);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\twhen(personService<span class=\"pl-k\">.</span>update(anyString(), any(<span class=\"pl-smi\">Person</span><span class=\"pl-k\">.</span>class)))<span class=\"pl-k\">.</span>thenReturn(person);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "varung-31", "createdAt": "2020-07-15T13:19:47Z", "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProviderWebTest.java", "diffHunk": "@@ -441,4 +457,88 @@ private MockHttpServletResponse getPersonHistoryByIdRequest() throws IOException\n \t\treturn get(\"/Person/\" + PERSON_UUID + \"/_history\").accept(FhirMediaTypes.JSON).go();\n \t}\n \t\n+\t@Test\n+\tpublic void createPerson_shouldCreatePerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.create(any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\n+\t\tMockHttpServletResponse response = post(\"/Person\").jsonContent(jsonPerson).accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isCreated());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldUpdateExistingPerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.update(anyString(), any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);", "originalCommit": "9e3ffaa6f7722dda94d061c582bcbac37297f1c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0NTA3Ng==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455045076", "body": "```suggestion\r\n\tpublic void updatePerson_shouldThrowErrorForNoId() throws Exception {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tpublic void updatePerson_shouldErrorForNoId() throws Exception {\n          \n          \n            \n            \tpublic void updatePerson_shouldThrowErrorForNoId() throws Exception {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t<span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"x x-first x-last\">updatePerson_shouldErrorForNoId</span>() throws <span class=\"pl-smi\">Exception</span> {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t<span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"x x-first x-last\">updatePerson_shouldThrowErrorForNoId</span>() throws <span class=\"pl-smi\">Exception</span> {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "varung-31", "createdAt": "2020-07-15T13:20:10Z", "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProviderWebTest.java", "diffHunk": "@@ -441,4 +457,88 @@ private MockHttpServletResponse getPersonHistoryByIdRequest() throws IOException\n \t\treturn get(\"/Person/\" + PERSON_UUID + \"/_history\").accept(FhirMediaTypes.JSON).go();\n \t}\n \t\n+\t@Test\n+\tpublic void createPerson_shouldCreatePerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.create(any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\n+\t\tMockHttpServletResponse response = post(\"/Person\").jsonContent(jsonPerson).accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isCreated());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldUpdateExistingPerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.update(anyString(), any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\n+\t\tMockHttpServletResponse response = put(\"/Person/\" + PERSON_UUID).jsonContent(jsonPerson).accept(FhirMediaTypes.JSON)\n+\t\t        .go();\n+\t\tassertThat(response, isOk());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldErrorForNoId() throws Exception {", "originalCommit": "9e3ffaa6f7722dda94d061c582bcbac37297f1c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0NTM0Nw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455045347", "body": "```suggestion\r\n\tpublic void updatePerson_shouldThrowErrorForIdMisMatch() throws Exception {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tpublic void updatePerson_shouldErrorForIdMissMatch() throws Exception {\n          \n          \n            \n            \tpublic void updatePerson_shouldThrowErrorForIdMisMatch() throws Exception {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t<span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"x x-first x-last\">updatePerson_shouldErrorForIdMissMatch</span>() throws <span class=\"pl-smi\">Exception</span> {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t<span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"x x-first x-last\">updatePerson_shouldThrowErrorForIdMisMatch</span>() throws <span class=\"pl-smi\">Exception</span> {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "varung-31", "createdAt": "2020-07-15T13:20:29Z", "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProviderWebTest.java", "diffHunk": "@@ -441,4 +457,88 @@ private MockHttpServletResponse getPersonHistoryByIdRequest() throws IOException\n \t\treturn get(\"/Person/\" + PERSON_UUID + \"/_history\").accept(FhirMediaTypes.JSON).go();\n \t}\n \t\n+\t@Test\n+\tpublic void createPerson_shouldCreatePerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.create(any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\n+\t\tMockHttpServletResponse response = post(\"/Person\").jsonContent(jsonPerson).accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isCreated());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldUpdateExistingPerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.update(anyString(), any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\n+\t\tMockHttpServletResponse response = put(\"/Person/\" + PERSON_UUID).jsonContent(jsonPerson).accept(FhirMediaTypes.JSON)\n+\t\t        .go();\n+\t\tassertThat(response, isOk());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldErrorForNoId() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PERSON_NO_ID_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\tMockHttpServletResponse response = put(\"/Person/\" + PERSON_UUID).jsonContent(jsonPerson).accept(FhirMediaTypes.JSON)\n+\t\t        .go();\n+\n+\t\tassertThat(response, isBadRequest());\n+\t\tassertThat(response.getContentAsString(),\n+\t\t\t\tcontainsStringIgnoringCase(\"body must contain an ID element for update\"));\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldErrorForIdMissMatch() throws Exception {", "originalCommit": "9e3ffaa6f7722dda94d061c582bcbac37297f1c1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0NTQ4Mg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455045482", "body": "```suggestion\r\n\t\tPerson person = new Person();\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n          \n          \n            \n            \t\tPerson person = new Person();", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t<span class=\"pl-smi\"><span class=\"x x-first\">org.hl7.fhir.r4.model</span><span class=\"pl-k x x-last\">.</span>Person</span> person <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\"><span class=\"x x-first\">org.hl7.fhir.r4.model</span><span class=\"pl-k x x-last\">.</span>Person</span>();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t<span class=\"pl-smi\">Person</span> person <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">Person</span>();</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "varung-31", "createdAt": "2020-07-15T13:20:40Z", "path": "omod/src/test/java/org/openmrs/module/fhir2/providers/r4/PersonFhirResourceProviderWebTest.java", "diffHunk": "@@ -441,4 +457,88 @@ private MockHttpServletResponse getPersonHistoryByIdRequest() throws IOException\n \t\treturn get(\"/Person/\" + PERSON_UUID + \"/_history\").accept(FhirMediaTypes.JSON).go();\n \t}\n \t\n+\t@Test\n+\tpublic void createPerson_shouldCreatePerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_CREATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.create(any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\n+\t\tMockHttpServletResponse response = post(\"/Person\").jsonContent(jsonPerson).accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isCreated());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldUpdateExistingPerson() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PERSON_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();\n+\t\tperson.setId(PERSON_UUID);\n+\n+\t\twhen(personService.update(anyString(), any(org.hl7.fhir.r4.model.Person.class))).thenReturn(person);\n+\n+\t\tMockHttpServletResponse response = put(\"/Person/\" + PERSON_UUID).jsonContent(jsonPerson).accept(FhirMediaTypes.JSON)\n+\t\t        .go();\n+\t\tassertThat(response, isOk());\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldErrorForNoId() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PERSON_NO_ID_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\tMockHttpServletResponse response = put(\"/Person/\" + PERSON_UUID).jsonContent(jsonPerson).accept(FhirMediaTypes.JSON)\n+\t\t        .go();\n+\n+\t\tassertThat(response, isBadRequest());\n+\t\tassertThat(response.getContentAsString(),\n+\t\t\t\tcontainsStringIgnoringCase(\"body must contain an ID element for update\"));\n+\t}\n+\n+\t@Test\n+\tpublic void updatePerson_shouldErrorForIdMissMatch() throws Exception {\n+\t\tString jsonPerson;\n+\t\ttry (InputStream is = this.getClass().getClassLoader().getResourceAsStream(JSON_UPDATE_PERSON_WRONG_ID_PATH)) {\n+\t\t\tObjects.requireNonNull(is);\n+\t\t\tjsonPerson = IOUtils.toString(is, StandardCharsets.UTF_8);\n+\t\t}\n+\n+\t\tMockHttpServletResponse response = put(\"/Person/\" + WRONG_PERSON_UUID).jsonContent(jsonPerson)\n+\t\t\t\t.accept(FhirMediaTypes.JSON).go();\n+\n+\t\tassertThat(response, isBadRequest());\n+\t\tassertThat(response.getContentAsString(),\n+\t\t\t\tcontainsStringIgnoringCase(\"body must contain an ID element which matches the request URL\"));\n+\t}\n+\n+\t@Test\n+\tpublic void deletePerson_shouldDeletePerson() throws Exception {\n+\t\tOperationOutcome retVal = new OperationOutcome();\n+\t\tretVal.setId(PERSON_UUID);\n+\t\tretVal.getText().setDivAsString(\"Deleted successfully\");\n+\n+\t\torg.hl7.fhir.r4.model.Person person = new org.hl7.fhir.r4.model.Person();", "originalCommit": "9e3ffaa6f7722dda94d061c582bcbac37297f1c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEwMjE1Nw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/230#discussion_r455102157", "bodyText": "fixed it", "author": "gitcliff", "createdAt": "2020-07-15T14:37:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTA0NTQ4Mg=="}], "type": "inlineReview"}, {"oid": "522029dd38e8a8c0b781da2cb3d5d9e1c94fec09", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/522029dd38e8a8c0b781da2cb3d5d9e1c94fec09", "message": "FM2-221:Add create, update, and delete for Person", "committedDate": "2020-07-15T13:51:34Z", "type": "commit"}, {"oid": "3735f14b14e933a0d29aab64a4418105cfef73d1", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/3735f14b14e933a0d29aab64a4418105cfef73d1", "message": "FM2-221:removing extra spaces", "committedDate": "2020-07-15T13:51:35Z", "type": "commit"}, {"oid": "b544ee9f488117ffa392b0bfef5904b20e69fcb4", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/b544ee9f488117ffa392b0bfef5904b20e69fcb4", "message": "FM2-221:fixing formattings", "committedDate": "2020-07-15T13:51:37Z", "type": "commit"}, {"oid": "22b384d3732bef71c66c07e877a570e74237e789", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/22b384d3732bef71c66c07e877a570e74237e789", "message": "FM2-221:fixing formats", "committedDate": "2020-07-15T14:29:15Z", "type": "commit"}, {"oid": "22b384d3732bef71c66c07e877a570e74237e789", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/22b384d3732bef71c66c07e877a570e74237e789", "message": "FM2-221:fixing formats", "committedDate": "2020-07-15T14:29:15Z", "type": "forcePushed"}, {"oid": "c62017aadbb2ee57d497dd95343c17917cf9da33", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/c62017aadbb2ee57d497dd95343c17917cf9da33", "message": "FM2-221:Fix formattings", "committedDate": "2020-07-15T18:43:17Z", "type": "commit"}, {"oid": "490d9d485020b691646e60f6628b99c9a97a9f4c", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/490d9d485020b691646e60f6628b99c9a97a9f4c", "message": "Update PersonWebTest_create.json", "committedDate": "2020-07-20T18:59:18Z", "type": "commit"}, {"oid": "cc8042ca3474054b8bde66c0a21f34deca89018b", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/cc8042ca3474054b8bde66c0a21f34deca89018b", "message": "Update PersonWebTest_UpdateWithWrongId.json", "committedDate": "2020-07-20T18:59:35Z", "type": "commit"}]}