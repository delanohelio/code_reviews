{"pr_number": 82, "pr_title": "FM2-61 Add support for Observation.referenceRange", "pr_author": "VaishSiddharth", "pr_createdAt": "2020-02-21T14:21:09Z", "pr_url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxMTQ0Mg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382611442", "body": "This class should have the annotations `@Component` and `@Setter(AccessLevel.PACKAGE)`. The first of those annotations registers this with Spring so it can be `@Inject`ed where appropriate. [A little more on that here](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/stereotype/Component.html). The second tells [Lombok](https://projectlombok.org/features/GetterSetter) to generate a setter.", "bodyText": "This class should have the annotations @Component and @Setter(AccessLevel.PACKAGE). The first of those annotations registers this with Spring so it can be @Injected where appropriate. A little more on that here. The second tells Lombok to generate a setter.", "bodyHTML": "<p dir=\"auto\">This class should have the annotations <code>@Component</code> and <code>@Setter(AccessLevel.PACKAGE)</code>. The first of those annotations registers this with Spring so it can be <code>@Inject</code>ed where appropriate. <a href=\"https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/stereotype/Component.html\" rel=\"nofollow\">A little more on that here</a>. The second tells <a href=\"https://projectlombok.org/features/GetterSetter\" rel=\"nofollow\">Lombok</a> to generate a setter.</p>", "author": "ibacher", "createdAt": "2020-02-21T14:31:14Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ObservationReferenceRangeTranslatorImpl.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.hl7.fhir.r4.model.CodeableConcept;\n+import org.hl7.fhir.r4.model.Observation;\n+import org.hl7.fhir.r4.model.Quantity;\n+import org.openmrs.ConceptNumeric;\n+import org.openmrs.module.fhir2.api.translators.ObservationReferenceRangeTranslator;\n+\n+public class ObservationReferenceRangeTranslatorImpl implements ObservationReferenceRangeTranslator {", "originalCommit": "2fe7a2a9399943b88db6a7d03c69ed3297ac6244", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxMTg1NA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382611854", "body": "I think it's preferable for these constants to go in the `FhirConstants` class.", "bodyText": "I think it's preferable for these constants to go in the FhirConstants class.", "bodyHTML": "<p dir=\"auto\">I think it's preferable for these constants to go in the <code>FhirConstants</code> class.</p>", "author": "ibacher", "createdAt": "2020-02-21T14:32:02Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ObservationReferenceRangeTranslatorImpl.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.hl7.fhir.r4.model.CodeableConcept;\n+import org.hl7.fhir.r4.model.Observation;\n+import org.hl7.fhir.r4.model.Quantity;\n+import org.openmrs.ConceptNumeric;\n+import org.openmrs.module.fhir2.api.translators.ObservationReferenceRangeTranslator;\n+\n+public class ObservationReferenceRangeTranslatorImpl implements ObservationReferenceRangeTranslator {\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_RANGE_URI = \"http://terminology.hl7.org/CodeSystem/referencerange-meaning\";", "originalCommit": "2fe7a2a9399943b88db6a7d03c69ed3297ac6244", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxMjI3Mw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382612273", "body": "Move this line to above 41", "bodyText": "Move this line to above 41", "bodyHTML": "<p dir=\"auto\">Move this line to above 41</p>", "author": "ibacher", "createdAt": "2020-02-21T14:32:50Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ObservationReferenceRangeTranslatorImpl.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.hl7.fhir.r4.model.CodeableConcept;\n+import org.hl7.fhir.r4.model.Observation;\n+import org.hl7.fhir.r4.model.Quantity;\n+import org.openmrs.ConceptNumeric;\n+import org.openmrs.module.fhir2.api.translators.ObservationReferenceRangeTranslator;\n+\n+public class ObservationReferenceRangeTranslatorImpl implements ObservationReferenceRangeTranslator {\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_RANGE_URI = \"http://terminology.hl7.org/CodeSystem/referencerange-meaning\";\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_NORMAL = \"normal\";\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_TREATMENT = \"treatment\";\n+\t\n+\t@Override\n+\tpublic List<Observation.ObservationReferenceRangeComponent> toFhirResource(ConceptNumeric conceptNumeric) {\n+\t\tif (conceptNumeric != null) {\n+\t\t\tList<Observation.ObservationReferenceRangeComponent> observationReferenceRangeComponentList = new ArrayList<>();\n+\t\t\tObservation.ObservationReferenceRangeComponent rangeComponentNormal = new Observation.ObservationReferenceRangeComponent();\n+\t\t\tObservation.ObservationReferenceRangeComponent rangeComponentTreatment = new Observation.ObservationReferenceRangeComponent();", "originalCommit": "2fe7a2a9399943b88db6a7d03c69ed3297ac6244", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxMjQzMw==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382612433", "body": "Remove this blank line", "bodyText": "Remove this blank line", "bodyHTML": "<p dir=\"auto\">Remove this blank line</p>", "author": "ibacher", "createdAt": "2020-02-21T14:33:07Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ObservationReferenceRangeTranslatorImpl.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.hl7.fhir.r4.model.CodeableConcept;\n+import org.hl7.fhir.r4.model.Observation;\n+import org.hl7.fhir.r4.model.Quantity;\n+import org.openmrs.ConceptNumeric;\n+import org.openmrs.module.fhir2.api.translators.ObservationReferenceRangeTranslator;\n+\n+public class ObservationReferenceRangeTranslatorImpl implements ObservationReferenceRangeTranslator {\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_RANGE_URI = \"http://terminology.hl7.org/CodeSystem/referencerange-meaning\";\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_NORMAL = \"normal\";\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_TREATMENT = \"treatment\";\n+\t\n+\t@Override\n+\tpublic List<Observation.ObservationReferenceRangeComponent> toFhirResource(ConceptNumeric conceptNumeric) {\n+\t\tif (conceptNumeric != null) {\n+\t\t\tList<Observation.ObservationReferenceRangeComponent> observationReferenceRangeComponentList = new ArrayList<>();\n+\t\t\tObservation.ObservationReferenceRangeComponent rangeComponentNormal = new Observation.ObservationReferenceRangeComponent();\n+\t\t\tObservation.ObservationReferenceRangeComponent rangeComponentTreatment = new Observation.ObservationReferenceRangeComponent();\n+\t\t\trangeComponentNormal.setHigh(new Quantity().setValue(conceptNumeric.getHiNormal()));\n+\t\t\trangeComponentNormal.setLow(new Quantity().setValue(conceptNumeric.getLowNormal()));\n+\t\t\tCodeableConcept codeableConcept = new CodeableConcept();\n+\t\t\tcodeableConcept.addCoding().setCode(OBSERVATION_REFERENCE_NORMAL).setSystem(OBSERVATION_REFERENCE_RANGE_URI);\n+\t\t\trangeComponentNormal.setType(codeableConcept);\n+\t\t\tobservationReferenceRangeComponentList.add(rangeComponentNormal);\n+\t\t\t\n+\t\t\tif (conceptNumeric.getHiCritical() != null || conceptNumeric.getLowCritical() != null) {\n+\t\t\t\trangeComponentTreatment.setHigh(new Quantity().setValue(conceptNumeric.getHiCritical()));\n+\t\t\t\trangeComponentTreatment.setLow(new Quantity().setValue(conceptNumeric.getLowCritical()));\n+\t\t\t\tCodeableConcept codeableConceptCritical = new CodeableConcept();\n+\t\t\t\tcodeableConceptCritical.addCoding().setCode(OBSERVATION_REFERENCE_TREATMENT)\n+\t\t\t\t        .setSystem(OBSERVATION_REFERENCE_RANGE_URI);\n+\t\t\t\trangeComponentTreatment.setType(codeableConceptCritical);\n+\t\t\t\tobservationReferenceRangeComponentList.add(rangeComponentTreatment);\n+\t\t\t\t", "originalCommit": "2fe7a2a9399943b88db6a7d03c69ed3297ac6244", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxMjY0NQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382612645", "body": "Add a blank line before this one", "bodyText": "Add a blank line before this one", "bodyHTML": "<p dir=\"auto\">Add a blank line before this one</p>", "author": "ibacher", "createdAt": "2020-02-21T14:33:29Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ObservationReferenceRangeTranslatorImpl.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.hl7.fhir.r4.model.CodeableConcept;\n+import org.hl7.fhir.r4.model.Observation;\n+import org.hl7.fhir.r4.model.Quantity;\n+import org.openmrs.ConceptNumeric;\n+import org.openmrs.module.fhir2.api.translators.ObservationReferenceRangeTranslator;\n+\n+public class ObservationReferenceRangeTranslatorImpl implements ObservationReferenceRangeTranslator {\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_RANGE_URI = \"http://terminology.hl7.org/CodeSystem/referencerange-meaning\";\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_NORMAL = \"normal\";\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_TREATMENT = \"treatment\";\n+\t\n+\t@Override\n+\tpublic List<Observation.ObservationReferenceRangeComponent> toFhirResource(ConceptNumeric conceptNumeric) {\n+\t\tif (conceptNumeric != null) {\n+\t\t\tList<Observation.ObservationReferenceRangeComponent> observationReferenceRangeComponentList = new ArrayList<>();\n+\t\t\tObservation.ObservationReferenceRangeComponent rangeComponentNormal = new Observation.ObservationReferenceRangeComponent();\n+\t\t\tObservation.ObservationReferenceRangeComponent rangeComponentTreatment = new Observation.ObservationReferenceRangeComponent();\n+\t\t\trangeComponentNormal.setHigh(new Quantity().setValue(conceptNumeric.getHiNormal()));\n+\t\t\trangeComponentNormal.setLow(new Quantity().setValue(conceptNumeric.getLowNormal()));\n+\t\t\tCodeableConcept codeableConcept = new CodeableConcept();\n+\t\t\tcodeableConcept.addCoding().setCode(OBSERVATION_REFERENCE_NORMAL).setSystem(OBSERVATION_REFERENCE_RANGE_URI);\n+\t\t\trangeComponentNormal.setType(codeableConcept);\n+\t\t\tobservationReferenceRangeComponentList.add(rangeComponentNormal);\n+\t\t\t\n+\t\t\tif (conceptNumeric.getHiCritical() != null || conceptNumeric.getLowCritical() != null) {\n+\t\t\t\trangeComponentTreatment.setHigh(new Quantity().setValue(conceptNumeric.getHiCritical()));\n+\t\t\t\trangeComponentTreatment.setLow(new Quantity().setValue(conceptNumeric.getLowCritical()));\n+\t\t\t\tCodeableConcept codeableConceptCritical = new CodeableConcept();\n+\t\t\t\tcodeableConceptCritical.addCoding().setCode(OBSERVATION_REFERENCE_TREATMENT)\n+\t\t\t\t        .setSystem(OBSERVATION_REFERENCE_RANGE_URI);\n+\t\t\t\trangeComponentTreatment.setType(codeableConceptCritical);\n+\t\t\t\tobservationReferenceRangeComponentList.add(rangeComponentTreatment);\n+\t\t\t\t\n+\t\t\t} else if (conceptNumeric.getHiAbsolute() != null || conceptNumeric.getLowAbsolute() != null) {\n+\t\t\t\trangeComponentTreatment.setHigh(new Quantity().setValue(conceptNumeric.getHiAbsolute()));\n+\t\t\t\trangeComponentTreatment.setLow(new Quantity().setValue(conceptNumeric.getLowAbsolute()));\n+\t\t\t\tCodeableConcept codeableConceptAbsolute = new CodeableConcept();\n+\t\t\t\tcodeableConceptAbsolute.addCoding().setCode(OBSERVATION_REFERENCE_TREATMENT)\n+\t\t\t\t        .setSystem(OBSERVATION_REFERENCE_RANGE_URI);\n+\t\t\t\trangeComponentTreatment.setType(codeableConceptAbsolute);\n+\t\t\t\tobservationReferenceRangeComponentList.add(rangeComponentTreatment);\n+\t\t\t}\n+\t\t\treturn observationReferenceRangeComponentList;", "originalCommit": "2fe7a2a9399943b88db6a7d03c69ed3297ac6244", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxMjc3Mg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382612772", "body": "Add a blank line before this", "bodyText": "Add a blank line before this", "bodyHTML": "<p dir=\"auto\">Add a blank line before this</p>", "author": "ibacher", "createdAt": "2020-02-21T14:33:40Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ObservationReferenceRangeTranslatorImpl.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.hl7.fhir.r4.model.CodeableConcept;\n+import org.hl7.fhir.r4.model.Observation;\n+import org.hl7.fhir.r4.model.Quantity;\n+import org.openmrs.ConceptNumeric;\n+import org.openmrs.module.fhir2.api.translators.ObservationReferenceRangeTranslator;\n+\n+public class ObservationReferenceRangeTranslatorImpl implements ObservationReferenceRangeTranslator {\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_RANGE_URI = \"http://terminology.hl7.org/CodeSystem/referencerange-meaning\";\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_NORMAL = \"normal\";\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_TREATMENT = \"treatment\";\n+\t\n+\t@Override\n+\tpublic List<Observation.ObservationReferenceRangeComponent> toFhirResource(ConceptNumeric conceptNumeric) {\n+\t\tif (conceptNumeric != null) {\n+\t\t\tList<Observation.ObservationReferenceRangeComponent> observationReferenceRangeComponentList = new ArrayList<>();\n+\t\t\tObservation.ObservationReferenceRangeComponent rangeComponentNormal = new Observation.ObservationReferenceRangeComponent();\n+\t\t\tObservation.ObservationReferenceRangeComponent rangeComponentTreatment = new Observation.ObservationReferenceRangeComponent();\n+\t\t\trangeComponentNormal.setHigh(new Quantity().setValue(conceptNumeric.getHiNormal()));\n+\t\t\trangeComponentNormal.setLow(new Quantity().setValue(conceptNumeric.getLowNormal()));\n+\t\t\tCodeableConcept codeableConcept = new CodeableConcept();\n+\t\t\tcodeableConcept.addCoding().setCode(OBSERVATION_REFERENCE_NORMAL).setSystem(OBSERVATION_REFERENCE_RANGE_URI);\n+\t\t\trangeComponentNormal.setType(codeableConcept);\n+\t\t\tobservationReferenceRangeComponentList.add(rangeComponentNormal);\n+\t\t\t\n+\t\t\tif (conceptNumeric.getHiCritical() != null || conceptNumeric.getLowCritical() != null) {\n+\t\t\t\trangeComponentTreatment.setHigh(new Quantity().setValue(conceptNumeric.getHiCritical()));\n+\t\t\t\trangeComponentTreatment.setLow(new Quantity().setValue(conceptNumeric.getLowCritical()));\n+\t\t\t\tCodeableConcept codeableConceptCritical = new CodeableConcept();\n+\t\t\t\tcodeableConceptCritical.addCoding().setCode(OBSERVATION_REFERENCE_TREATMENT)\n+\t\t\t\t        .setSystem(OBSERVATION_REFERENCE_RANGE_URI);\n+\t\t\t\trangeComponentTreatment.setType(codeableConceptCritical);\n+\t\t\t\tobservationReferenceRangeComponentList.add(rangeComponentTreatment);\n+\t\t\t\t\n+\t\t\t} else if (conceptNumeric.getHiAbsolute() != null || conceptNumeric.getLowAbsolute() != null) {\n+\t\t\t\trangeComponentTreatment.setHigh(new Quantity().setValue(conceptNumeric.getHiAbsolute()));\n+\t\t\t\trangeComponentTreatment.setLow(new Quantity().setValue(conceptNumeric.getLowAbsolute()));\n+\t\t\t\tCodeableConcept codeableConceptAbsolute = new CodeableConcept();", "originalCommit": "2fe7a2a9399943b88db6a7d03c69ed3297ac6244", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxMjgzNA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382612834", "body": "Add a blank line before this", "bodyText": "Add a blank line before this", "bodyHTML": "<p dir=\"auto\">Add a blank line before this</p>", "author": "ibacher", "createdAt": "2020-02-21T14:33:49Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ObservationReferenceRangeTranslatorImpl.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.hl7.fhir.r4.model.CodeableConcept;\n+import org.hl7.fhir.r4.model.Observation;\n+import org.hl7.fhir.r4.model.Quantity;\n+import org.openmrs.ConceptNumeric;\n+import org.openmrs.module.fhir2.api.translators.ObservationReferenceRangeTranslator;\n+\n+public class ObservationReferenceRangeTranslatorImpl implements ObservationReferenceRangeTranslator {\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_RANGE_URI = \"http://terminology.hl7.org/CodeSystem/referencerange-meaning\";\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_NORMAL = \"normal\";\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_TREATMENT = \"treatment\";\n+\t\n+\t@Override\n+\tpublic List<Observation.ObservationReferenceRangeComponent> toFhirResource(ConceptNumeric conceptNumeric) {\n+\t\tif (conceptNumeric != null) {\n+\t\t\tList<Observation.ObservationReferenceRangeComponent> observationReferenceRangeComponentList = new ArrayList<>();\n+\t\t\tObservation.ObservationReferenceRangeComponent rangeComponentNormal = new Observation.ObservationReferenceRangeComponent();\n+\t\t\tObservation.ObservationReferenceRangeComponent rangeComponentTreatment = new Observation.ObservationReferenceRangeComponent();\n+\t\t\trangeComponentNormal.setHigh(new Quantity().setValue(conceptNumeric.getHiNormal()));\n+\t\t\trangeComponentNormal.setLow(new Quantity().setValue(conceptNumeric.getLowNormal()));\n+\t\t\tCodeableConcept codeableConcept = new CodeableConcept();\n+\t\t\tcodeableConcept.addCoding().setCode(OBSERVATION_REFERENCE_NORMAL).setSystem(OBSERVATION_REFERENCE_RANGE_URI);\n+\t\t\trangeComponentNormal.setType(codeableConcept);\n+\t\t\tobservationReferenceRangeComponentList.add(rangeComponentNormal);\n+\t\t\t\n+\t\t\tif (conceptNumeric.getHiCritical() != null || conceptNumeric.getLowCritical() != null) {\n+\t\t\t\trangeComponentTreatment.setHigh(new Quantity().setValue(conceptNumeric.getHiCritical()));\n+\t\t\t\trangeComponentTreatment.setLow(new Quantity().setValue(conceptNumeric.getLowCritical()));\n+\t\t\t\tCodeableConcept codeableConceptCritical = new CodeableConcept();", "originalCommit": "2fe7a2a9399943b88db6a7d03c69ed3297ac6244", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxMjkwMg==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382612902", "body": "Add a blank line before this", "bodyText": "Add a blank line before this", "bodyHTML": "<p dir=\"auto\">Add a blank line before this</p>", "author": "ibacher", "createdAt": "2020-02-21T14:33:55Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ObservationReferenceRangeTranslatorImpl.java", "diffHunk": "@@ -0,0 +1,65 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.hl7.fhir.r4.model.CodeableConcept;\n+import org.hl7.fhir.r4.model.Observation;\n+import org.hl7.fhir.r4.model.Quantity;\n+import org.openmrs.ConceptNumeric;\n+import org.openmrs.module.fhir2.api.translators.ObservationReferenceRangeTranslator;\n+\n+public class ObservationReferenceRangeTranslatorImpl implements ObservationReferenceRangeTranslator {\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_RANGE_URI = \"http://terminology.hl7.org/CodeSystem/referencerange-meaning\";\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_NORMAL = \"normal\";\n+\t\n+\tprivate static final String OBSERVATION_REFERENCE_TREATMENT = \"treatment\";\n+\t\n+\t@Override\n+\tpublic List<Observation.ObservationReferenceRangeComponent> toFhirResource(ConceptNumeric conceptNumeric) {\n+\t\tif (conceptNumeric != null) {\n+\t\t\tList<Observation.ObservationReferenceRangeComponent> observationReferenceRangeComponentList = new ArrayList<>();\n+\t\t\tObservation.ObservationReferenceRangeComponent rangeComponentNormal = new Observation.ObservationReferenceRangeComponent();\n+\t\t\tObservation.ObservationReferenceRangeComponent rangeComponentTreatment = new Observation.ObservationReferenceRangeComponent();\n+\t\t\trangeComponentNormal.setHigh(new Quantity().setValue(conceptNumeric.getHiNormal()));\n+\t\t\trangeComponentNormal.setLow(new Quantity().setValue(conceptNumeric.getLowNormal()));\n+\t\t\tCodeableConcept codeableConcept = new CodeableConcept();", "originalCommit": "2fe7a2a9399943b88db6a7d03c69ed3297ac6244", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxMzIzOA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382613238", "body": "Remove this blank line", "bodyText": "Remove this blank line", "bodyHTML": "<p dir=\"auto\">Remove this blank line</p>", "author": "ibacher", "createdAt": "2020-02-21T14:34:28Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ObservationTranslatorImpl.java", "diffHunk": "@@ -89,6 +95,14 @@ public Observation toFhirResource(Obs observation) {\n \t\t\n \t\tobs.addInterpretation(interpretationTranslator.toFhirResource(observation));\n \t\t\n+\t\tif (observation.getValueNumeric() != null) {\n+\t\t\tConcept concept = observation.getConcept();\n+\t\t\tif (concept instanceof ConceptNumeric) {\n+\t\t\t\tobs.setReferenceRange(referenceRangeTranslator.toFhirResource((ConceptNumeric) concept));\n+\t\t\t}\n+\t\t\t", "originalCommit": "2fe7a2a9399943b88db6a7d03c69ed3297ac6244", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxMzk3NA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382613974", "body": "We'll need to add a test to this class as well to ensure that it's invoking the `referenceRangeTranslator`. I think this can be modeled on the test for `ObservationInterpretationTranslator`", "bodyText": "We'll need to add a test to this class as well to ensure that it's invoking the referenceRangeTranslator. I think this can be modeled on the test for ObservationInterpretationTranslator", "bodyHTML": "<p dir=\"auto\">We'll need to add a test to this class as well to ensure that it's invoking the <code>referenceRangeTranslator</code>. I think this can be modeled on the test for <code>ObservationInterpretationTranslator</code></p>", "author": "ibacher", "createdAt": "2020-02-21T14:35:52Z", "path": "api/src/test/java/org/openmrs/module/fhir2/api/translators/impl/ObservationTranslatorImplTest.java", "diffHunk": "@@ -41,6 +41,7 @@\n import org.openmrs.module.fhir2.api.translators.EncounterReferenceTranslator;", "originalCommit": "2fe7a2a9399943b88db6a7d03c69ed3297ac6244", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYzMTE3NQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382631175", "bodyText": "@ibacher I have written this test please suggest edits\n@Test\n\tpublic void toFhirResource_shouldInvokereferenceRangeTranslator() {\n\t\tConceptNumeric conceptNumeric = new ConceptNumeric();\n\t\tconceptNumeric.setUuid(CONCEPT_UUID);\n\t\t\n\t\tList<Observation.ObservationReferenceRangeComponent> observationReferenceRangeComponentList = referenceRangeTranslator\n\t\t        .toFhirResource(conceptNumeric);\n\t\t\n\t\tassertThat(observationReferenceRangeComponentList, notNullValue());\n\t}", "author": "VaishSiddharth", "createdAt": "2020-02-21T15:05:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxMzk3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY4NTM1MA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382685350", "bodyText": "So what else should we expect about this list, other than its not just a null value? Should it have any Observation.ObservationReferenceRangeComponents or should it be empty?", "author": "ibacher", "createdAt": "2020-02-21T16:40:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxMzk3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY4NjE2Ng==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382686166", "bodyText": "Also, feel free to keep pushing changes to this branch. You only need to squash everything down to one commit before it's merged.", "author": "ibacher", "createdAt": "2020-02-21T16:41:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxMzk3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY5MzE3OA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382693178", "bodyText": "@ibacher Yes it should have items in it, so maybe something similar to what we did in ObservationReferenceRangeTranslatorImplTest\nassertThat(result, notNullValue());\n\t\tassertThat(result, hasItem(hasProperty(\"low\", hasProperty(\"value\", equalTo(BigDecimal.valueOf(LOW_NORMAL_VALUE))))));\n\t\tassertThat(result,\n\t\t    hasItem(hasProperty(\"high\", hasProperty(\"value\", equalTo(BigDecimal.valueOf(HIGH_NORMAL_VALUE))))));\n\t\t\n\t\tassertThat(result,\n\t\t    hasItem(allOf(hasProperty(\"low\", hasProperty(\"value\", equalTo(BigDecimal.valueOf(LOW_NORMAL_VALUE)))),\n\t\t        hasProperty(\"type\",\n\t\t            hasProperty(\"coding\",\n\t\t                hasItem(allOf(\n\t\t                    hasProperty(\"system\", equalTo(\"http://terminology.hl7.org/CodeSystem/referencerange-meaning\")),\n\t\t                    hasProperty(\"code\", equalTo(\"normal\")))))))));", "author": "VaishSiddharth", "createdAt": "2020-02-21T16:54:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxMzk3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjYxOTk1NA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382619954", "body": "```java\r\nassertThat(result,\r\n\t        hasItem(allOf(hasProperty(\"low\", hasProperty(\"value\", equalTo(BigDecimal.valueOf(LOW_NORMAL_VALUE)))),\r\n\t            hasProperty(\"type\", hasProperty(\"coding\", hasItem(allOf(hasProperty(\"system\", equalTo(\"http://terminology.hl7.org/CodeSystem/referencerange-meaning\")),\r\n\t                hasProperty(\"code\", equalTo(\"normal\")))))))));\r\n```\r\n\r\nI forgot that `type` has a `coding` property, which is the list of codes themselves which have the `system` and `code` properties.", "bodyText": "assertThat(result,\n\t        hasItem(allOf(hasProperty(\"low\", hasProperty(\"value\", equalTo(BigDecimal.valueOf(LOW_NORMAL_VALUE)))),\n\t            hasProperty(\"type\", hasProperty(\"coding\", hasItem(allOf(hasProperty(\"system\", equalTo(\"http://terminology.hl7.org/CodeSystem/referencerange-meaning\")),\n\t                hasProperty(\"code\", equalTo(\"normal\")))))))));\nI forgot that type has a coding property, which is the list of codes themselves which have the system and code properties.", "bodyHTML": "<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"assertThat(result,\n\t        hasItem(allOf(hasProperty(&quot;low&quot;, hasProperty(&quot;value&quot;, equalTo(BigDecimal.valueOf(LOW_NORMAL_VALUE)))),\n\t            hasProperty(&quot;type&quot;, hasProperty(&quot;coding&quot;, hasItem(allOf(hasProperty(&quot;system&quot;, equalTo(&quot;http://terminology.hl7.org/CodeSystem/referencerange-meaning&quot;)),\n\t                hasProperty(&quot;code&quot;, equalTo(&quot;normal&quot;)))))))));\"><pre>assertThat(result,\n\t        hasItem(allOf(hasProperty(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>low<span class=\"pl-pds\">\"</span></span>, hasProperty(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>value<span class=\"pl-pds\">\"</span></span>, equalTo(<span class=\"pl-smi\">BigDecimal</span><span class=\"pl-k\">.</span>valueOf(<span class=\"pl-c1\">LOW_NORMAL_VALUE</span>)))),\n\t            hasProperty(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span>, hasProperty(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>coding<span class=\"pl-pds\">\"</span></span>, hasItem(allOf(hasProperty(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>system<span class=\"pl-pds\">\"</span></span>, equalTo(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>http://terminology.hl7.org/CodeSystem/referencerange-meaning<span class=\"pl-pds\">\"</span></span>)),\n\t                hasProperty(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>code<span class=\"pl-pds\">\"</span></span>, equalTo(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>normal<span class=\"pl-pds\">\"</span></span>)))))))));</pre></div>\n<p dir=\"auto\">I forgot that <code>type</code> has a <code>coding</code> property, which is the list of codes themselves which have the <code>system</code> and <code>code</code> properties.</p>", "author": "ibacher", "createdAt": "2020-02-21T14:46:16Z", "path": "api/src/test/java/org/openmrs/module/fhir2/api/translators/impl/ObservationReferenceRangeTranslatorImplTest.java", "diffHunk": "@@ -0,0 +1,76 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import static org.hamcrest.MatcherAssert.assertThat;\n+import static org.hamcrest.Matchers.equalTo;\n+import static org.hamcrest.Matchers.hasItem;\n+import static org.hamcrest.Matchers.hasProperty;\n+import static org.hamcrest.Matchers.notNullValue;\n+\n+import java.math.BigDecimal;\n+import java.util.List;\n+\n+import org.hl7.fhir.r4.model.Observation;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.openmrs.ConceptNumeric;\n+\n+public class ObservationReferenceRangeTranslatorImplTest {\n+\t\n+\tprivate static final Double LOW_NORMAL_VALUE = 1.0;\n+\t\n+\tprivate static final Double HIGH_NORMAL_VALUE = 2.0;\n+\t\n+\tprivate static final Double LOW_ABSOLUTE_VALUE = 3.0;\n+\t\n+\tprivate static final Double HIGH_ABSOLUTE_VALUE = 4.0;\n+\t\n+\tprivate static final Double LOW_CRITICAL_VALUE = 5.0;\n+\t\n+\tprivate static final Double HIGH_CRITICAL_VALUE = 6.0;\n+\t\n+\tprivate ObservationReferenceRangeTranslatorImpl observationReferenceRangeTranslator;\n+\t\n+\tprivate static final String CONCEPT_UUID = \"12345-abcdef-12345\";\n+\t\n+\t@Before\n+\tpublic void setup() {\n+\t\tobservationReferenceRangeTranslator = new ObservationReferenceRangeTranslatorImpl();\n+\t}\n+\t\n+\t@Test\n+\tpublic void toFhirType_shouldMapObservationReferenceRangeToExpected() {\n+\t\t\n+\t\tConceptNumeric conceptNumeric = new ConceptNumeric();\n+\t\tconceptNumeric.setUuid(CONCEPT_UUID);\n+\t\t\n+\t\tconceptNumeric.setLowNormal(LOW_NORMAL_VALUE);\n+\t\tconceptNumeric.setHiNormal(HIGH_NORMAL_VALUE);\n+\t\tconceptNumeric.setLowAbsolute(LOW_ABSOLUTE_VALUE);\n+\t\tconceptNumeric.setHiAbsolute(HIGH_ABSOLUTE_VALUE);\n+\t\tconceptNumeric.setLowCritical(LOW_CRITICAL_VALUE);\n+\t\tconceptNumeric.setHiCritical(HIGH_CRITICAL_VALUE);\n+\t\t\n+\t\tList<Observation.ObservationReferenceRangeComponent> result = observationReferenceRangeTranslator\n+\t\t        .toFhirResource(conceptNumeric);\n+\t\t\n+\t\tassertThat(result, notNullValue());\n+\t\tassertThat(result, hasItem(hasProperty(\"low\", hasProperty(\"value\", equalTo(BigDecimal.valueOf(LOW_NORMAL_VALUE))))));\n+\t\tassertThat(result,\n+\t\t    hasItem(hasProperty(\"high\", hasProperty(\"value\", equalTo(BigDecimal.valueOf(HIGH_NORMAL_VALUE))))));\n+\t\t\n+\t\t//    assertThat(result,", "originalCommit": "2fe7a2a9399943b88db6a7d03c69ed3297ac6244", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjY5ODg2Ng==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382698866", "body": "You've got a lot of repeated code here. It might be better to break this out into a method like this:\r\n\r\n```java\r\nprivate Observation.ObservationReferenceRangeComponent createObservationReferenceRange(double hiValue, double lowValue, String code) {\r\n    Observation.ObservationReferenceRangeComponent component = new Observation.ObservationReferenceRangeComponent()\r\n        .setHigh(new Quantity().setValue(hiValue))\r\n        .setLow(new Quantity().setValue(lowValue));\r\n\r\n    CodeableConcept referenceRangeType = new CodeableConcept();\r\n    concept.addCoding().setCode(code).setSystem(FhirConstants.OBSERVATION_REFERENCE_RANGE_URI);\r\n    component.setType(codeableConcept);\r\n    \r\n    return component;\r\n}\r\n```\r\n\r\nYou can then call it like this:\r\n\r\n```java\r\nobservationReferenceRangeComponentList.add(createObservationReferenceRange(conceptNumeric.getHiNormal(), conceptNumeric.getLowNormal(), FhirConstants.OBSERVATION_REFERENCE_NORMAL));\r\n```", "bodyText": "You've got a lot of repeated code here. It might be better to break this out into a method like this:\nprivate Observation.ObservationReferenceRangeComponent createObservationReferenceRange(double hiValue, double lowValue, String code) {\n    Observation.ObservationReferenceRangeComponent component = new Observation.ObservationReferenceRangeComponent()\n        .setHigh(new Quantity().setValue(hiValue))\n        .setLow(new Quantity().setValue(lowValue));\n\n    CodeableConcept referenceRangeType = new CodeableConcept();\n    concept.addCoding().setCode(code).setSystem(FhirConstants.OBSERVATION_REFERENCE_RANGE_URI);\n    component.setType(codeableConcept);\n    \n    return component;\n}\nYou can then call it like this:\nobservationReferenceRangeComponentList.add(createObservationReferenceRange(conceptNumeric.getHiNormal(), conceptNumeric.getLowNormal(), FhirConstants.OBSERVATION_REFERENCE_NORMAL));", "bodyHTML": "<p dir=\"auto\">You've got a lot of repeated code here. It might be better to break this out into a method like this:</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"private Observation.ObservationReferenceRangeComponent createObservationReferenceRange(double hiValue, double lowValue, String code) {\n    Observation.ObservationReferenceRangeComponent component = new Observation.ObservationReferenceRangeComponent()\n        .setHigh(new Quantity().setValue(hiValue))\n        .setLow(new Quantity().setValue(lowValue));\n\n    CodeableConcept referenceRangeType = new CodeableConcept();\n    concept.addCoding().setCode(code).setSystem(FhirConstants.OBSERVATION_REFERENCE_RANGE_URI);\n    component.setType(codeableConcept);\n    \n    return component;\n}\"><pre><span class=\"pl-k\">private</span> <span class=\"pl-smi\">Observation</span><span class=\"pl-k\">.</span><span class=\"pl-smi\">ObservationReferenceRangeComponent</span> createObservationReferenceRange(<span class=\"pl-k\">double</span> hiValue, <span class=\"pl-k\">double</span> lowValue, <span class=\"pl-smi\">String</span> code) {\n    <span class=\"pl-smi\">Observation</span><span class=\"pl-k\">.</span><span class=\"pl-smi\">ObservationReferenceRangeComponent</span> component <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">Observation</span>.<span class=\"pl-smi\">ObservationReferenceRangeComponent</span>()\n        .setHigh(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">Quantity</span>()<span class=\"pl-k\">.</span>setValue(hiValue))\n        .setLow(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">Quantity</span>()<span class=\"pl-k\">.</span>setValue(lowValue));\n\n    <span class=\"pl-smi\">CodeableConcept</span> referenceRangeType <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">CodeableConcept</span>();\n    concept<span class=\"pl-k\">.</span>addCoding()<span class=\"pl-k\">.</span>setCode(code)<span class=\"pl-k\">.</span>setSystem(<span class=\"pl-smi\">FhirConstants</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>OBSERVATION_REFERENCE_RANGE_URI</span>);\n    component<span class=\"pl-k\">.</span>setType(codeableConcept);\n    \n    <span class=\"pl-k\">return</span> component;\n}</pre></div>\n<p dir=\"auto\">You can then call it like this:</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"observationReferenceRangeComponentList.add(createObservationReferenceRange(conceptNumeric.getHiNormal(), conceptNumeric.getLowNormal(), FhirConstants.OBSERVATION_REFERENCE_NORMAL));\"><pre>observationReferenceRangeComponentList<span class=\"pl-k\">.</span>add(createObservationReferenceRange(conceptNumeric<span class=\"pl-k\">.</span>getHiNormal(), conceptNumeric<span class=\"pl-k\">.</span>getLowNormal(), <span class=\"pl-smi\">FhirConstants</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>OBSERVATION_REFERENCE_NORMAL</span>));</pre></div>", "author": "ibacher", "createdAt": "2020-02-21T17:05:17Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/impl/ObservationReferenceRangeTranslatorImpl.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import lombok.AccessLevel;\n+import lombok.Setter;\n+import org.hl7.fhir.r4.model.CodeableConcept;\n+import org.hl7.fhir.r4.model.Observation;\n+import org.hl7.fhir.r4.model.Quantity;\n+import org.openmrs.ConceptNumeric;\n+import org.openmrs.module.fhir2.FhirConstants;\n+import org.openmrs.module.fhir2.api.translators.ObservationReferenceRangeTranslator;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+@Setter(AccessLevel.PACKAGE)\n+public class ObservationReferenceRangeTranslatorImpl implements ObservationReferenceRangeTranslator {\n+\t\n+\t@Override\n+\tpublic List<Observation.ObservationReferenceRangeComponent> toFhirResource(ConceptNumeric conceptNumeric) {\n+\t\tif (conceptNumeric != null) {\n+\t\t\tList<Observation.ObservationReferenceRangeComponent> observationReferenceRangeComponentList = new ArrayList<>();\n+\t\t\tObservation.ObservationReferenceRangeComponent rangeComponentNormal = new Observation.ObservationReferenceRangeComponent();", "originalCommit": "dcd4f8b19e15d8a60e88b7417f7835f002d03e00", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkxNjA2OA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382916068", "body": "Can we swap this out for the other testing style we talked about? I think that\u2019s more maintainable. Also, the checks here make the assertions above redundant (they verify the same thing), so I\u2019d remove the above assertions.", "bodyText": "Can we swap this out for the other testing style we talked about? I think that\u2019s more maintainable. Also, the checks here make the assertions above redundant (they verify the same thing), so I\u2019d remove the above assertions.", "bodyHTML": "<p dir=\"auto\">Can we swap this out for the other testing style we talked about? I think that\u2019s more maintainable. Also, the checks here make the assertions above redundant (they verify the same thing), so I\u2019d remove the above assertions.</p>", "author": "ibacher", "createdAt": "2020-02-22T14:24:49Z", "path": "api/src/test/java/org/openmrs/module/fhir2/api/translators/impl/ObservationReferenceRangeTranslatorImplTest.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators.impl;\n+\n+import static org.hamcrest.MatcherAssert.assertThat;\n+import static org.hamcrest.Matchers.allOf;\n+import static org.hamcrest.Matchers.equalTo;\n+import static org.hamcrest.Matchers.hasItem;\n+import static org.hamcrest.Matchers.hasProperty;\n+import static org.hamcrest.Matchers.notNullValue;\n+\n+import java.math.BigDecimal;\n+import java.util.List;\n+\n+import org.hl7.fhir.r4.model.Observation;\n+import org.junit.Before;\n+import org.junit.Test;\n+import org.openmrs.ConceptNumeric;\n+\n+public class ObservationReferenceRangeTranslatorImplTest {\n+\t\n+\tprivate static final Double LOW_NORMAL_VALUE = 1.0;\n+\t\n+\tprivate static final Double HIGH_NORMAL_VALUE = 2.0;\n+\t\n+\tprivate static final Double LOW_ABSOLUTE_VALUE = 3.0;\n+\t\n+\tprivate static final Double HIGH_ABSOLUTE_VALUE = 4.0;\n+\t\n+\tprivate static final Double LOW_CRITICAL_VALUE = 5.0;\n+\t\n+\tprivate static final Double HIGH_CRITICAL_VALUE = 6.0;\n+\t\n+\tprivate ObservationReferenceRangeTranslatorImpl observationReferenceRangeTranslator;\n+\t\n+\tprivate static final String CONCEPT_UUID = \"12345-abcdef-12345\";\n+\t\n+\t@Before\n+\tpublic void setup() {\n+\t\tobservationReferenceRangeTranslator = new ObservationReferenceRangeTranslatorImpl();\n+\t}\n+\t\n+\t@Test\n+\tpublic void toFhirType_shouldMapObservationReferenceRangeToExpected() {\n+\t\t\n+\t\tConceptNumeric conceptNumeric = new ConceptNumeric();\n+\t\tconceptNumeric.setUuid(CONCEPT_UUID);\n+\t\t\n+\t\tconceptNumeric.setLowNormal(LOW_NORMAL_VALUE);\n+\t\tconceptNumeric.setHiNormal(HIGH_NORMAL_VALUE);\n+\t\tconceptNumeric.setLowAbsolute(LOW_ABSOLUTE_VALUE);\n+\t\tconceptNumeric.setHiAbsolute(HIGH_ABSOLUTE_VALUE);\n+\t\tconceptNumeric.setLowCritical(LOW_CRITICAL_VALUE);\n+\t\tconceptNumeric.setHiCritical(HIGH_CRITICAL_VALUE);\n+\t\t\n+\t\tList<Observation.ObservationReferenceRangeComponent> result = observationReferenceRangeTranslator\n+\t\t        .toFhirResource(conceptNumeric);\n+\t\t\n+\t\tassertThat(result, notNullValue());\n+\t\tassertThat(result, hasItem(hasProperty(\"low\", hasProperty(\"value\", equalTo(BigDecimal.valueOf(LOW_NORMAL_VALUE))))));\n+\t\tassertThat(result,\n+\t\t    hasItem(hasProperty(\"high\", hasProperty(\"value\", equalTo(BigDecimal.valueOf(HIGH_NORMAL_VALUE))))));\n+\t\t\n+\t\tassertThat(result,", "originalCommit": "3c6511e5e7cb569c392d46e827d293c26792a366", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkxNjEzMQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/82#discussion_r382916131", "body": "Please remove this blank line", "bodyText": "Please remove this blank line", "bodyHTML": "<p dir=\"auto\">Please remove this blank line</p>", "author": "ibacher", "createdAt": "2020-02-22T14:25:34Z", "path": "api/src/main/java/org/openmrs/module/fhir2/api/translators/ObservationReferenceRangeTranslator.java", "diffHunk": "@@ -0,0 +1,22 @@\n+/*\n+ * This Source Code Form is subject to the terms of the Mozilla Public License,\n+ * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n+ * obtain one at http://mozilla.org/MPL/2.0/. OpenMRS is also distributed under\n+ * the terms of the Healthcare Disclaimer located at http://openmrs.org/license.\n+ *\n+ * Copyright (C) OpenMRS Inc. OpenMRS is a registered trademark and the OpenMRS\n+ * graphic logo is a trademark of OpenMRS Inc.\n+ */\n+package org.openmrs.module.fhir2.api.translators;\n+\n+import java.util.List;\n+\n+import org.hl7.fhir.r4.model.Observation;\n+import org.openmrs.ConceptNumeric;\n+\n+public interface ObservationReferenceRangeTranslator extends ToFhirTranslator<ConceptNumeric, List<Observation.ObservationReferenceRangeComponent>> {\n+\t\n+\t@Override\n+\tList<Observation.ObservationReferenceRangeComponent> toFhirResource(ConceptNumeric concept);\n+\t", "originalCommit": "3c6511e5e7cb569c392d46e827d293c26792a366", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "468f858b4e70a07cae1c2ae8bcc73a5e56fda197", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/468f858b4e70a07cae1c2ae8bcc73a5e56fda197", "message": "FM2-61 Add support for Observation.referenceRange", "committedDate": "2020-02-24T16:52:25Z", "type": "forcePushed"}, {"oid": "96dfb5305605cbb5ba56453ba968f8e0e28c0dd3", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/96dfb5305605cbb5ba56453ba968f8e0e28c0dd3", "message": "FM2-61 Add support for Observation.referenceRange", "committedDate": "2020-02-24T16:56:20Z", "type": "commit"}, {"oid": "96dfb5305605cbb5ba56453ba968f8e0e28c0dd3", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/96dfb5305605cbb5ba56453ba968f8e0e28c0dd3", "message": "FM2-61 Add support for Observation.referenceRange", "committedDate": "2020-02-24T16:56:20Z", "type": "forcePushed"}]}