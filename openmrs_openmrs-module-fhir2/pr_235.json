{"pr_number": 235, "pr_title": "FM2-248:-Update MedicationFhirResource Provider delete method.", "pr_author": "Akayeshmantha", "pr_createdAt": "2020-06-28T19:48:53Z", "pr_url": "https://github.com/openmrs/openmrs-module-fhir2/pull/235", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjgzODgxOQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/235#discussion_r446838819", "body": "```java\r\nimport org.hl7.fhir.dstu3.model.OperationOutcome;\r\n```", "bodyText": "import org.hl7.fhir.dstu3.model.OperationOutcome;", "bodyHTML": "<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"import org.hl7.fhir.dstu3.model.OperationOutcome;\"><pre><span class=\"pl-k\">import</span> <span class=\"pl-smi\">org.hl7.fhir.dstu3.model.OperationOutcome</span>;</pre></div>", "author": "corneliouzbett", "createdAt": "2020-06-29T07:55:32Z", "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r3/MedicationFhirResourceProvider.java", "diffHunk": "@@ -22,8 +22,8 @@\n import org.hl7.fhir.convertors.conv30_40.Medication30_40;\n import org.hl7.fhir.dstu3.model.IdType;\n import org.hl7.fhir.dstu3.model.Medication;\n-import org.hl7.fhir.dstu3.model.OperationOutcome;\n import org.hl7.fhir.instance.model.api.IBaseResource;\n+import org.hl7.fhir.r4.model.OperationOutcome;", "originalCommit": "efe267ecf1f3fa5c01919d34074ac0507a2ac730", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjkxMjE5OA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/235#discussion_r446912198", "bodyText": "done", "author": "Akayeshmantha", "createdAt": "2020-06-29T11:54:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjgzODgxOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjgzOTI4OQ==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/235#discussion_r446839289", "body": "```java\r\nreturn OperationOutcome30_40.convertOperationOutcome(FhirProviderUtils.buildDelete(medication));\r\n```", "bodyText": "return OperationOutcome30_40.convertOperationOutcome(FhirProviderUtils.buildDelete(medication));", "bodyHTML": "<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"return OperationOutcome30_40.convertOperationOutcome(FhirProviderUtils.buildDelete(medication));\"><pre><span class=\"pl-k\">return</span> <span class=\"pl-smi\">OperationOutcome30_40</span><span class=\"pl-k\">.</span>convertOperationOutcome(<span class=\"pl-smi\">FhirProviderUtils</span><span class=\"pl-k\">.</span>buildDelete(medication));</pre></div>", "author": "corneliouzbett", "createdAt": "2020-06-29T07:56:25Z", "path": "api/src/main/java/org/openmrs/module/fhir2/providers/r3/MedicationFhirResourceProvider.java", "diffHunk": "@@ -87,9 +87,7 @@ public OperationOutcome deleteMedication(@IdParam @NotNull IdType id) {\n \t\tif (medication == null) {\n \t\t\tthrow new ResourceNotFoundException(\"Could not find medication to update with id \" + id.getIdPart());\n \t\t}\n-\t\tOperationOutcome retVal = new OperationOutcome();\n-\t\tretVal.setId(id.getIdPart());\n-\t\tretVal.getText().setDivAsString(\"Deleted successfully\");\n-\t\treturn retVal;\n+\t\t\n+\t\treturn FhirProviderUtils.buildDelete(medication);", "originalCommit": "efe267ecf1f3fa5c01919d34074ac0507a2ac730", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njg0MDUzOA==", "url": "https://github.com/openmrs/openmrs-module-fhir2/pull/235#discussion_r446840538", "body": "Add more assertions i.e\r\n```java\r\nassertThat(result.getIssueFirstRep().getSeverity(), equalTo(OperationOutcome.IssueSeverity.INFORMATION));\r\nassertThat(result.getIssueFirstRep().getDetails().getCodingFirstRep().getCode(), equalTo(\"MSG_DELETED\"));\r\n```", "bodyText": "Add more assertions i.e\nassertThat(result.getIssueFirstRep().getSeverity(), equalTo(OperationOutcome.IssueSeverity.INFORMATION));\nassertThat(result.getIssueFirstRep().getDetails().getCodingFirstRep().getCode(), equalTo(\"MSG_DELETED\"));", "bodyHTML": "<p dir=\"auto\">Add more assertions i.e</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"assertThat(result.getIssueFirstRep().getSeverity(), equalTo(OperationOutcome.IssueSeverity.INFORMATION));\nassertThat(result.getIssueFirstRep().getDetails().getCodingFirstRep().getCode(), equalTo(&quot;MSG_DELETED&quot;));\"><pre>assertThat(result<span class=\"pl-k\">.</span>getIssueFirstRep()<span class=\"pl-k\">.</span>getSeverity(), equalTo(<span class=\"pl-smi\">OperationOutcome</span><span class=\"pl-k\">.</span><span class=\"pl-smi\">IssueSeverity</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>INFORMATION</span>));\nassertThat(result<span class=\"pl-k\">.</span>getIssueFirstRep()<span class=\"pl-k\">.</span>getDetails()<span class=\"pl-k\">.</span>getCodingFirstRep()<span class=\"pl-k\">.</span>getCode(), equalTo(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>MSG_DELETED<span class=\"pl-pds\">\"</span></span>));</pre></div>", "author": "corneliouzbett", "createdAt": "2020-06-29T07:58:44Z", "path": "api/src/test/java/org/openmrs/module/fhir2/providers/r3/MedicationFhirResourceProviderTest.java", "diffHunk": "@@ -213,22 +213,18 @@ public void searchForMedication_shouldReturnMatchingBundleOfMedicationByIngredie\n \t//\t}\n \t\n \t@Test\n-\tpublic void shouldDeleteMedication() {\n-\t\torg.hl7.fhir.r4.model.Medication med = medication;\n-\t\tmed.setStatus(org.hl7.fhir.r4.model.Medication.MedicationStatus.INACTIVE);\n-\t\t\n-\t\twhen(fhirMedicationService.delete(MEDICATION_UUID)).thenReturn(med);\n+\tpublic void deleteMedication_shouldDeleteRequestedMedication() {\n+\t\twhen(fhirMedicationService.delete(MEDICATION_UUID)).thenReturn(medication);\n \t\t\n \t\tOperationOutcome result = resourceProvider.deleteMedication(new IdType().setValue(MEDICATION_UUID));\n \t\tassertThat(result, CoreMatchers.notNullValue());\n-\t\tassertThat(result.getId(), equalTo(MEDICATION_UUID));\n+\t\tassertThat(result.getIssue(), notNullValue());", "originalCommit": "efe267ecf1f3fa5c01919d34074ac0507a2ac730", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1226f90a5edac668f9ffd62aab739430e206d797", "url": "https://github.com/openmrs/openmrs-module-fhir2/commit/1226f90a5edac668f9ffd62aab739430e206d797", "message": "FM2-248:-Update MedicationFhirResource Provider delete method.", "committedDate": "2020-06-29T10:25:59Z", "type": "commit"}]}