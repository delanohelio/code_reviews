{"pr_number": 5266, "pr_title": "Fixed bug that caused the banner to not work if it's renamed before its first use.", "pr_author": "JiaYow", "pr_createdAt": "2020-06-21T21:27:38Z", "pr_url": "https://github.com/ldtteam/minecolonies/pull/5266", "timeline": [{"oid": "90a9f95c3dece88eb9f36aef7c4196137f15c34b", "url": "https://github.com/ldtteam/minecolonies/commit/90a9f95c3dece88eb9f36aef7c4196137f15c34b", "message": "Fixed bug that caused the banner to not work if it's renamed directly after crafting", "committedDate": "2020-06-21T21:12:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQwODY3NA==", "url": "https://github.com/ldtteam/minecolonies/pull/5266#discussion_r443408674", "body": "just use getOrCreateTag that does the same thing as you do here\r\n```suggestion\r\n        final CompoundNBT compound = banner.getOrCreateTag();\r\n```", "bodyText": "just use getOrCreateTag that does the same thing as you do here\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (!banner.hasTag())\n          \n          \n            \n                    {\n          \n          \n            \n                        final CompoundNBT compound = new CompoundNBT();\n          \n          \n            \n                        banner.setTag(compound);\n          \n          \n            \n                    }\n          \n          \n            \n            \n          \n          \n            \n                    final CompoundNBT compound = banner.getTag();\n          \n          \n            \n                    final CompoundNBT compound = banner.getOrCreateTag();", "bodyHTML": "<p dir=\"auto\">just use getOrCreateTag that does the same thing as you do here</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"435\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span>banner<span class=\"pl-k\">.</span>hasTag())</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"436\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"437\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">final</span> <span class=\"pl-smi\">CompoundNBT</span> compound <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">CompoundNBT</span>();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"438\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            banner<span class=\"pl-k\">.</span>setTag(compound);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"439\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"440\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"441\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">final</span> <span class=\"pl-smi\">CompoundNBT</span> compound <span class=\"pl-k\">=</span> banner<span class=\"pl-k\">.</span>getTag();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"435\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">final</span> <span class=\"pl-smi\">CompoundNBT</span> compound <span class=\"pl-k\">=</span> banner<span class=\"pl-k\">.</span>getOrCreateTag();</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Minecraftschurli", "createdAt": "2020-06-22T08:49:40Z", "path": "src/main/java/com/minecolonies/coremod/items/ItemBannerRallyGuards.java", "diffHunk": "@@ -435,14 +435,18 @@ public static CompoundNBT checkForCompound(final ItemStack banner)\n         if (!banner.hasTag())\n         {\n             final CompoundNBT compound = new CompoundNBT();\n+            banner.setTag(compound);\n+        }\n+\n+        final CompoundNBT compound = banner.getTag();", "originalCommit": "90a9f95c3dece88eb9f36aef7c4196137f15c34b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mzc5MjY4OQ==", "url": "https://github.com/ldtteam/minecolonies/pull/5266#discussion_r443792689", "bodyText": "You are 99% right. The reason why I did it this way is because it's done this way literally in all other items too.\nSearch in the project for getTag() and look at the Item-Classes. Then look for getOrCreateTag(). See what I mean?\nI must assume that the devs have a reason to have it this way. For example, hasTag() takes into consideration isEmpty, while getOrCreateTag() does not. Maybe there has been a bug related to that in the past.\nSo, when the devs confirm that they simply didn't know about getOrCreateTag(), we should change that everywhere. Otherwise, I prefer streamlined code to individually smart code. You don't want future devs to think \"Ah, the banner uses getOrCreate, the others use getTag(), there must be a reason for this.\"\n@Raycoms?", "author": "JiaYow", "createdAt": "2020-06-22T19:59:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQwODY3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDcxNzkzNg==", "url": "https://github.com/ldtteam/minecolonies/pull/5266#discussion_r444717936", "bodyText": "I believe we've been using hasTag() since forever for all the other items and getOrCreateTag() didn't exist yet.", "author": "Raycoms", "createdAt": "2020-06-24T08:06:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQwODY3NA=="}], "type": "inlineReview"}]}