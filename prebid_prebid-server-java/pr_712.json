{"pr_number": 712, "pr_title": "OpenX adapter: Pass rewarded video signal", "pr_author": "laurb9", "pr_createdAt": "2020-05-07T19:09:15Z", "pr_url": "https://github.com/prebid/prebid-server-java/pull/712", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTIxMzE0MA==", "url": "https://github.com/prebid/prebid-server-java/pull/712#discussion_r429213140", "body": "Minor. We don't need annotation here, since the field name will not be changed after marshaling to JSON.", "bodyText": "Minor. We don't need annotation here, since the field name will not be changed after marshaling to JSON.", "bodyHTML": "<p dir=\"auto\">Minor. We don't need annotation here, since the field name will not be changed after marshaling to JSON.</p>", "author": "rpanchyk", "createdAt": "2020-05-22T12:19:01Z", "path": "src/main/java/org/prebid/server/bidder/openx/proto/OpenxVideoExt.java", "diffHunk": "@@ -0,0 +1,15 @@\n+package org.prebid.server.bidder.openx.proto;\n+\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import lombok.AllArgsConstructor;\n+import lombok.Builder;\n+import lombok.Value;\n+\n+@AllArgsConstructor(staticName = \"of\")\n+@Value\n+@Builder\n+public class OpenxVideoExt {\n+\n+    @JsonProperty(\"rewarded\")", "originalCommit": "a24d3954e8378c4fdd850ad2b625fa05ae696539", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3a56d776080f790dbddcc29ed3c62e0d0a68a52c", "changed_code": [{"header": "diff --git a/src/main/java/org/prebid/server/bidder/openx/proto/OpenxVideoExt.java b/src/main/java/org/prebid/server/bidder/openx/proto/OpenxVideoExt.java\nindex 872be0ab7..fe2e6afcf 100644\n--- a/src/main/java/org/prebid/server/bidder/openx/proto/OpenxVideoExt.java\n+++ b/src/main/java/org/prebid/server/bidder/openx/proto/OpenxVideoExt.java\n", "chunk": "@@ -10,6 +9,5 @@ import lombok.Value;\n @Builder\n public class OpenxVideoExt {\n \n-    @JsonProperty(\"rewarded\")\n     Integer rewarded;\n }\n", "next_change": null}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTIxMzg2Nw==", "url": "https://github.com/prebid/prebid-server-java/pull/712#discussion_r429213867", "body": "Hint: we can use `Objects.equals(...)` helper here, so will avoid one check.", "bodyText": "Hint: we can use Objects.equals(...) helper here, so will avoid one check.", "bodyHTML": "<p dir=\"auto\">Hint: we can use <code>Objects.equals(...)</code> helper here, so will avoid one check.</p>", "author": "rpanchyk", "createdAt": "2020-05-22T12:20:45Z", "path": "src/main/java/org/prebid/server/bidder/openx/OpenxBidder.java", "diffHunk": "@@ -146,41 +148,56 @@ private BidRequest createSingleRequest(List<Imp> imps, BidRequest bidRequest, Li\n         }\n \n         return CollectionUtils.isNotEmpty(processedImps)\n-                ? bidRequest.toBuilder().imp(processedImps).ext(makeReqExt(imps)).build()\n+                ? bidRequest.toBuilder()\n+                    .imp(processedImps)\n+                    .ext(makeReqExt(imps.get(0)))\n+                    .build()\n                 : null;\n     }\n \n     private Imp makeImp(Imp imp) {\n-        final ExtImpOpenx openxImpExt = parseOpenxExt(imp);\n-        return imp.toBuilder()\n+        final ExtPrebid<ExtImpPrebid, ExtImpOpenx> impExt = parseOpenxExt(imp);\n+        final ExtImpOpenx openxImpExt = impExt.getBidder();\n+        final ExtImpPrebid prebidImpExt = impExt.getPrebid();\n+        final Imp.ImpBuilder impBuilder = imp.toBuilder()\n                 .tagid(openxImpExt.getUnit())\n                 .bidfloor(openxImpExt.getCustomFloor())\n-                .ext(makeImpExt(openxImpExt.getCustomParams()))\n-                .build();\n+                .ext(makeImpExt(openxImpExt.getCustomParams()));\n+\n+        if (resolveImpType(imp) == OpenxImpType.video\n+                && prebidImpExt != null\n+                && prebidImpExt.getIsRewardedInventory() != null", "originalCommit": "a24d3954e8378c4fdd850ad2b625fa05ae696539", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3a56d776080f790dbddcc29ed3c62e0d0a68a52c", "changed_code": [{"header": "diff --git a/src/main/java/org/prebid/server/bidder/openx/OpenxBidder.java b/src/main/java/org/prebid/server/bidder/openx/OpenxBidder.java\nindex e019e3154..3e3c1af6f 100644\n--- a/src/main/java/org/prebid/server/bidder/openx/OpenxBidder.java\n+++ b/src/main/java/org/prebid/server/bidder/openx/OpenxBidder.java\n", "chunk": "@@ -166,8 +168,7 @@ public class OpenxBidder implements Bidder<BidRequest> {\n \n         if (resolveImpType(imp) == OpenxImpType.video\n                 && prebidImpExt != null\n-                && prebidImpExt.getIsRewardedInventory() != null\n-                && prebidImpExt.getIsRewardedInventory() == 1) {\n+                && Objects.equals(prebidImpExt.getIsRewardedInventory(), 1)) {\n             impBuilder.video(imp.getVideo().toBuilder()\n                                 .ext(mapper.mapper().valueToTree(OpenxVideoExt.of(1)))\n                                 .build());\n", "next_change": null}]}}, {"oid": "3a56d776080f790dbddcc29ed3c62e0d0a68a52c", "url": "https://github.com/prebid/prebid-server-java/commit/3a56d776080f790dbddcc29ed3c62e0d0a68a52c", "message": "OpenX adapter: Pass rewarded video signal", "committedDate": "2020-05-26T21:26:33Z", "type": "commit"}, {"oid": "3a56d776080f790dbddcc29ed3c62e0d0a68a52c", "url": "https://github.com/prebid/prebid-server-java/commit/3a56d776080f790dbddcc29ed3c62e0d0a68a52c", "message": "OpenX adapter: Pass rewarded video signal", "committedDate": "2020-05-26T21:26:33Z", "type": "forcePushed"}]}