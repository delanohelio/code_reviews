{"pr_number": 3538, "pr_title": "DB-9504 Add NativeSpark support for NotNode", "pr_author": "dgomezferro", "pr_createdAt": "2020-05-05T18:39:27Z", "pr_url": "https://github.com/splicemachine/spliceengine/pull/3538", "timeline": [{"oid": "1e09c91c373d2be25fe29ba7106a72a697ff936c", "url": "https://github.com/splicemachine/spliceengine/commit/1e09c91c373d2be25fe29ba7106a72a697ff936c", "message": "DB-9504 Add NativeSpark support for NotNode", "committedDate": "2020-05-05T18:38:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDgwNDc0NA==", "url": "https://github.com/splicemachine/spliceengine/pull/3538#discussion_r420804744", "body": "i think this is effectively the same code as lines 355-357. SimpleStringOperatorNode doesn't override getOperand, and even if - if i understand java inheritance correctly - i think uop.getOperand() would call the same as (((SimpleStringOperatorNode)uop).getOperand() .\r\nso i think lines 355-361 can be replaced by\r\n```\r\nelse if (operand instanceof SimpleStringOperatorNode || operand instanceof NotNode) {\r\n    return format(\"%s(%s) \", operatorString, opToString2(uop.getOperand(), vars));\r\n}\r\n```", "bodyText": "i think this is effectively the same code as lines 355-357. SimpleStringOperatorNode doesn't override getOperand, and even if - if i understand java inheritance correctly - i think uop.getOperand() would call the same as (((SimpleStringOperatorNode)uop).getOperand() .\nso i think lines 355-361 can be replaced by\nelse if (operand instanceof SimpleStringOperatorNode || operand instanceof NotNode) {\n    return format(\"%s(%s) \", operatorString, opToString2(uop.getOperand(), vars));\n}", "bodyHTML": "<p dir=\"auto\">i think this is effectively the same code as lines 355-357. SimpleStringOperatorNode doesn't override getOperand, and even if - if i understand java inheritance correctly - i think uop.getOperand() would call the same as (((SimpleStringOperatorNode)uop).getOperand() .<br>\nso i think lines 355-361 can be replaced by</p>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"else if (operand instanceof SimpleStringOperatorNode || operand instanceof NotNode) {\n    return format(&quot;%s(%s) &quot;, operatorString, opToString2(uop.getOperand(), vars));\n}\"><pre><code>else if (operand instanceof SimpleStringOperatorNode || operand instanceof NotNode) {\n    return format(\"%s(%s) \", operatorString, opToString2(uop.getOperand(), vars));\n}\n</code></pre></div>", "author": "martinrupp", "createdAt": "2020-05-06T13:48:26Z", "path": "db-engine/src/main/java/com/splicemachine/db/impl/sql/compile/OperatorToString.java", "diffHunk": "@@ -356,6 +356,9 @@ else if (operand instanceof SimpleStringOperatorNode) {\n                     SimpleStringOperatorNode sso = (SimpleStringOperatorNode) operand;\n                     return format(\"%s(%s) \", operatorString, opToString2(sso.getOperand(), vars));\n                 }\n+                else if (operand instanceof NotNode) {", "originalCommit": "1e09c91c373d2be25fe29ba7106a72a697ff936c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg1MTc2Ng==", "url": "https://github.com/splicemachine/spliceengine/pull/3538#discussion_r420851766", "bodyText": "Good eye, I applied that change.", "author": "dgomezferro", "createdAt": "2020-05-06T14:48:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDgwNDc0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDgwODE5Nw==", "url": "https://github.com/splicemachine/spliceengine/pull/3538#discussion_r420808197", "body": "do we test this case?", "bodyText": "do we test this case?", "bodyHTML": "<p dir=\"auto\">do we test this case?</p>", "author": "martinrupp", "createdAt": "2020-05-06T13:52:43Z", "path": "splice_machine/src/main/java/com/splicemachine/derby/utils/StatisticsOperation.java", "diffHunk": "@@ -126,6 +126,9 @@ else if (storedAs.equals(\"O\"))\n             } else {\n                 statsDataSet = scanSetBuilder.buildDataSet(scope).map(new CloneFunction<>(operationContext));\n             }\n+            if(statsDataSet.partitions() == 0) {", "originalCommit": "1e09c91c373d2be25fe29ba7106a72a697ff936c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg0MDE5Ng==", "url": "https://github.com/splicemachine/spliceengine/pull/3538#discussion_r420840196", "bodyText": "Yes, ExternalTableIT.collectStats() was failing due to this since DB-9369 was merged", "author": "dgomezferro", "createdAt": "2020-05-06T14:33:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDgwODE5Nw=="}], "type": "inlineReview"}, {"oid": "2beb3ae701eb6c82ec355ed86d5e0938b6dd158f", "url": "https://github.com/splicemachine/spliceengine/commit/2beb3ae701eb6c82ec355ed86d5e0938b6dd158f", "message": "DB-9504 Address reviews", "committedDate": "2020-05-06T14:35:30Z", "type": "commit"}]}