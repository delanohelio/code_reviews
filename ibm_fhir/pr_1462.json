{"pr_number": 1462, "pr_title": "feat: US-Core: Upgrade to STU3 Release 3.1.1 #1311 #1427", "pr_author": "prb112", "pr_createdAt": "2020-08-31T18:25:29Z", "pr_url": "https://github.com/IBM/FHIR/pull/1462", "timeline": [{"oid": "5bf73281e5dba3b1c6b4c0c3a1220739204b0250", "url": "https://github.com/IBM/FHIR/commit/5bf73281e5dba3b1c6b4c0c3a1220739204b0250", "message": "feat: US-Core: Upgrade to STU3 Release 3.1.1 #1311 #1427\n\n- Added XML and JSON examples for fhir-ig-us-core and add entries in\nIndex.java\n- Added the specification artifacts and cleaned up the\nCapabilityStatements so CapabilityStatement.text contains valid XHTML\n- Updated the CHANGELOG with spec element changes\n- Update Tests for profile changes\n- Add fhir-examples to pom.xml for fhir-ig-us-core\n- Created Factory to run through the Spec Tests\n\t- Modified DiagnosticReport-cardiology-report.json and\nDiagnosticReport-cardiology-report.xml to corrected hash value\n\t- Modified MedicationRequest-uscore-mo2.xml and\nMedicationRequest-uscore-mo2.json (invalid xhtml)\nMedicationRequest-uscore-mo2.json as it contains invalid XHTML in the\nnarrative text\n- Added IT tests for:\n\t- USCoreAllergyIntoleranceTest - SHOULD/SHALL and REVINCLUDE\n\t- USCoreCarePlanTest - SHOULD/SHALL with one caveat the implication of\nsystem|code is not supported.  We support system less only.\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-08-31T18:19:09Z", "type": "commit"}, {"oid": "bef63607bd2452ae767dd4cba233af1e9f13b51a", "url": "https://github.com/IBM/FHIR/commit/bef63607bd2452ae767dd4cba233af1e9f13b51a", "message": "doc: updated the doc to indicate support for STU3.1.1\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-08-31T20:31:30Z", "type": "commit"}, {"oid": "1d8a28c7bf4d7bcbc14924bd8712402528c09629", "url": "https://github.com/IBM/FHIR/commit/1d8a28c7bf4d7bcbc14924bd8712402528c09629", "message": "Merge branch 'master' into issue-1427", "committedDate": "2020-09-01T17:05:24Z", "type": "commit"}, {"oid": "f39735264a1b1ce8f7edb67b30c5b5aac1c1491c", "url": "https://github.com/IBM/FHIR/commit/f39735264a1b1ce8f7edb67b30c5b5aac1c1491c", "message": "fix: US-Core: Create Integration Tests for STU3 Release 3.1.1\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-09-01T17:19:04Z", "type": "commit"}, {"oid": "1c0a2259e63a5fc52771431bec65b3efd1bdb547", "url": "https://github.com/IBM/FHIR/commit/1c0a2259e63a5fc52771431bec65b3efd1bdb547", "message": "feature: US-Core: Create Integration Tests for STU3 Release 3.1.1\n\n- Integration Test\n\t- USCoreCareTeamTest\n\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-09-01T18:45:31Z", "type": "commit"}, {"oid": "3ae0e6079131c4b8748d486a404ef1fd0f030ed2", "url": "https://github.com/IBM/FHIR/commit/3ae0e6079131c4b8748d486a404ef1fd0f030ed2", "message": "fix: SparkParquetWriterTest fails unexpectedly #1471\n\n- Disables the Unit Tests on Windows Build and Update windows.yml to\ncatch early Windows Build Errors\n- Update the automation to not skipTests\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-09-02T15:13:38Z", "type": "commit"}, {"oid": "99a7077573c4cb168ce26bb672bd8dcb1fb26433", "url": "https://github.com/IBM/FHIR/commit/99a7077573c4cb168ce26bb672bd8dcb1fb26433", "message": "Merge branch 'master' into issue-1427", "committedDate": "2020-09-02T15:31:51Z", "type": "commit"}, {"oid": "e78fe49522cedfea6ca60962fd5b6691b4ea53e5", "url": "https://github.com/IBM/FHIR/commit/e78fe49522cedfea6ca60962fd5b6691b4ea53e5", "message": "US-Core: Create Integration Tests for STU3 Release 3.1.1 #1311\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-09-02T15:35:07Z", "type": "commit"}, {"oid": "9a6b11cbeb9af4f36be4e77d3ddf068e29e0cc45", "url": "https://github.com/IBM/FHIR/commit/9a6b11cbeb9af4f36be4e77d3ddf068e29e0cc45", "message": "US-Core: Create Integration Tests for STU3 Release 3.1.1 #1311\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-09-02T15:40:23Z", "type": "commit"}, {"oid": "196480bf5347f781a2bfa85ea70fc8157fb43405", "url": "https://github.com/IBM/FHIR/commit/196480bf5347f781a2bfa85ea70fc8157fb43405", "message": "US-Core: Create Integration Tests for STU3 Release 3.1.1 #1311\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-09-02T15:49:12Z", "type": "commit"}, {"oid": "2b6bc86778b8820f1ca16bb2804a0a936e6cf60c", "url": "https://github.com/IBM/FHIR/commit/2b6bc86778b8820f1ca16bb2804a0a936e6cf60c", "message": "fix: add inline debugging\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-09-02T17:11:38Z", "type": "commit"}, {"oid": "e8cded39edf04c17fc6d4c00eebc44e007c071ce", "url": "https://github.com/IBM/FHIR/commit/e8cded39edf04c17fc6d4c00eebc44e007c071ce", "message": "fix: Change single test\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-09-02T17:16:28Z", "type": "commit"}, {"oid": "dc08fde2bd32427751567d0238db018d7fda5fe3", "url": "https://github.com/IBM/FHIR/commit/dc08fde2bd32427751567d0238db018d7fda5fe3", "message": "fix: debug issue on Windows integration tests\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-09-02T17:55:20Z", "type": "commit"}, {"oid": "433c3126121ade1e82eeca07d9b63832c91e16b4", "url": "https://github.com/IBM/FHIR/commit/433c3126121ade1e82eeca07d9b63832c91e16b4", "message": "fix: debug issue on Windows integration tests\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-09-02T18:23:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjI5NDk3MA==", "url": "https://github.com/IBM/FHIR/pull/1462#discussion_r482294970", "body": "did we need to generate our own `.index.json` file for US Core?  does it include an `.index.json` that just isn't valid or does it not even have one?", "bodyText": "did we need to generate our own .index.json file for US Core?  does it include an .index.json that just isn't valid or does it not even have one?", "bodyHTML": "<p dir=\"auto\">did we need to generate our own <code>.index.json</code> file for US Core?  does it include an <code>.index.json</code> that just isn't valid or does it not even have one?</p>", "author": "lmsurpre", "createdAt": "2020-09-02T18:42:08Z", "path": "conformance/fhir-ig-us-core/src/main/java/com/ibm/fhir/ig/us/core/util/IndexGenerator.java", "diffHunk": "@@ -0,0 +1,48 @@\n+/*\n+ * (C) Copyright IBM Corp. 2020\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+\n+package com.ibm.fhir.ig.us.core.util;\n+\n+import java.io.File;\n+import java.io.FileNotFoundException;\n+import java.io.FileOutputStream;\n+import java.io.FileReader;\n+import java.io.IOException;\n+import java.io.OutputStream;\n+\n+import com.ibm.fhir.model.format.Format;\n+import com.ibm.fhir.model.parser.FHIRParser;\n+import com.ibm.fhir.model.parser.exception.FHIRParserException;\n+import com.ibm.fhir.model.resource.Resource;\n+import com.ibm.fhir.registry.util.Index;\n+import com.ibm.fhir.registry.util.Index.Entry;\n+\n+public class IndexGenerator {", "originalCommit": "433c3126121ade1e82eeca07d9b63832c91e16b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjMxMzAyNg==", "url": "https://github.com/IBM/FHIR/pull/1462#discussion_r482313026", "bodyText": "This is a net new file. The version in master does not have an IndexGenerator utility class. @prb112 does the latest. version not include a .index.json file?", "author": "JohnTimm", "createdAt": "2020-09-02T19:01:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjI5NDk3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjM3NjMxMw==", "url": "https://github.com/IBM/FHIR/pull/1462#discussion_r482376313", "bodyText": "so - I totally own this one... I copied from a directory (. is hidden) so I had to generate the index.  I'll copy over the official one and remove the Generator.  This is on me.", "author": "prb112", "createdAt": "2020-09-02T19:56:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjI5NDk3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjM5MDI4MA==", "url": "https://github.com/IBM/FHIR/pull/1462#discussion_r482390280", "bodyText": "Fixed (lesson learned on hidden files)", "author": "prb112", "createdAt": "2020-09-02T20:06:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjI5NDk3MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjI5NjkxMQ==", "url": "https://github.com/IBM/FHIR/pull/1462#discussion_r482296911", "body": "pretty minor, but this will be taken as javadoc for only PROFILES_US_CORE_JSON.  i'd suggest we either change it to a block comment (removing a single `*`) or just have one for each.\r\n```suggestion\r\n    /*\r\n     * US Core Examples in XML and JSON\r\n     */\r\n    PROFILES_US_CORE_JSON(\"/profiles-us-core-json.txt\"),\r\n```", "bodyText": "pretty minor, but this will be taken as javadoc for only PROFILES_US_CORE_JSON.  i'd suggest we either change it to a block comment (removing a single *) or just have one for each.\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                /**\n          \n          \n            \n                 * US Core Examples in XML and JSON\n          \n          \n            \n                 */\n          \n          \n            \n                PROFILES_US_CORE_JSON(\"/profiles-us-core-json.txt\"),\n          \n          \n            \n                /*\n          \n          \n            \n                 * US Core Examples in XML and JSON\n          \n          \n            \n                 */\n          \n          \n            \n                PROFILES_US_CORE_JSON(\"/profiles-us-core-json.txt\"),", "bodyHTML": "<p dir=\"auto\">pretty minor, but this will be taken as javadoc for only PROFILES_US_CORE_JSON.  i'd suggest we either change it to a block comment (removing a single <code>*</code>) or just have one for each.</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"107\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-c\"><span class=\"pl-c\">/*<span class=\"x x-first x-last\">*</span></span></span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"108\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">     <span class=\"pl-k\">*</span> <span class=\"pl-c1\">US</span> <span class=\"pl-smi\">Core</span> <span class=\"pl-smi\">Examples</span> in <span class=\"pl-c1\">XML</span> and <span class=\"pl-c1\">JSON</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"109\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">     <span class=\"pl-k\">*/</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"110\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-c1\">PROFILES_US_CORE_JSON</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/profiles-us-core-json.txt<span class=\"pl-pds\">\"</span></span>),</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"107\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-c\"><span class=\"pl-c\">/*</span></span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"108\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-c1\">US</span> <span class=\"pl-smi\">Core</span> <span class=\"pl-smi\">Examples</span> in <span class=\"pl-c1\">XML</span> and <span class=\"pl-c1\">JSON</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"109\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*/</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"110\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-c1\">PROFILES_US_CORE_JSON</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/profiles-us-core-json.txt<span class=\"pl-pds\">\"</span></span>),</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "lmsurpre", "createdAt": "2020-09-02T18:44:18Z", "path": "fhir-examples/src/main/java/com/ibm/fhir/examples/Index.java", "diffHunk": "@@ -90,15 +101,28 @@\n      */\n     PROFILES_PDEX_PLAN_NET_JSON(\"/profiles-pdex-plan-net-json.txt\"),\n \n+    /**\n+     * US Core Examples in XML and JSON\n+     */\n+    PROFILES_US_CORE_JSON(\"/profiles-us-core-json.txt\"),", "originalCommit": "433c3126121ade1e82eeca07d9b63832c91e16b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjM4MjYzOQ==", "url": "https://github.com/IBM/FHIR/pull/1462#discussion_r482382639", "bodyText": "sometimes for comments like these I prefer the old-fashioned // to make it clear its not javadoc:\n\n  \n    \n  \n    \n\n  \n  This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                /**\n          \n          \n            \n                 * US Core Examples in XML and JSON\n          \n          \n            \n                 */\n          \n          \n            \n                PROFILES_US_CORE_JSON(\"/profiles-us-core-json.txt\"),\n          \n          \n            \n                ///////////////////////////////////\n          \n          \n            \n                // US Core Examples in XML and JSON\n          \n          \n            \n                ///////////////////////////////////\n          \n          \n            \n                PROFILES_US_CORE_JSON(\"/profiles-us-core-json.txt\"),", "author": "lmsurpre", "createdAt": "2020-09-02T20:01:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjI5NjkxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjM5NDc5Ng==", "url": "https://github.com/IBM/FHIR/pull/1462#discussion_r482394796", "bodyText": "Fixed locally and bundled into one PR", "author": "prb112", "createdAt": "2020-09-02T20:10:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjI5NjkxMQ=="}], "type": "inlineReview"}, {"oid": "10451ed3b9447a8f5ac4688b528d1cc2a6c8887c", "url": "https://github.com/IBM/FHIR/commit/10451ed3b9447a8f5ac4688b528d1cc2a6c8887c", "message": "fix: per code review of the US Core STU 3.1.1\n\n- Fix the Workflow\n- Copied over the hidden .index.json to the us-core package\n- Removed the IndexGenerator (wasn't needed)\n- Cleaned up change log to include only what is relevant and necessary\n- Fixed up the index to not include javadoc\n\nSigned-off-by: Paul Bastide <pbastide@us.ibm.com>", "committedDate": "2020-09-02T20:10:15Z", "type": "commit"}]}