{"pr_number": 2125, "pr_title": "Fix #2124: Raw Watch on CustomResource does not work if name specified", "pr_author": "rohanKanojia", "pr_createdAt": "2020-04-13T06:41:44Z", "pr_url": "https://github.com/fabric8io/kubernetes-client/pull/2125", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzg2ODgxNQ==", "url": "https://github.com/fabric8io/kubernetes-client/pull/2125#discussion_r407868815", "body": "Is it possible to keep the constructor clean and leave the additional logic here?\r\ne.g.\r\n```\r\n  private String fetchUrl(String name, String namespace, Map<String, String> labels, String resourceVersion) {\r\n    String resourceUrl = fetchUrl(namespace, labels);\r\n    if (resourceUrl.endsWith(\"/\")) {\r\n      resourceUrl = resourceUrl.substring(0, resourceUrl.length() - 1);\r\n    }\r\n    URL url = new URL(resourceUrl);\r\n    if (name != null) {\r\n      httpUrlBuilder.addQueryParameter(\"fieldSelector\", \"metadata.name=\" + name);\r\n    }\r\n    if (resourceVersion != null) {\r\n      httpUrlBuilder.addQueryParameter(\"resourceVersion\", resourceVersion);\r\n    }\r\n    return url;\r\n  }\r\n```\r\n\r\nIf you package expose the method, you could even add a couple of unit tests to verify the expected logic for each input variable combination.", "bodyText": "Is it possible to keep the constructor clean and leave the additional logic here?\ne.g.\n  private String fetchUrl(String name, String namespace, Map<String, String> labels, String resourceVersion) {\n    String resourceUrl = fetchUrl(namespace, labels);\n    if (resourceUrl.endsWith(\"/\")) {\n      resourceUrl = resourceUrl.substring(0, resourceUrl.length() - 1);\n    }\n    URL url = new URL(resourceUrl);\n    if (name != null) {\n      httpUrlBuilder.addQueryParameter(\"fieldSelector\", \"metadata.name=\" + name);\n    }\n    if (resourceVersion != null) {\n      httpUrlBuilder.addQueryParameter(\"resourceVersion\", resourceVersion);\n    }\n    return url;\n  }\n\nIf you package expose the method, you could even add a couple of unit tests to verify the expected logic for each input variable combination.", "bodyHTML": "<p dir=\"auto\">Is it possible to keep the constructor clean and leave the additional logic here?<br>\ne.g.</p>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"  private String fetchUrl(String name, String namespace, Map&lt;String, String&gt; labels, String resourceVersion) {\n    String resourceUrl = fetchUrl(namespace, labels);\n    if (resourceUrl.endsWith(&quot;/&quot;)) {\n      resourceUrl = resourceUrl.substring(0, resourceUrl.length() - 1);\n    }\n    URL url = new URL(resourceUrl);\n    if (name != null) {\n      httpUrlBuilder.addQueryParameter(&quot;fieldSelector&quot;, &quot;metadata.name=&quot; + name);\n    }\n    if (resourceVersion != null) {\n      httpUrlBuilder.addQueryParameter(&quot;resourceVersion&quot;, resourceVersion);\n    }\n    return url;\n  }\"><pre><code>  private String fetchUrl(String name, String namespace, Map&lt;String, String&gt; labels, String resourceVersion) {\n    String resourceUrl = fetchUrl(namespace, labels);\n    if (resourceUrl.endsWith(\"/\")) {\n      resourceUrl = resourceUrl.substring(0, resourceUrl.length() - 1);\n    }\n    URL url = new URL(resourceUrl);\n    if (name != null) {\n      httpUrlBuilder.addQueryParameter(\"fieldSelector\", \"metadata.name=\" + name);\n    }\n    if (resourceVersion != null) {\n      httpUrlBuilder.addQueryParameter(\"resourceVersion\", resourceVersion);\n    }\n    return url;\n  }\n</code></pre></div>\n<p dir=\"auto\">If you package expose the method, you could even add a couple of unit tests to verify the expected logic for each input variable combination.</p>", "author": "manusa", "createdAt": "2020-04-14T05:03:46Z", "path": "kubernetes-client/src/main/java/io/fabric8/kubernetes/client/dsl/internal/RawCustomResourceOperationsImpl.java", "diffHunk": "@@ -696,15 +704,6 @@ public Watch watch(String namespace, String name, Map<String, String> labels, St\n     return retVal;\n   }\n \n-  private String fetchUrl(String name, String namespace, Map<String, String> labels) {\n-    String url = fetchUrl(namespace, labels);\n-    if (name != null) {\n-      return url + name;\n-    } else {\n-      return url.substring(0, url.length() - 1);\n-    }\n-  }", "originalCommit": "13402b58971f5f18d3e4732221ae48954d7981ad", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "6939eb6ad9d6d9460af8cbba5f12e7a73384a80c", "url": "https://github.com/fabric8io/kubernetes-client/commit/6939eb6ad9d6d9460af8cbba5f12e7a73384a80c", "message": "Fix #2124: Raw Watch on CustomResource does not work if name specified", "committedDate": "2020-04-20T14:40:17Z", "type": "forcePushed"}, {"oid": "51f0d4f12b5de7a4f87542f92baff618bd235789", "url": "https://github.com/fabric8io/kubernetes-client/commit/51f0d4f12b5de7a4f87542f92baff618bd235789", "message": "Fix #2124: Raw Watch on CustomResource does not work if name specified", "committedDate": "2020-04-22T06:28:32Z", "type": "commit"}, {"oid": "51f0d4f12b5de7a4f87542f92baff618bd235789", "url": "https://github.com/fabric8io/kubernetes-client/commit/51f0d4f12b5de7a4f87542f92baff618bd235789", "message": "Fix #2124: Raw Watch on CustomResource does not work if name specified", "committedDate": "2020-04-22T06:28:32Z", "type": "forcePushed"}]}