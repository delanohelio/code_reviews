{"pr_number": 17853, "pr_title": "Issue 16589", "pr_author": "erickgonzalez", "pr_createdAt": "2020-01-15T20:18:23Z", "pr_url": "https://github.com/dotCMS/core/pull/17853", "timeline": [{"oid": "f8de41cb44d0add4774d9260450ba8c78c5ac8f6", "url": "https://github.com/dotCMS/core/commit/f8de41cb44d0add4774d9260450ba8c78c5ac8f6", "message": "#16589 set hostId when pulling nav from root so only pulls items that belongs to the selected host", "committedDate": "2020-01-15T20:06:48Z", "type": "commit"}, {"oid": "adaf3d358d84604ee710a47e285dfa3c4dc2d1c9", "url": "https://github.com/dotCMS/core/commit/adaf3d358d84604ee710a47e285dfa3c4dc2d1c9", "message": "#16589 IT and update old IT", "committedDate": "2020-01-15T20:07:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzA5MTYxOA==", "url": "https://github.com/dotCMS/core/pull/17853#discussion_r367091618", "body": "![Codacy](https://app.codacy.com/assets/images/favicon.png) Issue found: [Local variable 'navResult' could be declared final](https://app.codacy.com/manual/dotCMS/core/pullRequest?prid=4828419)", "bodyText": "Issue found: Local variable 'navResult' could be declared final", "bodyHTML": "<p dir=\"auto\"><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://camo.githubusercontent.com/ddf013cbb1295b347431f8757e505fb295e9c7dd5043d9a3a0bf610dd0bb0da7/68747470733a2f2f6170702e636f646163792e636f6d2f6173736574732f696d616765732f66617669636f6e2e706e67\"><img src=\"https://camo.githubusercontent.com/ddf013cbb1295b347431f8757e505fb295e9c7dd5043d9a3a0bf610dd0bb0da7/68747470733a2f2f6170702e636f646163792e636f6d2f6173736574732f696d616765732f66617669636f6e2e706e67\" alt=\"Codacy\" data-canonical-src=\"https://app.codacy.com/assets/images/favicon.png\" style=\"max-width: 100%;\"></a> Issue found: <a href=\"https://app.codacy.com/manual/dotCMS/core/pullRequest?prid=4828419\" rel=\"nofollow\">Local variable 'navResult' could be declared final</a></p>", "author": "dev-dotcms", "createdAt": "2020-01-15T20:30:30Z", "path": "dotCMS/src/integration-test/java/com/dotcms/rendering/velocity/viewtools/navigation/NavToolTest.java", "diffHunk": "@@ -409,4 +404,41 @@ private int findShowOnMenuUnderFolder(Folder folder, User user)\n         return showOnMenu;\n     }\n \n+    @Test\n+    public void testNavTool_rootLevel_returnItemsOnlyForSite() throws Exception\n+    {\n+        //Get SystemFolder\n+        final Folder systemFolder = APILocator.getFolderAPI().findSystemFolder();\n+\n+        //Create new Host\n+        final Host newHost1 = new SiteDataGen().nextPersisted();\n+\n+        //Create contentlets on one host\n+        final File file = File.createTempFile(\"fileTestEngTrue\", \".txt\");\n+        FileUtil.write(file, \"helloworld\");\n+        final Contentlet fileAssetOneHost = new FileAssetDataGen(systemFolder, file)\n+                .host(newHost1).setProperty(FileAssetAPI.SHOW_ON_MENU, \"true\").nextPersisted();\n+        final Template template = new TemplateDataGen().nextPersisted();\n+        final Contentlet pageAssetOneHost = new HTMLPageDataGen(systemFolder, template)\n+                .showOnMenu(true).host(newHost1).nextPersisted();\n+        ContentletDataGen.publish(pageAssetOneHost);\n+        ContentletDataGen.publish(fileAssetOneHost);\n+\n+        //Create new Host\n+        final Host newHost2 = new SiteDataGen().nextPersisted();\n+\n+        //Create contentlets on default host\n+        final Contentlet fileAssetNewHost = new FileAssetDataGen(systemFolder, file)\n+                .host(newHost2).setProperty(FileAssetAPI.SHOW_ON_MENU, \"true\").nextPersisted();\n+        final Contentlet pageAssetNewHost = new HTMLPageDataGen(systemFolder, template)\n+                .showOnMenu(true).host(newHost2).nextPersisted();\n+        ContentletDataGen.publish(pageAssetNewHost);\n+        ContentletDataGen.publish(fileAssetNewHost);\n+\n+        NavResult navResult = new NavTool().getNav(newHost2, systemFolder.getPath());", "originalCommit": "adaf3d358d84604ee710a47e285dfa3c4dc2d1c9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}