{"pr_number": 8697, "pr_title": "Issue #8662: Switch expression syntax check update for EmptyBlockCheck", "pr_author": "nmancus1", "pr_createdAt": "2020-08-15T16:26:16Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/8697", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTA3MjM5Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/8697#discussion_r471072392", "body": "One interesting case is missing here:\r\n```java\r\n            case ONE -> { break; } // OK\r\n            case TWO, THREE -> {} // violation\r\n            case FOUR -> {\r\n               // this block was intentionally left empty\r\n            } // OK when BlockOption == text\r\n```\r\nBut I'm not sure about that. The code ` { break; }` looks a bit weird. And we [already have](https://github.com/checkstyle/checkstyle/blob/master/src/test/resources/com/puppycrawl/tools/checkstyle/checks/blocks/emptyblock/InputEmptyBlockCase.java#L10) an exception for the `switch case`:\r\n```java\r\n        switch (k) {\r\n            case ONE: {} // OK\r\n            case TWO:\r\n              break;\r\n          }\r\n```\r\n\r\nThis behavior is (poorly) [documented](https://checkstyle.sourceforge.io/config_blocks.html#EmptyBlock), let's leave it as it is. @nmancus1 please add a test case here:\r\n```java\r\n    case TWO, THREE -> {} // OK, empty blocks are allowed for cases\r\n```\r\n", "bodyText": "One interesting case is missing here:\n            case ONE -> { break; } // OK\n            case TWO, THREE -> {} // violation\n            case FOUR -> {\n               // this block was intentionally left empty\n            } // OK when BlockOption == text\nBut I'm not sure about that. The code  { break; } looks a bit weird. And we already have an exception for the switch case:\n        switch (k) {\n            case ONE: {} // OK\n            case TWO:\n              break;\n          }\nThis behavior is (poorly) documented, let's leave it as it is. @nmancus1 please add a test case here:\n    case TWO, THREE -> {} // OK, empty blocks are allowed for cases", "bodyHTML": "<p dir=\"auto\">One interesting case is missing here:</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"            case ONE -&gt; { break; } // OK\n            case TWO, THREE -&gt; {} // violation\n            case FOUR -&gt; {\n               // this block was intentionally left empty\n            } // OK when BlockOption == text\"><pre>            <span class=\"pl-k\">case</span> <span class=\"pl-c1\">ONE</span> <span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> { <span class=\"pl-k\">break</span>; } <span class=\"pl-c\"><span class=\"pl-c\">//</span> OK</span>\n            <span class=\"pl-k\">case</span> <span class=\"pl-c1\">TWO</span>, <span class=\"pl-c1\">THREE</span> <span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> {} <span class=\"pl-c\"><span class=\"pl-c\">//</span> violation</span>\n            <span class=\"pl-k\">case</span> <span class=\"pl-c1\">FOUR</span> <span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> {\n               <span class=\"pl-c\"><span class=\"pl-c\">//</span> this block was intentionally left empty</span>\n            } <span class=\"pl-c\"><span class=\"pl-c\">//</span> OK when BlockOption == text</span></pre></div>\n<p dir=\"auto\">But I'm not sure about that. The code <code> { break; }</code> looks a bit weird. And we <a href=\"https://github.com/checkstyle/checkstyle/blob/master/src/test/resources/com/puppycrawl/tools/checkstyle/checks/blocks/emptyblock/InputEmptyBlockCase.java#L10\">already have</a> an exception for the <code>switch case</code>:</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"        switch (k) {\n            case ONE: {} // OK\n            case TWO:\n              break;\n          }\"><pre>        <span class=\"pl-k\">switch</span> (k) {\n            <span class=\"pl-k\">case</span> <span class=\"pl-c1\">ONE</span><span class=\"pl-k\">:</span> {} <span class=\"pl-c\"><span class=\"pl-c\">//</span> OK</span>\n            <span class=\"pl-k\">case</span> <span class=\"pl-c1\">TWO</span><span class=\"pl-k\">:</span>\n              <span class=\"pl-k\">break</span>;\n          }</pre></div>\n<p dir=\"auto\">This behavior is (poorly) <a href=\"https://checkstyle.sourceforge.io/config_blocks.html#EmptyBlock\" rel=\"nofollow\">documented</a>, let's leave it as it is. <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/nmancus1/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/nmancus1\">@nmancus1</a> please add a test case here:</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"    case TWO, THREE -&gt; {} // OK, empty blocks are allowed for cases\"><pre>    <span class=\"pl-k\">case</span> <span class=\"pl-c1\">TWO</span>, <span class=\"pl-c1\">THREE</span> <span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> {} <span class=\"pl-c\"><span class=\"pl-c\">//</span> OK, empty blocks are allowed for cases</span></pre></div>", "author": "pbludov", "createdAt": "2020-08-16T06:27:08Z", "path": "src/test/resources-noncompilable/com/puppycrawl/tools/checkstyle/checks/blocks/emptyblock/InputEmptyBlockSwitchExpressions.java", "diffHunk": "@@ -0,0 +1,114 @@\n+//non-compiled with javac: Compilable with Java14\n+package com.puppycrawl.tools.checkstyle.checks.blocks.emptyblock;\n+\n+/* Config:\n+ *\n+ * tokens = {LITERAL_WHILE , LITERAL_TRY , LITERAL_CATCH , LITERAL_FINALLY ,\n+ *  LITERAL_DO , LITERAL_IF , LITERAL_ELSE , LITERAL_FOR , INSTANCE_INIT ,\n+ *  STATIC_INIT , LITERAL_SWITCH , LITERAL_SYNCHRONIZED , LITERAL_CASE ,\n+ *  LITERAL_DEFAULT , ARRAY_INIT}\n+ * BlockOption = statement\n+ */\n+public class InputEmptyBlockSwitchExpressions {\n+    void howMany1(Nums k) {\n+        switch (k) {\n+            case ONE:\n+                System.out.println(\"case two\");\n+            case TWO, THREE: { // violation\n+\n+            }\n+\n+            case FOUR: {\n+                System.out.println(\"case three\");\n+            }\n+\n+            default:\n+                throw new IllegalStateException(\"Not a nums\");\n+        }\n+    }\n+\n+    void howMany2(Nums k) {\n+        switch (k) {\n+            case ONE ->\n+                    System.out.println(\"case one\");\n+\n+            case TWO, THREE ->", "originalCommit": "bbb6b3fe1606351eaa06fcf3fa317f269128026e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTExMDAwNw==", "url": "https://github.com/checkstyle/checkstyle/pull/8697#discussion_r471110007", "bodyText": "Done.", "author": "nmancus1", "createdAt": "2020-08-16T12:56:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTA3MjM5Mg=="}], "type": "inlineReview"}, {"oid": "9758a940ae2e02aafaaf52a04d675236b115f786", "url": "https://github.com/checkstyle/checkstyle/commit/9758a940ae2e02aafaaf52a04d675236b115f786", "message": "Issue #8662: Switch expression syntax check update for EmptyBlockCheck", "committedDate": "2020-08-16T12:51:30Z", "type": "commit"}, {"oid": "9758a940ae2e02aafaaf52a04d675236b115f786", "url": "https://github.com/checkstyle/checkstyle/commit/9758a940ae2e02aafaaf52a04d675236b115f786", "message": "Issue #8662: Switch expression syntax check update for EmptyBlockCheck", "committedDate": "2020-08-16T12:51:30Z", "type": "forcePushed"}]}