{"pr_number": 883, "pr_title": "Release Excel File in Table View", "pr_author": "Delphinus8821", "pr_createdAt": "2020-10-30T03:33:17Z", "pr_url": "https://github.com/constellation-app/constellation/pull/883", "timeline": [{"oid": "620acd5f8620df147acb4e1531599923adedf159", "url": "https://github.com/constellation-app/constellation/commit/620acd5f8620df147acb4e1531599923adedf159", "message": "Excel files now released after writing\n\nFIleOutputStream is closed after the file has been written to.", "committedDate": "2020-10-30T03:00:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDk5MTE3Mw==", "url": "https://github.com/constellation-app/constellation/pull/883#discussion_r514991173", "body": "Thank you for fixing this serious bug.\r\n\r\nNote that in Java 8 try with resource was introduced which will close the stream for you automatically (see https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html) so you can do:\r\n\r\n```\r\ntry (FileOutputStream fileStream = new FileOutputStream(file)) {\r\n    workbook.write(fileStream);\r\n}\r\n```\r\n\r\n", "bodyText": "Thank you for fixing this serious bug.\nNote that in Java 8 try with resource was introduced which will close the stream for you automatically (see https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html) so you can do:\ntry (FileOutputStream fileStream = new FileOutputStream(file)) {\n    workbook.write(fileStream);\n}", "bodyHTML": "<p dir=\"auto\">Thank you for fixing this serious bug.</p>\n<p dir=\"auto\">Note that in Java 8 try with resource was introduced which will close the stream for you automatically (see <a href=\"https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html\" rel=\"nofollow\">https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html</a>) so you can do:</p>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"try (FileOutputStream fileStream = new FileOutputStream(file)) {\n    workbook.write(fileStream);\n}\"><pre><code>try (FileOutputStream fileStream = new FileOutputStream(file)) {\n    workbook.write(fileStream);\n}\n</code></pre></div>", "author": "arcturus2", "createdAt": "2020-10-30T10:10:05Z", "path": "CoreTableView/src/au/gov/asd/tac/constellation/views/tableview2/TableViewUtilities.java", "diffHunk": "@@ -292,8 +296,10 @@ public void execute(final PluginGraphs graphs, final PluginInteraction interacti\n                     final List<ObservableList<String>> data = table.getItems();\n                     writeRecords(sheet, visibleIndices, data);\n                 }\n-\n-                workbook.write(new FileOutputStream(file));\n+                FileOutputStream fileStream = new FileOutputStream(file);\n+                workbook.write(fileStream);\n+                fileStream.close();", "originalCommit": "620acd5f8620df147acb4e1531599923adedf159", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}