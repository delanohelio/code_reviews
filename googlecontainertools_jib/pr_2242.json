{"pr_number": 2242, "pr_title": "Add user agent to update check", "pr_author": "TadCordle", "pr_createdAt": "2020-01-23T21:03:51Z", "pr_url": "https://github.com/GoogleContainerTools/jib/pull/2242", "timeline": [{"oid": "c44e8cb3132eb86fb26c73186b5c9ab6ad58e35e", "url": "https://github.com/GoogleContainerTools/jib/commit/c44e8cb3132eb86fb26c73186b5c9ab6ad58e35e", "message": "Add user agent to update check", "committedDate": "2020-01-23T21:00:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM3MjkwMw==", "url": "https://github.com/GoogleContainerTools/jib/pull/2242#discussion_r370372903", "body": "I actually don't like our current string format (#1067), but I guess we'll just go with this for consistency.", "bodyText": "I actually don't like our current string format (#1067), but I guess we'll just go with this for consistency.", "bodyHTML": "<p dir=\"auto\">I actually don't like our current string format (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"365034539\" data-permission-text=\"Title is private\" data-url=\"https://github.com/GoogleContainerTools/jib/issues/1067\" data-hovercard-type=\"issue\" data-hovercard-url=\"/GoogleContainerTools/jib/issues/1067/hovercard\" href=\"https://github.com/GoogleContainerTools/jib/issues/1067\">#1067</a>), but I guess we'll just go with this for consistency.</p>", "author": "chanseokoh", "createdAt": "2020-01-23T21:48:40Z", "path": "jib-plugins-common/src/main/java/com/google/cloud/tools/jib/plugins/common/UpdateChecker.java", "diffHunk": "@@ -139,11 +150,17 @@ void setDisableUpdateCheck(boolean disableUpdateCheck) {\n       }\n \n       // Check for update\n-      HttpURLConnection connection = (HttpURLConnection) new URL(versionUrl).openConnection();\n+      FailoverHttpClient httpClient = new FailoverHttpClient(true, false, log);\n+      Response response =\n+          httpClient.get(\n+              new URL(versionUrl),\n+              Request.builder()\n+                  .setHttpTimeout(3000)\n+                  .setUserAgent(\"jib \" + ProjectInfo.VERSION + \" \" + toolName)", "originalCommit": "c44e8cb3132eb86fb26c73186b5c9ab6ad58e35e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM3MzMxNQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2242#discussion_r370373315", "body": "You can put this line into `try`, can't you? Otherwise, if `httpClient.get()` throws an exception, `httpClient.shutDown()` is not called.", "bodyText": "You can put this line into try, can't you? Otherwise, if httpClient.get() throws an exception, httpClient.shutDown() is not called.", "bodyHTML": "<p dir=\"auto\">You can put this line into <code>try</code>, can't you? Otherwise, if <code>httpClient.get()</code> throws an exception, <code>httpClient.shutDown()</code> is not called.</p>", "author": "chanseokoh", "createdAt": "2020-01-23T21:49:42Z", "path": "jib-plugins-common/src/main/java/com/google/cloud/tools/jib/plugins/common/UpdateChecker.java", "diffHunk": "@@ -139,11 +150,17 @@ void setDisableUpdateCheck(boolean disableUpdateCheck) {\n       }\n \n       // Check for update\n-      HttpURLConnection connection = (HttpURLConnection) new URL(versionUrl).openConnection();\n+      FailoverHttpClient httpClient = new FailoverHttpClient(true, false, log);\n+      Response response =\n+          httpClient.get(", "originalCommit": "c44e8cb3132eb86fb26c73186b5c9ab6ad58e35e", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "58792f77c56610c1109fd7f4883dba6558ba676a", "url": "https://github.com/GoogleContainerTools/jib/commit/58792f77c56610c1109fd7f4883dba6558ba676a", "message": "Feedback", "committedDate": "2020-01-23T22:03:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM4NzU5OQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2242#discussion_r370387599", "body": "Actually, maybe it's better to ignore logs?\r\n\r\n`new FailoverHttpClient(true, false, ignored -> {})`", "bodyText": "Actually, maybe it's better to ignore logs?\nnew FailoverHttpClient(true, false, ignored -> {})", "bodyHTML": "<p dir=\"auto\">Actually, maybe it's better to ignore logs?</p>\n<p dir=\"auto\"><code>new FailoverHttpClient(true, false, ignored -&gt; {})</code></p>", "author": "chanseokoh", "createdAt": "2020-01-23T22:25:08Z", "path": "jib-plugins-common/src/main/java/com/google/cloud/tools/jib/plugins/common/UpdateChecker.java", "diffHunk": "@@ -139,11 +150,17 @@ void setDisableUpdateCheck(boolean disableUpdateCheck) {\n       }\n \n       // Check for update\n-      HttpURLConnection connection = (HttpURLConnection) new URL(versionUrl).openConnection();\n+      FailoverHttpClient httpClient = new FailoverHttpClient(true, false, log);", "originalCommit": "58792f77c56610c1109fd7f4883dba6558ba676a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM4Nzg4NQ==", "url": "https://github.com/GoogleContainerTools/jib/pull/2242#discussion_r370387885", "bodyText": "True, I'll submit another PR.", "author": "TadCordle", "createdAt": "2020-01-23T22:25:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM4NzU5OQ=="}], "type": "inlineReview"}]}