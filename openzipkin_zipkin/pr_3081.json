{"pr_number": 3081, "pr_title": "Friendly advice about trim", "pr_author": "uckyk", "pr_createdAt": "2020-05-15T02:29:26Z", "pr_url": "https://github.com/openzipkin/zipkin/pull/3081", "timeline": [{"oid": "ed7d974cf57a7eb5a0d4c1850050bab63a312ea1", "url": "https://github.com/openzipkin/zipkin/commit/ed7d974cf57a7eb5a0d4c1850050bab63a312ea1", "message": "Friendly advice about  trim()\n\nFriendly advice\r\nwhen use \"@get(\"/api/v2/trace/{traceId}\")\"\r\nhere is the code traceId = Span.normalizeTraceId(traceId);\r\nif trace with space , it will doesnt work.\r\n\r\n[ in ZipkinQueryApiV2, we add this \u201c traceId = traceId != null ? traceId.trim() :null; \u201d ]\r\n\r\nI think it's okay to add trim when querying, this performance is not affected at all.\r\nMaybe this is not the best way to deal with it, you can also improve it according to the friendliness I mentioned in the follow-up, and you do n\u2019t have to use mine completely.\r\nI also mentioned that adding a common to SPAN may cause low performance problems, so set the trim here", "committedDate": "2020-05-15T02:26:45Z", "type": "commit"}, {"oid": "59d53d590cf26211fdc30ee2171eb092fcee3ae5", "url": "https://github.com/openzipkin/zipkin/commit/59d53d590cf26211fdc30ee2171eb092fcee3ae5", "message": "Merge pull request #1 from uckyk/uckyk-patch-2\n\nFriendly advice about  trim()", "committedDate": "2020-05-15T02:27:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTUzNDcwNw==", "url": "https://github.com/openzipkin/zipkin/pull/3081#discussion_r425534707", "body": "```suggestion\r\n    traceId = traceId != null ? traceId.trim() : null;\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                traceId = traceId != null ? traceId.trim() :null;\n          \n          \n            \n                traceId = traceId != null ? traceId.trim() : null;", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    traceId <span class=\"pl-k\">=</span> traceId <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span> <span class=\"pl-k\">?</span> traceId<span class=\"pl-k\">.</span>trim() <span class=\"pl-k\">:</span><span class=\"pl-c1\">null</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    traceId <span class=\"pl-k\">=</span> traceId <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span> <span class=\"pl-k\">?</span> traceId<span class=\"pl-k\">.</span>trim() <span class=\"pl-k\">:</span><span class=\"x x-first x-last\"> </span><span class=\"pl-c1\">null</span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "codefromthecrypt", "createdAt": "2020-05-15T02:40:47Z", "path": "zipkin-server/src/main/java/zipkin2/server/internal/ZipkinQueryApiV2.java", "diffHunk": "@@ -151,6 +151,7 @@ public AggregatedHttpResponse getTraces(\n   @Get(\"/api/v2/trace/{traceId}\")\n   @Blocking\n   public AggregatedHttpResponse getTrace(@Param(\"traceId\") String traceId) throws IOException {\n+    traceId = traceId != null ? traceId.trim() :null;", "originalCommit": "59d53d590cf26211fdc30ee2171eb092fcee3ae5", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "68b8743223f824ab83316c18547cd53f651640d9", "url": "https://github.com/openzipkin/zipkin/commit/68b8743223f824ab83316c18547cd53f651640d9", "message": "format", "committedDate": "2020-05-15T02:40:55Z", "type": "commit"}, {"oid": "5c75bd9501b146bce58f8e3c3c2cc8b02d8d6b21", "url": "https://github.com/openzipkin/zipkin/commit/5c75bd9501b146bce58f8e3c3c2cc8b02d8d6b21", "message": "add test\n\nadd trim test", "committedDate": "2020-05-15T02:56:59Z", "type": "commit"}]}