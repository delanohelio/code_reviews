{"pr_number": 3668, "pr_title": "[Memory Engine] Add TabletType to PartitionInfo and TabletMeta", "pr_author": "decster", "pr_createdAt": "2020-05-22T11:42:34Z", "pr_url": "https://github.com/apache/incubator-doris/pull/3668", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDE4MzkwNA==", "url": "https://github.com/apache/incubator-doris/pull/3668#discussion_r430183904", "body": "You should add constraint about ALTER TABLE.\r\nIf I have a disk table.\r\n```\r\nALTER TABLE test SET(\"tablet_type\"=\"memory\");\r\n```\r\nwill be encounter error in BE processing.", "bodyText": "You should add constraint about ALTER TABLE.\nIf I have a disk table.\nALTER TABLE test SET(\"tablet_type\"=\"memory\");\n\nwill be encounter error in BE processing.", "bodyHTML": "<p dir=\"auto\">You should add constraint about ALTER TABLE.<br>\nIf I have a disk table.</p>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ALTER TABLE test SET(&quot;tablet_type&quot;=&quot;memory&quot;);\n\"><pre><code>ALTER TABLE test SET(\"tablet_type\"=\"memory\");\n</code></pre></div>\n<p dir=\"auto\">will be encounter error in BE processing.</p>", "author": "chaoyli", "createdAt": "2020-05-26T06:32:49Z", "path": "fe/src/main/java/org/apache/doris/alter/SchemaChangeJobV2.java", "diffHunk": "@@ -240,7 +240,8 @@ protected void runPendingJob() throws AlterCancelException {\n                                     Partition.PARTITION_INIT_VERSION, Partition.PARTITION_INIT_VERSION_HASH,\n                                     tbl.getKeysType(), TStorageType.COLUMN, storageMedium,\n                                     shadowSchema, bfColumns, bfFpp, countDownLatch, indexes,\n-                                    tbl.isInMemory());\n+                                    tbl.isInMemory(),\n+                                    tbl.getPartitionInfo().getTabletType(partitionId));\n                             createReplicaTask.setBaseTablet(partitionIndexTabletMap.get(partitionId, shadowIdxId).get(shadowTabletId), originSchemaHash);", "originalCommit": "4c20b5d7e14a15f59aefcc9e90a944f78abb03ed", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTIwMjc3OA==", "url": "https://github.com/apache/incubator-doris/pull/3668#discussion_r431202778", "body": "modify the comment", "bodyText": "modify the comment", "bodyHTML": "<p dir=\"auto\">modify the comment</p>", "author": "morningman", "createdAt": "2020-05-27T14:56:00Z", "path": "fe/src/main/java/org/apache/doris/common/util/PropertyAnalyzer.java", "diffHunk": "@@ -233,6 +236,23 @@ public static TStorageType analyzeStorageType(Map<String, String> properties) th\n         return tStorageType;\n     }\n \n+    public static TTabletType analyzeTabletType(Map<String, String> properties) throws AnalysisException {\n+        // default is COLUMN", "originalCommit": "1cef0cb5ce8743ec68f0d1baaecb71a108c8965e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTY2NTMzOQ==", "url": "https://github.com/apache/incubator-doris/pull/3668#discussion_r431665339", "bodyText": "fixed", "author": "decster", "createdAt": "2020-05-28T08:24:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTIwMjc3OA=="}], "type": "inlineReview"}, {"oid": "a3c0d9005017b550b388a51c069626490f46959f", "url": "https://github.com/apache/incubator-doris/commit/a3c0d9005017b550b388a51c069626490f46959f", "message": "[Memory Engine] Add TabletType to PartitionInfo and TabletMeta", "committedDate": "2020-05-29T09:04:32Z", "type": "commit"}, {"oid": "ff3215d6f82990fa0174448acab526746c9a4bec", "url": "https://github.com/apache/incubator-doris/commit/ff3215d6f82990fa0174448acab526746c9a4bec", "message": "[Memory Engine] Add TabletType to PartitionInfo and TabletMeta: fix java build error", "committedDate": "2020-05-29T09:04:32Z", "type": "commit"}, {"oid": "7ef7f336dfb03456dcc92fdb16a2b3563bf426f7", "url": "https://github.com/apache/incubator-doris/commit/7ef7f336dfb03456dcc92fdb16a2b3563bf426f7", "message": "[Memory Engine] Add TabletType to PartitionInfo and TabletMeta: fix UT error", "committedDate": "2020-05-29T09:04:32Z", "type": "commit"}, {"oid": "4546fdd618da499888530be5f7c7ebb3e536d4e8", "url": "https://github.com/apache/incubator-doris/commit/4546fdd618da499888530be5f7c7ebb3e536d4e8", "message": "[Memory Engine] Add TabletType to PartitionInfo and TabletMeta: address review comments", "committedDate": "2020-05-29T09:04:32Z", "type": "commit"}, {"oid": "ce70ac4808795e6cd595edeffcc42f7b547bc113", "url": "https://github.com/apache/incubator-doris/commit/ce70ac4808795e6cd595edeffcc42f7b547bc113", "message": "[Memory Engine] Add TabletType to PartitionInfo and TabletMeta: address review comments", "committedDate": "2020-05-29T09:04:32Z", "type": "commit"}, {"oid": "ce70ac4808795e6cd595edeffcc42f7b547bc113", "url": "https://github.com/apache/incubator-doris/commit/ce70ac4808795e6cd595edeffcc42f7b547bc113", "message": "[Memory Engine] Add TabletType to PartitionInfo and TabletMeta: address review comments", "committedDate": "2020-05-29T09:04:32Z", "type": "forcePushed"}]}