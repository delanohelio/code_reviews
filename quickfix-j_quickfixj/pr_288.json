{"pr_number": 288, "pr_title": "QFJ-375 - configurable timeout multiplier", "pr_author": "the-thing", "pr_createdAt": "2020-05-15T09:30:51Z", "pr_url": "https://github.com/quickfix-j/quickfixj/pull/288", "merge_commit": "5a31fcd730829841d35a34919b351f487f288347", "timeline": [{"oid": "810ba9d4486753ddd7426d3bd4c90899824b34e3", "url": "https://github.com/quickfix-j/quickfixj/commit/810ba9d4486753ddd7426d3bd4c90899824b34e3", "message": "QFJ-375 - configurable timeout multiplier", "committedDate": "2020-05-15T09:17:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMxODYzOQ==", "url": "https://github.com/quickfix-j/quickfixj/pull/288#discussion_r427318639", "body": "Just a nitpick: could we remove the access modifier to enable access from within the package?", "bodyText": "Just a nitpick: could we remove the access modifier to enable access from within the package?", "bodyHTML": "<p dir=\"auto\">Just a nitpick: could we remove the access modifier to enable access from within the package?</p>", "author": "chrjohn", "createdAt": "2020-05-19T13:52:06Z", "path": "quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java", "diffHunk": "@@ -40,7 +40,7 @@ public void setSystemTimes(long[] times) {\n         systemTimes = times;\n     }\n \n-    private void setSystemTimes(long time) {\n+    public void setSystemTimes(long time) {", "originalCommit": "810ba9d4486753ddd7426d3bd4c90899824b34e3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzM5OTMzNg==", "url": "https://github.com/quickfix-j/quickfixj/pull/288#discussion_r427399336", "bodyText": "No problem. Done.", "author": "the-thing", "createdAt": "2020-05-19T15:35:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMxODYzOQ=="}], "type": "inlineReview", "revised_code": {"commit": "de4a975a0a6f54641a8e22e0ac75d059cbdcfd54", "changed_code": [{"header": "diff --git a/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java b/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java\nindex e0ecbe78..3c9dea46 100644\n--- a/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java\n+++ b/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java\n", "chunk": "@@ -40,7 +40,7 @@ public class MockSystemTimeSource implements SystemTimeSource {\n         systemTimes = times;\n     }\n \n-    public void setSystemTimes(long time) {\n+    void setSystemTimes(long time) {\n         systemTimes = new long[] { time };\n     }\n \n", "next_change": null}]}, "revised_code_in_main": {"commit": "5a31fcd730829841d35a34919b351f487f288347", "changed_code": [{"header": "diff --git a/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java b/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java\nindex e0ecbe78..3c9dea46 100644\n--- a/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java\n+++ b/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java\n", "chunk": "@@ -40,7 +40,7 @@ public class MockSystemTimeSource implements SystemTimeSource {\n         systemTimes = times;\n     }\n \n-    public void setSystemTimes(long time) {\n+    void setSystemTimes(long time) {\n         systemTimes = new long[] { time };\n     }\n \n", "next_change": null}]}, "commits_in_main": [{"oid": "5a31fcd730829841d35a34919b351f487f288347", "message": "Merge commit", "committedDate": null}]}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzMxODY1Ng==", "url": "https://github.com/quickfix-j/quickfixj/pull/288#discussion_r427318656", "body": "Just a nitpick: could we remove the access modifier to enable access from within the package?", "bodyText": "Just a nitpick: could we remove the access modifier to enable access from within the package?", "bodyHTML": "<p dir=\"auto\">Just a nitpick: could we remove the access modifier to enable access from within the package?</p>", "author": "chrjohn", "createdAt": "2020-05-19T13:52:08Z", "path": "quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java", "diffHunk": "@@ -40,7 +40,7 @@ public void setSystemTimes(long[] times) {\n         systemTimes = times;\n     }\n \n-    private void setSystemTimes(long time) {\n+    public void setSystemTimes(long time) {", "originalCommit": "810ba9d4486753ddd7426d3bd4c90899824b34e3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "de4a975a0a6f54641a8e22e0ac75d059cbdcfd54", "changed_code": [{"header": "diff --git a/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java b/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java\nindex e0ecbe78..3c9dea46 100644\n--- a/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java\n+++ b/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java\n", "chunk": "@@ -40,7 +40,7 @@ public class MockSystemTimeSource implements SystemTimeSource {\n         systemTimes = times;\n     }\n \n-    public void setSystemTimes(long time) {\n+    void setSystemTimes(long time) {\n         systemTimes = new long[] { time };\n     }\n \n", "next_change": null}]}, "revised_code_in_main": {"commit": "5a31fcd730829841d35a34919b351f487f288347", "changed_code": [{"header": "diff --git a/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java b/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java\nindex e0ecbe78..3c9dea46 100644\n--- a/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java\n+++ b/quickfixj-core/src/test/java/quickfix/MockSystemTimeSource.java\n", "chunk": "@@ -40,7 +40,7 @@ public class MockSystemTimeSource implements SystemTimeSource {\n         systemTimes = times;\n     }\n \n-    public void setSystemTimes(long time) {\n+    void setSystemTimes(long time) {\n         systemTimes = new long[] { time };\n     }\n \n", "next_change": null}]}, "commits_in_main": [{"oid": "5a31fcd730829841d35a34919b351f487f288347", "message": "Merge commit", "committedDate": null}]}, {"oid": "de4a975a0a6f54641a8e22e0ac75d059cbdcfd54", "url": "https://github.com/quickfix-j/quickfixj/commit/de4a975a0a6f54641a8e22e0ac75d059cbdcfd54", "message": "QFJ-375 - configurable timeout multiplier", "committedDate": "2020-05-19T15:31:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU3MTcwNQ==", "url": "https://github.com/quickfix-j/quickfixj/pull/288#discussion_r427571705", "body": "Instead of using this magic number, what about using `Session.DEFAULT_HEARTBEAT_TIMEOUT_MULTIPLIER` in this test?", "bodyText": "Instead of using this magic number, what about using Session.DEFAULT_HEARTBEAT_TIMEOUT_MULTIPLIER in this test?", "bodyHTML": "<p dir=\"auto\">Instead of using this magic number, what about using <code>Session.DEFAULT_HEARTBEAT_TIMEOUT_MULTIPLIER</code> in this test?</p>", "author": "chrjohn", "createdAt": "2020-05-19T20:13:27Z", "path": "quickfixj-core/src/test/java/quickfix/SessionTest.java", "diffHunk": "@@ -101,7 +101,7 @@ public void testDisposalOfFileResources() throws Exception {\n                 new DefaultMessageFactory(), 30, false, 30, UtcTimestampPrecision.MILLIS, true, false,\n                 false, false, false, false, true, false, 1.5, null, true,\n                 new int[] { 5 }, false, false, false, false, true, false, true, false,\n-                null, true, 0, false, false, true, new ArrayList<>())) {\n+                null, true, 0, false, false, true, new ArrayList<>(), 1.4)) {", "originalCommit": "810ba9d4486753ddd7426d3bd4c90899824b34e3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU4MDM1MA==", "url": "https://github.com/quickfix-j/quickfixj/pull/288#discussion_r427580350", "bodyText": "Changed in the whole file.", "author": "the-thing", "createdAt": "2020-05-19T20:29:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU3MTcwNQ=="}], "type": "inlineReview", "revised_code": {"commit": "42aea7beb1565d406f146f54cf8a93a8e6bc149f", "changed_code": [{"header": "diff --git a/quickfixj-core/src/test/java/quickfix/SessionTest.java b/quickfixj-core/src/test/java/quickfix/SessionTest.java\nindex 6193099c..2a2bb003 100644\n--- a/quickfixj-core/src/test/java/quickfix/SessionTest.java\n+++ b/quickfixj-core/src/test/java/quickfix/SessionTest.java\n", "chunk": "@@ -101,7 +101,7 @@ public class SessionTest {\n                 new DefaultMessageFactory(), 30, false, 30, UtcTimestampPrecision.MILLIS, true, false,\n                 false, false, false, false, true, false, 1.5, null, true,\n                 new int[] { 5 }, false, false, false, false, true, false, true, false,\n-                null, true, 0, false, false, true, new ArrayList<>(), 1.4)) {\n+                null, true, 0, false, false, true, new ArrayList<>(), Session.DEFAULT_HEARTBEAT_TIMEOUT_MULTIPLIER)) {\n             // Simulate socket disconnect\n             session.setResponder(null);\n         }\n", "next_change": null}]}, "revised_code_in_main": {"commit": "5a31fcd730829841d35a34919b351f487f288347", "changed_code": [{"header": "diff --git a/quickfixj-core/src/test/java/quickfix/SessionTest.java b/quickfixj-core/src/test/java/quickfix/SessionTest.java\nindex 6193099c..2a2bb003 100644\n--- a/quickfixj-core/src/test/java/quickfix/SessionTest.java\n+++ b/quickfixj-core/src/test/java/quickfix/SessionTest.java\n", "chunk": "@@ -101,7 +101,7 @@ public class SessionTest {\n                 new DefaultMessageFactory(), 30, false, 30, UtcTimestampPrecision.MILLIS, true, false,\n                 false, false, false, false, true, false, 1.5, null, true,\n                 new int[] { 5 }, false, false, false, false, true, false, true, false,\n-                null, true, 0, false, false, true, new ArrayList<>(), 1.4)) {\n+                null, true, 0, false, false, true, new ArrayList<>(), Session.DEFAULT_HEARTBEAT_TIMEOUT_MULTIPLIER)) {\n             // Simulate socket disconnect\n             session.setResponder(null);\n         }\n", "next_change": {"commit": "8eba4b31d4ba28f65450f545d71fecb5d17dcf21", "changed_code": [{"header": "diff --git a/quickfixj-core/src/test/java/quickfix/SessionTest.java b/quickfixj-core/src/test/java/quickfix/SessionTest.java\nindex 2a2bb003..c59c9280 100644\n--- a/quickfixj-core/src/test/java/quickfix/SessionTest.java\n+++ b/quickfixj-core/src/test/java/quickfix/SessionTest.java\n", "chunk": "@@ -101,7 +103,7 @@ public class SessionTest {\n                 new DefaultMessageFactory(), 30, false, 30, UtcTimestampPrecision.MILLIS, true, false,\n                 false, false, false, false, true, false, 1.5, null, true,\n                 new int[] { 5 }, false, false, false, false, true, false, true, false,\n-                null, true, 0, false, false, true, new ArrayList<>(), Session.DEFAULT_HEARTBEAT_TIMEOUT_MULTIPLIER)) {\n+                null, true, 0, false, false, true, new ArrayList<>(), Session.DEFAULT_HEARTBEAT_TIMEOUT_MULTIPLIER, false)) {\n             // Simulate socket disconnect\n             session.setResponder(null);\n         }\n", "next_change": {"commit": "ee9b2daf3685b5427221a78131bff6ab23972d19", "changed_code": [{"header": "diff --git a/quickfixj-core/src/test/java/quickfix/SessionTest.java b/quickfixj-core/src/test/java/quickfix/SessionTest.java\nindex c59c9280..98d2f7ff 100644\n--- a/quickfixj-core/src/test/java/quickfix/SessionTest.java\n+++ b/quickfixj-core/src/test/java/quickfix/SessionTest.java\n", "chunk": "@@ -91,15 +90,18 @@ public class SessionTest {\n \n         final MessageStoreFactory mockMessageStoreFactory = mock(MessageStoreFactory.class);\n         final CloseableMessageStore mockMessageStore = mock(CloseableMessageStore.class);\n-        stub(mockMessageStoreFactory.create(sessionID)).toReturn(\n-                mockMessageStore);\n+        when(mockMessageStoreFactory.create(sessionID)).thenReturn(mockMessageStore);\n+\n+        final MessageQueueFactory mockMessageQueueFactory = mock(MessageQueueFactory.class);\n+        final MessageQueue mockMessageQueue = mock(MessageQueue.class);\n+        when(mockMessageQueueFactory.create(sessionID)).thenReturn(mockMessageQueue);\n \n         final LogFactory mockLogFactory = mock(LogFactory.class);\n         final CloseableLog mockLog = mock(CloseableLog.class);\n-        stub(mockLogFactory.create(sessionID)).toReturn(mockLog);\n+        when(mockLogFactory.create(sessionID)).thenReturn(mockLog);\n \n         try (Session session = new Session(application,\n-                mockMessageStoreFactory, sessionID, null, null, mockLogFactory,\n+                mockMessageStoreFactory, mockMessageQueueFactory, sessionID, null, null, mockLogFactory,\n                 new DefaultMessageFactory(), 30, false, 30, UtcTimestampPrecision.MILLIS, true, false,\n                 false, false, false, false, true, false, 1.5, null, true,\n                 new int[] { 5 }, false, false, false, false, true, false, true, false,\n", "next_change": null}]}}]}}]}, "commits_in_main": [{"oid": "5a31fcd730829841d35a34919b351f487f288347", "message": "Merge commit", "committedDate": null}, {"oid": "17f0239b6d276c8b981608fd771aeb1d856c2c7b", "committedDate": "2021-02-08 00:16:43 +0100", "message": "Wait for Logout response or timeout before disconnect on session reset (#312)"}, {"oid": "895224da1a05055bc99d936920d1e1ed7edc9935", "committedDate": "2021-04-03 01:05:49 +0200", "message": "Preventing the acceptor session from accepting Logon message when Logout was initiated locally. (#360)"}, {"oid": "8eba4b31d4ba28f65450f545d71fecb5d17dcf21", "committedDate": "2021-07-30 12:28:06 +0200", "message": "allow sending unchanged message in `Session#send` (#395)"}, {"oid": "ce6c3edb0345756a11972e529ba4b7778bc083bd", "committedDate": "2021-09-28 00:51:36 +0200", "message": "Add `SessionID` to `SessionStateListener` methods (#370)"}, {"oid": "5aa37ef2fb1af1ab700ece0f0d4542fddc5f8560", "committedDate": "2021-10-08 23:24:16 +0200", "message": "update Mockito to 3.x and switch build to JDK17 (#416)"}, {"oid": "ee9b2daf3685b5427221a78131bff6ab23972d19", "committedDate": "2022-09-12 13:57:01 +0200", "message": "[QFJ-968] Allow provision of custom Message Queue implementation (#380)"}, {"oid": "0ef2ac42ac9966a965b9e811713b9b8c6bc7c32c", "committedDate": "2022-10-07 11:26:35 +0200", "message": "Validate `Logon` message before acting upon `ResetMsgSeqNum` flag (#549)"}, {"oid": "fcb33efa7d62fddcb062e0b72798a9ac169d75fe", "committedDate": "2022-12-19 19:21:51 +0100", "message": "Bump mockito-core from 3.12.4 to 4.10.0 (#587)"}]}, {"oid": "42aea7beb1565d406f146f54cf8a93a8e6bc149f", "url": "https://github.com/quickfix-j/quickfixj/commit/42aea7beb1565d406f146f54cf8a93a8e6bc149f", "message": "QFJ-375 - replaced heartbeat timeout multiplier magic number with default value in unit test", "committedDate": "2020-05-19T20:27:19Z", "type": "commit"}, {"oid": "42aea7beb1565d406f146f54cf8a93a8e6bc149f", "url": "https://github.com/quickfix-j/quickfixj/commit/42aea7beb1565d406f146f54cf8a93a8e6bc149f", "message": "QFJ-375 - replaced heartbeat timeout multiplier magic number with default value in unit test", "committedDate": "2020-05-19T20:27:19Z", "type": "forcePushed"}]}