{"pr_number": 678, "pr_title": "add sm binary code to Java contract", "pr_author": "ywy2090", "pr_createdAt": "2020-07-07T12:10:18Z", "pr_url": "https://github.com/FISCO-BCOS/web3sdk/pull/678", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQwMg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816402", "body": "__[PMD Java]__ Rather than using a lot of String arguments, consider using a container object for those values. ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116791))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `UseObjectForClearerAPI` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#useobjectforclearerapi>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116791) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Rather than using a lot of String arguments, consider using a container object for those values. (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nUseObjectForClearerAPI\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#useobjectforclearerapi\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Rather than using a lot of String arguments, consider using a container object for those values. (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116791\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>UseObjectForClearerAPI</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#useobjectforclearerapi\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#useobjectforclearerapi</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116791\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:55Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -114,20 +121,38 @@ public void generateJavaFiles(\n             String destinationDir,\n             String basePackageName)\n             throws IOException, ClassNotFoundException {\n-        abiContent = abi;\n-        generateJavaFiles(\n-                contractName,\n-                bin,\n-                loadContractDefinition(abi),\n-                destinationDir,\n-                basePackageName,\n-                null);\n+\n+        generateJavaFiles(contractName, bin, null, abi, destinationDir, basePackageName);\n+    }\n+\n+    public void generateJavaFiles(", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQwOQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816409", "body": "__[PMD Java]__ A method or constructor should not explicitly declare unchecked exceptions in its 'throws' clause ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116792))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `AvoidUncheckedExceptionsInSignatures` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116792) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] A method or constructor should not explicitly declare unchecked exceptions in its 'throws' clause (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nAvoidUncheckedExceptionsInSignatures\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> A method or constructor should not explicitly declare unchecked exceptions in its 'throws' clause (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116792\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>AvoidUncheckedExceptionsInSignatures</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116792\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:56Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -114,20 +121,38 @@ public void generateJavaFiles(\n             String destinationDir,\n             String basePackageName)\n             throws IOException, ClassNotFoundException {\n-        abiContent = abi;\n-        generateJavaFiles(\n-                contractName,\n-                bin,\n-                loadContractDefinition(abi),\n-                destinationDir,\n-                basePackageName,\n-                null);\n+\n+        generateJavaFiles(contractName, bin, null, abi, destinationDir, basePackageName);\n+    }\n+\n+    public void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String smBin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName)\n+            throws IOException, ClassNotFoundException {\n+\n+        generateJavaFiles(contractName, bin, smBin, abi, destinationDir, basePackageName, null);\n+    }\n+\n+    void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName,\n+            Map<String, String> addresses)\n+            throws IOException, ClassNotFoundException, UnsupportedOperationException {", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQxMQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816411", "body": "__[PMD Java]__ Potential violation of Law of Demeter (method chain calls) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116793))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116793) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (method chain calls) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116793\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116793\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:56Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -140,48 +165,57 @@ void generateJavaFiles(\n                             + Integer.valueOf(bin.length()));\n         }\n \n-        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, abi);\n+        List<AbiDefinition> abiDefinitions = loadContractDefinition(abi);\n+        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, smBin, abi);\n \n+        classBuilder.addMethod(buildBinaryMethod(smBin));\n         classBuilder.addMethod(buildReturnTransactionDecoder());\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, true));\n-        classBuilder.addFields(buildFuncNameConstants(abi));\n-        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abi));\n+        classBuilder.addFields(buildFuncNameConstants(abiDefinitions));\n+        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abiDefinitions));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, true));\n         if (!bin.equals(Contract.BIN_NOT_PROVIDED)) {\n-            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abi));\n+            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abiDefinitions));\n         }\n \n         write(basePackageName, classBuilder.build(), destinationDir);\n     }\n \n     private TypeSpec.Builder createClassBuilder(\n-            String className, String binary, List<AbiDefinition> abi) {\n+            String className, String binary, String smBinary, String abi) {\n \n         String javadoc = CODEGEN_WARNING + getWeb3jVersion();\n+        TypeSpec.Builder builder =\n+                TypeSpec.classBuilder(className)\n+                        .addModifiers(Modifier.PUBLIC)\n+                        .addJavadoc(javadoc)\n+                        .superclass(Contract.class)\n+                        .addAnnotation(\n+                                AnnotationSpec.builder(SuppressWarnings.class)", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQxMw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816413", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116794))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116794) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116794\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116794\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:56Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +256,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQxOQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816419", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116795))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116795) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116795\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116795\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:56Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +256,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQyMQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816421", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116796))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116796) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116796\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116796\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:56Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +256,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQyNA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816424", "body": "__[PMD Java]__ Potential violation of Law of Demeter (method chain calls) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116797))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116797) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (method chain calls) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116797\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116797\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:56Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +256,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n+        return FieldSpec.builder(String[].class, \"SM_BINARY_ARRAY\")", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQyOA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816428", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116798))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116798) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116798\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116798\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:57Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +256,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n+        return FieldSpec.builder(String[].class, \"SM_BINARY_ARRAY\")\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQyOQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816429", "body": "__[PMD Java]__ Potential violation of Law of Demeter (method chain calls) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116799))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116799) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (method chain calls) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116799\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116799\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:57Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +289,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n-\n-            String item = abiContent.substring(offset, offset + length);\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQzMA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816430", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116800))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116800) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116800\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116800\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:57Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +289,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n-\n-            String item = abiContent.substring(offset, offset + length);\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"String.join(\\\"\\\", SM_BINARY_ARRAY)\")\n+                .build();\n+    }\n \n-            abiArray.add(item);\n-            offset += item.length();\n-        }\n+    private FieldSpec createABIArrayDefinition(String abi) {\n+        List<String> abiArray = stringToArrayString(abi);\n+        List<String> formatArray = new ArrayList<>(Collections.nCopies(abiArray.size(), \"$S\"));", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQzMw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816433", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116801))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116801) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116801\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116801\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:57Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +289,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n-\n-            String item = abiContent.substring(offset, offset + length);\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"String.join(\\\"\\\", SM_BINARY_ARRAY)\")\n+                .build();\n+    }\n \n-            abiArray.add(item);\n-            offset += item.length();\n-        }\n+    private FieldSpec createABIArrayDefinition(String abi) {\n+        List<String> abiArray = stringToArrayString(abi);\n+        List<String> formatArray = new ArrayList<>(Collections.nCopies(abiArray.size(), \"$S\"));\n \n         return FieldSpec.builder(String[].class, \"ABI_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", abiArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", abiArray.toArray())", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQzNg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816436", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116802))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116802) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116802\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116802\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:57Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -465,6 +509,27 @@ private static MethodSpec buildReturnTransactionDecoder() {\n         return toReturn.build();\n     }\n \n+    private static MethodSpec buildBinaryMethod(String smBin) {\n+\n+        MethodSpec.Builder toReturn =\n+                MethodSpec.methodBuilder(\"getBinary\")\n+                        .addModifiers(Modifier.PUBLIC, Modifier.STATIC)\n+                        .returns(String.class);\n+\n+        if (smBin.equals(Contract.BIN_NOT_PROVIDED)) {\n+            toReturn.addStatement(\"return $N\", BINARY);\n+        } else {\n+            toReturn.addStatement(\n+                    \"return ($T.encryptType == $T.ECDSA_TYPE ? $N : $N)\",\n+                    EncryptType.class,\n+                    EncryptType.class,\n+                    BINARY,\n+                    SM_BINARY);\n+        }\n+\n+        return toReturn.build();", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQzNw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816437", "body": "__[PMD Java]__ Found non-transient, non-static member. Please mark as transient or provide accessors. ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116803))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `BeanMembersShouldSerialize` | Error Prone | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116803) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Found non-transient, non-static member. Please mark as transient or provide accessors. (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nBeanMembersShouldSerialize\nError Prone\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Found non-transient, non-static member. Please mark as transient or provide accessors. (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116803\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>BeanMembersShouldSerialize</code></td>\n<td>Error Prone</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116803\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:57Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "diffHunk": "@@ -41,6 +43,7 @@\n      */\n \n     private final File binFile;\n+    private final File smBinFile;", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ0MA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816440", "body": "__[PMD Java]__ Found 'DD'-anomaly for variable 'smBinary' (lines '80'-'88'). ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116804))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `DataflowAnomalyAnalysis` | Error Prone | 5 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116804) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Found 'DD'-anomaly for variable 'smBinary' (lines '80'-'88'). (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nDataflowAnomalyAnalysis\nError Prone\n5\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Found 'DD'-anomaly for variable 'smBinary' (lines '80'-'88'). (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116804\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>DataflowAnomalyAnalysis</code></td>\n<td>Error Prone</td>\n<td>5</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116804\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:58Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "diffHunk": "@@ -63,11 +77,17 @@ private SolidityFunctionWrapperGenerator(\n \n     private void generate() throws IOException, ClassNotFoundException {\n         String binary = Contract.BIN_NOT_PROVIDED;\n+        String smBinary = Contract.BIN_NOT_PROVIDED;", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ0Mg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816442", "body": "__[PMD Java]__ Found 'DU'-anomaly for variable 'smBinary' (lines '80'-'109'). ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116805))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `DataflowAnomalyAnalysis` | Error Prone | 5 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116805) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Found 'DU'-anomaly for variable 'smBinary' (lines '80'-'109'). (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nDataflowAnomalyAnalysis\nError Prone\n5\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Found 'DU'-anomaly for variable 'smBinary' (lines '80'-'109'). (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116805\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>DataflowAnomalyAnalysis</code></td>\n<td>Error Prone</td>\n<td>5</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116805\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:58Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "diffHunk": "@@ -63,11 +77,17 @@ private SolidityFunctionWrapperGenerator(\n \n     private void generate() throws IOException, ClassNotFoundException {\n         String binary = Contract.BIN_NOT_PROVIDED;\n+        String smBinary = Contract.BIN_NOT_PROVIDED;", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ0NA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816444", "body": "__[PMD Java]__ Found 'DU'-anomaly for variable 'smBinary' (lines '88'-'109'). ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116806))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `DataflowAnomalyAnalysis` | Error Prone | 5 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116806) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Found 'DU'-anomaly for variable 'smBinary' (lines '88'-'109'). (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nDataflowAnomalyAnalysis\nError Prone\n5\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Found 'DU'-anomaly for variable 'smBinary' (lines '88'-'109'). (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116806\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>DataflowAnomalyAnalysis</code></td>\n<td>Error Prone</td>\n<td>5</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116806\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:58Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "diffHunk": "@@ -63,11 +77,17 @@ private SolidityFunctionWrapperGenerator(\n \n     private void generate() throws IOException, ClassNotFoundException {\n         String binary = Contract.BIN_NOT_PROVIDED;\n+        String smBinary = Contract.BIN_NOT_PROVIDED;\n         if (binFile != null) {\n             byte[] bytes = Files.readBytes(binFile);\n             binary = new String(bytes);\n         }\n \n+        if (smBinFile != null) {\n+            byte[] bytes = Files.readBytes(smBinFile);\n+            smBinary = new String(bytes);", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ0Ng==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816446", "body": "__[PMD Java]__ Found non-transient, non-static member. Please mark as transient or provide accessors. ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116807))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `BeanMembersShouldSerialize` | Error Prone | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116807) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Found non-transient, non-static member. Please mark as transient or provide accessors. (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nBeanMembersShouldSerialize\nError Prone\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Found non-transient, non-static member. Please mark as transient or provide accessors. (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116807\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>BeanMembersShouldSerialize</code></td>\n<td>Error Prone</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116807\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:58Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapperGenerator.java", "diffHunk": "@@ -119,6 +140,14 @@ public static void main(String[] args) {\n                 required = false)\n         private File binFile;\n \n+        @Option(\n+                names = {\"-s\", \"--smBinFile\"},\n+                description =\n+                        \"sm bin file with contract compiled code \"\n+                                + \"in order to generate deploy methods.\",\n+                required = false)\n+        private File smBinFile;", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ0OA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816448", "body": "__[PMD Java]__ Found non-transient, non-static member. Please mark as transient or provide accessors. ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116808))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `BeanMembersShouldSerialize` | Error Prone | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116808) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Found non-transient, non-static member. Please mark as transient or provide accessors. (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nBeanMembersShouldSerialize\nError Prone\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Found non-transient, non-static member. Please mark as transient or provide accessors. (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116808\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>BeanMembersShouldSerialize</code></td>\n<td>Error Prone</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#beanmembersshouldserialize</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116808\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:58Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/TruffleJsonFunctionWrapperGenerator.java", "diffHunk": "@@ -161,7 +160,7 @@ private void generate() throws IOException, ClassNotFoundException {\n         public String contractName;\n \n         @JsonProperty(value = \"abi\", required = true)\n-        public List<AbiDefinition> abi;\n+        public String abi;", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ1Mw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816453", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116809))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116809) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116809\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116809\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:59Z", "path": "src/main/java/org/fisco/bcos/web3j/tx/txdecode/TransactionDecoderFactory.java", "diffHunk": "@@ -64,11 +64,11 @@ private static TransactionDecoder compileContract(String contractName, File solF\n                 continue;\n             }\n             SolidityCompiler.Result res =\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\n-            if (\"\".equals(res.output)) {\n-                throw new CompileSolidityException(\"Compile error: \" + res.errors);\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\n+            if (\"\".equals(res.getOutput())) {", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ1NQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816455", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116810))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116810) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116810\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116810\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:59Z", "path": "src/main/java/org/fisco/bcos/web3j/tx/txdecode/TransactionDecoderFactory.java", "diffHunk": "@@ -64,11 +64,11 @@ private static TransactionDecoder compileContract(String contractName, File solF\n                 continue;\n             }\n             SolidityCompiler.Result res =\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\n-            if (\"\".equals(res.output)) {\n-                throw new CompileSolidityException(\"Compile error: \" + res.errors);\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\n+            if (\"\".equals(res.getOutput())) {\n+                throw new CompileSolidityException(\"Compile error: \" + res.getErrors());", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ1Ng==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816456", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116811))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116811) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116811\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116811\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:59Z", "path": "src/main/java/org/fisco/bcos/web3j/tx/txdecode/TransactionDecoderFactory.java", "diffHunk": "@@ -64,11 +64,11 @@ private static TransactionDecoder compileContract(String contractName, File solF\n                 continue;\n             }\n             SolidityCompiler.Result res =\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\n-            if (\"\".equals(res.output)) {\n-                throw new CompileSolidityException(\"Compile error: \" + res.errors);\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\n+            if (\"\".equals(res.getOutput())) {\n+                throw new CompileSolidityException(\"Compile error: \" + res.getErrors());\n             }\n-            CompilationResult result = CompilationResult.parse(res.output);\n+            CompilationResult result = CompilationResult.parse(res.getOutput());", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ2MA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816460", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116812))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116812) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116812\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116812\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:59Z", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ2Mg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816462", "body": "__[PMD Java]__ System.out.println is used ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116813))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `SystemPrintln` | Best Practices | 2 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_bestpractices.html#systemprintln>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116813) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] System.out.println is used (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nSystemPrintln\nBest Practices\n2\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_bestpractices.html#systemprintln\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> System.out.println is used (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116813\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>SystemPrintln</code></td>\n<td>Best Practices</td>\n<td>2</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_bestpractices.html#systemprintln\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_bestpractices.html#systemprintln</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116813\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:10:59Z", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ2Nw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816467", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116814))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116814) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116814\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116814\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:11:00Z", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ3MQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816471", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116815))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116815) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116815\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116815\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:11:00Z", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r\n                 return;\r\n             }\r\n-            CompilationResult result = CompilationResult.parse(res.output);\r\n+\r\n+            /** sm compile */\r\n+            SolidityCompiler.Result smRes =\r\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (smRes.isFailed() || \"\".equals(smRes.getOutput())) {\r", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ3Mw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816473", "body": "__[PMD Java]__ Avoid using Literals in Conditional Statements ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116816))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `AvoidLiteralsInIfCondition` | Error Prone | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#avoidliteralsinifcondition>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116816) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Avoid using Literals in Conditional Statements (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nAvoidLiteralsInIfCondition\nError Prone\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#avoidliteralsinifcondition\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Avoid using Literals in Conditional Statements (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116816\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>AvoidLiteralsInIfCondition</code></td>\n<td>Error Prone</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#avoidliteralsinifcondition\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#avoidliteralsinifcondition</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116816\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:11:00Z", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r\n                 return;\r\n             }\r\n-            CompilationResult result = CompilationResult.parse(res.output);\r\n+\r\n+            /** sm compile */\r\n+            SolidityCompiler.Result smRes =\r\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (smRes.isFailed() || \"\".equals(smRes.getOutput())) {\r", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ3Nw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816477", "body": "__[PMD Java]__ System.out.println is used ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116817))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `SystemPrintln` | Best Practices | 2 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_bestpractices.html#systemprintln>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116817) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] System.out.println is used (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nSystemPrintln\nBest Practices\n2\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_bestpractices.html#systemprintln\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> System.out.println is used (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116817\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>SystemPrintln</code></td>\n<td>Best Practices</td>\n<td>2</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_bestpractices.html#systemprintln\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_bestpractices.html#systemprintln</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116817\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:11:00Z", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r\n                 return;\r\n             }\r\n-            CompilationResult result = CompilationResult.parse(res.output);\r\n+\r\n+            /** sm compile */\r\n+            SolidityCompiler.Result smRes =\r\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (smRes.isFailed() || \"\".equals(smRes.getOutput())) {\r\n+                System.out.println(\"Compile SM error: \" + res.getErrors());\r", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ3OQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816479", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116818))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116818) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116818\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116818\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:11:00Z", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r\n                 return;\r\n             }\r\n-            CompilationResult result = CompilationResult.parse(res.output);\r\n+\r\n+            /** sm compile */\r\n+            SolidityCompiler.Result smRes =\r\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (smRes.isFailed() || \"\".equals(smRes.getOutput())) {\r\n+                System.out.println(\"Compile SM error: \" + res.getErrors());\r", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ4Mg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816482", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116819))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116819) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116819\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116819\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:11:00Z", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r\n                 return;\r\n             }\r\n-            CompilationResult result = CompilationResult.parse(res.output);\r\n+\r\n+            /** sm compile */\r\n+            SolidityCompiler.Result smRes =\r\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (smRes.isFailed() || \"\".equals(smRes.getOutput())) {\r\n+                System.out.println(\"Compile SM error: \" + res.getErrors());\r\n+                return;\r\n+            }\r\n+\r\n+            CompilationResult result = CompilationResult.parse(res.getOutput());\r", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDgxNjQ4NA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450816484", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116820))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116820) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116820\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116820\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T12:11:01Z", "path": "src/main/java/org/fisco/bcos/web3j/utils/CompileSolToJava.java", "diffHunk": "@@ -31,28 +31,52 @@ public static void main(String[] args) throws Exception {\n                 continue;\r\n             }\r\n             SolidityCompiler.Result res =\r\n-                    SolidityCompiler.compile(solFile, true, ABI, BIN, INTERFACE, METADATA);\r\n-            if (\"\".equals(res.output)) {\r\n-                System.out.println(\"Compile error: \" + res.errors);\r\n+                    SolidityCompiler.compile(solFile, false, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (\"\".equals(res.getOutput())) {\r\n+                System.out.println(\"Compile error: \" + res.getErrors());\r\n                 return;\r\n             }\r\n-            CompilationResult result = CompilationResult.parse(res.output);\r\n+\r\n+            /** sm compile */\r\n+            SolidityCompiler.Result smRes =\r\n+                    SolidityCompiler.compile(solFile, true, true, ABI, BIN, INTERFACE, METADATA);\r\n+            if (smRes.isFailed() || \"\".equals(smRes.getOutput())) {\r\n+                System.out.println(\"Compile SM error: \" + res.getErrors());\r\n+                return;\r\n+            }\r\n+\r\n+            CompilationResult result = CompilationResult.parse(res.getOutput());\r\n+            CompilationResult smResult = CompilationResult.parse(smRes.getOutput());\r", "originalCommit": "2ac0c5ac540b4423610d6963d452bf2b04a2ed86", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a93068d3e958b04e72a07fb82a83201b3f10e601", "url": "https://github.com/FISCO-BCOS/web3sdk/commit/a93068d3e958b04e72a07fb82a83201b3f10e601", "message": "add sm binary code to Java contract", "committedDate": "2020-07-07T13:14:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDc5OQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854799", "body": "__[PMD Java]__ Rather than using a lot of String arguments, consider using a container object for those values. ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116867))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `UseObjectForClearerAPI` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#useobjectforclearerapi>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116867) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Rather than using a lot of String arguments, consider using a container object for those values. (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nUseObjectForClearerAPI\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#useobjectforclearerapi\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Rather than using a lot of String arguments, consider using a container object for those values. (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116867\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>UseObjectForClearerAPI</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#useobjectforclearerapi\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#useobjectforclearerapi</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116867\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T13:15:33Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -114,20 +121,39 @@ public void generateJavaFiles(\n             String destinationDir,\n             String basePackageName)\n             throws IOException, ClassNotFoundException {\n-        abiContent = abi;\n+\n         generateJavaFiles(\n-                contractName,\n-                bin,\n-                loadContractDefinition(abi),\n-                destinationDir,\n-                basePackageName,\n-                null);\n+                contractName, bin, Contract.BIN_NOT_PROVIDED, abi, destinationDir, basePackageName);\n+    }\n+\n+    public void generateJavaFiles(", "originalCommit": "a93068d3e958b04e72a07fb82a83201b3f10e601", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgwNA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854804", "body": "__[PMD Java]__ A method or constructor should not explicitly declare unchecked exceptions in its 'throws' clause ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116868))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `AvoidUncheckedExceptionsInSignatures` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116868) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] A method or constructor should not explicitly declare unchecked exceptions in its 'throws' clause (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nAvoidUncheckedExceptionsInSignatures\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> A method or constructor should not explicitly declare unchecked exceptions in its 'throws' clause (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116868\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>AvoidUncheckedExceptionsInSignatures</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116868\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T13:15:33Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -114,20 +121,39 @@ public void generateJavaFiles(\n             String destinationDir,\n             String basePackageName)\n             throws IOException, ClassNotFoundException {\n-        abiContent = abi;\n+\n         generateJavaFiles(\n-                contractName,\n-                bin,\n-                loadContractDefinition(abi),\n-                destinationDir,\n-                basePackageName,\n-                null);\n+                contractName, bin, Contract.BIN_NOT_PROVIDED, abi, destinationDir, basePackageName);\n+    }\n+\n+    public void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String smBin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName)\n+            throws IOException, ClassNotFoundException {\n+\n+        generateJavaFiles(contractName, bin, smBin, abi, destinationDir, basePackageName, null);\n     }\n \n     void generateJavaFiles(\n             String contractName,\n             String bin,\n-            List<AbiDefinition> abi,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName,\n+            Map<String, String> addresses)\n+            throws IOException, ClassNotFoundException, UnsupportedOperationException {", "originalCommit": "a93068d3e958b04e72a07fb82a83201b3f10e601", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgwOQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854809", "body": "__[PMD Java]__ Potential violation of Law of Demeter (method chain calls) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116869))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116869) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (method chain calls) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116869\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116869\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T13:15:33Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -140,48 +166,59 @@ void generateJavaFiles(\n                             + Integer.valueOf(bin.length()));\n         }\n \n-        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, abi);\n+        List<AbiDefinition> abiDefinitions = loadContractDefinition(abi);\n+        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, smBin, abi);\n \n+        classBuilder.addMethod(buildBinaryMethod(smBin));\n         classBuilder.addMethod(buildReturnTransactionDecoder());\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, true));\n-        classBuilder.addFields(buildFuncNameConstants(abi));\n-        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abi));\n+        classBuilder.addFields(buildFuncNameConstants(abiDefinitions));\n+        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abiDefinitions));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, true));\n         if (!bin.equals(Contract.BIN_NOT_PROVIDED)) {\n-            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abi));\n+            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abiDefinitions));\n         }\n \n         write(basePackageName, classBuilder.build(), destinationDir);\n     }\n \n     private TypeSpec.Builder createClassBuilder(\n-            String className, String binary, List<AbiDefinition> abi) {\n+            String className, String binary, String smBinary, String abi) {\n \n         String javadoc = CODEGEN_WARNING + getWeb3jVersion();\n+        TypeSpec.Builder builder =\n+                TypeSpec.classBuilder(className)\n+                        .addModifiers(Modifier.PUBLIC)\n+                        .addJavadoc(javadoc)\n+                        .superclass(Contract.class)\n+                        .addAnnotation(\n+                                AnnotationSpec.builder(SuppressWarnings.class)", "originalCommit": "a93068d3e958b04e72a07fb82a83201b3f10e601", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgxMw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854813", "body": "__[PMD Java]__ Potential violation of Law of Demeter (method chain calls) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116870))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116870) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (method chain calls) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116870\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116870\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T13:15:33Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -140,48 +166,59 @@ void generateJavaFiles(\n                             + Integer.valueOf(bin.length()));\n         }\n \n-        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, abi);\n+        List<AbiDefinition> abiDefinitions = loadContractDefinition(abi);\n+        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, smBin, abi);\n \n+        classBuilder.addMethod(buildBinaryMethod(smBin));\n         classBuilder.addMethod(buildReturnTransactionDecoder());\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, true));\n-        classBuilder.addFields(buildFuncNameConstants(abi));\n-        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abi));\n+        classBuilder.addFields(buildFuncNameConstants(abiDefinitions));\n+        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abiDefinitions));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, true));\n         if (!bin.equals(Contract.BIN_NOT_PROVIDED)) {\n-            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abi));\n+            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abiDefinitions));\n         }\n \n         write(basePackageName, classBuilder.build(), destinationDir);\n     }\n \n     private TypeSpec.Builder createClassBuilder(\n-            String className, String binary, List<AbiDefinition> abi) {\n+            String className, String binary, String smBinary, String abi) {\n \n         String javadoc = CODEGEN_WARNING + getWeb3jVersion();\n+        TypeSpec.Builder builder =\n+                TypeSpec.classBuilder(className)\n+                        .addModifiers(Modifier.PUBLIC)\n+                        .addJavadoc(javadoc)\n+                        .superclass(Contract.class)\n+                        .addAnnotation(\n+                                AnnotationSpec.builder(SuppressWarnings.class)\n+                                        .addMember(\"value\", \"$S\", \"unchecked\")\n+                                        .build())\n+                        // binary fields\n+                        .addField(createBinaryArrayDefinition(binary))\n+                        .addField(createBinaryDefinition())\n+                        // abi fields\n+                        .addField(createABIArrayDefinition(abi))\n+                        .addField(createABIDefinition())\n+                        .addField(createTransactionDecoderDefinition());\n \n-        return TypeSpec.classBuilder(className)\n-                .addModifiers(Modifier.PUBLIC)\n-                .addJavadoc(javadoc)\n-                .superclass(Contract.class)\n-                .addAnnotation(\n-                        AnnotationSpec.builder(SuppressWarnings.class)\n-                                .addMember(\"value\", \"$S\", \"unchecked\")\n-                                .build())\n-                .addField(createBinaryArrayDefinition(binary))\n-                .addField(createBinaryDefinition())\n-                .addField(createABIArrayDefinition())\n-                .addField(createABIDefinition())\n-                .addField(createTransactionDecoderDefinition());\n+        if (!smBinary.equalsIgnoreCase(Contract.BIN_NOT_PROVIDED)) {\n+            builder.addField(createSMBinaryArrayDefinition(smBinary))", "originalCommit": "a93068d3e958b04e72a07fb82a83201b3f10e601", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgxNg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854816", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116871))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116871) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116871\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116871\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T13:15:34Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +259,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));", "originalCommit": "a93068d3e958b04e72a07fb82a83201b3f10e601", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgxNw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854817", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116872))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116872) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116872\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116872\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T13:15:34Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +259,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())", "originalCommit": "a93068d3e958b04e72a07fb82a83201b3f10e601", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgxOQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854819", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116873))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116873) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116873\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116873\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T13:15:34Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +259,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));", "originalCommit": "a93068d3e958b04e72a07fb82a83201b3f10e601", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgyMg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854822", "body": "__[PMD Java]__ Potential violation of Law of Demeter (method chain calls) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116874))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116874) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (method chain calls) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116874\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116874\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T13:15:34Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +259,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n+        return FieldSpec.builder(String[].class, \"SM_BINARY_ARRAY\")", "originalCommit": "a93068d3e958b04e72a07fb82a83201b3f10e601", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgyNQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854825", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116875))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116875) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116875\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116875\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T13:15:34Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +259,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n+        return FieldSpec.builder(String[].class, \"SM_BINARY_ARRAY\")\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())", "originalCommit": "a93068d3e958b04e72a07fb82a83201b3f10e601", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgyNw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854827", "body": "__[PMD Java]__ Potential violation of Law of Demeter (method chain calls) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116876))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116876) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (method chain calls) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116876\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116876\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T13:15:35Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +292,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)", "originalCommit": "a93068d3e958b04e72a07fb82a83201b3f10e601", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgzMg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854832", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116877))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116877) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116877\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116877\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T13:15:35Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +292,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"String.join(\\\"\\\", SM_BINARY_ARRAY)\")\n+                .build();\n+    }\n \n-            String item = abiContent.substring(offset, offset + length);\n-\n-            abiArray.add(item);\n-            offset += item.length();\n-        }\n+    private FieldSpec createABIArrayDefinition(String abi) {\n+        List<String> abiArray = stringToArrayString(abi);\n+        List<String> formatArray = new ArrayList<>(Collections.nCopies(abiArray.size(), \"$S\"));", "originalCommit": "a93068d3e958b04e72a07fb82a83201b3f10e601", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDgzNw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854837", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116878))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116878) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116878\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116878\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T13:15:35Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +292,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"String.join(\\\"\\\", SM_BINARY_ARRAY)\")\n+                .build();\n+    }\n \n-            String item = abiContent.substring(offset, offset + length);\n-\n-            abiArray.add(item);\n-            offset += item.length();\n-        }\n+    private FieldSpec createABIArrayDefinition(String abi) {\n+        List<String> abiArray = stringToArrayString(abi);\n+        List<String> formatArray = new ArrayList<>(Collections.nCopies(abiArray.size(), \"$S\"));\n \n         return FieldSpec.builder(String[].class, \"ABI_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", abiArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", abiArray.toArray())", "originalCommit": "a93068d3e958b04e72a07fb82a83201b3f10e601", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDg1NDg0Mg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450854842", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116879))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116879) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116879\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116879\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T13:15:35Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -465,6 +512,27 @@ private static MethodSpec buildReturnTransactionDecoder() {\n         return toReturn.build();\n     }\n \n+    private static MethodSpec buildBinaryMethod(String smBin) {\n+\n+        MethodSpec.Builder toReturn =\n+                MethodSpec.methodBuilder(\"getBinary\")\n+                        .addModifiers(Modifier.PUBLIC, Modifier.STATIC)\n+                        .returns(String.class);\n+\n+        if (smBin.equals(Contract.BIN_NOT_PROVIDED)) {\n+            toReturn.addStatement(\"return $N\", BINARY);\n+        } else {\n+            toReturn.addStatement(\n+                    \"return ($T.encryptType == $T.ECDSA_TYPE ? $N : $N)\",\n+                    EncryptType.class,\n+                    EncryptType.class,\n+                    BINARY,\n+                    SM_BINARY);\n+        }\n+\n+        return toReturn.build();", "originalCommit": "a93068d3e958b04e72a07fb82a83201b3f10e601", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3944d96736cf60f0636085a3091fd343a4e2c5d8", "url": "https://github.com/FISCO-BCOS/web3sdk/commit/3944d96736cf60f0636085a3091fd343a4e2c5d8", "message": "add sm binary code to Java contract", "committedDate": "2020-07-07T13:28:56Z", "type": "forcePushed"}, {"oid": "9bb8a2274e49eac8b8fdf608283bfcd424af69fc", "url": "https://github.com/FISCO-BCOS/web3sdk/commit/9bb8a2274e49eac8b8fdf608283bfcd424af69fc", "message": "add sm binary code to Java contract", "committedDate": "2020-07-07T13:39:17Z", "type": "forcePushed"}, {"oid": "3a4e688387890ce2c0ae21a52d22103bbb8e1948", "url": "https://github.com/FISCO-BCOS/web3sdk/commit/3a4e688387890ce2c0ae21a52d22103bbb8e1948", "message": "add sm binary code to Java contract", "committedDate": "2020-07-07T15:39:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM1MA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964350", "body": "__[PMD Java]__ A method or constructor should not explicitly declare unchecked exceptions in its 'throws' clause ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4116868))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `AvoidUncheckedExceptionsInSignatures` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4116868) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] A method or constructor should not explicitly declare unchecked exceptions in its 'throws' clause (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nAvoidUncheckedExceptionsInSignatures\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> A method or constructor should not explicitly declare unchecked exceptions in its 'throws' clause (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116868\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>AvoidUncheckedExceptionsInSignatures</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#avoiduncheckedexceptionsinsignatures</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4116868\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T15:45:27Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -114,74 +121,107 @@ public void generateJavaFiles(\n             String destinationDir,\n             String basePackageName)\n             throws IOException, ClassNotFoundException {\n-        abiContent = abi;\n+\n         generateJavaFiles(\n-                contractName,\n-                bin,\n-                loadContractDefinition(abi),\n-                destinationDir,\n-                basePackageName,\n-                null);\n+                contractName, bin, Contract.BIN_NOT_PROVIDED, abi, destinationDir, basePackageName);\n+    }\n+\n+    public void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String smBin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName)\n+            throws IOException, ClassNotFoundException {\n+\n+        generateJavaFiles(contractName, bin, smBin, abi, destinationDir, basePackageName, null);\n+    }\n+\n+    void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName,\n+            Map<String, String> addresses)\n+            throws IOException, ClassNotFoundException, UnsupportedOperationException {", "originalCommit": "3a4e688387890ce2c0ae21a52d22103bbb8e1948", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM1NQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964355", "body": "__[PMD Java]__ Potential violation of Law of Demeter (method chain calls) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4117174))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4117174) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (method chain calls) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117174\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117174\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T15:45:27Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -114,74 +121,107 @@ public void generateJavaFiles(\n             String destinationDir,\n             String basePackageName)\n             throws IOException, ClassNotFoundException {\n-        abiContent = abi;\n+\n         generateJavaFiles(\n-                contractName,\n-                bin,\n-                loadContractDefinition(abi),\n-                destinationDir,\n-                basePackageName,\n-                null);\n+                contractName, bin, Contract.BIN_NOT_PROVIDED, abi, destinationDir, basePackageName);\n+    }\n+\n+    public void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String smBin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName)\n+            throws IOException, ClassNotFoundException {\n+\n+        generateJavaFiles(contractName, bin, smBin, abi, destinationDir, basePackageName, null);\n+    }\n+\n+    void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName,\n+            Map<String, String> addresses)\n+            throws IOException, ClassNotFoundException, UnsupportedOperationException {\n+        generateJavaFiles(contractName, bin, null, abi, destinationDir, basePackageName, addresses);\n     }\n \n     void generateJavaFiles(\n             String contractName,\n             String bin,\n-            List<AbiDefinition> abi,\n+            String smBin,\n+            String abi,\n             String destinationDir,\n             String basePackageName,\n             Map<String, String> addresses)\n             throws IOException, ClassNotFoundException, UnsupportedOperationException {\n         String className = Strings.capitaliseFirstLetter(contractName);\n \n+        logger.info(\"bin: {}\", bin);\n+        logger.info(\"smBin: {}\", smBin);\n+\n         if (bin.length() > maxSolidityBinSize) {\n             throw new UnsupportedOperationException(\n                     \" contract binary too long, max support is 256k, now is \"\n                             + Integer.valueOf(bin.length()));\n         }\n \n-        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, abi);\n+        List<AbiDefinition> abiDefinitions = loadContractDefinition(abi);\n+        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, smBin, abi);\n \n+        classBuilder.addMethod(buildBinaryMethod(smBin));\n         classBuilder.addMethod(buildReturnTransactionDecoder());\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, true));\n-        classBuilder.addFields(buildFuncNameConstants(abi));\n-        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abi));\n+        classBuilder.addFields(buildFuncNameConstants(abiDefinitions));\n+        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abiDefinitions));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, true));\n         if (!bin.equals(Contract.BIN_NOT_PROVIDED)) {\n-            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abi));\n+            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abiDefinitions));\n         }\n \n         write(basePackageName, classBuilder.build(), destinationDir);\n     }\n \n     private TypeSpec.Builder createClassBuilder(\n-            String className, String binary, List<AbiDefinition> abi) {\n+            String className, String binary, String smBinary, String abi) {\n \n         String javadoc = CODEGEN_WARNING + getWeb3jVersion();\n+        TypeSpec.Builder builder =\n+                TypeSpec.classBuilder(className)\n+                        .addModifiers(Modifier.PUBLIC)\n+                        .addJavadoc(javadoc)\n+                        .superclass(Contract.class)\n+                        .addAnnotation(\n+                                AnnotationSpec.builder(SuppressWarnings.class)", "originalCommit": "3a4e688387890ce2c0ae21a52d22103bbb8e1948", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM1Nw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964357", "body": "__[PMD Java]__ Potential violation of Law of Demeter (method chain calls) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4117175))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4117175) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (method chain calls) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117175\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117175\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T15:45:28Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -114,74 +121,107 @@ public void generateJavaFiles(\n             String destinationDir,\n             String basePackageName)\n             throws IOException, ClassNotFoundException {\n-        abiContent = abi;\n+\n         generateJavaFiles(\n-                contractName,\n-                bin,\n-                loadContractDefinition(abi),\n-                destinationDir,\n-                basePackageName,\n-                null);\n+                contractName, bin, Contract.BIN_NOT_PROVIDED, abi, destinationDir, basePackageName);\n+    }\n+\n+    public void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String smBin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName)\n+            throws IOException, ClassNotFoundException {\n+\n+        generateJavaFiles(contractName, bin, smBin, abi, destinationDir, basePackageName, null);\n+    }\n+\n+    void generateJavaFiles(\n+            String contractName,\n+            String bin,\n+            String abi,\n+            String destinationDir,\n+            String basePackageName,\n+            Map<String, String> addresses)\n+            throws IOException, ClassNotFoundException, UnsupportedOperationException {\n+        generateJavaFiles(contractName, bin, null, abi, destinationDir, basePackageName, addresses);\n     }\n \n     void generateJavaFiles(\n             String contractName,\n             String bin,\n-            List<AbiDefinition> abi,\n+            String smBin,\n+            String abi,\n             String destinationDir,\n             String basePackageName,\n             Map<String, String> addresses)\n             throws IOException, ClassNotFoundException, UnsupportedOperationException {\n         String className = Strings.capitaliseFirstLetter(contractName);\n \n+        logger.info(\"bin: {}\", bin);\n+        logger.info(\"smBin: {}\", smBin);\n+\n         if (bin.length() > maxSolidityBinSize) {\n             throw new UnsupportedOperationException(\n                     \" contract binary too long, max support is 256k, now is \"\n                             + Integer.valueOf(bin.length()));\n         }\n \n-        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, abi);\n+        List<AbiDefinition> abiDefinitions = loadContractDefinition(abi);\n+        TypeSpec.Builder classBuilder = createClassBuilder(className, bin, smBin, abi);\n \n+        classBuilder.addMethod(buildBinaryMethod(smBin));\n         classBuilder.addMethod(buildReturnTransactionDecoder());\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(buildConstructor(Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(\n                 buildConstructor(TransactionManager.class, TRANSACTION_MANAGER, true));\n-        classBuilder.addFields(buildFuncNameConstants(abi));\n-        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abi));\n+        classBuilder.addFields(buildFuncNameConstants(abiDefinitions));\n+        classBuilder.addMethods(buildFunctionDefinitions(className, classBuilder, abiDefinitions));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, false));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, false));\n         classBuilder.addMethod(buildLoad(className, Credentials.class, CREDENTIALS, true));\n         classBuilder.addMethod(\n                 buildLoad(className, TransactionManager.class, TRANSACTION_MANAGER, true));\n         if (!bin.equals(Contract.BIN_NOT_PROVIDED)) {\n-            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abi));\n+            classBuilder.addMethods(buildDeployMethods(className, classBuilder, abiDefinitions));\n         }\n \n         write(basePackageName, classBuilder.build(), destinationDir);\n     }\n \n     private TypeSpec.Builder createClassBuilder(\n-            String className, String binary, List<AbiDefinition> abi) {\n+            String className, String binary, String smBinary, String abi) {\n \n         String javadoc = CODEGEN_WARNING + getWeb3jVersion();\n+        TypeSpec.Builder builder =\n+                TypeSpec.classBuilder(className)\n+                        .addModifiers(Modifier.PUBLIC)\n+                        .addJavadoc(javadoc)\n+                        .superclass(Contract.class)\n+                        .addAnnotation(\n+                                AnnotationSpec.builder(SuppressWarnings.class)\n+                                        .addMember(\"value\", \"$S\", \"unchecked\")\n+                                        .build())\n+                        // binary fields\n+                        .addField(createBinaryArrayDefinition(binary))\n+                        .addField(createBinaryDefinition())\n+                        // abi fields\n+                        .addField(createABIArrayDefinition(abi))\n+                        .addField(createABIDefinition())\n+                        .addField(createTransactionDecoderDefinition());\n \n-        return TypeSpec.classBuilder(className)\n-                .addModifiers(Modifier.PUBLIC)\n-                .addJavadoc(javadoc)\n-                .superclass(Contract.class)\n-                .addAnnotation(\n-                        AnnotationSpec.builder(SuppressWarnings.class)\n-                                .addMember(\"value\", \"$S\", \"unchecked\")\n-                                .build())\n-                .addField(createBinaryArrayDefinition(binary))\n-                .addField(createBinaryDefinition())\n-                .addField(createABIArrayDefinition())\n-                .addField(createABIDefinition())\n-                .addField(createTransactionDecoderDefinition());\n+        if (!smBinary.equalsIgnoreCase(Contract.BIN_NOT_PROVIDED)) {\n+            builder.addField(createSMBinaryArrayDefinition(smBinary))", "originalCommit": "3a4e688387890ce2c0ae21a52d22103bbb8e1948", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM2Mg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964362", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4117176))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4117176) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117176\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117176\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T15:45:28Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +262,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));", "originalCommit": "3a4e688387890ce2c0ae21a52d22103bbb8e1948", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM2Nw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964367", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4117177))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4117177) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117177\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117177\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T15:45:28Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +262,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())", "originalCommit": "3a4e688387890ce2c0ae21a52d22103bbb8e1948", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM3MA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964370", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4117178))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4117178) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117178\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117178\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T15:45:28Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +262,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));", "originalCommit": "3a4e688387890ce2c0ae21a52d22103bbb8e1948", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM3NQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964375", "body": "__[PMD Java]__ Potential violation of Law of Demeter (method chain calls) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4117179))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4117179) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (method chain calls) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117179\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117179\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T15:45:29Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +262,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n+        return FieldSpec.builder(String[].class, \"SM_BINARY_ARRAY\")", "originalCommit": "3a4e688387890ce2c0ae21a52d22103bbb8e1948", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM3OA==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964378", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4117180))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4117180) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117180\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117180\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T15:45:29Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -225,9 +262,29 @@ private FieldSpec createBinaryArrayDefinition(String binary) {\n             offset += item.length();\n         }\n \n+        return binaryArray;\n+    }\n+\n+    private FieldSpec createBinaryArrayDefinition(String binary) {\n+\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n         return FieldSpec.builder(String[].class, \"BINARY_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", binaryArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())\n+                .build();\n+    }\n+\n+    private FieldSpec createSMBinaryArrayDefinition(String binary) {\n+        List<String> binaryArray = stringToArrayString(binary);\n+        List<String> formatArray =\n+                new ArrayList<String>(Collections.nCopies(binaryArray.size(), \"$S\"));\n+\n+        return FieldSpec.builder(String[].class, \"SM_BINARY_ARRAY\")\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", binaryArray.toArray())", "originalCommit": "3a4e688387890ce2c0ae21a52d22103bbb8e1948", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM4Mg==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964382", "body": "__[PMD Java]__ Potential violation of Law of Demeter (method chain calls) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4117181))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4117181) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (method chain calls) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (method chain calls) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117181\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117181\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T15:45:29Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +295,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)", "originalCommit": "3a4e688387890ce2c0ae21a52d22103bbb8e1948", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM4Mw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964383", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4117182))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4117182) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117182\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117182\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T15:45:29Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +295,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"String.join(\\\"\\\", SM_BINARY_ARRAY)\")\n+                .build();\n+    }\n \n-            String item = abiContent.substring(offset, offset + length);\n-\n-            abiArray.add(item);\n-            offset += item.length();\n-        }\n+    private FieldSpec createABIArrayDefinition(String abi) {\n+        List<String> abiArray = stringToArrayString(abi);\n+        List<String> formatArray = new ArrayList<>(Collections.nCopies(abiArray.size(), \"$S\"));", "originalCommit": "3a4e688387890ce2c0ae21a52d22103bbb8e1948", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM4NQ==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964385", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4117183))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4117183) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117183\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117183\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T15:45:29Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -238,29 +295,20 @@ private FieldSpec createBinaryDefinition() {\n                 .build();\n     }\n \n-    private FieldSpec createABIArrayDefinition() {\n-        int maxField = 8 * 1024; // 8k for each field\n-\n-        List<String> format = new ArrayList<String>();\n-        List<String> abiArray = new ArrayList<String>();\n-\n-        for (int offset = 0; offset < abiContent.length(); ) {\n-            format.add(\"$S\");\n-\n-            int length = abiContent.length() - offset;\n-            if (length > maxField) {\n-                length = maxField;\n-            }\n+    private FieldSpec createSMBinaryDefinition() {\n+        return FieldSpec.builder(String.class, SM_BINARY)\n+                .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n+                .initializer(\"String.join(\\\"\\\", SM_BINARY_ARRAY)\")\n+                .build();\n+    }\n \n-            String item = abiContent.substring(offset, offset + length);\n-\n-            abiArray.add(item);\n-            offset += item.length();\n-        }\n+    private FieldSpec createABIArrayDefinition(String abi) {\n+        List<String> abiArray = stringToArrayString(abi);\n+        List<String> formatArray = new ArrayList<>(Collections.nCopies(abiArray.size(), \"$S\"));\n \n         return FieldSpec.builder(String[].class, \"ABI_ARRAY\")\n                 .addModifiers(Modifier.PUBLIC, Modifier.FINAL, Modifier.STATIC)\n-                .initializer(\"{\" + String.join(\",\", format) + \"}\", abiArray.toArray())\n+                .initializer(\"{\" + String.join(\",\", formatArray) + \"}\", abiArray.toArray())", "originalCommit": "3a4e688387890ce2c0ae21a52d22103bbb8e1948", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk2NDM4Ng==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/678#discussion_r450964386", "body": "__[PMD Java]__ Potential violation of Law of Demeter (object not created locally) ([view](https://sider.review/gh/repos/113938008/pulls/678#issue-4117184))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `LawOfDemeter` | Design | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/678#issue-4117184) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Potential violation of Law of Demeter (object not created locally) (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nLawOfDemeter\nDesign\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Potential violation of Law of Demeter (object not created locally) (<a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117184\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>LawOfDemeter</code></td>\n<td>Design</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_design.html#lawofdemeter</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/678#issue-4117184\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-07-07T15:45:29Z", "path": "src/main/java/org/fisco/bcos/web3j/codegen/SolidityFunctionWrapper.java", "diffHunk": "@@ -465,6 +515,27 @@ private static MethodSpec buildReturnTransactionDecoder() {\n         return toReturn.build();\n     }\n \n+    private static MethodSpec buildBinaryMethod(String smBin) {\n+\n+        MethodSpec.Builder toReturn =\n+                MethodSpec.methodBuilder(\"getBinary\")\n+                        .addModifiers(Modifier.PUBLIC, Modifier.STATIC)\n+                        .returns(String.class);\n+\n+        if (smBin.equals(Contract.BIN_NOT_PROVIDED)) {\n+            toReturn.addStatement(\"return $N\", BINARY);\n+        } else {\n+            toReturn.addStatement(\n+                    \"return ($T.encryptType == $T.ECDSA_TYPE ? $N : $N)\",\n+                    EncryptType.class,\n+                    EncryptType.class,\n+                    BINARY,\n+                    SM_BINARY);\n+        }\n+\n+        return toReturn.build();", "originalCommit": "3a4e688387890ce2c0ae21a52d22103bbb8e1948", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1b4a5915ff335060d9ca7f824e645917ca95ed00", "url": "https://github.com/FISCO-BCOS/web3sdk/commit/1b4a5915ff335060d9ca7f824e645917ca95ed00", "message": "add sm binary code to Java contract", "committedDate": "2020-07-07T15:49:40Z", "type": "commit"}, {"oid": "1b4a5915ff335060d9ca7f824e645917ca95ed00", "url": "https://github.com/FISCO-BCOS/web3sdk/commit/1b4a5915ff335060d9ca7f824e645917ca95ed00", "message": "add sm binary code to Java contract", "committedDate": "2020-07-07T15:49:40Z", "type": "forcePushed"}]}