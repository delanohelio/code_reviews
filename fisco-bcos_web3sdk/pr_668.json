{"pr_number": 668, "pr_title": "Adapt to IPv6", "pr_author": "sulenn", "pr_createdAt": "2020-06-28T08:18:28Z", "pr_url": "https://github.com/FISCO-BCOS/web3sdk/pull/668", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjYxODE1Mw==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/668#discussion_r446618153", "body": "__[PMD Java]__ String.indexOf(char) is faster than String.indexOf(String). ([view](https://sider.review/gh/repos/113938008/pulls/668#issue-4060759))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `UseIndexOfChar` | Performance | 3 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_performance.html#useindexofchar>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/668#issue-4060759) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] String.indexOf(char) is faster than String.indexOf(String). (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nUseIndexOfChar\nPerformance\n3\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_performance.html#useindexofchar\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> String.indexOf(char) is faster than String.indexOf(String). (<a href=\"https://sider.review/gh/repos/113938008/pulls/668#issue-4060759\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>UseIndexOfChar</code></td>\n<td>Performance</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_performance.html#useindexofchar\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_performance.html#useindexofchar</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/668#issue-4060759\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-06-28T08:19:05Z", "path": "src/main/java/org/fisco/bcos/channel/handler/ChannelConnections.java", "diffHunk": "@@ -288,18 +289,17 @@ public void init() {\n         for (String connectionStr : connectionsStr) {\n             ConnectionInfo connection = new ConnectionInfo();\n \n-            String[] stringArray = connectionStr.split(\":\");\n-\n-            if (stringArray.length < 1) {\n+            int index = connectionStr.lastIndexOf(\":\");", "originalCommit": "fe54930c32ba56f760525174ba43d7a60168e174", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjYxODE1Ng==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/668#discussion_r446618156", "body": "__[PMD Java]__ Found 'DU'-anomaly for variable 'port' (lines '300'-'321'). ([view](https://sider.review/gh/repos/113938008/pulls/668#issue-4060760))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `DataflowAnomalyAnalysis` | Error Prone | 5 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/668#issue-4060760) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Found 'DU'-anomaly for variable 'port' (lines '300'-'321'). (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nDataflowAnomalyAnalysis\nError Prone\n5\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Found 'DU'-anomaly for variable 'port' (lines '300'-'321'). (<a href=\"https://sider.review/gh/repos/113938008/pulls/668#issue-4060760\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>DataflowAnomalyAnalysis</code></td>\n<td>Error Prone</td>\n<td>5</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/668#issue-4060760\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-06-28T08:19:06Z", "path": "src/main/java/org/fisco/bcos/channel/handler/ChannelConnections.java", "diffHunk": "@@ -288,18 +289,17 @@ public void init() {\n         for (String connectionStr : connectionsStr) {\n             ConnectionInfo connection = new ConnectionInfo();\n \n-            String[] stringArray = connectionStr.split(\":\");\n-\n-            if (stringArray.length < 1) {\n+            int index = connectionStr.lastIndexOf(\":\");\n+            if (index == -1) {\n                 throw new IllegalArgumentException(\n-                        \" Invalid configuration, the value should in IP:Port format(eg: 127.0.0.1:1111), value: \"\n+                        \" Invalid configuration, the value should in IP:Port format(eg: 127.0.0.1:1111\u3001[::1]:1111), value: \"\n                                 + connectionStr);\n             }\n \n-            String IP = stringArray[0];\n-            String port = stringArray[1];\n+            String IP = connectionStr.substring(0,index);\n+            String port = connectionStr.substring(index+1);", "originalCommit": "fe54930c32ba56f760525174ba43d7a60168e174", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "0f85ee8ed985305cb74675f3cca4ba2e4eedf5d9", "url": "https://github.com/FISCO-BCOS/web3sdk/commit/0f85ee8ed985305cb74675f3cca4ba2e4eedf5d9", "message": "Adapt to IPv6", "committedDate": "2020-06-28T09:21:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjYyNTc1Ng==", "url": "https://github.com/FISCO-BCOS/web3sdk/pull/668#discussion_r446625756", "body": "__[PMD Java]__ Found 'DU'-anomaly for variable 'port' (lines '300'-'321'). ([view](https://sider.review/gh/repos/113938008/pulls/668#issue-4061892))\n\n<details>\n\n| Rule | Ruleset | Priority |\n| ---- | ------- | -------- |\n| `DataflowAnomalyAnalysis` | Error Prone | 5 |\n\nReferences:\n- <https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis>\n\nYou can [close this issue](https://sider.review/gh/repos/113938008/pulls/668#issue-4061892) if no need to fix it. [Learn more](https://help.sider.review/getting-started/working-with-issues).\n\n</details>", "bodyText": "[PMD Java] Found 'DU'-anomaly for variable 'port' (lines '300'-'321'). (view)\n\n\n\n\nRule\nRuleset\nPriority\n\n\n\n\nDataflowAnomalyAnalysis\nError Prone\n5\n\n\n\nReferences:\n\nhttps://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\n\nYou can close this issue if no need to fix it. Learn more.", "bodyHTML": "<p dir=\"auto\"><strong>[PMD Java]</strong> Found 'DU'-anomaly for variable 'port' (lines '300'-'321'). (<a href=\"https://sider.review/gh/repos/113938008/pulls/668#issue-4061892\" rel=\"nofollow\">view</a>)</p>\n<details>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Rule</th>\n<th>Ruleset</th>\n<th>Priority</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>DataflowAnomalyAnalysis</code></td>\n<td>Error Prone</td>\n<td>5</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">References:</p>\n<ul dir=\"auto\">\n<li><a href=\"https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis\" rel=\"nofollow\">https://pmd.github.io/pmd-6.24.0/pmd_rules_java_errorprone.html#dataflowanomalyanalysis</a></li>\n</ul>\n<p dir=\"auto\">You can <a href=\"https://sider.review/gh/repos/113938008/pulls/668#issue-4061892\" rel=\"nofollow\">close this issue</a> if no need to fix it. <a href=\"https://help.sider.review/getting-started/working-with-issues\" rel=\"nofollow\">Learn more</a>.</p>\n</details>", "author": "sider", "createdAt": "2020-06-28T09:24:36Z", "path": "src/main/java/org/fisco/bcos/channel/handler/ChannelConnections.java", "diffHunk": "@@ -288,18 +289,17 @@ public void init() {\n         for (String connectionStr : connectionsStr) {\n             ConnectionInfo connection = new ConnectionInfo();\n \n-            String[] stringArray = connectionStr.split(\":\");\n-\n-            if (stringArray.length < 1) {\n+            int index = connectionStr.lastIndexOf(':');\n+            if (index == -1) {\n                 throw new IllegalArgumentException(\n-                        \" Invalid configuration, the value should in IP:Port format(eg: 127.0.0.1:1111), value: \"\n+                        \" Invalid configuration, the value should in IP:Port format(eg: 127.0.0.1:1111\u3001[::1]:1111), value: \"\n                                 + connectionStr);\n             }\n \n-            String IP = stringArray[0];\n-            String port = stringArray[1];\n+            String IP = connectionStr.substring(0, index);\n+            String port = connectionStr.substring(index + 1);", "originalCommit": "0f85ee8ed985305cb74675f3cca4ba2e4eedf5d9", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}