{"pr_number": 1871, "pr_title": "[HUDI-781] Introduce HoodieTestTable for test preparation", "pr_author": "xushiyan", "pr_createdAt": "2020-07-24T06:05:00Z", "pr_url": "https://github.com/apache/hudi/pull/1871", "timeline": [{"oid": "25e34cb49310a4cbab5640e9dac46080a189b760", "url": "https://github.com/apache/hudi/commit/25e34cb49310a4cbab5640e9dac46080a189b760", "message": "[HUDI-781] Introduce HoodieTestTable for test preparation", "committedDate": "2020-08-10T06:49:04Z", "type": "commit"}, {"oid": "ce7c979304cc169685d493be9cb4434328afd2f2", "url": "https://github.com/apache/hudi/commit/ce7c979304cc169685d493be9cb4434328afd2f2", "message": "Use Files API", "committedDate": "2020-08-10T07:56:13Z", "type": "commit"}, {"oid": "9abe1d29ef8d82c057bbd480bbc2b9f38e31cb7a", "url": "https://github.com/apache/hudi/commit/9abe1d29ef8d82c057bbd480bbc2b9f38e31cb7a", "message": "revert the indentation", "committedDate": "2020-08-10T07:56:13Z", "type": "commit"}, {"oid": "69e99fc9437e55248a8508f430088271616dd9d0", "url": "https://github.com/apache/hudi/commit/69e99fc9437e55248a8508f430088271616dd9d0", "message": "add TODO for newly added APIs", "committedDate": "2020-08-10T07:56:13Z", "type": "commit"}, {"oid": "0c841a398870142c5e153d924094dbd086d154e4", "url": "https://github.com/apache/hudi/commit/0c841a398870142c5e153d924094dbd086d154e4", "message": "rename FilesTestUtils to FileCreateUtils and rename APIs using `create`", "committedDate": "2020-08-10T07:56:13Z", "type": "commit"}, {"oid": "0c841a398870142c5e153d924094dbd086d154e4", "url": "https://github.com/apache/hudi/commit/0c841a398870142c5e153d924094dbd086d154e4", "message": "rename FilesTestUtils to FileCreateUtils and rename APIs using `create`", "committedDate": "2020-08-10T07:56:13Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzgyNzI2NA==", "url": "https://github.com/apache/hudi/pull/1871#discussion_r467827264", "body": "Can we use `Paths.get()` to reduce link path parts via `/`?", "bodyText": "Can we use Paths.get() to reduce link path parts via /?", "bodyHTML": "<p dir=\"auto\">Can we use <code>Paths.get()</code> to reduce link path parts via <code>/</code>?</p>", "author": "yanghua", "createdAt": "2020-08-10T10:57:25Z", "path": "hudi-common/src/test/java/org/apache/hudi/common/testutils/HoodieTestUtils.java", "diffHunk": "@@ -237,11 +229,12 @@ public static void createPendingCleanFiles(HoodieTableMetaClient metaClient, Str\n \n   public static void createCorruptedPendingCleanFiles(HoodieTableMetaClient metaClient, String commitTime) {\n     Arrays.asList(HoodieTimeline.makeRequestedCleanerFileName(commitTime),\n-        HoodieTimeline.makeInflightCleanerFileName(commitTime)).forEach(f -> {\n+        HoodieTimeline.makeInflightCleanerFileName(commitTime))\n+        .forEach(f -> {\n           FSDataOutputStream os = null;\n           try {\n             Path commitFile = new Path(\n-                    metaClient.getBasePath() + \"/\" + HoodieTableMetaClient.METAFOLDER_NAME + \"/\" + f);\n+                metaClient.getBasePath() + \"/\" + HoodieTableMetaClient.METAFOLDER_NAME + \"/\" + f);", "originalCommit": "0c841a398870142c5e153d924094dbd086d154e4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAzMjEzMw==", "url": "https://github.com/apache/hudi/pull/1871#discussion_r468032133", "bodyText": "sure, fixed 2 of this. Please note that, as this is from the original codebase, i didn't change all of this kind of usage in this file. I think it could be a good chance to change while moving the APIs to HoodieTestTable.", "author": "xushiyan", "createdAt": "2020-08-10T16:32:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzgyNzI2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI3NjE5NA==", "url": "https://github.com/apache/hudi/pull/1871#discussion_r468276194", "bodyText": "Ok, I noticed this because I saw the indent has been changed. Actually, I suggested that we can focus on the core work about the PR want to do. Do not touch something else e.g. indent and code style. Of cause, I should not ask you to change this.", "author": "yanghua", "createdAt": "2020-08-11T01:34:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzgyNzI2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODI3OTA5Mg==", "url": "https://github.com/apache/hudi/pull/1871#discussion_r468279092", "bodyText": "ok @yanghua ,  understood. I agree that the work should focus on the task. I didn't intend to change these; intellij did it for me. i should have disabled the auto-formatting. will keep this sort of diffs out from now on. thanks", "author": "xushiyan", "createdAt": "2020-08-11T01:45:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzgyNzI2NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzgyNzQ2Nw==", "url": "https://github.com/apache/hudi/pull/1871#discussion_r467827467", "body": "Why do we need to break the `forEach`?", "bodyText": "Why do we need to break the forEach?", "bodyHTML": "<p dir=\"auto\">Why do we need to break the <code>forEach</code>?</p>", "author": "yanghua", "createdAt": "2020-08-10T10:57:55Z", "path": "hudi-common/src/test/java/org/apache/hudi/common/testutils/HoodieTestUtils.java", "diffHunk": "@@ -237,11 +229,12 @@ public static void createPendingCleanFiles(HoodieTableMetaClient metaClient, Str\n \n   public static void createCorruptedPendingCleanFiles(HoodieTableMetaClient metaClient, String commitTime) {\n     Arrays.asList(HoodieTimeline.makeRequestedCleanerFileName(commitTime),\n-        HoodieTimeline.makeInflightCleanerFileName(commitTime)).forEach(f -> {\n+        HoodieTimeline.makeInflightCleanerFileName(commitTime))\n+        .forEach(f -> {", "originalCommit": "0c841a398870142c5e153d924094dbd086d154e4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAyMTYzMA==", "url": "https://github.com/apache/hudi/pull/1871#discussion_r468021630", "bodyText": "intellij will force some weird indentation that breaks checkstyle rule...this is the easiest way I can find to prevent that", "author": "xushiyan", "createdAt": "2020-08-10T16:15:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzgyNzQ2Nw=="}], "type": "inlineReview"}, {"oid": "33b0d1073938ca8d1cfe95ca873792fcaf0522b5", "url": "https://github.com/apache/hudi/commit/33b0d1073938ca8d1cfe95ca873792fcaf0522b5", "message": "use Paths API", "committedDate": "2020-08-10T16:28:42Z", "type": "commit"}]}