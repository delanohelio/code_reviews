{"pr_number": 869, "pr_title": "[JENKINS-63016] feat: new resource - ephemeral storage", "pr_author": "KrapivinAndrey", "pr_createdAt": "2020-10-14T19:22:11Z", "pr_url": "https://github.com/jenkinsci/kubernetes-plugin/pull/869", "timeline": [{"oid": "d2125f8711e4471735290dfc8f0b0c2aaad50222", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/d2125f8711e4471735290dfc8f0b0c2aaad50222", "message": "feat: new resource EphemeralStorage", "committedDate": "2020-10-06T13:26:47Z", "type": "commit"}, {"oid": "703d6b227974f1a00c69f007b4d25e5af466ee26", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/703d6b227974f1a00c69f007b4d25e5af466ee26", "message": "feat: add ephemeral", "committedDate": "2020-10-06T19:15:49Z", "type": "commit"}, {"oid": "2a7fa09f5ee24d78cf3bf112e7613cf270a9837f", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/2a7fa09f5ee24d78cf3bf112e7613cf270a9837f", "message": "feat: Add field", "committedDate": "2020-10-14T19:11:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMzMDM0Ng==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/869#discussion_r514330346", "body": "```suggestion\r\n        String actualEphemeral = substituteEnv(ephemeral);\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    String actualEpemeral = substituteEnv(ephemeral);\n          \n          \n            \n                    String actualEphemeral = substituteEnv(ephemeral);", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-smi\">String</span> <span class=\"x x-first x-last\">actualEpemeral</span> <span class=\"pl-k\">=</span> substituteEnv(ephemeral);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-smi\">String</span> <span class=\"x x-first x-last\">actualEphemeral</span> <span class=\"pl-k\">=</span> substituteEnv(ephemeral);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Vlatombe", "createdAt": "2020-10-29T15:03:53Z", "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/PodTemplateBuilder.java", "diffHunk": "@@ -500,10 +500,11 @@ private VolumeMount getDefaultVolumeMount(@CheckForNull String workingDir) {\n         return commands;\n     }\n \n-    private Map<String, Quantity> getResourcesMap(String memory, String cpu) {\n+    private Map<String, Quantity> getResourcesMap(String memory, String cpu, String ephemeral) {\n         ImmutableMap.Builder<String, Quantity> builder = ImmutableMap.<String, Quantity>builder();\n         String actualMemory = substituteEnv(memory);\n         String actualCpu = substituteEnv(cpu);\n+        String actualEpemeral = substituteEnv(ephemeral);", "originalCommit": "2a7fa09f5ee24d78cf3bf112e7613cf270a9837f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQzNzM5Ng==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/869#discussion_r514437396", "bodyText": "fix", "author": "KrapivinAndrey", "createdAt": "2020-10-29T17:25:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMzMDM0Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMzMDQ2Mw==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/869#discussion_r514330463", "body": "```suggestion\r\n            Quantity ephemeralQuantity = new Quantity(actualEphemeral);\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        Quantity ephemeralQuantity = new Quantity(actualEpemeral);\n          \n          \n            \n                        Quantity ephemeralQuantity = new Quantity(actualEphemeral);", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-smi\">Quantity</span> ephemeralQuantity <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">Quantity</span>(<span class=\"x x-first x-last\">actualEpemeral</span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-smi\">Quantity</span> ephemeralQuantity <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">Quantity</span>(<span class=\"x x-first x-last\">actualEphemeral</span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Vlatombe", "createdAt": "2020-10-29T15:04:03Z", "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/PodTemplateBuilder.java", "diffHunk": "@@ -512,6 +513,10 @@ private VolumeMount getDefaultVolumeMount(@CheckForNull String workingDir) {\n             Quantity cpuQuantity = new Quantity(actualCpu);\n             builder.put(\"cpu\", cpuQuantity);\n         }\n+        if (StringUtils.isNotBlank(actualEpemeral)) {\n+            Quantity ephemeralQuantity = new Quantity(actualEpemeral);", "originalCommit": "2a7fa09f5ee24d78cf3bf112e7613cf270a9837f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDQzNzQ2Nw==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/869#discussion_r514437467", "bodyText": "fix", "author": "KrapivinAndrey", "createdAt": "2020-10-29T17:25:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMzMDQ2Mw=="}], "type": "inlineReview"}, {"oid": "bfc81fc337a9568d212e61cb0543ce449f209aba", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/bfc81fc337a9568d212e61cb0543ce449f209aba", "message": "fix", "committedDate": "2020-10-29T16:11:25Z", "type": "commit"}, {"oid": "158c3dd0338a54c8b3f8ca55d1e40c2078824b90", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/158c3dd0338a54c8b3f8ca55d1e40c2078824b90", "message": "Merge branch 'master' into feature/resource_ephemeral_storage", "committedDate": "2020-11-05T11:10:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTYxODY4Mw==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/869#discussion_r531618683", "body": "Remove these.", "bodyText": "Remove these.", "bodyHTML": "<p dir=\"auto\">Remove these.</p>", "author": "Vlatombe", "createdAt": "2020-11-27T14:00:55Z", "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/PodTemplate.java", "diffHunk": "@@ -662,6 +666,18 @@ public void setResourceLimitCpu(String resourceLimitCpu) {\n         getFirstContainer().ifPresent((i) -> i.setResourceLimitCpu(resourceLimitCpu));\n     }\n \n+    @Deprecated\n+    @DataBoundSetter\n+    public void setResourceLimitEphemeral(String resourceLimitEphemeral) {\n+        getFirstContainer().ifPresent((i) -> i.setResourceLimitEphemeral(resourceLimitEphemeral));\n+    }\n+\n+    @Deprecated\n+    public String getResourceLimitEphemeral() {\n+        return getFirstContainer().map(ContainerTemplate::getResourceLimitEphemeral).orElse(null);\n+    }", "originalCommit": "158c3dd0338a54c8b3f8ca55d1e40c2078824b90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTkwMjEzMA==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/869#discussion_r531902130", "bodyText": "Fix", "author": "KrapivinAndrey", "createdAt": "2020-11-28T05:38:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTYxODY4Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTYxODcyMw==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/869#discussion_r531618723", "body": "Remove these.", "bodyText": "Remove these.", "bodyHTML": "<p dir=\"auto\">Remove these.</p>", "author": "Vlatombe", "createdAt": "2020-11-27T14:01:01Z", "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/PodTemplate.java", "diffHunk": "@@ -684,6 +700,17 @@ public void setResourceRequestCpu(String resourceRequestCpu) {\n         getFirstContainer().ifPresent((i) -> i.setResourceRequestCpu(resourceRequestCpu));\n     }\n \n+    @Deprecated\n+    @DataBoundSetter\n+    public void setResourceRequestEphemeral(String resourceRequestEphemeral) {\n+        getFirstContainer().ifPresent((i) -> i.setResourceRequestEphemeral(resourceRequestEphemeral));\n+    }\n+    \n+    @Deprecated\n+    public String getResourceRequestEphemeral() {\n+        return getFirstContainer().map(ContainerTemplate::getResourceRequestEphemeral).orElse(null);\n+    }", "originalCommit": "158c3dd0338a54c8b3f8ca55d1e40c2078824b90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTkwMjAzMg==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/869#discussion_r531902032", "bodyText": "Fix", "author": "KrapivinAndrey", "createdAt": "2020-11-28T05:38:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTYxODcyMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTYxOTk3Mw==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/869#discussion_r531619973", "body": "Replace `ephemeral` with `ephemeralStorage` in the PR please.", "bodyText": "Replace ephemeral with ephemeralStorage in the PR please.", "bodyHTML": "<p dir=\"auto\">Replace <code>ephemeral</code> with <code>ephemeralStorage</code> in the PR please.</p>", "author": "Vlatombe", "createdAt": "2020-11-27T14:03:31Z", "path": "src/main/java/org/csanchez/jenkins/plugins/kubernetes/ContainerTemplate.java", "diffHunk": "@@ -57,9 +57,13 @@\n \n     private String resourceRequestMemory;\n \n+    private String resourceRequestEphemeral;", "originalCommit": "158c3dd0338a54c8b3f8ca55d1e40c2078824b90", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTkwMTkyOA==", "url": "https://github.com/jenkinsci/kubernetes-plugin/pull/869#discussion_r531901928", "bodyText": "Fix", "author": "KrapivinAndrey", "createdAt": "2020-11-28T05:38:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTYxOTk3Mw=="}], "type": "inlineReview"}, {"oid": "848a9979bdb11d15db6dc1e19738dd2aedf76964", "url": "https://github.com/jenkinsci/kubernetes-plugin/commit/848a9979bdb11d15db6dc1e19738dd2aedf76964", "message": "fix after review", "committedDate": "2020-11-27T16:30:43Z", "type": "commit"}]}