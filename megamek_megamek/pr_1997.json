{"pr_number": 1997, "pr_title": "long range bridge + deep water handling", "pr_author": "NickAragua", "pr_createdAt": "2020-06-09T03:43:42Z", "pr_url": "https://github.com/MegaMek/megamek/pull/1997", "timeline": [{"oid": "93a147911a568dde752444940977a16c37ee09bf", "url": "https://github.com/MegaMek/megamek/commit/93a147911a568dde752444940977a16c37ee09bf", "message": "long range bridge + deep water handling", "committedDate": "2020-06-09T03:37:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzEyMTAxOA==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r437121018", "body": "it occurs to me that we should forego this discount if jumping onto a bridge.", "bodyText": "it occurs to me that we should forego this discount if jumping onto a bridge.", "bodyHTML": "<p dir=\"auto\">it occurs to me that we should forego this discount if jumping onto a bridge.</p>", "author": "NickAragua", "createdAt": "2020-06-09T03:44:09Z", "path": "megamek/src/megamek/common/BulldozerMovePath.java", "diffHunk": "@@ -93,15 +96,24 @@ public MovePath addStep(final MoveStepType type) {\n             // we want to make note of when we're going into water (if we are capable of it)\n             // it may look cheaper, but it slows you down to max walking speed or worse, \n             // and we should flag it as costing extra, that extra being the difference between walking and running speed\n-            IHex hex = mp.getGame().getBoard().getHex(mp.getFinalCoords());\n-            if((hex != null) && hex.containsTerrain(Terrains.WATER) && (hex.depth() > 0)) {\n+            if(hexWaterDepth > 0) {\n                 MovementType mType = MovementType.getMovementType(mp.getEntity());\n                 if(mType == MovementType.Walker || mType == MovementType.WheeledAmphi || mType == MovementType.TrackedAmphi) {\n                     additionalCosts.put(mp.getFinalCoords(), 1);\n                 }\n             }\n         }\n \n+        if (mp.isJumping()) {", "originalCommit": "93a147911a568dde752444940977a16c37ee09bf", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "3e3d9bab2b1f8f437ad56d684f2104103a1a97cd", "url": "https://github.com/MegaMek/megamek/commit/3e3d9bab2b1f8f437ad56d684f2104103a1a97cd", "message": "fix a few more issues", "committedDate": "2020-06-10T00:55:22Z", "type": "commit"}, {"oid": "cefaf2a5dabdaec8dd6c48fb021bc52482ae67bc", "url": "https://github.com/MegaMek/megamek/commit/cefaf2a5dabdaec8dd6c48fb021bc52482ae67bc", "message": "fix many bridge issues; refactor", "committedDate": "2020-06-14T02:23:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg1ODUyNQ==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r439858525", "body": "Should one of these be F_LIMITED_AMPHIBIOUS?", "bodyText": "Should one of these be F_LIMITED_AMPHIBIOUS?", "bodyHTML": "<p dir=\"auto\">Should one of these be F_LIMITED_AMPHIBIOUS?</p>", "author": "neoancient", "createdAt": "2020-06-14T19:03:11Z", "path": "megamek/src/megamek/common/pathfinder/CachedEntityState.java", "diffHunk": "@@ -90,4 +93,25 @@ public boolean hasWorkingMisc(BigInteger flag) {\n         \n         return hasWorkingMisc.get(flag);\n     }\n+    \n+    public int getTorsoJumpJets() {\n+        if(torsoJumpJets == null) {\n+            if(backingEntity instanceof Mech) {\n+                torsoJumpJets = ((Mech) backingEntity).torsoJumpJets();\n+            } else {\n+                torsoJumpJets = 0;\n+            }\n+        }\n+        \n+        return torsoJumpJets;\n+    }\n+    \n+    /**\n+     * Convenience property to determine if the backing entity is amphibious.\n+     */\n+    public boolean isAmphibious() {\n+        return hasWorkingMisc(MiscType.F_FULLY_AMPHIBIOUS) || \n+                hasWorkingMisc(MiscType.F_AMPHIBIOUS) ||\n+                hasWorkingMisc(MiscType.F_FULLY_AMPHIBIOUS);", "originalCommit": "cefaf2a5dabdaec8dd6c48fb021bc52482ae67bc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg2ODQ4Mg==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r439868482", "bodyText": "Yes.", "author": "NickAragua", "createdAt": "2020-06-14T21:18:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg1ODUyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg1ODgyMw==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r439858823", "body": "```suggestion\r\n        @Override\r\n        public int compare(BulldozerMovePath first, BulldozerMovePath second) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    public int compare(BulldozerMovePath first, BulldozerMovePath second) {\n          \n          \n            \n                    @Override\n          \n          \n            \n                    public int compare(BulldozerMovePath first, BulldozerMovePath second) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"265\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k x x-first\">public</span><span class=\"x\"> </span><span class=\"pl-k x\">int</span><span class=\"x\"> compare(</span><span class=\"pl-smi x\">BulldozerMovePath</span><span class=\"x\"> first, </span><span class=\"pl-smi x\">BulldozerMovePath</span><span class=\"x x-last\"> second) {</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"265\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k x x-first x-last\">@Override</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"266\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">public</span> <span class=\"pl-k\">int</span> compare(<span class=\"pl-smi\">BulldozerMovePath</span> first, <span class=\"pl-smi\">BulldozerMovePath</span> second) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "neoancient", "createdAt": "2020-06-14T19:07:05Z", "path": "megamek/src/megamek/common/pathfinder/DestructionAwareDestinationPathfinder.java", "diffHunk": "@@ -235,14 +261,14 @@ public AStarComparator(Coords destination) {\n          * Favors paths that move closer to the destination edge first.\n          * in case of tie, favors paths that cost less MP\n          */\n-        public int compare(BulldozerMovePath first, BulldozerMovePath second) {            \n+        public int compare(BulldozerMovePath first, BulldozerMovePath second) {", "originalCommit": "cefaf2a5dabdaec8dd6c48fb021bc52482ae67bc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg1OTA0Ng==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r439859046", "body": "```suggestion\r\n     * @param ignore\r\n     * @return\r\n```\r\nAlso needs descriptive text for the parameters", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * @return\n          \n          \n            \n                 * @param ignore\n          \n          \n            \n                 * @return\n          \n      \n    \n    \n  \n\nAlso needs descriptive text for the parameters", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">     <span class=\"pl-k\">*</span> <span class=\"pl-k\">@<span class=\"x x-first x-last\">return</span></span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-k\">@<span class=\"x x-first\">param</span></span><span class=\"x x-last\"> ignore</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-k\">@return</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n\n<p dir=\"auto\">Also needs descriptive text for the parameters</p>", "author": "neoancient", "createdAt": "2020-06-14T19:10:21Z", "path": "megamek/src/megamek/common/pathfinder/ShortestPathFinder.java", "diffHunk": "@@ -370,13 +370,9 @@ public static int getFacingDiff(final MovePath mp, Coords dest,\n      * @param board\n      * @return", "originalCommit": "cefaf2a5dabdaec8dd6c48fb021bc52482ae67bc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg1OTM2Ng==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r439859366", "body": "```suggestion\r\n    @SuppressWarnings(\"unused\")\r\n    public MovePath calculateDestructionAwarePath(Coords dest) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public MovePath calculateDestructionAwarePath(Coords dest) {\n          \n          \n            \n                @SuppressWarnings(\"unused\")\n          \n          \n            \n                public MovePath calculateDestructionAwarePath(Coords dest) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"1842\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k x x-first\">public</span><span class=\"x\"> </span><span class=\"pl-smi x\">MovePath</span><span class=\"x\"> calculateDestructionAwarePath(</span><span class=\"pl-smi x\">Coords</span><span class=\"x x-last\"> dest) {</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"1842\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k x x-first\">@SuppressWarnings</span><span class=\"x\">(</span><span class=\"pl-s\"><span class=\"pl-pds x\">\"</span><span class=\"x\">unused</span><span class=\"pl-pds x\">\"</span></span><span class=\"x x-last\">)</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"1843\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">public</span> <span class=\"pl-smi\">MovePath</span> calculateDestructionAwarePath(<span class=\"pl-smi\">Coords</span> dest) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "neoancient", "createdAt": "2020-06-14T19:14:57Z", "path": "megamek/src/megamek/common/MovePath.java", "diffHunk": "@@ -1841,16 +1841,16 @@ public boolean nextForwardStepOffBoard() {\n     public MovePath calculateDestructionAwarePath(Coords dest) {", "originalCommit": "cefaf2a5dabdaec8dd6c48fb021bc52482ae67bc", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e2ab8a76a62b3394d8820440558518698935aa98", "url": "https://github.com/MegaMek/megamek/commit/e2ab8a76a62b3394d8820440558518698935aa98", "message": "Apply suggestions from code review\n\nCo-authored-by: neoancient <neoancient@megamek.org>", "committedDate": "2020-06-14T21:20:38Z", "type": "commit"}, {"oid": "e075805c0bd3c012cb0f4a8e0bc13024fa9009a0", "url": "https://github.com/MegaMek/megamek/commit/e075805c0bd3c012cb0f4a8e0bc13024fa9009a0", "message": "Update CachedEntityState.java", "committedDate": "2020-06-14T21:21:21Z", "type": "commit"}, {"oid": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "url": "https://github.com/MegaMek/megamek/commit/58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "message": "Update ShortestPathFinder.java", "committedDate": "2020-06-14T21:23:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI0NjAyOA==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440246028", "body": "```suggestion\r\n            for (Coords coords : cluster.contents.keySet()) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        for(Coords coords : cluster.contents.keySet()) {\n          \n          \n            \n                        for (Coords coords : cluster.contents.keySet()) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">for</span>(<span class=\"pl-smi\">Coords</span> coords <span class=\"pl-k\">:</span> cluster<span class=\"pl-k\">.</span>contents<span class=\"pl-k\">.</span>keySet()) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">for</span><span class=\"x x-first x-last\"> </span>(<span class=\"pl-smi\">Coords</span> coords <span class=\"pl-k\">:</span> cluster<span class=\"pl-k\">.</span>contents<span class=\"pl-k\">.</span>keySet()) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:08:55Z", "path": "megamek/src/megamek/client/ui/swing/boardview/BoardView1.java", "diffHunk": "@@ -1480,13 +1480,13 @@ private void renderDonut(Graphics2D g, Coords coords, int radius) {\n     @SuppressWarnings(\"unused\")\n     private void renderClusters(Graphics2D g) {\n         BoardClusterTracker bct = new BoardClusterTracker();\n-        Map<Coords, BoardCluster> clusterMap = bct.generateClusters(selectedEntity, false);\n+        Map<Coords, BoardCluster> clusterMap = bct.generateClusters(selectedEntity, false, true);\n         \n         for(BoardCluster cluster : clusterMap.values().stream().distinct().collect(Collectors.toList())) {\n-            for(Coords coords : cluster.contents) {\n+            for(Coords coords : cluster.contents.keySet()) {", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI0NjI2MQ==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440246261", "body": "```suggestion\r\n        int hexWaterDepth = ((hex != null) && hex.containsTerrain(Terrains.WATER)) ?\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    int hexWaterDepth = (hex != null) && hex.containsTerrain(Terrains.WATER) ?\n          \n          \n            \n                    int hexWaterDepth = ((hex != null) && hex.containsTerrain(Terrains.WATER)) ?", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">int</span> hexWaterDepth <span class=\"pl-k\">=</span> (hex <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) <span class=\"pl-k\">&amp;&amp;</span> hex<span class=\"pl-k\">.</span>containsTerrain(<span class=\"pl-smi\">Terrains</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>WATER</span>) <span class=\"pl-k\">?</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">int</span> hexWaterDepth <span class=\"pl-k\">=</span> (<span class=\"x x-first x-last\">(</span>hex <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) <span class=\"pl-k\">&amp;&amp;</span> hex<span class=\"pl-k\">.</span>containsTerrain(<span class=\"pl-smi\">Terrains</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>WATER</span><span class=\"x x-first x-last\">)</span>) <span class=\"pl-k\">?</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:09:19Z", "path": "megamek/src/megamek/common/BulldozerMovePath.java", "diffHunk": "@@ -78,7 +78,10 @@ public int getLevelingCost() {\n     @Override\n     public MovePath addStep(final MoveStepType type) {\n         BulldozerMovePath mp = (BulldozerMovePath) super.addStep(type);\n-\n+        IHex hex = mp.getGame().getBoard().getHex(mp.getFinalCoords());\n+        int hexWaterDepth = (hex != null) && hex.containsTerrain(Terrains.WATER) ?", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI0NjU5NA==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440246594", "bodyText": "This is a suggestion that I find makes it easier to read the line, but your mileage may vary.", "author": "Windchild292", "createdAt": "2020-06-15T15:09:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI0NjI2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI0NjcwOQ==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440246709", "body": "```suggestion\r\n            if (hexWaterDepth > 0) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if(hexWaterDepth > 0) {\n          \n          \n            \n                        if (hexWaterDepth > 0) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"99\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">if</span>(hexWaterDepth <span class=\"pl-k\">&gt;</span> <span class=\"pl-c1\">0</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"99\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(hexWaterDepth <span class=\"pl-k\">&gt;</span> <span class=\"pl-c1\">0</span>) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:09:59Z", "path": "megamek/src/megamek/common/BulldozerMovePath.java", "diffHunk": "@@ -93,15 +96,29 @@ public MovePath addStep(final MoveStepType type) {\n             // we want to make note of when we're going into water (if we are capable of it)\n             // it may look cheaper, but it slows you down to max walking speed or worse, \n             // and we should flag it as costing extra, that extra being the difference between walking and running speed\n-            IHex hex = mp.getGame().getBoard().getHex(mp.getFinalCoords());\n-            if((hex != null) && hex.containsTerrain(Terrains.WATER) && (hex.depth() > 0)) {\n+            if(hexWaterDepth > 0) {", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI0NzA2MA==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440247060", "body": "```suggestion\r\n\r\n```", "bodyText": "Suggested change", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"><span class=\"x x-first x-last\">    </span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:10:30Z", "path": "megamek/src/megamek/common/Mech.java", "diffHunk": "@@ -211,7 +211,7 @@\n     public static final int HAS_UNKNOWN = 0;\n \n     public static final int HAS_TRUE = 1;\n-\n+    ", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI0NzQ1Nw==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440247457", "body": "```suggestion\r\n                    if (contents.containsKey(coords)) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                if(contents.containsKey(coords)) {\n          \n          \n            \n                                if (contents.containsKey(coords)) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    <span class=\"pl-k\">if</span>(contents<span class=\"pl-k\">.</span>containsKey(coords)) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(contents<span class=\"pl-k\">.</span>containsKey(coords)) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:11:04Z", "path": "megamek/src/megamek/common/pathfinder/BoardClusterTracker.java", "diffHunk": "@@ -363,7 +444,7 @@ public BoardCluster(int id) {\n             for(int x = xStart; x < xEnd; x++) {\n                 for(int y = yStart; y < yEnd; y++) {\n                     Coords coords = new Coords(x, y);\n-                    if(contents.contains(coords)) {\n+                    if(contents.containsKey(coords)) {", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI0ODYyMw==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440248623", "body": "```suggestion\r\n        if (terrainReduction) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(terrainReduction) {\n          \n          \n            \n                    if (terrainReduction) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span>(terrainReduction) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(terrainReduction) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:12:35Z", "path": "megamek/src/megamek/common/pathfinder/BoardClusterTracker.java", "diffHunk": "@@ -94,28 +103,58 @@ public static MovementType getMovementType(Entity entity) {\n     \n     private Map<MovementType, Map<Coords, BoardCluster>> movableAreas = new HashMap<>();\n     private Map<MovementType, Map<Coords, BoardCluster>> movableAreasWithTerrainReduction = new HashMap<>();\n-\n+    private Map<MovementType, Map<Coords, BoardCluster>> movableAreasBridges = new HashMap<>();\n+    private Map<MovementType, Map<Coords, BoardCluster>> movableAreasBridgesWithTerrainReduction = new HashMap<>();\n+    \n     /**\n-     * Returns the terrain-reduced or non-terrain-reduced \n-     * board cluster in which the given entity currently resides\n+     * Returns the size of the biggest terrain-reduced or non-terrain-reduced\n+     * board cluster in which the given coordinates currently reside.\n      */\n-    public BoardCluster getCurrentBoardCluster(Entity entity, boolean terrainReduction) {\n-        return getCurrentBoardCluster(entity, terrainReduction);\n+    public int getBoardClusterSize(Entity entity, Coords actualCoords, boolean terrainReduction) {\n+        MovementType movementType = MovementType.getMovementType(entity);\n+        \n+        updateMovableAreas(entity);\n+        \n+        if(terrainReduction) {", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI0OTA3OA==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440249078", "body": "```suggestion\r\n        if (retVal.size() == 0) {\r\n            if (terrainReduction) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(retVal.size() == 0) {\n          \n          \n            \n                        if(terrainReduction) {\n          \n          \n            \n                    if (retVal.size() == 0) {\n          \n          \n            \n                        if (terrainReduction) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span>(retVal<span class=\"pl-k\">.</span>size() <span class=\"pl-k\">==</span> <span class=\"pl-c1\">0</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">if</span>(terrainReduction) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(retVal<span class=\"pl-k\">.</span>size() <span class=\"pl-k\">==</span> <span class=\"pl-c1\">0</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(terrainReduction) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:13:14Z", "path": "megamek/src/megamek/common/pathfinder/BoardClusterTracker.java", "diffHunk": "@@ -139,11 +178,26 @@ public BoardCluster getCurrentBoardCluster(Entity entity, Coords actualCoords, b\n             entityCluster = movableAreas.get(movementType).get(entity.getPosition());\n         }\n         \n+        Set<Coords> retVal = Collections.emptySet();\n+        \n         if(entityCluster != null) {\n-            return entityCluster.getIntersectingHexes(actualEdge, entity.getGame().getBoard());\n+            retVal = entityCluster.getIntersectingHexes(actualEdge, entity.getGame().getBoard());\n+        }\n+        \n+        // try with bridges\n+        if(retVal.size() == 0) {\n+            if(terrainReduction) {", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI0OTIyMw==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440249223", "body": "```suggestion\r\n            if (entityCluster != null) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if(entityCluster != null) {\n          \n          \n            \n                        if (entityCluster != null) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">if</span>(entityCluster <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(entityCluster <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:13:23Z", "path": "megamek/src/megamek/common/pathfinder/BoardClusterTracker.java", "diffHunk": "@@ -139,11 +178,26 @@ public BoardCluster getCurrentBoardCluster(Entity entity, Coords actualCoords, b\n             entityCluster = movableAreas.get(movementType).get(entity.getPosition());\n         }\n         \n+        Set<Coords> retVal = Collections.emptySet();\n+        \n         if(entityCluster != null) {\n-            return entityCluster.getIntersectingHexes(actualEdge, entity.getGame().getBoard());\n+            retVal = entityCluster.getIntersectingHexes(actualEdge, entity.getGame().getBoard());\n+        }\n+        \n+        // try with bridges\n+        if(retVal.size() == 0) {\n+            if(terrainReduction) {\n+                entityCluster = movableAreasBridgesWithTerrainReduction.get(movementType).get(entity.getPosition());\n+            } else {\n+                entityCluster = movableAreasBridges.get(movementType).get(entity.getPosition());\n+            }\n+            \n+            if(entityCluster != null) {", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI0OTQ1Mg==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440249452", "body": "```suggestion\r\n                        canUseBridge && (entity.getWeight() <= board.getBuildingAt(c).getCurrentCF(c))) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    canUseBridge && entity.getWeight() <= board.getBuildingAt(c).getCurrentCF(c)) {\n          \n          \n            \n                                    canUseBridge && (entity.getWeight() <= board.getBuildingAt(c).getCurrentCF(c))) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                        canUseBridge <span class=\"pl-k\">&amp;&amp;</span> entity<span class=\"pl-k\">.</span>getWeight() <span class=\"pl-k\">&lt;=</span> board<span class=\"pl-k\">.</span>getBuildingAt(c)<span class=\"pl-k\">.</span>getCurrentCF(c)) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                        canUseBridge <span class=\"pl-k\">&amp;&amp;</span> <span class=\"x x-first x-last\">(</span>entity<span class=\"pl-k\">.</span>getWeight() <span class=\"pl-k\">&lt;=</span> board<span class=\"pl-k\">.</span>getBuildingAt(c)<span class=\"pl-k\">.</span>getCurrentCF(c<span class=\"x x-first x-last\">)</span>)) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:13:43Z", "path": "megamek/src/megamek/common/pathfinder/BoardClusterTracker.java", "diffHunk": "@@ -208,6 +274,15 @@ public void updateMovableAreas(Entity entity) {\n                     continue;\n                 }\n                 \n+                int myElevation = 0; \n+                        \n+                if (useBridgeTop && board.getHex(c).containsTerrain(Terrains.BRIDGE) &&\n+                        canUseBridge && entity.getWeight() <= board.getBuildingAt(c).getCurrentCF(c)) {", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI0OTcwMg==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440249702", "body": "```suggestion\r\n                                canUseBridge && (entity.getWeight() <= board.getBuildingAt(neighbor).getCurrentCF(neighbor))) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                            canUseBridge && entity.getWeight() <= board.getBuildingAt(neighbor).getCurrentCF(neighbor)) {\n          \n          \n            \n                                            canUseBridge && (entity.getWeight() <= board.getBuildingAt(neighbor).getCurrentCF(neighbor))) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                                canUseBridge <span class=\"pl-k\">&amp;&amp;</span> entity<span class=\"pl-k\">.</span>getWeight() <span class=\"pl-k\">&lt;=</span> board<span class=\"pl-k\">.</span>getBuildingAt(neighbor)<span class=\"pl-k\">.</span>getCurrentCF(neighbor)) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                                canUseBridge <span class=\"pl-k\">&amp;&amp;</span> <span class=\"x x-first x-last\">(</span>entity<span class=\"pl-k\">.</span>getWeight() <span class=\"pl-k\">&lt;=</span> board<span class=\"pl-k\">.</span>getBuildingAt(neighbor)<span class=\"pl-k\">.</span>getCurrentCF(neighbor<span class=\"x x-first x-last\">)</span>)) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:14:06Z", "path": "megamek/src/megamek/common/pathfinder/BoardClusterTracker.java", "diffHunk": "@@ -216,8 +291,14 @@ public void updateMovableAreas(Entity entity) {\n                     Coords neighbor = c.translated(direction);\n                     \n                     if(clusters.containsKey(neighbor)) {\n-                        int neighborElevation = BoardEdgePathFinder.calculateUnitElevationInHex(board.getHex(neighbor), entity, isHovercraft, isAmphibious);\n-                        int myElevation = BoardEdgePathFinder.calculateUnitElevationInHex(board.getHex(c), entity, isHovercraft, isAmphibious);\n+                        int neighborElevation = 0;\n+                        \n+                        if (useBridgeTop && board.getHex(neighbor).containsTerrain(Terrains.BRIDGE) &&\n+                                canUseBridge && entity.getWeight() <= board.getBuildingAt(neighbor).getCurrentCF(neighbor)) {", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI1MDA1OA==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440250058", "body": "```suggestion\r\n        if (useBridgeTop && !entity.isSurfaceNaval() && hex.containsTerrain(Terrains.BRIDGE_CF)) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(useBridgeTop && !entity.isSurfaceNaval() && hex.containsTerrain(Terrains.BRIDGE_CF)) {\n          \n          \n            \n                    if (useBridgeTop && !entity.isSurfaceNaval() && hex.containsTerrain(Terrains.BRIDGE_CF)) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"648\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span>(useBridgeTop <span class=\"pl-k\">&amp;&amp;</span> <span class=\"pl-k\">!</span>entity<span class=\"pl-k\">.</span>isSurfaceNaval() <span class=\"pl-k\">&amp;&amp;</span> hex<span class=\"pl-k\">.</span>containsTerrain(<span class=\"pl-smi\">Terrains</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>BRIDGE_CF</span>)) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"648\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(useBridgeTop <span class=\"pl-k\">&amp;&amp;</span> <span class=\"pl-k\">!</span>entity<span class=\"pl-k\">.</span>isSurfaceNaval() <span class=\"pl-k\">&amp;&amp;</span> hex<span class=\"pl-k\">.</span>containsTerrain(<span class=\"pl-smi\">Terrains</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>BRIDGE_CF</span>)) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:14:36Z", "path": "megamek/src/megamek/common/pathfinder/BoardEdgePathFinder.java", "diffHunk": "@@ -616,14 +627,30 @@ private MoveLegalityIndicator isLegalMove(MovePath movePath, IHex destHex, Build\n      * @return The effective elevation\n      */\n     public static int calculateUnitElevationInHex(IHex hex, Entity entity, boolean isHovercraft, boolean isAmphibious) {\n+        return calculateUnitElevationInHex(hex, entity, isHovercraft, isAmphibious, false);\n+    }\n+    \n+    /**\n+     * Helper function that calculates the effective elevation for a unit standing there.\n+     * @param hex The hex to check\n+     * @param entity The entity to check\n+     * @param bridgeTop Whether we're going on top of a bridge or under it\n+     * @return The effective elevation\n+     */\n+    public static int calculateUnitElevationInHex(IHex hex, Entity entity, boolean isHovercraft, boolean isAmphibious, boolean useBridgeTop) {\n         // we calculate the height of a hex as \"on the ground\" by default\n         // Special exceptions:\n-        // We are a mech, which can hopping on top of some buildings\n+        // We are a mech, which can hop on top of some buildings\n         // We are naval unit going under a bridge, in which case the height is the water level (naval units go on the surface, mostly)\n         // We are non-naval going into water but not onto a bridge, in which case the height is the floor (mechs sink to the bottom)\n-\n+        // if we are explicitly going to the top of a bridge, use that.\n+        \n+        if(useBridgeTop && !entity.isSurfaceNaval() && hex.containsTerrain(Terrains.BRIDGE_CF)) {", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI1MDE0OA==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440250148", "body": "```suggestion\r\n\r\n```", "bodyText": "Suggested change", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"653\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"><span class=\"x x-first x-last\">        </span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:14:44Z", "path": "megamek/src/megamek/common/pathfinder/BoardEdgePathFinder.java", "diffHunk": "@@ -616,14 +627,30 @@ private MoveLegalityIndicator isLegalMove(MovePath movePath, IHex destHex, Build\n      * @return The effective elevation\n      */\n     public static int calculateUnitElevationInHex(IHex hex, Entity entity, boolean isHovercraft, boolean isAmphibious) {\n+        return calculateUnitElevationInHex(hex, entity, isHovercraft, isAmphibious, false);\n+    }\n+    \n+    /**\n+     * Helper function that calculates the effective elevation for a unit standing there.\n+     * @param hex The hex to check\n+     * @param entity The entity to check\n+     * @param bridgeTop Whether we're going on top of a bridge or under it\n+     * @return The effective elevation\n+     */\n+    public static int calculateUnitElevationInHex(IHex hex, Entity entity, boolean isHovercraft, boolean isAmphibious, boolean useBridgeTop) {\n         // we calculate the height of a hex as \"on the ground\" by default\n         // Special exceptions:\n-        // We are a mech, which can hopping on top of some buildings\n+        // We are a mech, which can hop on top of some buildings\n         // We are naval unit going under a bridge, in which case the height is the water level (naval units go on the surface, mostly)\n         // We are non-naval going into water but not onto a bridge, in which case the height is the floor (mechs sink to the bottom)\n-\n+        // if we are explicitly going to the top of a bridge, use that.\n+        \n+        if(useBridgeTop && !entity.isSurfaceNaval() && hex.containsTerrain(Terrains.BRIDGE_CF)) {\n+            return hex.ceiling();\n+        }\n+        \n         int hexElevation = hex.getLevel();\n-\n+        ", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI1MDUwMA==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440250500", "body": "```suggestion\r\n        if (torsoJumpJets == null) {\r\n            if (backingEntity instanceof Mech) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(torsoJumpJets == null) {\n          \n          \n            \n                        if(backingEntity instanceof Mech) {\n          \n          \n            \n                    if (torsoJumpJets == null) {\n          \n          \n            \n                        if (backingEntity instanceof Mech) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"98\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span>(torsoJumpJets <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"99\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">if</span>(backingEntity <span class=\"pl-k\">instanceof</span> <span class=\"pl-smi\">Mech</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"98\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(torsoJumpJets <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"99\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(backingEntity <span class=\"pl-k\">instanceof</span> <span class=\"pl-smi\">Mech</span>) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:15:11Z", "path": "megamek/src/megamek/common/pathfinder/CachedEntityState.java", "diffHunk": "@@ -90,4 +93,25 @@ public boolean hasWorkingMisc(BigInteger flag) {\n         \n         return hasWorkingMisc.get(flag);\n     }\n+    \n+    public int getTorsoJumpJets() {\n+        if(torsoJumpJets == null) {\n+            if(backingEntity instanceof Mech) {", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI1MDkzMw==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440250933", "body": "```suggestion\r\n        if (irreversibleJumpDown && \r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(irreversibleJumpDown && \n          \n          \n            \n                    if (irreversibleJumpDown &&", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span>(irreversibleJumpDown <span class=\"pl-k\">&amp;&amp;</span> </td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(irreversibleJumpDown <span class=\"pl-k\">&amp;&amp;</span> </td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:15:37Z", "path": "megamek/src/megamek/common/pathfinder/DestructionAwareDestinationPathfinder.java", "diffHunk": "@@ -202,6 +209,25 @@ protected void processChild(BulldozerMovePath child, List<BulldozerMovePath> chi\n                 !mli.outOfBounds &&\n                 (!mli.goingUpTooHigh || child.needsLeveling());\n         \n+        // this is true if we're jumping down further down than our max jump MP\n+        // or jumping down lower than our max elevation change\n+        boolean irreversibleJumpDown = \n+                (child.isJumping() && (Math.abs(mli.elevationChange) > child.getCachedEntityState().getJumpMP())) ||\n+                (child.getEntity().getMaxElevationDown() == Entity.UNLIMITED_JUMP_DOWN) && (Math.abs(mli.elevationChange) > child.getEntity().getMaxElevationChange());\n+        \n+        boolean destinationUseBridge = child.getGame().getBoard().getHex(destinationCoords).getTerrain(Terrains.BRIDGE) != null;\n+        int destHexElevation = calculateUnitElevationInHex(child.getGame().getBoard().getHex(destinationCoords), \n+                child.getEntity(), child.getEntity().getMovementMode() == EntityMovementMode.HOVER, child.getCachedEntityState().isAmphibious(),\n+                destinationUseBridge);\n+        \n+        // if we jumped into a hole and this results into us moving into a different cluster than the destination,\n+        // that's not great and we should not consider the possibility for long range path finding.\n+        if(irreversibleJumpDown && ", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI1MTIzMw==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440251233", "body": "```suggestion\r\n        if (clippedSource.getGame().getFirstEnemyEntity(clippedSource.getLastStep().getPosition(), clippedSource.getEntity()) != null) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(clippedSource.getGame().getFirstEnemyEntity(clippedSource.getLastStep().getPosition(), clippedSource.getEntity()) != null) {\n          \n          \n            \n                    if (clippedSource.getGame().getFirstEnemyEntity(clippedSource.getLastStep().getPosition(), clippedSource.getEntity()) != null) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span>(clippedSource<span class=\"pl-k\">.</span>getGame()<span class=\"pl-k\">.</span>getFirstEnemyEntity(clippedSource<span class=\"pl-k\">.</span>getLastStep()<span class=\"pl-k\">.</span>getPosition(), clippedSource<span class=\"pl-k\">.</span>getEntity()) <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(clippedSource<span class=\"pl-k\">.</span>getGame()<span class=\"pl-k\">.</span>getFirstEnemyEntity(clippedSource<span class=\"pl-k\">.</span>getLastStep()<span class=\"pl-k\">.</span>getPosition(), clippedSource<span class=\"pl-k\">.</span>getEntity()) <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:16:01Z", "path": "megamek/src/megamek/common/pathfinder/PathDecorator.java", "diffHunk": "@@ -62,6 +62,16 @@\n             retVal.addAll(clippedPaths);\n         }\n         \n+        // if there is a bad guy in the last step, clip to one step short and see if we can't get around.\n+        if(clippedSource.getGame().getFirstEnemyEntity(clippedSource.getLastStep().getPosition(), clippedSource.getEntity()) != null) {", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDI1MTMzNQ==", "url": "https://github.com/MegaMek/megamek/pull/1997#discussion_r440251335", "body": "```suggestion\r\n            for (int desiredMP : desiredMPs) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        for(int desiredMP : desiredMPs) {\n          \n          \n            \n                        for (int desiredMP : desiredMPs) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">for</span>(<span class=\"pl-k\">int</span> desiredMP <span class=\"pl-k\">:</span> desiredMPs) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">for</span><span class=\"x x-first x-last\"> </span>(<span class=\"pl-k\">int</span> desiredMP <span class=\"pl-k\">:</span> desiredMPs) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-06-15T15:16:08Z", "path": "megamek/src/megamek/common/pathfinder/PathDecorator.java", "diffHunk": "@@ -62,6 +62,16 @@\n             retVal.addAll(clippedPaths);\n         }\n         \n+        // if there is a bad guy in the last step, clip to one step short and see if we can't get around.\n+        if(clippedSource.getGame().getFirstEnemyEntity(clippedSource.getLastStep().getPosition(), clippedSource.getEntity()) != null) {\n+            clippedSource.removeLastStep();\n+            \n+            for(int desiredMP : desiredMPs) {", "originalCommit": "58fd24db4e41611fc7c3696e9d76bb3b32bfd5f1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "debca0c7f18a6d0bacaf75b274a5e82eec67e62b", "url": "https://github.com/MegaMek/megamek/commit/debca0c7f18a6d0bacaf75b274a5e82eec67e62b", "message": "Apply suggestions from code review\n\nCo-authored-by: Justin Bowen <39067288+Windchild292@users.noreply.github.com>", "committedDate": "2020-06-15T21:08:24Z", "type": "commit"}]}