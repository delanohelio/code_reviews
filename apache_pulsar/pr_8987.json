{"pr_number": 8987, "pr_title": "Support create and update sink with package name", "pr_author": "zymap", "pr_createdAt": "2020-12-17T14:33:54Z", "pr_url": "https://github.com/apache/pulsar/pull/8987", "timeline": [{"oid": "a92e1aae11cc905ee8d8d2faec0bcaefad53ad27", "url": "https://github.com/apache/pulsar/commit/a92e1aae11cc905ee8d8d2faec0bcaefad53ad27", "message": "Support create and update sink with package name\n---\n\nMaster Issue: #8676\n\n*Motivation*\n\nWe have a new package management service that can manage all\nthe sink packages. We can use that in the Pulsar Sink to manage\nsink pakcages.\n\n*Modifications*\n\n- Support create and update sink with package name\n- Add test for this", "committedDate": "2020-12-17T14:19:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQxODU4Mg==", "url": "https://github.com/apache/pulsar/pull/8987#discussion_r547418582", "body": "Same comment in apache/pulsar#8988. Why do we need to download the package?", "bodyText": "Same comment in #8988. Why do we need to download the package?", "bodyHTML": "<p dir=\"auto\">Same comment in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"770098604\" data-permission-text=\"Title is private\" data-url=\"https://github.com/apache/pulsar/issues/8988\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/apache/pulsar/pull/8988/hovercard\" href=\"https://github.com/apache/pulsar/pull/8988\">#8988</a>. Why do we need to download the package?</p>", "author": "sijie", "createdAt": "2020-12-22T17:56:36Z", "path": "pulsar-functions/worker/src/main/java/org/apache/pulsar/functions/worker/rest/api/SinksImpl.java", "diffHunk": "@@ -317,10 +321,14 @@ public void updateSink(final String tenant,\n             // validate parameters\n             try {\n                 if (isNotBlank(sinkPkgUrl)) {\n-                    try {\n-                        componentPackageFile = FunctionCommon.extractFileFromPkgURL(sinkPkgUrl);\n-                    } catch (Exception e) {\n-                        throw new IllegalArgumentException(String.format(\"Encountered error \\\"%s\\\" when getting %s package from %s\", e.getMessage(), ComponentTypeUtils.toString(componentType), sinkPkgUrl));\n+                    if (hasPackageTypePrefix(sinkPkgUrl)) {\n+                        componentPackageFile = downloadPackageFile(sinkPkgUrl);", "originalCommit": "a92e1aae11cc905ee8d8d2faec0bcaefad53ad27", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}