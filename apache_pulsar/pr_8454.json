{"pr_number": 8454, "pr_title": "[pulsar-broker] Security-Recommendation: Remove verbose error message with system info for admin-api", "pr_author": "rdhabalia", "pr_createdAt": "2020-11-05T19:14:02Z", "pr_url": "https://github.com/apache/pulsar/pull/8454", "timeline": [{"oid": "4837f7689a9caa95e154febfd81965ccddb8f2de", "url": "https://github.com/apache/pulsar/commit/4837f7689a9caa95e154febfd81965ccddb8f2de", "message": "[pulsar-broker] Security-Recommendation: Remove verbose error message with system info for admin-api", "committedDate": "2020-11-05T19:12:32Z", "type": "commit"}, {"oid": "77071a21713f23225de1b2ccf48d122d8379b713", "url": "https://github.com/apache/pulsar/commit/77071a21713f23225de1b2ccf48d122d8379b713", "message": "add unit-test", "committedDate": "2020-11-05T22:27:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODU3NDgxOQ==", "url": "https://github.com/apache/pulsar/pull/8454#discussion_r518574819", "body": "thank you for adding the test @rdhabalia \r\n\r\nI asked for a test, because IIUC the issue here is that we want a new message for security reasons, \r\nmessages in exceptions sometimes change due to refactors and it is probable that in the future someone will change the error message if there is no test case.\r\n\r\nthe implementation is that we are now referring to the bundleRange in the message\r\nIMHO the test should test that actually the message contains that value.\r\n\r\nAlso I would add here a comment that states that it is better to not change the message for security reasons (with a minimal explanation, not just \"for security reasons\")\r\n\r\n", "bodyText": "thank you for adding the test @rdhabalia\nI asked for a test, because IIUC the issue here is that we want a new message for security reasons,\nmessages in exceptions sometimes change due to refactors and it is probable that in the future someone will change the error message if there is no test case.\nthe implementation is that we are now referring to the bundleRange in the message\nIMHO the test should test that actually the message contains that value.\nAlso I would add here a comment that states that it is better to not change the message for security reasons (with a minimal explanation, not just \"for security reasons\")", "bodyHTML": "<p dir=\"auto\">thank you for adding the test <a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/rdhabalia/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rdhabalia\">@rdhabalia</a></p>\n<p dir=\"auto\">I asked for a test, because IIUC the issue here is that we want a new message for security reasons,<br>\nmessages in exceptions sometimes change due to refactors and it is probable that in the future someone will change the error message if there is no test case.</p>\n<p dir=\"auto\">the implementation is that we are now referring to the bundleRange in the message<br>\nIMHO the test should test that actually the message contains that value.</p>\n<p dir=\"auto\">Also I would add here a comment that states that it is better to not change the message for security reasons (with a minimal explanation, not just \"for security reasons\")</p>", "author": "eolivelli", "createdAt": "2020-11-06T07:49:05Z", "path": "pulsar-broker/src/test/java/org/apache/pulsar/broker/admin/AdminApiTest2.java", "diffHunk": "@@ -1338,6 +1338,16 @@ public void testMaxNamespacesPerTenant() throws Exception {\n \n     }\n \n+    @Test\n+    public void testInvalidBundleErrorResponse() throws Exception {\n+        try {\n+            admin.namespaces().deleteNamespaceBundle(\"prop-xyz/ns1\", \"invalid-bundle\");\n+            fail(\"should have failed due to invalid bundle\");\n+        } catch (PreconditionFailedException e) {\n+            assertTrue(e.getMessage().startsWith(\"Invalid bundle range\"));", "originalCommit": "77071a21713f23225de1b2ccf48d122d8379b713", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}