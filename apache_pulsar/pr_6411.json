{"pr_number": 6411, "pr_title": "[functions] Allow custom resources for k8s", "pr_author": "rivernate", "pr_createdAt": "2020-02-24T17:49:18Z", "pr_url": "https://github.com/apache/pulsar/pull/6411", "timeline": [{"oid": "8428c1abfc4b294527fc5842e0456129f0148b30", "url": "https://github.com/apache/pulsar/commit/8428c1abfc4b294527fc5842e0456129f0148b30", "message": "[functions] Allow custom resources for k8s\n\nThis commit adds additional arguments to the\nBasicKubernetesManifestCustomizer for resource requirements. Currently\nboth the request and limit for cpu and memory are specified by resources\narguments, with no way to change the limit. This commit allows both the\nlimit and request to be set independently.", "committedDate": "2020-02-24T17:47:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQ3NTAzNw==", "url": "https://github.com/apache/pulsar/pull/6411#discussion_r383475037", "body": "```suggestion\r\n    private static final String RESOURCE_CPU = \"cpu\";\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                String RESOURCE_CPU = \"cpu\";\n          \n          \n            \n                private static final String RESOURCE_CPU = \"cpu\";", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-smi\">String</span> <span class=\"pl-c1\">RESOURCE_CPU</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>cpu<span class=\"pl-pds\">\"</span></span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k x x-first\">private</span><span class=\"x\"> </span><span class=\"pl-k x\">static</span><span class=\"x\"> </span><span class=\"pl-k x\">final</span><span class=\"x x-last\"> </span><span class=\"pl-smi\">String</span> <span class=\"pl-c1\">RESOURCE_CPU</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>cpu<span class=\"pl-pds\">\"</span></span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "sijie", "createdAt": "2020-02-24T19:43:51Z", "path": "pulsar-functions/runtime/src/main/java/org/apache/pulsar/functions/runtime/kubernetes/BasicKubernetesManifestCustomizer.java", "diffHunk": "@@ -42,6 +41,10 @@\n  */\n public class BasicKubernetesManifestCustomizer implements KubernetesManifestCustomizer {\n \n+    String RESOURCE_CPU = \"cpu\";", "originalCommit": "8428c1abfc4b294527fc5842e0456129f0148b30", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQ3NTEzMA==", "url": "https://github.com/apache/pulsar/pull/6411#discussion_r383475130", "body": "```suggestion\r\n    private static final String RESOURCE_MEMORY = \"memory\";\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                String RESOURCE_MEMORY = \"memory\";\n          \n          \n            \n                private static final String RESOURCE_MEMORY = \"memory\";", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-smi\">String</span> <span class=\"pl-c1\">RESOURCE_MEMORY</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>memory<span class=\"pl-pds\">\"</span></span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k x x-first\">private</span><span class=\"x\"> </span><span class=\"pl-k x\">static</span><span class=\"x\"> </span><span class=\"pl-k x\">final</span><span class=\"x x-last\"> </span><span class=\"pl-smi\">String</span> <span class=\"pl-c1\">RESOURCE_MEMORY</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>memory<span class=\"pl-pds\">\"</span></span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "sijie", "createdAt": "2020-02-24T19:44:01Z", "path": "pulsar-functions/runtime/src/main/java/org/apache/pulsar/functions/runtime/kubernetes/BasicKubernetesManifestCustomizer.java", "diffHunk": "@@ -42,6 +41,10 @@\n  */\n public class BasicKubernetesManifestCustomizer implements KubernetesManifestCustomizer {\n \n+    String RESOURCE_CPU = \"cpu\";\n+    String RESOURCE_MEMORY = \"memory\";", "originalCommit": "8428c1abfc4b294527fc5842e0456129f0148b30", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDAxNjE5Nw==", "url": "https://github.com/apache/pulsar/pull/6411#discussion_r384016197", "bodyText": "done", "author": "rivernate", "createdAt": "2020-02-25T17:22:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQ3NTEzMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MzQ3NTIwNg==", "url": "https://github.com/apache/pulsar/pull/6411#discussion_r383475206", "body": "```suggestion\r\n    private static final String[] RESOURCES = {RESOURCE_CPU, RESOURCE_MEMORY};\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                String[] RESOURCES = {RESOURCE_CPU, RESOURCE_MEMORY};\n          \n          \n            \n                private static final String[] RESOURCES = {RESOURCE_CPU, RESOURCE_MEMORY};", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">String</span>[] <span class=\"pl-c1\">RESOURCES</span> <span class=\"pl-k\">=</span> {<span class=\"pl-c1\">RESOURCE_CPU</span>, <span class=\"pl-c1\">RESOURCE_MEMORY</span>};</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k x x-first\">private</span><span class=\"x\"> </span><span class=\"pl-k x\">static</span><span class=\"x\"> </span><span class=\"pl-k x\">final</span><span class=\"x x-last\"> </span><span class=\"pl-k\">String</span>[] <span class=\"pl-c1\">RESOURCES</span> <span class=\"pl-k\">=</span> {<span class=\"pl-c1\">RESOURCE_CPU</span>, <span class=\"pl-c1\">RESOURCE_MEMORY</span>};</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "sijie", "createdAt": "2020-02-24T19:44:10Z", "path": "pulsar-functions/runtime/src/main/java/org/apache/pulsar/functions/runtime/kubernetes/BasicKubernetesManifestCustomizer.java", "diffHunk": "@@ -42,6 +41,10 @@\n  */\n public class BasicKubernetesManifestCustomizer implements KubernetesManifestCustomizer {\n \n+    String RESOURCE_CPU = \"cpu\";\n+    String RESOURCE_MEMORY = \"memory\";\n+    String[] RESOURCES = {RESOURCE_CPU, RESOURCE_MEMORY};", "originalCommit": "8428c1abfc4b294527fc5842e0456129f0148b30", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "56d4f90e3807697502a283489ed1e4b72dbc38fc", "url": "https://github.com/apache/pulsar/commit/56d4f90e3807697502a283489ed1e4b72dbc38fc", "message": "Make constants private static final", "committedDate": "2020-02-25T17:20:56Z", "type": "commit"}]}