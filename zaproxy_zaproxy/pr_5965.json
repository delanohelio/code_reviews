{"pr_number": 5965, "pr_title": "Add host, path and query columns to the history table", "pr_author": "DiogoMRSilva", "pr_createdAt": "2020-05-01T18:36:28Z", "pr_url": "https://github.com/zaproxy/zaproxy/pull/5965", "timeline": [{"oid": "12bd272c29d017d4f3e13bfbc99c5cd55d7fbe61", "url": "https://github.com/zaproxy/zaproxy/commit/12bd272c29d017d4f3e13bfbc99c5cd55d7fbe61", "message": "Add host, path and query columns to the history table\n\nSigned-off-by: Diogo Silva <diogo.m.r.silva@tecnico.ulisboa.pt>", "committedDate": "2020-05-01T18:18:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY4ODkzMQ==", "url": "https://github.com/zaproxy/zaproxy/pull/5965#discussion_r418688931", "body": "Since these are basically all the same why not extract a private method and pass the column constant?\r\nPrinting the stack trace should be replaced with a logger.", "bodyText": "Since these are basically all the same why not extract a private method and pass the column constant?\nPrinting the stack trace should be replaced with a logger.", "bodyHTML": "<p dir=\"auto\">Since these are basically all the same why not extract a private method and pass the column constant?<br>\nPrinting the stack trace should be replaced with a logger.</p>", "author": "kingthorin", "createdAt": "2020-05-01T19:02:07Z", "path": "zap/src/main/java/org/zaproxy/zap/view/table/DefaultHistoryReferencesTableEntry.java", "diffHunk": "@@ -120,6 +129,52 @@ public DefaultHistoryReferencesTableEntry(HistoryReference historyReference, Col\n \n         alertRiskCellItem = super.getHighestAlert();\n \n+        try {\n+            hostname1 =\n+                    hasColumn(sortedColumns, Column.HOSTNAME)\n+                            ? historyReference.getURI().getHost()\n+                            : null;\n+        } catch (URIException e) {\n+            hostname1 = null;\n+            e.printStackTrace();\n+        }\n+        hostname = hostname1;", "originalCommit": "12bd272c29d017d4f3e13bfbc99c5cd55d7fbe61", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY4OTc1Ng==", "url": "https://github.com/zaproxy/zaproxy/pull/5965#discussion_r418689756", "bodyText": "Also is the intermediate storage necessary? (var vs var1)", "author": "kingthorin", "createdAt": "2020-05-01T19:04:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY4ODkzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODcyMDQwMQ==", "url": "https://github.com/zaproxy/zaproxy/pull/5965#discussion_r418720401", "bodyText": "That's because they are final instance variables. Although IMO the components should be shown encoded, showing them decoded leads to data loss and misleading values (crude example, the path /%2F will be shown as // which is a completely different path).", "author": "thc202", "createdAt": "2020-05-01T20:19:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY4ODkzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODkzNTQ4Ng==", "url": "https://github.com/zaproxy/zaproxy/pull/5965#discussion_r418935486", "bodyText": "@thc202 I also think that they should be shown encoded, I didn't notice that was happening. @kingthorin the functions I will use now don't throw exception and the code will become more clean.", "author": "DiogoMRSilva", "createdAt": "2020-05-02T09:20:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY4ODkzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY1Mjg5Ng==", "url": "https://github.com/zaproxy/zaproxy/pull/5965#discussion_r420652896", "bodyText": "The host should also be shown encoded (for same reason), e.g.:\nnew String(historyReference.getURI().getRawHost())", "author": "thc202", "createdAt": "2020-05-06T09:19:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODY4ODkzMQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODcyMTQ4MQ==", "url": "https://github.com/zaproxy/zaproxy/pull/5965#discussion_r418721481", "body": "I'd expect these to be closer/next to the URL column by default (same in the enum).", "bodyText": "I'd expect these to be closer/next to the URL column by default (same in the enum).", "bodyHTML": "<p dir=\"auto\">I'd expect these to be closer/next to the URL column by default (same in the enum).</p>", "author": "thc202", "createdAt": "2020-05-01T20:22:52Z", "path": "zap/src/main/java/org/parosproxy/paros/extension/history/HistoryTableModel.java", "diffHunk": "@@ -44,7 +44,11 @@ public HistoryTableModel() {\n                     Column.SIZE_RESPONSE_BODY,\n                     Column.HIGHEST_ALERT,\n                     Column.NOTE,\n-                    Column.TAGS\n+                    Column.TAGS,\n+                    Column.HOSTNAME,", "originalCommit": "12bd272c29d017d4f3e13bfbc99c5cd55d7fbe61", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODcyMTU4OQ==", "url": "https://github.com/zaproxy/zaproxy/pull/5965#discussion_r418721589", "body": "Can let fall-through.", "bodyText": "Can let fall-through.", "bodyHTML": "<p dir=\"auto\">Can let fall-through.</p>", "author": "thc202", "createdAt": "2020-05-01T20:23:09Z", "path": "zap/src/main/java/org/zaproxy/zap/view/table/AbstractHistoryReferencesTableEntry.java", "diffHunk": "@@ -267,6 +303,14 @@ public static Object getPrototypeValue(Column column) {\n                 return String.class;\n             case CUSTOM:\n                 return null;\n+            case HOSTNAME:\n+                return String.class;", "originalCommit": "12bd272c29d017d4f3e13bfbc99c5cd55d7fbe61", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODcyMTY0OA==", "url": "https://github.com/zaproxy/zaproxy/pull/5965#discussion_r418721648", "body": "This is not necessary for these columns.", "bodyText": "This is not necessary for these columns.", "bodyHTML": "<p dir=\"auto\">This is not necessary for these columns.</p>", "author": "thc202", "createdAt": "2020-05-01T20:23:20Z", "path": "zap/src/main/java/org/zaproxy/zap/view/table/HistoryReferencesTable.java", "diffHunk": "@@ -379,6 +379,11 @@ public void configureTableColumn(final TableModel model, final TableColumnExt co\n                     columnExt, hRefModel.getColumnIndex(Column.SIZE_RESPONSE_HEADER), model);\n             installSizeBytesRenderer(\n                     columnExt, hRefModel.getColumnIndex(Column.SIZE_RESPONSE_BODY), model);\n+            installSizeBytesRenderer(columnExt, hRefModel.getColumnIndex(Column.HOSTNAME), model);", "originalCommit": "12bd272c29d017d4f3e13bfbc99c5cd55d7fbe61", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "eb43ed101a538f9b4af064050c1c673085cddd13", "url": "https://github.com/zaproxy/zaproxy/commit/eb43ed101a538f9b4af064050c1c673085cddd13", "message": "Fix the encoding of path and args that are show in history table\n\nSigned-off-by: Diogo Silva <diogo.m.r.silva@tecnico.ulisboa.pt>", "committedDate": "2020-05-02T09:24:11Z", "type": "commit"}, {"oid": "ebd3570f6622e1d12b664eb0a1f4f7861095ac05", "url": "https://github.com/zaproxy/zaproxy/commit/ebd3570f6622e1d12b664eb0a1f4f7861095ac05", "message": "Reorder History table columns\n\nSigned-off-by: Diogo Silva <diogo.m.r.silva@tecnico.ulisboa.pt>", "committedDate": "2020-05-02T09:42:51Z", "type": "commit"}, {"oid": "6c799dfcb48e6140a8fbed9a2b697bae18a57c24", "url": "https://github.com/zaproxy/zaproxy/commit/6c799dfcb48e6140a8fbed9a2b697bae18a57c24", "message": "Remove path and args columns from history table to reduce memory usage\n\nSigned-off-by: Diogo Silva <diogo.m.r.silva@tecnico.ulisboa.pt>", "committedDate": "2020-05-02T10:17:04Z", "type": "forcePushed"}, {"oid": "644eb8da4f9c38297aee37fec1c060a2c393ef77", "url": "https://github.com/zaproxy/zaproxy/commit/644eb8da4f9c38297aee37fec1c060a2c393ef77", "message": "Fix the encoding of path and args that are show in history table\n\nSigned-off-by: Diogo Silva <diogo.m.r.silva@tecnico.ulisboa.pt>", "committedDate": "2020-05-02T10:26:39Z", "type": "commit"}, {"oid": "ab734821d7021173e465361f7ca1e82545c39f30", "url": "https://github.com/zaproxy/zaproxy/commit/ab734821d7021173e465361f7ca1e82545c39f30", "message": "Fix the encoding of path and args that are show in history table\n\nSigned-off-by: Diogo Silva <diogo.m.r.silva@tecnico.ulisboa.pt>", "committedDate": "2020-05-02T10:26:39Z", "type": "forcePushed"}, {"oid": "644eb8da4f9c38297aee37fec1c060a2c393ef77", "url": "https://github.com/zaproxy/zaproxy/commit/644eb8da4f9c38297aee37fec1c060a2c393ef77", "message": "Fix the encoding of path and args that are show in history table\n\nSigned-off-by: Diogo Silva <diogo.m.r.silva@tecnico.ulisboa.pt>", "committedDate": "2020-05-02T10:26:39Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTA4NjA3Ng==", "url": "https://github.com/zaproxy/zaproxy/pull/5965#discussion_r419086076", "body": "Should use a logger", "bodyText": "Should use a logger", "bodyHTML": "<p dir=\"auto\">Should use a logger</p>", "author": "kingthorin", "createdAt": "2020-05-03T10:59:05Z", "path": "zap/src/main/java/org/zaproxy/zap/view/table/DefaultHistoryReferencesTableEntry.java", "diffHunk": "@@ -87,6 +91,20 @@ public DefaultHistoryReferencesTableEntry(HistoryReference historyReference, Col\n         rtt = hasColumn(sortedColumns, Column.RTT) ? historyReference.getRtt() : null;\n \n         uri = hasColumn(sortedColumns, Column.URL) ? historyReference.getURI().toString() : null;\n+        try {\n+            hostname1 =\n+                    hasColumn(sortedColumns, Column.HOSTNAME)\n+                            ? historyReference.getURI().getHost()\n+                            : null;\n+        } catch (URIException e) {\n+            hostname1 = null;\n+            e.printStackTrace();", "originalCommit": "644eb8da4f9c38297aee37fec1c060a2c393ef77", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "f3f150d2d8a0a999523d2f2d24f80d8092de80e0", "url": "https://github.com/zaproxy/zaproxy/commit/f3f150d2d8a0a999523d2f2d24f80d8092de80e0", "message": "Replace print stack trace with logger\n\nSigned-off-by: Diogo Silva <diogo.m.r.silva@tecnico.ulisboa.pt>", "committedDate": "2020-05-03T11:49:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTA5MjIyNg==", "url": "https://github.com/zaproxy/zaproxy/pull/5965#discussion_r419092226", "body": "```suggestion\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        e.printStackTrace();", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"><span class=\"x x-first\">            e</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">printStackTrace();</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "kingthorin", "createdAt": "2020-05-03T11:51:33Z", "path": "zap/src/main/java/org/zaproxy/zap/view/table/DefaultHistoryReferencesTableEntry.java", "diffHunk": "@@ -98,6 +101,7 @@ public DefaultHistoryReferencesTableEntry(HistoryReference historyReference, Col\n                             : null;\n         } catch (URIException e) {\n             hostname1 = null;\n+            LOGGER.error(e);\n             e.printStackTrace();", "originalCommit": "f3f150d2d8a0a999523d2f2d24f80d8092de80e0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "08c09d25076a9569047e3453bdc5165d2aeb44e0", "url": "https://github.com/zaproxy/zaproxy/commit/08c09d25076a9569047e3453bdc5165d2aeb44e0", "message": "Remove print stack trace\n\nSigned-off-by: Diogo Silva <diogo.m.r.silva@tecnico.ulisboa.pt>", "committedDate": "2020-05-03T11:54:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDY1NjgyMQ==", "url": "https://github.com/zaproxy/zaproxy/pull/5965#discussion_r420656821", "body": "This could be reverted.", "bodyText": "This could be reverted.", "bodyHTML": "<p dir=\"auto\">This could be reverted.</p>", "author": "thc202", "createdAt": "2020-05-06T09:26:32Z", "path": "zap/src/main/java/org/zaproxy/zap/view/table/HistoryReferencesTableModel.java", "diffHunk": "@@ -58,7 +60,6 @@\n         HIGHEST_ALERT,\n         NOTE,\n         TAGS,\n-", "originalCommit": "08c09d25076a9569047e3453bdc5165d2aeb44e0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "491db186fe9b89c5c21aea2018866c04650c2ba7", "url": "https://github.com/zaproxy/zaproxy/commit/491db186fe9b89c5c21aea2018866c04650c2ba7", "message": "revert deleted line\n\nSigned-off-by: Diogo Silva <diogo.m.r.silva@tecnico.ulisboa.pt>", "committedDate": "2020-05-06T21:44:02Z", "type": "commit"}, {"oid": "b036be0aeff850749fb57bf290815901ab064ebc", "url": "https://github.com/zaproxy/zaproxy/commit/b036be0aeff850749fb57bf290815901ab064ebc", "message": "Set host column of history encoded\n\nSigned-off-by: Diogo Silva <diogo.m.r.silva@tecnico.ulisboa.pt>", "committedDate": "2020-05-06T21:59:34Z", "type": "commit"}]}