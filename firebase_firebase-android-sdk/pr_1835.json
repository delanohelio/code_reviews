{"pr_number": 1835, "pr_title": "initial implementation of valueDecoder", "pr_author": "James201311", "pr_createdAt": "2020-07-30T17:23:41Z", "pr_url": "https://github.com/firebase/firebase-android-sdk/pull/1835", "timeline": [{"oid": "0d017b753fcb26503a1394120c58fd94b27ddb6d", "url": "https://github.com/firebase/firebase-android-sdk/commit/0d017b753fcb26503a1394120c58fd94b27ddb6d", "message": "initial implementation of valueDecoder", "committedDate": "2020-07-30T17:23:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE4MTE2NQ==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1835#discussion_r463181165", "body": "I may be wrong but my first hunch is that having value decoders return a `TypeCreator` seems like overkill.\r\nIf the idea is that ValueDecoders are only supposed to decode primitive types(i.e. not `{}` or `[]`) then we don't need the `TypeCreator` indirection, whose main intent is to delay the creation until all the requested values become available. But all primitives are already available and value decoders could directly return the value like:\r\n\r\n```java\r\ninterface ValueDecoder<T> {\r\n  @Nullable T decode(ValueDecoderContext ctx);\r\n}\r\n```\r\n\r\nwdyt?", "bodyText": "I may be wrong but my first hunch is that having value decoders return a TypeCreator seems like overkill.\nIf the idea is that ValueDecoders are only supposed to decode primitive types(i.e. not {} or []) then we don't need the TypeCreator indirection, whose main intent is to delay the creation until all the requested values become available. But all primitives are already available and value decoders could directly return the value like:\ninterface ValueDecoder<T> {\n  @Nullable T decode(ValueDecoderContext ctx);\n}\nwdyt?", "bodyHTML": "<p dir=\"auto\">I may be wrong but my first hunch is that having value decoders return a <code>TypeCreator</code> seems like overkill.<br>\nIf the idea is that ValueDecoders are only supposed to decode primitive types(i.e. not <code>{}</code> or <code>[]</code>) then we don't need the <code>TypeCreator</code> indirection, whose main intent is to delay the creation until all the requested values become available. But all primitives are already available and value decoders could directly return the value like:</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"interface ValueDecoder&lt;T&gt; {\n  @Nullable T decode(ValueDecoderContext ctx);\n}\"><pre><span class=\"pl-k\">interface</span> <span class=\"pl-en\">ValueDecoder</span>&lt;T&gt; {\n  <span class=\"pl-k\">@Nullable</span> <span class=\"pl-smi\">T</span> <span class=\"pl-en\">decode</span>(<span class=\"pl-smi\">ValueDecoderContext</span> <span class=\"pl-v\">ctx</span>);\n}</pre></div>\n<p dir=\"auto\">wdyt?</p>", "author": "vkryachko", "createdAt": "2020-07-30T18:11:27Z", "path": "encoders/firebase-decoders-json/src/main/java/com/google/firebase/decoders/ValueDecoder.java", "diffHunk": "@@ -0,0 +1,23 @@\n+// Copyright 2020 Google LLC\n+//\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\n+// you may not use this file except in compliance with the License.\n+// You may obtain a copy of the License at\n+//\n+//      http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package com.google.firebase.decoders;\n+\n+/**\n+ * This interface should be implemented by a specific ValueDecoder to provide its decoding logic. A\n+ * {@code ValueDecoder} writes its decoding logic in {@link ValueDecoderContext}.\n+ *\n+ * <p>Use this interface if the object to decode was represented as a single or primitive value.\n+ */\n+public interface ValueDecoder<T> extends Decoder<T, ValueDecoderContext> {}", "originalCommit": "0d017b753fcb26503a1394120c58fd94b27ddb6d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE4NzE2OA==", "url": "https://github.com/firebase/firebase-android-sdk/pull/1835#discussion_r463187168", "bodyText": "Yes, you are right. TypeCreator is an overkill. I will change it,", "author": "James201311", "createdAt": "2020-07-30T18:22:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzE4MTE2NQ=="}], "type": "inlineReview"}, {"oid": "b10f058ec9b0d59f2e6465e375152b0517f76645", "url": "https://github.com/firebase/firebase-android-sdk/commit/b10f058ec9b0d59f2e6465e375152b0517f76645", "message": "address comments", "committedDate": "2020-07-30T19:34:32Z", "type": "commit"}, {"oid": "fc64466b821a7894844ccb6d050e1a5bed91d367", "url": "https://github.com/firebase/firebase-android-sdk/commit/fc64466b821a7894844ccb6d050e1a5bed91d367", "message": "remove Decoder interface", "committedDate": "2020-07-30T20:15:44Z", "type": "commit"}]}