{"pr_number": 1195, "pr_title": "remove extra class", "pr_author": "elharo", "pr_createdAt": "2020-02-07T14:22:10Z", "pr_url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195", "timeline": [{"oid": "eb806e9743bf9d10efcdb768685bebda5040df11", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/eb806e9743bf9d10efcdb768685bebda5040df11", "message": "remove extra class", "committedDate": "2020-02-07T14:21:32Z", "type": "commit"}, {"oid": "0bcc3b93b3a4fa905e604f9492e53df4f10f1a19", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/0bcc3b93b3a4fa905e604f9492e53df4f10f1a19", "message": "remove extra class", "committedDate": "2020-02-07T14:30:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQyMTA4Mw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376421083", "body": "`path` needs to include the unfound artifact; otherwise we cannot tell the scope / optional of the dependency.", "bodyText": "path needs to include the unfound artifact; otherwise we cannot tell the scope / optional of the dependency.", "bodyHTML": "<p dir=\"auto\"><code>path</code> needs to include the unfound artifact; otherwise we cannot tell the scope / optional of the dependency.</p>", "author": "suztomo", "createdAt": "2020-02-07T14:34:20Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/UnresolvableArtifactProblem.java", "diffHunk": "@@ -41,6 +42,18 @@ public UnresolvableArtifactProblem(Artifact artifact) {\n   public UnresolvableArtifactProblem(List<DependencyNode> dependencyPath) {\n     super(dependencyPath.get(dependencyPath.size() - 1).getArtifact(), dependencyPath);\n   }\n+  \n+  /**\n+   * Problem when Maven cannot resolve the artifact at the leaf of {@code dependencyPath} in a\n+   * dependency tree.\n+   * \n+   * @param artifact dependency that can't be found\n+   * @param path to the unfound artifact, not including the unfound artifact", "originalCommit": "0bcc3b93b3a4fa905e604f9492e53df4f10f1a19", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ1MDYwNQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376450605", "bodyText": "Let me double check, but I think that would be a behavioral change from the current code", "author": "elharo", "createdAt": "2020-02-07T15:27:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQyMTA4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ1NzEyMg==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376457122", "bodyText": "OK, I think you're right though the code is a little hard to follow. The parentNodes stack variable might be poorly named. In any case I can make this doc comment ambiguous enough to cover both cases, and this PR does not change the behavior", "author": "elharo", "createdAt": "2020-02-07T15:38:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQyMTA4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ2NzA2MQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376467061", "bodyText": "The parentNodes do not have the node being checked. ExceptionAndPath was combining them to make the dependency path for UnresolvableArtifactProblem.", "author": "suztomo", "createdAt": "2020-02-07T15:55:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQyMTA4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ4NDE2MQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376484161", "bodyText": "The parentNodes do not have the node being checked.\n\nThis was wrong.", "author": "suztomo", "createdAt": "2020-02-07T16:27:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQyMTA4Mw=="}], "type": "inlineReview"}, {"oid": "52e1eb2f1f3c4d93db438c29357773feabfcdc1f", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/52e1eb2f1f3c4d93db438c29357773feabfcdc1f", "message": "fix javadoc", "committedDate": "2020-02-07T15:37:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ4MjI0MA==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376482240", "body": "Why does this needs to be changed to Collection?\r\n- As we care about the order of the dependency path, List is appropriate.\r\n- I see Stack implements List interface. https://docs.oracle.com/javase/8/docs/api/java/util/Stack.html.", "bodyText": "Why does this needs to be changed to Collection?\n\nAs we care about the order of the dependency path, List is appropriate.\nI see Stack implements List interface. https://docs.oracle.com/javase/8/docs/api/java/util/Stack.html.", "bodyHTML": "<p dir=\"auto\">Why does this needs to be changed to Collection?</p>\n<ul dir=\"auto\">\n<li>As we care about the order of the dependency path, List is appropriate.</li>\n<li>I see Stack implements List interface. <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Stack.html\" rel=\"nofollow\">https://docs.oracle.com/javase/8/docs/api/java/util/Stack.html</a>.</li>\n</ul>", "author": "suztomo", "createdAt": "2020-02-07T16:24:03Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/ArtifactProblem.java", "diffHunk": "@@ -35,7 +35,7 @@\n \n   protected final ImmutableList<DependencyNode> dependencyPath;\n \n-  protected ArtifactProblem(Artifact artifact, List<DependencyNode> dependencyPath) {\n+  protected ArtifactProblem(Artifact artifact, Collection<DependencyNode> dependencyPath) {", "originalCommit": "52e1eb2f1f3c4d93db438c29357773feabfcdc1f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ5MzE0Mw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376493143", "bodyText": "OK, fixed, though stacks being a subclass of List is a long-recognized problem in the Java Collections API since it violates the ADT for stack.", "author": "elharo", "createdAt": "2020-02-07T16:45:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ4MjI0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ4Mzk3OQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376483979", "body": "Memo: The parentNodes.push(dependencyNode) happens at line 327 (before this line). Therefore, the code should behave the same as the previous one.\r\n\r\nShall we rename the variable at the line 327?", "bodyText": "Memo: The parentNodes.push(dependencyNode) happens at line 327 (before this line). Therefore, the code should behave the same as the previous one.\nShall we rename the variable at the line 327?", "bodyHTML": "<p dir=\"auto\">Memo: The parentNodes.push(dependencyNode) happens at line 327 (before this line). Therefore, the code should behave the same as the previous one.</p>\n<p dir=\"auto\">Shall we rename the variable at the line 327?</p>", "author": "suztomo", "createdAt": "2020-02-07T16:27:26Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java", "diffHunk": "@@ -340,16 +340,15 @@ private DependencyGraphResult levelOrder(\n                 resolutionException.getResult().getArtifactResults()) {\n               if (artifactResult.getArtifact() == null) {\n                 DependencyNode failedDependencyNode = artifactResult.getRequest().getDependencyNode();\n-                ExceptionAndPath failure =\n-                    ExceptionAndPath.create(parentNodes, failedDependencyNode, resolutionException);\n-                artifactProblems.add(new UnresolvableArtifactProblem(failure.getPath()));\n+                artifactProblems.add(\n+                    new UnresolvableArtifactProblem(failedDependencyNode.getArtifact(), parentNodes));", "originalCommit": "52e1eb2f1f3c4d93db438c29357773feabfcdc1f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ5MzI4Nw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376493287", "bodyText": "next PR", "author": "elharo", "createdAt": "2020-02-07T16:45:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ4Mzk3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ4NTA5OQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376485099", "body": "```suggestion\r\n   * @param path path to the unavailable artifact\r\n```\r\n", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * @param path to the unfound artifact\n          \n          \n            \n               * @param path path to the unavailable artifact", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">   <span class=\"pl-k\">*</span> <span class=\"pl-k\">@param</span> path to the <span class=\"x x-first x-last\">unfound</span> artifact</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">   <span class=\"pl-k\">*</span> <span class=\"pl-k\">@param</span> path <span class=\"x x-first x-last\">path </span>to the <span class=\"x x-first x-last\">unavailable</span> artifact</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "suztomo", "createdAt": "2020-02-07T16:29:22Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/UnresolvableArtifactProblem.java", "diffHunk": "@@ -41,6 +42,18 @@ public UnresolvableArtifactProblem(Artifact artifact) {\n   public UnresolvableArtifactProblem(List<DependencyNode> dependencyPath) {\n     super(dependencyPath.get(dependencyPath.size() - 1).getArtifact(), dependencyPath);\n   }\n+  \n+  /**\n+   * Problem when Maven cannot resolve the artifact at the leaf of {@code dependencyPath} in a\n+   * dependency tree.\n+   * \n+   * @param artifact dependency that can't be found\n+   * @param path to the unfound artifact", "originalCommit": "52e1eb2f1f3c4d93db438c29357773feabfcdc1f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ4NTc4OQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376485789", "bodyText": "Because the artifact is held by the last element of path, you don't need the constructor.", "author": "suztomo", "createdAt": "2020-02-07T16:30:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ4NTA5OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ4NjA2Ng==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376486066", "body": "Because the `artifact` is held by the last element of path, you don't need the constructor.", "bodyText": "Because the artifact is held by the last element of path, you don't need the constructor.", "bodyHTML": "<p dir=\"auto\">Because the <code>artifact</code> is held by the last element of path, you don't need the constructor.</p>", "author": "suztomo", "createdAt": "2020-02-07T16:31:12Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/UnresolvableArtifactProblem.java", "diffHunk": "@@ -41,6 +42,18 @@ public UnresolvableArtifactProblem(Artifact artifact) {\n   public UnresolvableArtifactProblem(List<DependencyNode> dependencyPath) {\n     super(dependencyPath.get(dependencyPath.size() - 1).getArtifact(), dependencyPath);\n   }\n+  \n+  /**\n+   * Problem when Maven cannot resolve the artifact at the leaf of {@code dependencyPath} in a\n+   * dependency tree.\n+   * \n+   * @param artifact dependency that can't be found\n+   * @param path to the unfound artifact\n+   */\n+  public UnresolvableArtifactProblem(Artifact artifact, Collection<DependencyNode> path) {", "originalCommit": "52e1eb2f1f3c4d93db438c29357773feabfcdc1f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ5NDM1NQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376494355", "bodyText": "done", "author": "elharo", "createdAt": "2020-02-07T16:47:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjQ4NjA2Ng=="}], "type": "inlineReview"}, {"oid": "1123b3d99b35f81099552245be6542387595d094", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/1123b3d99b35f81099552245be6542387595d094", "message": "code review", "committedDate": "2020-02-07T16:47:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjUwNzg4OQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376507889", "body": "Incorrect param name.", "bodyText": "Incorrect param name.", "bodyHTML": "<p dir=\"auto\">Incorrect param name.</p>", "author": "suztomo", "createdAt": "2020-02-07T17:15:51Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/UnresolvableArtifactProblem.java", "diffHunk": "@@ -37,6 +37,8 @@ public UnresolvableArtifactProblem(Artifact artifact) {\n   /**\n    * Problem when Maven cannot resolve the artifact at the leaf of {@code dependencyPath} in a\n    * dependency tree.\n+   * \n+   * @param path to the unavailable artifact\n    */", "originalCommit": "1123b3d99b35f81099552245be6542387595d094", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "c74a58c177026002f9d5170c1e6e9a0c05d33b30", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/c74a58c177026002f9d5170c1e6e9a0c05d33b30", "message": "rollbacl last commit which did not preserve behavior", "committedDate": "2020-02-07T17:35:37Z", "type": "commit"}, {"oid": "1e3fbfc2a76fd5a9d898cdb34bcfce313909f971", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/1e3fbfc2a76fd5a9d898cdb34bcfce313909f971", "message": "Merge branch 'exp' of github.com:GoogleCloudPlatform/cloud-opensource-java into exp", "committedDate": "2020-02-07T17:36:30Z", "type": "commit"}, {"oid": "9b44432e3cf803b14ecc177f49df858cdaaa7e01", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/9b44432e3cf803b14ecc177f49df858cdaaa7e01", "message": "Merge branch 'master' into exp", "committedDate": "2020-02-07T18:37:22Z", "type": "commit"}, {"oid": "a146640fa203a89cf68c8fbc227b7ea5c6db6028", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/a146640fa203a89cf68c8fbc227b7ea5c6db6028", "message": "fix test", "committedDate": "2020-02-07T18:52:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjU1NDE1OQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376554159", "body": "Memo:\r\n\r\nThis fails:\r\n\r\n![image](https://user-images.githubusercontent.com/28604/74057557-2f03b580-49b2-11ea-9526-b521b703b93c.png)\r\n\r\n", "bodyText": "Memo:\nThis fails:", "bodyHTML": "<p dir=\"auto\">Memo:</p>\n<p dir=\"auto\">This fails:</p>\n<p dir=\"auto\"><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/28604/74057557-2f03b580-49b2-11ea-9526-b521b703b93c.png\"><img src=\"https://user-images.githubusercontent.com/28604/74057557-2f03b580-49b2-11ea-9526-b521b703b93c.png\" alt=\"image\" style=\"max-width: 100%;\"></a></p>", "author": "suztomo", "createdAt": "2020-02-07T19:00:26Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java", "diffHunk": "@@ -339,8 +339,11 @@ private DependencyGraphResult levelOrder(\n             for (ArtifactResult artifactResult :\n                 resolutionException.getResult().getArtifactResults()) {\n               if (artifactResult.getArtifact() == null) {\n-                artifactProblems.add(new UnresolvableArtifactProblem(parentNodes));", "originalCommit": "a146640fa203a89cf68c8fbc227b7ea5c6db6028", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjU1OTkyOQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376559929", "body": "```\r\nparentDependencyNodes:\r\n  org.sonatype.sisu:sisu-guice:3.2.6 (compile)\r\n   / cglib:cglib:3.1 (provided, optional)\r\n   / ant:ant:1.6.2 (compile, optional)\r\n\r\ndependencyNode: xerces:xerces-impl:jar:2.6.2 (compile?)\r\n```\r\ncreating \r\n```\r\nparentDependencyNodes:\r\n  org.sonatype.sisu:sisu-guice:3.2.6 (compile)\r\n   / cglib:cglib:3.1 (provided, optional)\r\n   / ant:ant:1.6.2 (compile, optional) \r\n   / dependencyNode: xerces:xerces-impl:jar:2.6.2 (compile?)\r\n```\r\n\r\n\r\n", "bodyText": "parentDependencyNodes:\n  org.sonatype.sisu:sisu-guice:3.2.6 (compile)\n   / cglib:cglib:3.1 (provided, optional)\n   / ant:ant:1.6.2 (compile, optional)\n\ndependencyNode: xerces:xerces-impl:jar:2.6.2 (compile?)\n\ncreating\nparentDependencyNodes:\n  org.sonatype.sisu:sisu-guice:3.2.6 (compile)\n   / cglib:cglib:3.1 (provided, optional)\n   / ant:ant:1.6.2 (compile, optional) \n   / dependencyNode: xerces:xerces-impl:jar:2.6.2 (compile?)", "bodyHTML": "<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"parentDependencyNodes:\n  org.sonatype.sisu:sisu-guice:3.2.6 (compile)\n   / cglib:cglib:3.1 (provided, optional)\n   / ant:ant:1.6.2 (compile, optional)\n\ndependencyNode: xerces:xerces-impl:jar:2.6.2 (compile?)\"><pre><code>parentDependencyNodes:\n  org.sonatype.sisu:sisu-guice:3.2.6 (compile)\n   / cglib:cglib:3.1 (provided, optional)\n   / ant:ant:1.6.2 (compile, optional)\n\ndependencyNode: xerces:xerces-impl:jar:2.6.2 (compile?)\n</code></pre></div>\n<p dir=\"auto\">creating</p>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"parentDependencyNodes:\n  org.sonatype.sisu:sisu-guice:3.2.6 (compile)\n   / cglib:cglib:3.1 (provided, optional)\n   / ant:ant:1.6.2 (compile, optional) \n   / dependencyNode: xerces:xerces-impl:jar:2.6.2 (compile?)\"><pre><code>parentDependencyNodes:\n  org.sonatype.sisu:sisu-guice:3.2.6 (compile)\n   / cglib:cglib:3.1 (provided, optional)\n   / ant:ant:1.6.2 (compile, optional) \n   / dependencyNode: xerces:xerces-impl:jar:2.6.2 (compile?)\n</code></pre></div>", "author": "suztomo", "createdAt": "2020-02-07T19:13:29Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/ExceptionAndPath.java", "diffHunk": "@@ -1,67 +0,0 @@\n-/*\n- * Copyright 2019 Google LLC.\n- *\n- * Licensed under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- *     http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- */\n-\n-package com.google.cloud.tools.opensource.dependencies;\n-\n-import static com.google.common.base.Preconditions.checkNotNull;\n-\n-import com.google.common.annotations.VisibleForTesting;\n-import com.google.common.collect.ImmutableList;\n-import org.eclipse.aether.RepositoryException;\n-import org.eclipse.aether.graph.DependencyNode;\n-\n-/**\n- * Tuple of a path in a Maven dependency graph and a {@link RepositoryException}, indicating that\n- * the {@link DependencyNode} specified at the path raises the exception.\n- */\n-public final class ExceptionAndPath {\n-\n-  private final ImmutableList<DependencyNode> path;\n-\n-  private final RepositoryException exception;\n-\n-  /** Returns a path from the root of dependency graph to a dependency node. */\n-  public ImmutableList<DependencyNode> getPath() {\n-    return path;\n-  }\n-\n-  /** Returns the exception raised at the {@link DependencyNode} specified at the path. */\n-  RepositoryException getException() {\n-    return exception;\n-  }\n-\n-  @VisibleForTesting\n-  ExceptionAndPath(ImmutableList<DependencyNode> path, RepositoryException exception) {\n-    this.path = checkNotNull(path);\n-    this.exception = checkNotNull(exception);\n-  }\n-\n-  static ExceptionAndPath create(\n-      Iterable<DependencyNode> parentDependencyNodes,\n-      DependencyNode dependencyNode,\n-      RepositoryException repositoryException) {\n-    return new ExceptionAndPath(\n-        ImmutableList.<DependencyNode>builder()\n-            .addAll(parentDependencyNodes)\n-            .add(dependencyNode)", "originalCommit": "a146640fa203a89cf68c8fbc227b7ea5c6db6028", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjU2NDA5OQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376564099", "body": "```suggestion\r\n                        ImmutableList.builder().addAll(parentNodes).add(failedDependencyNode).build()));\r\n```\r\n\r\nIn `ClassPathBuilderTest.testResolve_artifactProblems` failure, the last element of parentNodes does not match `failedDependencyNode.getArtifact()`, because \"ant:1.6.2\" is not the missing artifact.\r\n\r\n![image](https://user-images.githubusercontent.com/28604/74058917-03ce9580-49b5-11ea-80d4-95339962b6a7.png)\r\n\r\n", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    failedDependencyNode.getArtifact(), parentNodes));\n          \n          \n            \n                                    ImmutableList.builder().addAll(parentNodes).add(failedDependencyNode).build()));\n          \n      \n    \n    \n  \n\nIn ClassPathBuilderTest.testResolve_artifactProblems failure, the last element of parentNodes does not match failedDependencyNode.getArtifact(), because \"ant:1.6.2\" is not the missing artifact.", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                        <span class=\"x x-first\">failedDependencyNode</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">getArtifact(), </span>parentNodes));</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                        <span class=\"pl-smi x x-first\">ImmutableList</span><span class=\"pl-k x\">.</span><span class=\"x\">builder()</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">addAll(</span>parentNodes<span class=\"x x-first\">)</span><span class=\"pl-k x\">.</span><span class=\"x\">add(failedDependencyNode)</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">build()</span>));</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n\n<p dir=\"auto\">In <code>ClassPathBuilderTest.testResolve_artifactProblems</code> failure, the last element of parentNodes does not match <code>failedDependencyNode.getArtifact()</code>, because \"ant:1.6.2\" is not the missing artifact.</p>\n<p dir=\"auto\"><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/28604/74058917-03ce9580-49b5-11ea-80d4-95339962b6a7.png\"><img src=\"https://user-images.githubusercontent.com/28604/74058917-03ce9580-49b5-11ea-80d4-95339962b6a7.png\" alt=\"image\" style=\"max-width: 100%;\"></a></p>", "author": "suztomo", "createdAt": "2020-02-07T19:22:47Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java", "diffHunk": "@@ -339,17 +339,15 @@ private DependencyGraphResult levelOrder(\n             for (ArtifactResult artifactResult :\n                 resolutionException.getResult().getArtifactResults()) {\n               if (artifactResult.getArtifact() == null) {\n-                DependencyNode failedDependencyNode = artifactResult.getRequest().getDependencyNode();\n-                ExceptionAndPath failure =\n-                    ExceptionAndPath.create(parentNodes, failedDependencyNode, resolutionException);\n-                artifactProblems.add(new UnresolvableArtifactProblem(failure.getPath()));\n+                DependencyNode failedDependencyNode =\n+                    artifactResult.getRequest().getDependencyNode();\n+                artifactProblems.add(\n+                    new UnresolvableArtifactProblem(\n+                        failedDependencyNode.getArtifact(), parentNodes));", "originalCommit": "a146640fa203a89cf68c8fbc227b7ea5c6db6028", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a896605ece1d21c30e39932e0723edcedbaec14a", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/a896605ece1d21c30e39932e0723edcedbaec14a", "message": "fix javadoc", "committedDate": "2020-02-07T19:40:42Z", "type": "commit"}, {"oid": "377b8e8d8be33c96539e8e2a36183392ac604f46", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/377b8e8d8be33c96539e8e2a36183392ac604f46", "message": "fix javadoc", "committedDate": "2020-02-07T20:09:44Z", "type": "commit"}, {"oid": "973acfb6f3c8243fd69785d81127c9a705b6b838", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/973acfb6f3c8243fd69785d81127c9a705b6b838", "message": "Merge branch 'master' into exp", "committedDate": "2020-02-07T21:22:51Z", "type": "commit"}, {"oid": "690fb66060a5559e66b6fa867059e71e64d27d02", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/690fb66060a5559e66b6fa867059e71e64d27d02", "message": "merge master", "committedDate": "2020-02-07T21:36:26Z", "type": "commit"}, {"oid": "c7e0ff27cbe1101ae4be772bdd410fd2fa327840", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/c7e0ff27cbe1101ae4be772bdd410fd2fa327840", "message": "append failed node to path", "committedDate": "2020-02-07T21:50:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY0MjE5Mg==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376642192", "body": "```suggestion\r\n                    new UnresolvableArtifactProblem(fullPath)\r\n```\r\n\r\nThen the new constructor is not needed.", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                new UnresolvableArtifactProblem(\n          \n          \n            \n                                new UnresolvableArtifactProblem(fullPath)\n          \n      \n    \n    \n  \n\nThen the new constructor is not needed.", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    <span class=\"pl-k\">new</span> <span class=\"pl-smi\">UnresolvableArtifactProblem</span>(</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    <span class=\"pl-k\">new</span> <span class=\"pl-smi\">UnresolvableArtifactProblem</span>(<span class=\"x x-first x-last\">fullPath)</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n\n<p dir=\"auto\">Then the new constructor is not needed.</p>", "author": "suztomo", "createdAt": "2020-02-07T22:44:31Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java", "diffHunk": "@@ -339,20 +339,22 @@ private DependencyGraphResult levelOrder(\n             for (ArtifactResult artifactResult :\n                 resolutionException.getResult().getArtifactResults()) {\n               if (artifactResult.getArtifact() == null) {\n-                DependencyNode failedDependencyNode = artifactResult.getRequest().getDependencyNode();\n-                ExceptionAndPath failure =\n-                    ExceptionAndPath.create(parentNodes, failedDependencyNode, resolutionException);\n-                artifactProblems.add(new UnresolvableArtifactProblem(failure.getPath()));\n+                DependencyNode failedDependencyNode =\n+                    artifactResult.getRequest().getDependencyNode();\n+                \n+                List<DependencyNode> fullPath = makeFullPath(parentNodes, failedDependencyNode);\n+                \n+                artifactProblems.add(\n+                    new UnresolvableArtifactProblem(", "originalCommit": "c7e0ff27cbe1101ae4be772bdd410fd2fa327840", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY1NDc0MQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376654741", "bodyText": "removed", "author": "elharo", "createdAt": "2020-02-07T23:29:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY0MjE5Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY0MjU4MQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376642581", "body": "Why is it being removed?", "bodyText": "Why is it being removed?", "bodyHTML": "<p dir=\"auto\">Why is it being removed?</p>", "author": "suztomo", "createdAt": "2020-02-07T22:45:44Z", "path": "dependencies/src/test/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilderTest.java", "diffHunk": "@@ -201,8 +201,6 @@ public void testGetStaticLinkageCheckDependencyGraph_artifactProblems()\n     assertEquals(\"xerces:xerces-impl:jar:2.6.2\", firstProblem.getArtifact().toString());\n \n     assertEquals(\n-        \"The problem should explain the dependency path to the unavailable artifact, \"\n-            + \"including scope and optional flag\",", "originalCommit": "c7e0ff27cbe1101ae4be772bdd410fd2fa327840", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY1NTI0Mw==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376655243", "bodyText": "This feels like more a comment about what the method does rather than why the test failed. When I ran the test this message pushed the actual diff out of the way.", "author": "elharo", "createdAt": "2020-02-07T23:31:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY0MjU4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY4MzkzOA==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376683938", "bodyText": "That's true. This should be a source code comment in which I wanted to clarify the reason of this assertion.", "author": "suztomo", "createdAt": "2020-02-08T03:36:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY0MjU4MQ=="}], "type": "inlineReview"}, {"oid": "929e3753eef1351559cc72a92622874d8f23f69f", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/929e3753eef1351559cc72a92622874d8f23f69f", "message": "remove constructor", "committedDate": "2020-02-07T23:31:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY4MzcyNQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376683725", "body": "```suggestion\r\n                        fullPath));\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                    failedDependencyNode.getArtifact(), fullPath));\n          \n          \n            \n                                    fullPath));", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                        <span class=\"x x-first\">failedDependencyNode</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">getArtifact(), </span>fullPath));</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                        fullPath));</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "suztomo", "createdAt": "2020-02-08T03:32:31Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/DependencyGraphBuilder.java", "diffHunk": "@@ -339,20 +339,22 @@ private DependencyGraphResult levelOrder(\n             for (ArtifactResult artifactResult :\n                 resolutionException.getResult().getArtifactResults()) {\n               if (artifactResult.getArtifact() == null) {\n-                DependencyNode failedDependencyNode = artifactResult.getRequest().getDependencyNode();\n-                ExceptionAndPath failure =\n-                    ExceptionAndPath.create(parentNodes, failedDependencyNode, resolutionException);\n-                artifactProblems.add(new UnresolvableArtifactProblem(failure.getPath()));\n+                DependencyNode failedDependencyNode =\n+                    artifactResult.getRequest().getDependencyNode();\n+                \n+                List<DependencyNode> fullPath = makeFullPath(parentNodes, failedDependencyNode);\n+                \n+                artifactProblems.add(\n+                    new UnresolvableArtifactProblem(\n+                        failedDependencyNode.getArtifact(), fullPath));", "originalCommit": "929e3753eef1351559cc72a92622874d8f23f69f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcwNjQ2Ng==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376706466", "bodyText": "done", "author": "elharo", "createdAt": "2020-02-08T12:08:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY4MzcyNQ=="}], "type": "inlineReview"}, {"oid": "5d956c6c59b8bca45f72c919f819cdb889656a11", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/5d956c6c59b8bca45f72c919f819cdb889656a11", "message": "remove constructor", "committedDate": "2020-02-08T12:07:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcxMjExMQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1195#discussion_r376712111", "body": "This non-public constructor allows artifact problems in which we don\u2019t know dependencyPath.", "bodyText": "This non-public constructor allows artifact problems in which we don\u2019t know dependencyPath.", "bodyHTML": "<p dir=\"auto\">This non-public constructor allows artifact problems in which we don\u2019t know dependencyPath.</p>", "author": "suztomo", "createdAt": "2020-02-08T14:09:33Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/dependencies/ArtifactProblem.java", "diffHunk": "@@ -35,6 +35,8 @@\n \n   protected final ImmutableList<DependencyNode> dependencyPath;\n \n+  // todo since the artifact is the last element in the list, there's really no\n+  // reason to pass the artifact here. \n   protected ArtifactProblem(Artifact artifact, List<DependencyNode> dependencyPath) {", "originalCommit": "5d956c6c59b8bca45f72c919f819cdb889656a11", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}