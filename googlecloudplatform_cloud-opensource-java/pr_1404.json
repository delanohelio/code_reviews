{"pr_number": 1404, "pr_title": "clarify distinction between file names and class names", "pr_author": "elharo", "pr_createdAt": "2020-05-14T16:06:34Z", "pr_url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1404", "timeline": [{"oid": "d029fa87100046e388f888b8ac8413d96ea320d6", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/d029fa87100046e388f888b8ac8413d96ea320d6", "message": "clarify comment", "committedDate": "2020-05-14T16:05:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2ODUzMQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1404#discussion_r425268531", "body": "This locates a class file in a class path. Not in a class path entry. This FixedSizeClassPathRepository operates on a class path.\r\n\r\nDo you see this description is inaccurate?\r\n", "bodyText": "This locates a class file in a class path. Not in a class path entry. This FixedSizeClassPathRepository operates on a class path.\nDo you see this description is inaccurate?", "bodyHTML": "<p dir=\"auto\">This locates a class file in a class path. Not in a class path entry. This FixedSizeClassPathRepository operates on a class path.</p>\n<p dir=\"auto\">Do you see this description is inaccurate?</p>", "author": "suztomo", "createdAt": "2020-05-14T16:24:51Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/FixedSizeClassPathRepository.java", "diffHunk": "@@ -52,14 +52,15 @@\n    *\r\n    * <p>While class name and class file name are the same in most cases, sometimes classes are not\r\n    * placed in the root of a JAR file to support a framework-specific JAR structure. For example,\r\n-   * Spring Boot Gradle Java plugin places class files under \"BOOT-INF/classes\". To load such\r\n+   * the Spring Boot Gradle Java plugin places class files under \"BOOT-INF/classes\". To load such\r\n    * classes by class name, this mapping keeps track of the special location once they are loaded.\r\n    *\r\n    * <ul>\r\n    *   <li>Key: class name (value from {@link JavaClass#getClassName()}) which has a special class\r\n    *       file name different from its class name. Example: {@code com.google.Foo}\r\n    *   <li>Value: the special class file name as in {@link JavaClass#getFileName()}, a path that\r\n-   *       locates a class file in a class path. Example: {@code BOOT-INF.classes.com.google.Foo}\r\n+   *       locates a class file in a class path entry.\r", "originalCommit": "d029fa87100046e388f888b8ac8413d96ea320d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3NjEzMA==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1404#discussion_r425276130", "bodyText": "A class file name such as BOOT-INF.classes.com.google.Foo does not tell us which jar the file is in. It only tells us where in this jar the file will be. Or am I misunderstanding the special class file name?", "author": "elharo", "createdAt": "2020-05-14T16:35:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2ODUzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMwOTY3Mg==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1404#discussion_r425309672", "bodyText": "A class file name such as BOOT-INF.classes.com.google.Foo does not tell us which jar the file is in\n\nCorrect. No specific JAR file. That's why this is a path to locate a class file in a class path, not a JAR file.", "author": "suztomo", "createdAt": "2020-05-14T17:27:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2ODUzMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTMxNTE0MQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1404#discussion_r425315141", "bodyText": "I think I see where you're coming from, but I don't think as written this is correct. For instance, there can be multiple files with the same name in the class path. There can be only one of these in a class path entry. Perhaps we need to get rid of the notion of this as \"locating\" something. That's not what it does.", "author": "elharo", "createdAt": "2020-05-14T17:36:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2ODUzMQ=="}], "type": "inlineReview"}, {"oid": "2ca383a3b058fc9b11be80546dcaf571a053729f", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/commit/2ca383a3b058fc9b11be80546dcaf571a053729f", "message": "distinguish file names", "committedDate": "2020-05-14T18:32:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM1ODMzOQ==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1404#discussion_r425358339", "body": "This is nice. Placing getOrDefault here is simplifying other places.", "bodyText": "This is nice. Placing getOrDefault here is simplifying other places.", "bodyHTML": "<p dir=\"auto\">This is nice. Placing getOrDefault here is simplifying other places.</p>", "author": "suztomo", "createdAt": "2020-05-14T18:49:26Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/FixedSizeClassPathRepository.java", "diffHunk": "@@ -114,11 +119,9 @@ public void clear() {\n   }\r\n \r\n   /**\r\n-   * Returns the special location for {@code className}. Null if no special location is known.\r\n-   *\r\n-   * @see #classFileNames\r\n+   * Returns the file name for the class.\r\n    */\r\n-  String getSpecialLocation(String className) {\r\n-    return classFileNames.get(className);\r\n+  String getFileName(String className) {\r\n+    return classFileNames.getOrDefault(className, className);\r", "originalCommit": "2ca383a3b058fc9b11be80546dcaf571a053729f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM4MTUzNg==", "url": "https://github.com/GoogleCloudPlatform/cloud-opensource-java/pull/1404#discussion_r425381536", "body": "```suggestion\r\n   * <p>A few tools relocate classes into different directories within the JAR and use a special\r\n```\r\n\r\nI like the clear explanation of the difference.", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * A few tools relocate classes into different directories within the JAR and use a special\n          \n          \n            \n               * <p>A few tools relocate classes into different directories within the JAR and use a special\n          \n      \n    \n    \n  \n\nI like the clear explanation of the difference.", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"57\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">   <span class=\"pl-k\">*</span> <span class=\"pl-smi\">A</span> few tools relocate classes into different directories within the <span class=\"pl-c1\">JAR</span> and use a special</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"57\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">   <span class=\"pl-k\">*</span> <span class=\"pl-k x x-first\">&lt;</span><span class=\"x\">p</span><span class=\"pl-k x x-last\">&gt;</span><span class=\"pl-smi\">A</span> few tools relocate classes into different directories within the <span class=\"pl-c1\">JAR</span> and use a special</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n\n<p dir=\"auto\">I like the clear explanation of the difference.</p>", "author": "suztomo", "createdAt": "2020-05-14T19:33:02Z", "path": "dependencies/src/main/java/com/google/cloud/tools/opensource/classpath/FixedSizeClassPathRepository.java", "diffHunk": "@@ -48,18 +48,23 @@\n   private final Cache<String, JavaClass> loadedClass;\r\n \r\n   /**\r\n-   * Mapping from class names to special class file locations.\r\n+   * Mapping from class names to file names.\r\n    *\r\n-   * <p>While class name and class file name are the same in most cases, sometimes classes are not\r\n-   * placed in the root of a JAR file to support a framework-specific JAR structure. For example,\r\n-   * Spring Boot Gradle Java plugin places class files under \"BOOT-INF/classes\". To load such\r\n-   * classes by class name, this mapping keeps track of the special location once they are loaded.\r\n+   * <p>Class names are the fully package qualified names found in Java source code such as\r\n+   * {@code com.google.Foo}. The byte code of this class is normally found in a JAR at the path\r\n+   * com/google/Foo.class. In this case {@code com.google.Foo} is also the file name.\r\n+   * \r\n+   * A few tools relocate classes into different directories within the JAR and use a special\r", "originalCommit": "2ca383a3b058fc9b11be80546dcaf571a053729f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}