{"pr_number": 256, "pr_title": "Support for non-api mediaccc links, invidious shortened links, refactor mediaccc tests ", "pr_author": "B0pol", "pr_createdAt": "2020-02-12T18:09:14Z", "pr_url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/256", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQzNzY5Mw==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/256#discussion_r378437693", "body": "It looks like you want to check if the path starts with `b/`. if this is the case use\r\n```suggestion\r\n        if (path.startsWith(\"b/\")) {\r\n```\r\nfor better performance. In which case can an url path start with `b/`? Do we need to check the host here or do we have only urls like `/b/myConferenceId`?", "bodyText": "It looks like you want to check if the path starts with b/. if this is the case use\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (path.contains(\"b/\")) {\n          \n          \n            \n                    if (path.startsWith(\"b/\")) {\n          \n      \n    \n    \n  \n\nfor better performance. In which case can an url path start with b/? Do we need to check the host here or do we have only urls like /b/myConferenceId?", "bodyHTML": "<p dir=\"auto\">It looks like you want to check if the path starts with <code>b/</code>. if this is the case use</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span> (path<span class=\"pl-k\">.</span><span class=\"x x-first x-last\">contains</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>b/<span class=\"pl-pds\">\"</span></span>)) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span> (path<span class=\"pl-k\">.</span><span class=\"x x-first x-last\">startsWith</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>b/<span class=\"pl-pds\">\"</span></span>)) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n\n<p dir=\"auto\">for better performance. In which case can an url path start with <code>b/</code>? Do we need to check the host here or do we have only urls like <code>/b/myConferenceId</code>?</p>", "author": "TobiGr", "createdAt": "2020-02-12T18:37:02Z", "path": "extractor/src/main/java/org/schabi/newpipe/extractor/services/media_ccc/linkHandler/MediaCCCConferenceLinkHandlerFactory.java", "diffHunk": "@@ -14,19 +18,43 @@ public String getUrl(String id, List<String> contentFilter, String sortFilter) t\n     }\n \n     @Override\n-    public String getId(String url) throws ParsingException {\n-        if(url.startsWith(\"https://api.media.ccc.de/public/conferences/\")) {\n-            return url.replace(\"https://api.media.ccc.de/public/conferences/\", \"\");\n-        } else if(url.startsWith(\"https://media.ccc.de/c/\")) {\n-            return Parser.matchGroup1(\"https://media.ccc.de/c/([^?#]*)\", url);\n-        } else {\n-            throw new ParsingException(\"Could not get id from url: \" + url);\n+    public String getId(String urlString) throws ParsingException {\n+        if (urlString.startsWith(\"https://api.media.ccc.de/public/conferences/\")) {\n+            return urlString.replace(\"https://api.media.ccc.de/public/conferences/\", \"\");\n+        } else if (urlString.startsWith(\"https://media.ccc.de/c/\")) {\n+            return Parser.matchGroup1(\"https://media.ccc.de/c/([^?#]*)\", urlString);\n         }\n+\n+        URL url;\n+        try {\n+            url = Utils.stringToURL(urlString);\n+        } catch (MalformedURLException e) {\n+            throw new IllegalArgumentException(\"The given URL is not valid\");\n+        }\n+\n+        String path = url.getPath();\n+        // remove leading \"/\" of URL-path if URL-path is given\n+        if (!path.isEmpty()) {\n+            path = path.substring(1);\n+        }\n+\n+        if (path.contains(\"b/\")) {", "originalCommit": "ff90d2233fc6e6422359276a28acb8fa3b88c07d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQ1MTIzMw==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/256#discussion_r378451233", "bodyText": "Instead of this, just do urlString.startsWith(\"https://media.ccc.de/b/\") (and preferably change the name of the urlString variable back to just url)", "author": "wb9688", "createdAt": "2020-02-12T19:02:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQzNzY5Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQ5MjE4MA==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/256#discussion_r378492180", "bodyText": "Yes it's conferences @TobiGr\nI changed back to how it was and added an else if", "author": "B0pol", "createdAt": "2020-02-12T20:22:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQzNzY5Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQ0MzQyNQ==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/256#discussion_r378443425", "body": "```suggestion\r\n        if (path.startsWith(\"v/\")) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if (path.contains(\"v/\")) {\n          \n          \n            \n                    if (path.startsWith(\"v/\")) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span> (path<span class=\"pl-k\">.</span><span class=\"x x-first x-last\">contains</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>v/<span class=\"pl-pds\">\"</span></span>)) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span> (path<span class=\"pl-k\">.</span><span class=\"x x-first x-last\">startsWith</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>v/<span class=\"pl-pds\">\"</span></span>)) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "TobiGr", "createdAt": "2020-02-12T18:48:14Z", "path": "extractor/src/main/java/org/schabi/newpipe/extractor/services/media_ccc/linkHandler/MediaCCCStreamLinkHandlerFactory.java", "diffHunk": "@@ -1,16 +1,39 @@\n package org.schabi.newpipe.extractor.services.media_ccc.linkHandler;\n \n+import org.schabi.newpipe.extractor.exceptions.FoundAdException;\n import org.schabi.newpipe.extractor.exceptions.ParsingException;\n import org.schabi.newpipe.extractor.linkhandler.LinkHandlerFactory;\n+import org.schabi.newpipe.extractor.utils.Utils;\n+\n+import java.net.MalformedURLException;\n+import java.net.URL;\n \n public class MediaCCCStreamLinkHandlerFactory extends LinkHandlerFactory {\n \n     @Override\n-    public String getId(String url) throws ParsingException {\n-        if(url.startsWith(\"https://api.media.ccc.de/public/events/\") &&\n-            !url.contains(\"?q=\")) {\n-            return url.replace(\"https://api.media.ccc.de/public/events/\", \"\");\n+    public String getId(String urlString) throws ParsingException {\n+        if (urlString.startsWith(\"https://api.media.ccc.de/public/events/\") &&\n+                !urlString.contains(\"?q=\")) {\n+            return urlString.replace(\"https://api.media.ccc.de/public/events/\", \"\");\n+        }\n+        \n+        URL url;\n+        try {\n+            url = Utils.stringToURL(urlString);\n+        } catch (MalformedURLException e) {\n+            throw new IllegalArgumentException(\"The given URL is not valid\");\n+        }\n+\n+        String path = url.getPath();\n+        // remove leading \"/\" of URL-path if URL-path is given\n+        if (!path.isEmpty()) {\n+            path = path.substring(1);\n         }\n+\n+        if (path.contains(\"v/\")) {", "originalCommit": "ff90d2233fc6e6422359276a28acb8fa3b88c07d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQ1MTY0MQ==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/256#discussion_r378451641", "body": "Why are you catching that FoundAdException? `getId` doesn't even throw that.", "bodyText": "Why are you catching that FoundAdException? getId doesn't even throw that.", "bodyHTML": "<p dir=\"auto\">Why are you catching that FoundAdException? <code>getId</code> doesn't even throw that.</p>", "author": "wb9688", "createdAt": "2020-02-12T19:03:19Z", "path": "extractor/src/main/java/org/schabi/newpipe/extractor/services/media_ccc/linkHandler/MediaCCCConferenceLinkHandlerFactory.java", "diffHunk": "@@ -14,19 +18,43 @@ public String getUrl(String id, List<String> contentFilter, String sortFilter) t\n     }\n \n     @Override\n-    public String getId(String url) throws ParsingException {\n-        if(url.startsWith(\"https://api.media.ccc.de/public/conferences/\")) {\n-            return url.replace(\"https://api.media.ccc.de/public/conferences/\", \"\");\n-        } else if(url.startsWith(\"https://media.ccc.de/c/\")) {\n-            return Parser.matchGroup1(\"https://media.ccc.de/c/([^?#]*)\", url);\n-        } else {\n-            throw new ParsingException(\"Could not get id from url: \" + url);\n+    public String getId(String urlString) throws ParsingException {\n+        if (urlString.startsWith(\"https://api.media.ccc.de/public/conferences/\")) {\n+            return urlString.replace(\"https://api.media.ccc.de/public/conferences/\", \"\");\n+        } else if (urlString.startsWith(\"https://media.ccc.de/c/\")) {\n+            return Parser.matchGroup1(\"https://media.ccc.de/c/([^?#]*)\", urlString);\n         }\n+\n+        URL url;\n+        try {\n+            url = Utils.stringToURL(urlString);\n+        } catch (MalformedURLException e) {\n+            throw new IllegalArgumentException(\"The given URL is not valid\");\n+        }\n+\n+        String path = url.getPath();\n+        // remove leading \"/\" of URL-path if URL-path is given\n+        if (!path.isEmpty()) {\n+            path = path.substring(1);\n+        }\n+\n+        if (path.contains(\"b/\")) {\n+            return path.substring(2);\n+        }\n+\n+        throw new ParsingException(\"Could not get id from url: \" + url);\n+\n     }\n \n     @Override\n     public boolean onAcceptUrl(String url) throws ParsingException {\n-        return url.startsWith(\"https://api.media.ccc.de/public/conferences/\")\n-                || url.startsWith(\"https://media.ccc.de/c/\");\n+        try {\n+            getId(url);\n+            return true;\n+        } catch (FoundAdException fe) {", "originalCommit": "ff90d2233fc6e6422359276a28acb8fa3b88c07d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQ5MjYwMQ==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/256#discussion_r378492601", "bodyText": "my bad. because I used the same piece of code of youtubestreamlinkhandlerfactory and yeah, it's thrown on ad. I removed it.", "author": "B0pol", "createdAt": "2020-02-12T20:23:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODQ1MTY0MQ=="}], "type": "inlineReview"}, {"oid": "85f6362c026b8ad02baff9f4b711ac2fa2ca34e4", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/85f6362c026b8ad02baff9f4b711ac2fa2ca34e4", "message": "code optimization", "committedDate": "2020-02-12T20:33:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjY0MDg3Ng==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/256#discussion_r386640876", "body": "As far as I know this is not good practice, an empty `List` should be returned instead. Though I am not sure if it is normal to see null instead of empty lists in NewPipeExtractor. Same 5 lines below", "bodyText": "As far as I know this is not good practice, an empty List should be returned instead. Though I am not sure if it is normal to see null instead of empty lists in NewPipeExtractor. Same 5 lines below", "bodyHTML": "<p dir=\"auto\">As far as I know this is not good practice, an empty <code>List</code> should be returned instead. Though I am not sure if it is normal to see null instead of empty lists in NewPipeExtractor. Same 5 lines below</p>", "author": "Stypox", "createdAt": "2020-03-02T20:47:48Z", "path": "extractor/src/main/java/org/schabi/newpipe/extractor/services/media_ccc/extractors/MediaCCCStreamExtractor.java", "diffHunk": "@@ -170,15 +170,13 @@ public String getHlsUrl() throws ParsingException {\n         return null;\n     }\n \n-    @Nonnull\n     @Override\n     public List<SubtitlesStream> getSubtitlesDefault() throws IOException, ExtractionException {\n         return null;", "originalCommit": "85f6362c026b8ad02baff9f4b711ac2fa2ca34e4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjY0MjA4Nw==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/256#discussion_r386642087", "body": "Wouldn't it be a better idea to use substring? That's what we want, in the end", "bodyText": "Wouldn't it be a better idea to use substring? That's what we want, in the end", "bodyHTML": "<p dir=\"auto\">Wouldn't it be a better idea to use substring? That's what we want, in the end</p>", "author": "Stypox", "createdAt": "2020-03-02T20:50:18Z", "path": "extractor/src/main/java/org/schabi/newpipe/extractor/services/media_ccc/linkHandler/MediaCCCStreamLinkHandlerFactory.java", "diffHunk": "@@ -1,16 +1,39 @@\n package org.schabi.newpipe.extractor.services.media_ccc.linkHandler;\n \n+import org.schabi.newpipe.extractor.exceptions.FoundAdException;\n import org.schabi.newpipe.extractor.exceptions.ParsingException;\n import org.schabi.newpipe.extractor.linkhandler.LinkHandlerFactory;\n+import org.schabi.newpipe.extractor.utils.Utils;\n+\n+import java.net.MalformedURLException;\n+import java.net.URL;\n \n public class MediaCCCStreamLinkHandlerFactory extends LinkHandlerFactory {\n \n     @Override\n-    public String getId(String url) throws ParsingException {\n-        if(url.startsWith(\"https://api.media.ccc.de/public/events/\") &&\n-            !url.contains(\"?q=\")) {\n-            return url.replace(\"https://api.media.ccc.de/public/events/\", \"\");\n+    public String getId(String urlString) throws ParsingException {\n+        if (urlString.startsWith(\"https://api.media.ccc.de/public/events/\") &&\n+                !urlString.contains(\"?q=\")) {\n+            return urlString.replace(\"https://api.media.ccc.de/public/events/\", \"\");", "originalCommit": "85f6362c026b8ad02baff9f4b711ac2fa2ca34e4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjY2NjI3Nw==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/256#discussion_r386666277", "bodyText": "You can notice I didn't changed anything here, just the parameter name.\nAnyway, I've done it, if I understood your request", "author": "B0pol", "createdAt": "2020-03-02T21:39:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjY0MjA4Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjY0Mzc3Nw==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/256#discussion_r386643777", "body": "In these stream tests you should also check if all stream urls are secure urls (i.e. start with `https://`)", "bodyText": "In these stream tests you should also check if all stream urls are secure urls (i.e. start with https://)", "bodyHTML": "<p dir=\"auto\">In these stream tests you should also check if all stream urls are secure urls (i.e. start with <code>https://</code>)</p>", "author": "Stypox", "createdAt": "2020-03-02T20:53:37Z", "path": "extractor/src/test/java/org/schabi/newpipe/extractor/services/media_ccc/MediaCCCStreamExtractorTest.java", "diffHunk": "@@ -21,81 +19,157 @@\n /**\n  * Test {@link MediaCCCStreamExtractor}\n  */\n-public class MediaCCCStreamExtractorTest implements BaseExtractorTest {\n-    private static StreamExtractor extractor;\n-\n-    @BeforeClass\n-    public static void setUpClass() throws Exception {\n-        NewPipe.init(DownloaderTestImpl.getInstance());\n-\n-        extractor =  MediaCCC.getStreamExtractor(\"https://api.media.ccc.de/public/events/8afc16c2-d76a-53f6-85e4-90494665835d\");\n-        extractor.fetchPage();\n-    }\n-\n-    @Override\n-    public void testServiceId() throws Exception {\n-        assertEquals(2, extractor.getServiceId());\n-    }\n-\n-    @Override\n-    public void testName() throws Exception {\n-        assertEquals(\"tmux - Warum ein schwarzes Fenster am Bildschirm reicht\", extractor.getName());\n-    }\n-\n-    @Override\n-    public void testId() throws Exception {\n-        assertEquals(\"\", extractor.getId());\n-    }\n-\n-    @Override\n-    public void testUrl() throws Exception {\n-        assertEquals(\"\", extractor.getUrl());\n-    }\n-\n-    @Override\n-    public void testOriginalUrl() throws Exception {\n-        assertEquals(\"\", extractor.getOriginalUrl());\n-    }\n-\n-    @Test\n-    public void testThumbnail() throws Exception {\n-        assertEquals(\"https://static.media.ccc.de/media/events/gpn/gpn18/105-hd.jpg\", extractor.getThumbnailUrl());\n-    }\n-\n-    @Test\n-    public void testUploaderName() throws Exception {\n-        assertEquals(\"gpn18\", extractor.getUploaderName());\n-    }\n-\n-    @Test\n-    public void testUploaderUrl() throws Exception {\n-        assertEquals(\"https://api.media.ccc.de/public/conferences/gpn18\", extractor.getUploaderUrl());\n-    }\n-\n-    @Test\n-    public void testUploaderAvatarUrl() throws Exception {\n-        assertEquals(\"https://static.media.ccc.de/media/events/gpn/gpn18/logo.png\", extractor.getUploaderAvatarUrl());\n-    }\n-\n-    @Test\n-    public void testVideoStreams() throws Exception {\n-        assertEquals(4, extractor.getVideoStreams().size());\n-    }\n-\n-    @Test\n-    public void testAudioStreams() throws Exception {\n-        assertEquals(2, extractor.getAudioStreams().size());\n-    }\n-\n-    @Test\n-    public void testGetTextualUploadDate() throws ParsingException {\n-        Assert.assertEquals(\"2018-05-11T02:00:00.000+02:00\", extractor.getTextualUploadDate());\n+public class MediaCCCStreamExtractorTest {\n+\n+    public static class Gpn18Tmux {\n+        private static MediaCCCStreamExtractor extractor;\n+\n+        @BeforeClass\n+        public static void setUpClass() throws Exception {\n+            NewPipe.init(DownloaderTestImpl.getInstance());\n+\n+            extractor = (MediaCCCStreamExtractor) MediaCCC.getStreamExtractor(\"https://media.ccc.de/v/gpn18-105-tmux-warum-ein-schwarzes-fenster-am-bildschirm-reicht\");\n+            extractor.fetchPage();\n+        }\n+\n+        @Test\n+        public void testServiceId() throws Exception {\n+            assertEquals(2, extractor.getServiceId());\n+        }\n+\n+        @Test\n+        public void testName() throws Exception {\n+            assertEquals(\"tmux - Warum ein schwarzes Fenster am Bildschirm reicht\", extractor.getName());\n+        }\n+\n+        @Test\n+        public void testId() throws Exception {\n+            assertEquals(\"gpn18-105-tmux-warum-ein-schwarzes-fenster-am-bildschirm-reicht\", extractor.getId());\n+        }\n+\n+        @Test\n+        public void testUrl() throws Exception {\n+            assertEquals(\"https://api.media.ccc.de/public/events/gpn18-105-tmux-warum-ein-schwarzes-fenster-am-bildschirm-reicht\", extractor.getUrl());\n+        }\n+\n+        @Test\n+        public void testOriginalUrl() throws Exception {\n+            assertEquals(\"https://media.ccc.de/v/gpn18-105-tmux-warum-ein-schwarzes-fenster-am-bildschirm-reicht\", extractor.getOriginalUrl());\n+        }\n+\n+        @Test\n+        public void testThumbnail() throws Exception {\n+            assertEquals(\"https://static.media.ccc.de/media/events/gpn/gpn18/105-hd.jpg\", extractor.getThumbnailUrl());\n+        }\n+\n+        @Test\n+        public void testUploaderName() throws Exception {\n+            assertEquals(\"gpn18\", extractor.getUploaderName());\n+        }\n+\n+        @Test\n+        public void testUploaderUrl() throws Exception {\n+            assertEquals(\"https://api.media.ccc.de/public/conferences/gpn18\", extractor.getUploaderUrl());\n+        }\n+\n+        @Test\n+        public void testUploaderAvatarUrl() throws Exception {\n+            assertEquals(\"https://static.media.ccc.de/media/events/gpn/gpn18/logo.png\", extractor.getUploaderAvatarUrl());\n+        }\n+\n+        @Test\n+        public void testVideoStreams() throws Exception {\n+            assertEquals(4, extractor.getVideoStreams().size());", "originalCommit": "85f6362c026b8ad02baff9f4b711ac2fa2ca34e4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjgxNTk3Nw==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/256#discussion_r386815977", "bodyText": "for each stream run isSecureUrl(stream.getUrl())", "author": "Stypox", "createdAt": "2020-03-03T06:09:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjY0Mzc3Nw=="}], "type": "inlineReview"}, {"oid": "0f767b1fe192db01efc3055e5dd37fa78fb0cfb1", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/0f767b1fe192db01efc3055e5dd37fa78fb0cfb1", "message": "code optimization", "committedDate": "2020-03-02T21:11:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzI2NzE1NQ==", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/pull/256#discussion_r387267155", "body": "Please do something like this (also below and in all MediaCCC testVideoStreams and testAudioStreams functions).\r\nThe below code is untested\r\n```suggestion\r\n        public void testVideoStreams() throws Exception {\r\n            List<VideoStream> streams = extractor.getVideoStreams();\r\n            assertEquals(4, streams.size());\r\n            for (VideoStream stream : streams) {\r\n                assertIsSecureUrl(stream.getUrl())\r\n            }\r\n        }\r\n```", "bodyText": "Please do something like this (also below and in all MediaCCC testVideoStreams and testAudioStreams functions).\nThe below code is untested\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    public void testVideoStreams() throws Exception {\n          \n          \n            \n                        assertEquals(4, extractor.getVideoStreams().size());\n          \n          \n            \n                    }\n          \n          \n            \n                    public void testVideoStreams() throws Exception {\n          \n          \n            \n                        List<VideoStream> streams = extractor.getVideoStreams();\n          \n          \n            \n                        assertEquals(4, streams.size());\n          \n          \n            \n                        for (VideoStream stream : streams) {\n          \n          \n            \n                            assertIsSecureUrl(stream.getUrl())\n          \n          \n            \n                        }\n          \n          \n            \n                    }", "bodyHTML": "<p dir=\"auto\">Please do something like this (also below and in all MediaCCC testVideoStreams and testAudioStreams functions).<br>\nThe below code is untested</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"97\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> testVideoStreams() throws <span class=\"pl-smi\">Exception</span> {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"98\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            assertEquals(<span class=\"pl-c1\">4</span>, extractor<span class=\"pl-k\">.</span>getVideoStreams()<span class=\"pl-k\">.</span>size());</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"99\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"97\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> testVideoStreams() throws <span class=\"pl-smi\">Exception</span> {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"98\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">List&lt;<span class=\"pl-smi\">VideoStream</span>&gt;</span> streams <span class=\"pl-k\">=</span> extractor<span class=\"pl-k\">.</span>getVideoStreams();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"99\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            assertEquals(<span class=\"pl-c1\">4</span>, streams<span class=\"pl-k\">.</span>size());</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"100\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">for</span> (<span class=\"pl-smi\">VideoStream</span> stream <span class=\"pl-k\">:</span> streams) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"101\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                assertIsSecureUrl(stream<span class=\"pl-k\">.</span>getUrl())</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"102\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"103\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        }</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Stypox", "createdAt": "2020-03-03T20:13:05Z", "path": "extractor/src/test/java/org/schabi/newpipe/extractor/services/media_ccc/MediaCCCStreamExtractorTest.java", "diffHunk": "@@ -6,96 +6,182 @@\n import org.schabi.newpipe.DownloaderTestImpl;\n import org.schabi.newpipe.extractor.NewPipe;\n import org.schabi.newpipe.extractor.exceptions.ParsingException;\n-import org.schabi.newpipe.extractor.services.BaseExtractorTest;\n import org.schabi.newpipe.extractor.services.media_ccc.extractors.MediaCCCStreamExtractor;\n-import org.schabi.newpipe.extractor.stream.StreamExtractor;\n+import org.schabi.newpipe.extractor.utils.UtilsTest;\n \n import java.text.ParseException;\n import java.text.SimpleDateFormat;\n import java.util.Calendar;\n \n import static java.util.Objects.requireNonNull;\n import static junit.framework.TestCase.assertEquals;\n+import static org.schabi.newpipe.extractor.ExtractorAsserts.assertIsSecureUrl;\n import static org.schabi.newpipe.extractor.ServiceList.MediaCCC;\n \n /**\n  * Test {@link MediaCCCStreamExtractor}\n  */\n-public class MediaCCCStreamExtractorTest implements BaseExtractorTest {\n-    private static StreamExtractor extractor;\n-\n-    @BeforeClass\n-    public static void setUpClass() throws Exception {\n-        NewPipe.init(DownloaderTestImpl.getInstance());\n-\n-        extractor = MediaCCC.getStreamExtractor(\"https://api.media.ccc.de/public/events/8afc16c2-d76a-53f6-85e4-90494665835d\");\n-        extractor.fetchPage();\n-    }\n-\n-    @Override\n-    public void testServiceId() throws Exception {\n-        assertEquals(2, extractor.getServiceId());\n-    }\n-\n-    @Override\n-    public void testName() throws Exception {\n-        assertEquals(\"tmux - Warum ein schwarzes Fenster am Bildschirm reicht\", extractor.getName());\n-    }\n-\n-    @Override\n-    public void testId() throws Exception {\n-        assertEquals(\"\", extractor.getId());\n-    }\n-\n-    @Override\n-    public void testUrl() throws Exception {\n-        assertEquals(\"\", extractor.getUrl());\n-    }\n-\n-    @Override\n-    public void testOriginalUrl() throws Exception {\n-        assertEquals(\"\", extractor.getOriginalUrl());\n-    }\n-\n-    @Test\n-    public void testThumbnail() throws Exception {\n-        assertEquals(\"https://static.media.ccc.de/media/events/gpn/gpn18/105-hd.jpg\", extractor.getThumbnailUrl());\n-    }\n-\n-    @Test\n-    public void testUploaderName() throws Exception {\n-        assertEquals(\"gpn18\", extractor.getUploaderName());\n-    }\n-\n-    @Test\n-    public void testUploaderUrl() throws Exception {\n-        assertEquals(\"https://api.media.ccc.de/public/conferences/gpn18\", extractor.getUploaderUrl());\n-    }\n-\n-    @Test\n-    public void testUploaderAvatarUrl() throws Exception {\n-        assertEquals(\"https://static.media.ccc.de/media/events/gpn/gpn18/logo.png\", extractor.getUploaderAvatarUrl());\n-    }\n-\n-    @Test\n-    public void testVideoStreams() throws Exception {\n-        assertEquals(4, extractor.getVideoStreams().size());\n-    }\n-\n-    @Test\n-    public void testAudioStreams() throws Exception {\n-        assertEquals(2, extractor.getAudioStreams().size());\n-    }\n-\n-    @Test\n-    public void testGetTextualUploadDate() throws ParsingException {\n-        Assert.assertEquals(\"2018-05-11T02:00:00.000+02:00\", extractor.getTextualUploadDate());\n+public class MediaCCCStreamExtractorTest {\n+\n+    public static class Gpn18Tmux {\n+        private static MediaCCCStreamExtractor extractor;\n+\n+        @BeforeClass\n+        public static void setUpClass() throws Exception {\n+            NewPipe.init(DownloaderTestImpl.getInstance());\n+\n+            extractor = (MediaCCCStreamExtractor) MediaCCC.getStreamExtractor(\"https://media.ccc.de/v/gpn18-105-tmux-warum-ein-schwarzes-fenster-am-bildschirm-reicht\");\n+            extractor.fetchPage();\n+        }\n+\n+        @Test\n+        public void testServiceId() throws Exception {\n+            assertEquals(2, extractor.getServiceId());\n+        }\n+\n+        @Test\n+        public void testName() throws Exception {\n+            assertEquals(\"tmux - Warum ein schwarzes Fenster am Bildschirm reicht\", extractor.getName());\n+        }\n+\n+        @Test\n+        public void testId() throws Exception {\n+            assertEquals(\"gpn18-105-tmux-warum-ein-schwarzes-fenster-am-bildschirm-reicht\", extractor.getId());\n+        }\n+\n+        @Test\n+        public void testUrl() throws Exception {\n+            assertIsSecureUrl(extractor.getUrl());\n+            assertEquals(\"https://api.media.ccc.de/public/events/gpn18-105-tmux-warum-ein-schwarzes-fenster-am-bildschirm-reicht\", extractor.getUrl());\n+        }\n+\n+        @Test\n+        public void testOriginalUrl() throws Exception {\n+            assertIsSecureUrl(extractor.getOriginalUrl());\n+            assertEquals(\"https://media.ccc.de/v/gpn18-105-tmux-warum-ein-schwarzes-fenster-am-bildschirm-reicht\", extractor.getOriginalUrl());\n+        }\n+\n+        @Test\n+        public void testThumbnail() throws Exception {\n+            assertIsSecureUrl(extractor.getThumbnailUrl());\n+            assertEquals(\"https://static.media.ccc.de/media/events/gpn/gpn18/105-hd.jpg\", extractor.getThumbnailUrl());\n+        }\n+\n+        @Test\n+        public void testUploaderName() throws Exception {\n+            assertEquals(\"gpn18\", extractor.getUploaderName());\n+        }\n+\n+        @Test\n+        public void testUploaderUrl() throws Exception {\n+            assertIsSecureUrl(extractor.getUploaderUrl());\n+            assertEquals(\"https://api.media.ccc.de/public/conferences/gpn18\", extractor.getUploaderUrl());\n+        }\n+\n+        @Test\n+        public void testUploaderAvatarUrl() throws Exception {\n+            assertIsSecureUrl(extractor.getUploaderAvatarUrl());\n+            assertEquals(\"https://static.media.ccc.de/media/events/gpn/gpn18/logo.png\", extractor.getUploaderAvatarUrl());\n+        }\n+\n+        @Test\n+        public void testVideoStreams() throws Exception {\n+            assertEquals(4, extractor.getVideoStreams().size());\n+        }", "originalCommit": "6180226ec526861d6f8aacd4fe861a9dfcff41b6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e8e535b815e6a99dee08d1f3c2536868c8c03de0", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/e8e535b815e6a99dee08d1f3c2536868c8c03de0", "message": "mediaccc: update linkhandlers & refactor tests", "committedDate": "2020-03-13T19:00:49Z", "type": "commit"}, {"oid": "9701c7d800ae91fda88791dc21e02ee80888c030", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/9701c7d800ae91fda88791dc21e02ee80888c030", "message": "invidious shortened links", "committedDate": "2020-03-13T19:00:49Z", "type": "commit"}, {"oid": "f742a6bd3ea68a1d243aeceae5092703e92c3cc9", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/f742a6bd3ea68a1d243aeceae5092703e92c3cc9", "message": "code optimization", "committedDate": "2020-03-13T19:00:49Z", "type": "commit"}, {"oid": "0cd5e05b7b927a3d53048e5347a4f37fd8920efa", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/0cd5e05b7b927a3d53048e5347a4f37fd8920efa", "message": "MediaCCCLH: use substring instead of replace; improve a bit tests, return Collections.emptyList(); instead of null where it's annotated @NonNull", "committedDate": "2020-03-13T19:00:49Z", "type": "commit"}, {"oid": "66518ec44452f2fd3916805a07d3959409b0e16c", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/66518ec44452f2fd3916805a07d3959409b0e16c", "message": "check wether mediaccc streams url are secure", "committedDate": "2020-03-13T19:07:36Z", "type": "commit"}, {"oid": "66518ec44452f2fd3916805a07d3959409b0e16c", "url": "https://github.com/TeamNewPipe/NewPipeExtractor/commit/66518ec44452f2fd3916805a07d3959409b0e16c", "message": "check wether mediaccc streams url are secure", "committedDate": "2020-03-13T19:07:36Z", "type": "forcePushed"}]}