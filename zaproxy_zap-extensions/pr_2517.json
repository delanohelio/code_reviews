{"pr_number": 2517, "pr_title": "Changed ViewState and XFrameOption to return example alerts for the docs", "pr_author": "psiinon", "pr_createdAt": "2020-08-13T16:28:34Z", "pr_url": "https://github.com/zaproxy/zap-extensions/pull/2517", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA4ODA0Nw==", "url": "https://github.com/zaproxy/zap-extensions/pull/2517#discussion_r470088047", "body": "Do you care that this doesn't account for:\r\nhttps://github.com/zaproxy/zap-extensions/blob/7261748f7dfc5c4762d272eab880a439707b9778/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/XFrameOptionScanRule.java#L116-L121\r\n\r\nIs \"Other Info\" included in the docs?", "bodyText": "Do you care that this doesn't account for:\n\n  \n    \n      zap-extensions/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/XFrameOptionScanRule.java\n    \n    \n        Lines 116 to 121\n      in\n      7261748\n    \n    \n    \n    \n\n        \n          \n           int risk = Alert.RISK_MEDIUM; \n        \n\n        \n          \n           String other = \"\"; \n        \n\n        \n          \n           if (this.includedInCsp) { \n        \n\n        \n          \n               risk = Alert.RISK_LOW; \n        \n\n        \n          \n               other = Constant.messages.getString(MESSAGE_PREFIX + \"incInCsp\"); \n        \n\n        \n          \n           } \n        \n    \n  \n\n\nIs \"Other Info\" included in the docs?", "bodyHTML": "<p dir=\"auto\">Do you care that this doesn't account for:<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom color-bg-subtle\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/zaproxy/zap-extensions/blob/7261748f7dfc5c4762d272eab880a439707b9778/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/XFrameOptionScanRule.java#L116-L121\">zap-extensions/addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/XFrameOptionScanRule.java</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 116 to 121\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/zaproxy/zap-extensions/commit/7261748f7dfc5c4762d272eab880a439707b9778\">7261748</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L116\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"116\"></td>\n          <td id=\"LC116\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">int</span> risk <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Alert</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>RISK_MEDIUM</span>; </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L117\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"117\"></td>\n          <td id=\"LC117\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-smi\">String</span> other <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>; </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L118\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"118\"></td>\n          <td id=\"LC118\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">if</span> (<span class=\"pl-c1\">this</span><span class=\"pl-k\">.</span>includedInCsp) { </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L119\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"119\"></td>\n          <td id=\"LC119\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     risk <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Alert</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>RISK_LOW</span>; </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L120\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"120\"></td>\n          <td id=\"LC120\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     other <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Constant</span><span class=\"pl-k\">.</span>messages<span class=\"pl-k\">.</span>getString(<span class=\"pl-c1\">MESSAGE_PREFIX</span> <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>incInCsp<span class=\"pl-pds\">\"</span></span>); </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L121\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"121\"></td>\n          <td id=\"LC121\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> } </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>\n<p dir=\"auto\">Is \"Other Info\" included in the docs?</p>", "author": "kingthorin", "createdAt": "2020-08-13T16:48:23Z", "path": "addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/XFrameOptionScanRule.java", "diffHunk": "@@ -188,4 +189,23 @@ private String getMetaXFOEvidence(Source source) {\n         }\n         return null;\n     }\n+\n+    public List<Alert> getExampleAlerts() {\n+        List<Alert> alerts = new ArrayList<Alert>();\n+        for (VulnType vulnType : VulnType.values()) {\n+            alerts.add(\n+                    newAlert()\n+                            .setName(getAlertElement(vulnType, \"name\"))\n+                            .setRisk(Alert.RISK_MEDIUM)\n+                            .setConfidence(Alert.CONFIDENCE_MEDIUM)", "originalCommit": "7261748f7dfc5c4762d272eab880a439707b9778", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA4ODM5Ng==", "url": "https://github.com/zaproxy/zap-extensions/pull/2517#discussion_r470088396", "bodyText": "Oops I guess this should only be associated with line 199.", "author": "kingthorin", "createdAt": "2020-08-13T16:49:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA4ODA0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDQ5NDc5MA==", "url": "https://github.com/zaproxy/zap-extensions/pull/2517#discussion_r470494790", "bodyText": "No - they are just example alerts. I dont think we can document every possible variation.", "author": "psiinon", "createdAt": "2020-08-14T08:46:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA4ODA0Nw=="}], "type": "inlineReview"}, {"oid": "7c497c50e194b2e49046f32d0d6451f850b5406b", "url": "https://github.com/zaproxy/zap-extensions/commit/7c497c50e194b2e49046f32d0d6451f850b5406b", "message": "Changed ViewState and XFrameOption to return example alerts for the docs\n\nPart of https://github.com/zaproxy/zaproxy/issues/6119\n\nAssociated script changes will follow v shortly...\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>", "committedDate": "2020-08-14T10:32:38Z", "type": "forcePushed"}, {"oid": "0f551a8e9248e5f09f230e9ff1a35545773d2fef", "url": "https://github.com/zaproxy/zap-extensions/commit/0f551a8e9248e5f09f230e9ff1a35545773d2fef", "message": "Changed ViewState and XFrameOption to return example alerts for the docs\n\nPart of https://github.com/zaproxy/zaproxy/issues/6119\n\nAssociated script changes will follow v shortly...\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>", "committedDate": "2020-08-14T10:44:56Z", "type": "commit"}, {"oid": "0f551a8e9248e5f09f230e9ff1a35545773d2fef", "url": "https://github.com/zaproxy/zap-extensions/commit/0f551a8e9248e5f09f230e9ff1a35545773d2fef", "message": "Changed ViewState and XFrameOption to return example alerts for the docs\n\nPart of https://github.com/zaproxy/zaproxy/issues/6119\n\nAssociated script changes will follow v shortly...\n\nSigned-off-by: Simon Bennetts <psiinon@gmail.com>", "committedDate": "2020-08-14T10:44:56Z", "type": "forcePushed"}]}