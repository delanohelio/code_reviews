{"pr_number": 2532, "pr_title": "Provide example alerts in Cookie scan rules", "pr_author": "martinspielmann", "pr_createdAt": "2020-09-03T13:42:10Z", "pr_url": "https://github.com/zaproxy/zap-extensions/pull/2532", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mjk5MzkwNQ==", "url": "https://github.com/zaproxy/zap-extensions/pull/2532#discussion_r482993905", "body": "Not worth adding the JavaDoc.", "bodyText": "Not worth adding the JavaDoc.", "bodyHTML": "<p dir=\"auto\">Not worth adding the JavaDoc.</p>", "author": "thc202", "createdAt": "2020-09-03T13:51:53Z", "path": "addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/CookieHttpOnlyScanRule.java", "diffHunk": "@@ -134,4 +134,28 @@ private Model getModel() {\n     protected void setModel(Model model) {\n         this.model = model;\n     }\n+\n+    /**\n+     * Gets the CWE ID of the issue(s) raised by the scanner.\n+     *\n+     * @return the CWE ID,\n+     * @see <a href=\"https://cwe.mitre.org/index.html\">CWE - Common Weakness Enumeration</a>\n+     */", "originalCommit": "06e2f7e4fc444eb282825594f29ba32d5365836d", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e8cf83b6f2beb6d3ecea65fb2f45fa7e6107aa43", "url": "https://github.com/zaproxy/zap-extensions/commit/e8cf83b6f2beb6d3ecea65fb2f45fa7e6107aa43", "message": "Expose getCweId and getWascId method for Cookie scan rules.\n\nThe CWE id was already managed for these Alerts/ScanRules and within ZAP they were already presented to the user.\nHowever, when visiting the alert detail pages online (https://www.zaproxy.org/docs/alerts/), CWE (and WASC) links were not generated correctly.\n\nThe reason is, that the id values were set inline to the alert.\nFor the script which generates the detail pages however, the getter methods for the ids have to be added publicly to the class.\n\nNote: if this solves the issue, I'll vote for another follow up issue to add this change to the PluginPassiveScanner parent class,\nso that the docs will be generated consistently over all Passive Scan Rules.\n\nFixes zaproxy/zaproxy#6140.\n\nSigned-off-by: Martin Spielmann <mail@martinspielmann.de>", "committedDate": "2020-09-03T14:06:22Z", "type": "commit"}, {"oid": "e8cf83b6f2beb6d3ecea65fb2f45fa7e6107aa43", "url": "https://github.com/zaproxy/zap-extensions/commit/e8cf83b6f2beb6d3ecea65fb2f45fa7e6107aa43", "message": "Expose getCweId and getWascId method for Cookie scan rules.\n\nThe CWE id was already managed for these Alerts/ScanRules and within ZAP they were already presented to the user.\nHowever, when visiting the alert detail pages online (https://www.zaproxy.org/docs/alerts/), CWE (and WASC) links were not generated correctly.\n\nThe reason is, that the id values were set inline to the alert.\nFor the script which generates the detail pages however, the getter methods for the ids have to be added publicly to the class.\n\nNote: if this solves the issue, I'll vote for another follow up issue to add this change to the PluginPassiveScanner parent class,\nso that the docs will be generated consistently over all Passive Scan Rules.\n\nFixes zaproxy/zaproxy#6140.\n\nSigned-off-by: Martin Spielmann <mail@martinspielmann.de>", "committedDate": "2020-09-03T14:06:22Z", "type": "forcePushed"}, {"oid": "0e7f54d05deb5bc0a629cd60654e8c00f9de6f71", "url": "https://github.com/zaproxy/zap-extensions/commit/0e7f54d05deb5bc0a629cd60654e8c00f9de6f71", "message": "Removed worthless javadoc and fix formatting.\n\nSigned-off-by: Martin Spielmann <mail@martinspielmann.de>", "committedDate": "2020-09-03T14:11:29Z", "type": "commit"}, {"oid": "d4ac01d43e6c2db85480014a5bbb0c3d3f525167", "url": "https://github.com/zaproxy/zap-extensions/commit/d4ac01d43e6c2db85480014a5bbb0c3d3f525167", "message": "Add new common getExampleAlerts() method\n\nTo comply with zaproxy/zaproxy#6140, the affected ScanRules have been provided with a getExampeAlerts method.\nIt allows maintenance scripts to generate documentation pages in a common way.\n\nSigned-off-by: Martin Spielmann <mail@martinspielmann.de>", "committedDate": "2020-09-03T15:03:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDQ5MTk1NQ==", "url": "https://github.com/zaproxy/zap-extensions/pull/2532#discussion_r484491955", "body": "This should call existing method, avoids maintaining the same info in two places (which is error prone). There's another PR with similar changes: https://github.com/zaproxy/zap-extensions/pull/2517/files#diff-2587ce4776bf99dbb14cf9284389ba13\r\nThe methods `getCweId()` and `getWascId()` would no longer be needed.", "bodyText": "This should call existing method, avoids maintaining the same info in two places (which is error prone). There's another PR with similar changes: https://github.com/zaproxy/zap-extensions/pull/2517/files#diff-2587ce4776bf99dbb14cf9284389ba13\nThe methods getCweId() and getWascId() would no longer be needed.", "bodyHTML": "<p dir=\"auto\">This should call existing method, avoids maintaining the same info in two places (which is error prone). There's another PR with similar changes: <a href=\"https://github.com/zaproxy/zap-extensions/pull/2517/files#diff-2587ce4776bf99dbb14cf9284389ba13\">https://github.com/zaproxy/zap-extensions/pull/2517/files#diff-2587ce4776bf99dbb14cf9284389ba13</a><br>\nThe methods <code>getCweId()</code> and <code>getWascId()</code> would no longer be needed.</p>", "author": "thc202", "createdAt": "2020-09-07T15:25:04Z", "path": "addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/CookieHttpOnlyScanRule.java", "diffHunk": "@@ -134,4 +135,30 @@ private Model getModel() {\n     protected void setModel(Model model) {\n         this.model = model;\n     }\n+\n+    private int getCweId() {\n+        // CWE Id 16 - Configuration\n+        return 16;\n+    }\n+\n+    private int getWascId() {\n+        // WASC Id 13 - Info leakage)\n+        return 13;\n+    }\n+\n+    public List<Alert> getExampleAlerts() {\n+        List<Alert> alerts = new ArrayList<Alert>();\n+        Alert alert =\n+                newAlert()", "originalCommit": "d4ac01d43e6c2db85480014a5bbb0c3d3f525167", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDQ3NjA0Mw==", "url": "https://github.com/zaproxy/zap-extensions/pull/2532#discussion_r484476043", "body": "I dunno why it was there...\r\n```suggestion\r\n        // WASC Id 13 - Info leakage\r\n```", "bodyText": "I dunno why it was there...\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    // WASC Id 13 - Info leakage)\n          \n          \n            \n                    // WASC Id 13 - Info leakage", "bodyHTML": "<p dir=\"auto\">I dunno why it was there...</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> WASC Id 13 - Info leakage<span class=\"x x-first x-last\">)</span></span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> WASC Id 13 - Info leakage</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "kingthorin", "createdAt": "2020-09-07T14:49:49Z", "path": "addOns/pscanrules/src/main/java/org/zaproxy/zap/extension/pscanrules/CookieHttpOnlyScanRule.java", "diffHunk": "@@ -134,4 +135,30 @@ private Model getModel() {\n     protected void setModel(Model model) {\n         this.model = model;\n     }\n+\n+    private int getCweId() {\n+        // CWE Id 16 - Configuration\n+        return 16;\n+    }\n+\n+    private int getWascId() {\n+        // WASC Id 13 - Info leakage)", "originalCommit": "d4ac01d43e6c2db85480014a5bbb0c3d3f525167", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "16cfbf872ebcc5fc5a97ee643d7f527784a159f5", "url": "https://github.com/zaproxy/zap-extensions/commit/16cfbf872ebcc5fc5a97ee643d7f527784a159f5", "message": "Cleanup methods\n\nSigned-off-by: Martin Spielmann <mail@martinspielmann.de>", "committedDate": "2020-09-07T18:24:55Z", "type": "commit"}]}