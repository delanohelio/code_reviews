{"pr_number": 5941, "pr_title": "[2.20.x] DDF-5940 - Add anyText expansion whitelist / blacklist capability", "pr_author": "derekwilhelm", "pr_createdAt": "2020-03-25T20:58:35Z", "pr_url": "https://github.com/codice/ddf/pull/5941", "timeline": [{"oid": "8c1c31408ec70029338ee84b6a3092292ede8884", "url": "https://github.com/codice/ddf/commit/8c1c31408ec70029338ee84b6a3092292ede8884", "message": "Add anyText expansion whitelist and blacklist", "committedDate": "2020-03-25T14:31:45Z", "type": "commit"}, {"oid": "aadd3a0e9b31d02d16535ee0b62fd58d8d1b5ab7", "url": "https://github.com/codice/ddf/commit/aadd3a0e9b31d02d16535ee0b62fd58d8d1b5ab7", "message": "Add whitelist/blacklist configuration to cache", "committedDate": "2020-03-25T19:37:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE3ODA3Mw==", "url": "https://github.com/codice/ddf/pull/5941#discussion_r398178073", "body": "I would suggest updating this to allow a blacklist and a whitelist at the same time.  A common strategy for this is have the whitelist take precedence.  Then admins could filter out entire namespaces while letting a few parts of the namespace through the filter.   \r\n\r\n```suggestion\r\n  private void filterAnyTextFieldCache() {\r\n    Set<String> filteredList = new HashSet<>();\r\n\r\n    ConfigurationStore config = ConfigurationStore.getInstance();\r\n    List<String> anyTextFieldWhitelist = config.getAnyTextFieldWhitelist();\r\n    List<String> anyTextFieldBlacklist = config.getAnyTextFieldBlacklist();\r\n    \r\n    if (!anyTextFieldBlacklist.isEmpty()) {\r\n      filteredList.addAll(anyTextFieldsCache);\r\n      for (String blacklistField : anyTextFieldBlacklist) {\r\n        String blacklist;\r\n        if (!blacklistField.endsWith(SchemaFields.TEXT_SUFFIX)) {\r\n          blacklist = blacklistField + SchemaFields.TEXT_SUFFIX;\r\n        } else {\r\n          blacklist = blacklistField;\r\n        }\r\n        filteredList.removeAll(\r\n            anyTextFieldsCache\r\n                .stream()\r\n                .filter(field -> field.matches(blacklist))\r\n                .collect(Collectors.toList()));\r\n      }\r\n    } \r\n    if (!anyTextFieldWhitelist.isEmpty()) {\r\n      for (String whitelistField : anyTextFieldWhitelist) {\r\n        String whitelist;\r\n        if (!whitelistField.endsWith(SchemaFields.TEXT_SUFFIX)) {\r\n          whitelist = whitelistField + SchemaFields.TEXT_SUFFIX;\r\n        } else {\r\n          whitelist = whitelistField;\r\n        }\r\n        filteredList.addAll(\r\n            anyTextFieldsCache\r\n                .stream()\r\n                .filter(field -> field.matches(whitelist))\r\n                .collect(Collectors.toList()));\r\n      }\r\n    } \r\n    \r\n    if (anyTextFieldWhitelist.isEmpty() && anyTextFieldBlacklist.isEmpty()) {\r\n      filteredList.addAll(anyTextFieldsCache);\r\n    }\r\n```\r\n\r\n", "bodyText": "I would suggest updating this to allow a blacklist and a whitelist at the same time.  A common strategy for this is have the whitelist take precedence.  Then admins could filter out entire namespaces while letting a few parts of the namespace through the filter.\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private void filterAnyTextFieldCache() {\n          \n          \n            \n                Set<String> filteredList = new HashSet<>();\n          \n          \n            \n            \n          \n          \n            \n                ConfigurationStore config = ConfigurationStore.getInstance();\n          \n          \n            \n                List<String> anyTextFieldWhitelist = config.getAnyTextFieldWhitelist();\n          \n          \n            \n                List<String> anyTextFieldBlacklist = config.getAnyTextFieldBlacklist();\n          \n          \n            \n                if (!anyTextFieldWhitelist.isEmpty()) {\n          \n          \n            \n                  for (String whitelistField : anyTextFieldWhitelist) {\n          \n          \n            \n                    String whitelist;\n          \n          \n            \n                    if (!whitelistField.endsWith(SchemaFields.TEXT_SUFFIX)) {\n          \n          \n            \n                      whitelist = whitelistField + SchemaFields.TEXT_SUFFIX;\n          \n          \n            \n                    } else {\n          \n          \n            \n                      whitelist = whitelistField;\n          \n          \n            \n                    }\n          \n          \n            \n                    filteredList.addAll(\n          \n          \n            \n                        anyTextFieldsCache\n          \n          \n            \n                            .stream()\n          \n          \n            \n                            .filter(field -> field.matches(whitelist))\n          \n          \n            \n                            .collect(Collectors.toList()));\n          \n          \n            \n                  }\n          \n          \n            \n                } else if (!anyTextFieldBlacklist.isEmpty()) {\n          \n          \n            \n                  filteredList.addAll(anyTextFieldsCache);\n          \n          \n            \n                  for (String blacklistField : anyTextFieldBlacklist) {\n          \n          \n            \n                    String blacklist;\n          \n          \n            \n                    if (!blacklistField.endsWith(SchemaFields.TEXT_SUFFIX)) {\n          \n          \n            \n                      blacklist = blacklistField + SchemaFields.TEXT_SUFFIX;\n          \n          \n            \n                    } else {\n          \n          \n            \n                      blacklist = blacklistField;\n          \n          \n            \n                    }\n          \n          \n            \n                    filteredList.removeAll(\n          \n          \n            \n                        anyTextFieldsCache\n          \n          \n            \n                            .stream()\n          \n          \n            \n                            .filter(field -> field.matches(blacklist))\n          \n          \n            \n                            .collect(Collectors.toList()));\n          \n          \n            \n                  }\n          \n          \n            \n                } else {\n          \n          \n            \n                  filteredList.addAll(anyTextFieldsCache);\n          \n          \n            \n                }\n          \n          \n            \n              private void filterAnyTextFieldCache() {\n          \n          \n            \n                Set<String> filteredList = new HashSet<>();\n          \n          \n            \n            \n          \n          \n            \n                ConfigurationStore config = ConfigurationStore.getInstance();\n          \n          \n            \n                List<String> anyTextFieldWhitelist = config.getAnyTextFieldWhitelist();\n          \n          \n            \n                List<String> anyTextFieldBlacklist = config.getAnyTextFieldBlacklist();\n          \n          \n            \n                \n          \n          \n            \n                if (!anyTextFieldBlacklist.isEmpty()) {\n          \n          \n            \n                  filteredList.addAll(anyTextFieldsCache);\n          \n          \n            \n                  for (String blacklistField : anyTextFieldBlacklist) {\n          \n          \n            \n                    String blacklist;\n          \n          \n            \n                    if (!blacklistField.endsWith(SchemaFields.TEXT_SUFFIX)) {\n          \n          \n            \n                      blacklist = blacklistField + SchemaFields.TEXT_SUFFIX;\n          \n          \n            \n                    } else {\n          \n          \n            \n                      blacklist = blacklistField;\n          \n          \n            \n                    }\n          \n          \n            \n                    filteredList.removeAll(\n          \n          \n            \n                        anyTextFieldsCache\n          \n          \n            \n                            .stream()\n          \n          \n            \n                            .filter(field -> field.matches(blacklist))\n          \n          \n            \n                            .collect(Collectors.toList()));\n          \n          \n            \n                  }\n          \n          \n            \n                } \n          \n          \n            \n                if (!anyTextFieldWhitelist.isEmpty()) {\n          \n          \n            \n                  for (String whitelistField : anyTextFieldWhitelist) {\n          \n          \n            \n                    String whitelist;\n          \n          \n            \n                    if (!whitelistField.endsWith(SchemaFields.TEXT_SUFFIX)) {\n          \n          \n            \n                      whitelist = whitelistField + SchemaFields.TEXT_SUFFIX;\n          \n          \n            \n                    } else {\n          \n          \n            \n                      whitelist = whitelistField;\n          \n          \n            \n                    }\n          \n          \n            \n                    filteredList.addAll(\n          \n          \n            \n                        anyTextFieldsCache\n          \n          \n            \n                            .stream()\n          \n          \n            \n                            .filter(field -> field.matches(whitelist))\n          \n          \n            \n                            .collect(Collectors.toList()));\n          \n          \n            \n                  }\n          \n          \n            \n                } \n          \n          \n            \n                \n          \n          \n            \n                if (anyTextFieldWhitelist.isEmpty() && anyTextFieldBlacklist.isEmpty()) {\n          \n          \n            \n                  filteredList.addAll(anyTextFieldsCache);\n          \n          \n            \n                }", "bodyHTML": "<p dir=\"auto\">I would suggest updating this to allow a blacklist and a whitelist at the same time.  A common strategy for this is have the whitelist take precedence.  Then admins could filter out entire namespaces while letting a few parts of the namespace through the filter.</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"218\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">  <span class=\"pl-k\">private</span> <span class=\"pl-k\">void</span> filterAnyTextFieldCache() {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"219\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">Set&lt;<span class=\"pl-smi\">String</span>&gt;</span> filteredList <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">HashSet&lt;&gt;</span>();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"220\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"221\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-smi\">ConfigurationStore</span> config <span class=\"pl-k\">=</span> <span class=\"pl-smi\">ConfigurationStore</span><span class=\"pl-k\">.</span>getInstance();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"222\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">List&lt;<span class=\"pl-smi\">String</span>&gt;</span> anyTextFieldWhitelist <span class=\"pl-k\">=</span> config<span class=\"pl-k\">.</span>getAnyTextFieldWhitelist();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"223\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">List&lt;<span class=\"pl-smi\">String</span>&gt;</span> anyTextFieldBlacklist <span class=\"pl-k\">=</span> config<span class=\"pl-k\">.</span>getAnyTextFieldBlacklist();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"224\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span>anyTextFieldWhitelist<span class=\"pl-k\">.</span>isEmpty()) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"225\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">      <span class=\"pl-k\">for</span> (<span class=\"pl-smi\">String</span> whitelistField <span class=\"pl-k\">:</span> anyTextFieldWhitelist) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"226\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-smi\">String</span> whitelist;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"227\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span>whitelistField<span class=\"pl-k\">.</span>endsWith(<span class=\"pl-smi\">SchemaFields</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>TEXT_SUFFIX</span>)) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"228\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">          whitelist <span class=\"pl-k\">=</span> whitelistField <span class=\"pl-k\">+</span> <span class=\"pl-smi\">SchemaFields</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>TEXT_SUFFIX</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"229\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        } <span class=\"pl-k\">else</span> {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"230\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">          whitelist <span class=\"pl-k\">=</span> whitelistField;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"231\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"232\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        filteredList<span class=\"pl-k\">.</span>addAll(</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"233\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            anyTextFieldsCache</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"234\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                .stream()</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"235\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                .filter(field <span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> field<span class=\"pl-k\">.</span>matches(whitelist))</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"236\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                .collect(<span class=\"pl-smi\">Collectors</span><span class=\"pl-k\">.</span>toList()));</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"237\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">      }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"238\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    } <span class=\"pl-k\">else</span> <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span>anyTextFieldBlacklist<span class=\"pl-k\">.</span>isEmpty()) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"239\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">      filteredList<span class=\"pl-k\">.</span>addAll(anyTextFieldsCache);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"240\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">      <span class=\"pl-k\">for</span> (<span class=\"pl-smi\">String</span> blacklistField <span class=\"pl-k\">:</span> anyTextFieldBlacklist) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"241\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-smi\">String</span> blacklist;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"242\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span>blacklistField<span class=\"pl-k\">.</span>endsWith(<span class=\"pl-smi\">SchemaFields</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>TEXT_SUFFIX</span>)) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"243\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">          blacklist <span class=\"pl-k\">=</span> blacklistField <span class=\"pl-k\">+</span> <span class=\"pl-smi\">SchemaFields</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>TEXT_SUFFIX</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"244\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        } <span class=\"pl-k\">else</span> {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"245\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">          blacklist <span class=\"pl-k\">=</span> blacklistField;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"246\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"247\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        filteredList<span class=\"pl-k\">.</span>removeAll(</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"248\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            anyTextFieldsCache</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"249\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                .stream()</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"250\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                .filter(field <span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> field<span class=\"pl-k\">.</span>matches(blacklist))</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"251\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                .collect(<span class=\"pl-smi\">Collectors</span><span class=\"pl-k\">.</span>toList()));</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"252\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">      }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"253\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    } <span class=\"pl-k\">else</span> {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"254\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">      filteredList<span class=\"pl-k\">.</span>addAll(anyTextFieldsCache);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"255\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"218\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">  <span class=\"pl-k\">private</span> <span class=\"pl-k\">void</span> filterAnyTextFieldCache() {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"219\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">Set&lt;<span class=\"pl-smi\">String</span>&gt;</span> filteredList <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">HashSet&lt;&gt;</span>();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"220\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\"></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"221\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-smi\">ConfigurationStore</span> config <span class=\"pl-k\">=</span> <span class=\"pl-smi\">ConfigurationStore</span><span class=\"pl-k\">.</span>getInstance();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"222\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">List&lt;<span class=\"pl-smi\">String</span>&gt;</span> anyTextFieldWhitelist <span class=\"pl-k\">=</span> config<span class=\"pl-k\">.</span>getAnyTextFieldWhitelist();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"223\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">List&lt;<span class=\"pl-smi\">String</span>&gt;</span> anyTextFieldBlacklist <span class=\"pl-k\">=</span> config<span class=\"pl-k\">.</span>getAnyTextFieldBlacklist();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"224\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    </td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"225\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span>anyTextFieldBlacklist<span class=\"pl-k\">.</span>isEmpty()) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"226\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">      filteredList<span class=\"pl-k\">.</span>addAll(anyTextFieldsCache);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"227\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">      <span class=\"pl-k\">for</span> (<span class=\"pl-smi\">String</span> blacklistField <span class=\"pl-k\">:</span> anyTextFieldBlacklist) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"228\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-smi\">String</span> blacklist;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"229\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span>blacklistField<span class=\"pl-k\">.</span>endsWith(<span class=\"pl-smi\">SchemaFields</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>TEXT_SUFFIX</span>)) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"230\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">          blacklist <span class=\"pl-k\">=</span> blacklistField <span class=\"pl-k\">+</span> <span class=\"pl-smi\">SchemaFields</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>TEXT_SUFFIX</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"231\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        } <span class=\"pl-k\">else</span> {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"232\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">          blacklist <span class=\"pl-k\">=</span> blacklistField;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"233\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"234\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        filteredList<span class=\"pl-k\">.</span>removeAll(</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"235\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            anyTextFieldsCache</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"236\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                .stream()</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"237\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                .filter(field <span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> field<span class=\"pl-k\">.</span>matches(blacklist))</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"238\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                .collect(<span class=\"pl-smi\">Collectors</span><span class=\"pl-k\">.</span>toList()));</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"239\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">      }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"240\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    } </td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"241\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span>anyTextFieldWhitelist<span class=\"pl-k\">.</span>isEmpty()) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"242\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">      <span class=\"pl-k\">for</span> (<span class=\"pl-smi\">String</span> whitelistField <span class=\"pl-k\">:</span> anyTextFieldWhitelist) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"243\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-smi\">String</span> whitelist;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"244\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span>whitelistField<span class=\"pl-k\">.</span>endsWith(<span class=\"pl-smi\">SchemaFields</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>TEXT_SUFFIX</span>)) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"245\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">          whitelist <span class=\"pl-k\">=</span> whitelistField <span class=\"pl-k\">+</span> <span class=\"pl-smi\">SchemaFields</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>TEXT_SUFFIX</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"246\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        } <span class=\"pl-k\">else</span> {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"247\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">          whitelist <span class=\"pl-k\">=</span> whitelistField;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"248\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"249\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        filteredList<span class=\"pl-k\">.</span>addAll(</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"250\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            anyTextFieldsCache</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"251\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                .stream()</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"252\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                .filter(field <span class=\"pl-k\">-</span><span class=\"pl-k\">&gt;</span> field<span class=\"pl-k\">.</span>matches(whitelist))</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"253\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                .collect(<span class=\"pl-smi\">Collectors</span><span class=\"pl-k\">.</span>toList()));</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"254\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">      }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"255\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    } </td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"256\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    </td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"257\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">if</span> (anyTextFieldWhitelist<span class=\"pl-k\">.</span>isEmpty() <span class=\"pl-k\">&amp;&amp;</span> anyTextFieldBlacklist<span class=\"pl-k\">.</span>isEmpty()) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"258\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">      filteredList<span class=\"pl-k\">.</span>addAll(anyTextFieldsCache);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"259\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    }</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "andrewkfiedler", "createdAt": "2020-03-25T21:22:36Z", "path": "catalog/core/catalog-core-solr/src/main/java/ddf/catalog/source/solr/ConfigurationStore.java", "diffHunk": "@@ -83,4 +96,123 @@ public void setInMemory(boolean isInMemory) {\n   public void setForceAutoCommit(boolean forceAutoCommit) {\n     this.forceAutoCommit = forceAutoCommit;\n   }\n+\n+  public void setAnyTextFieldWhitelist(List<String> fieldWhitelist) {\n+    this.anyTextFieldWhitelist.clear();\n+    if (fieldWhitelist != null) {\n+      this.anyTextFieldWhitelist.addAll(fieldWhitelist);\n+    }\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public List<String> getAnyTextFieldWhitelist() {\n+    return new ArrayList<>(anyTextFieldWhitelist);\n+  }\n+\n+  public void addAnyTextWhitelistField(String whitelistField) {\n+    if (whitelistField != null) {\n+      this.anyTextFieldWhitelist.add(whitelistField);\n+    }\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public void removeAnyTextWhiteListField(String whitelistField) {\n+    this.anyTextFieldWhitelist.remove(whitelistField);\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public void setAnyTextFieldBlacklist(List<String> fieldBlacklist) {\n+    this.anyTextFieldBlacklist.clear();\n+    if (fieldBlacklist != null) {\n+      this.anyTextFieldBlacklist.addAll(fieldBlacklist);\n+    }\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public List<String> getAnyTextFieldBlacklist() {\n+    return new ArrayList<>(anyTextFieldBlacklist);\n+  }\n+\n+  public void addAnyTextBlacklistField(String blacklistField) {\n+    this.anyTextFieldBlacklist.add(blacklistField);\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public void removeAnyTextBlacklistField(String blacklistField) {\n+    this.anyTextFieldBlacklist.remove(blacklistField);\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public void addAnyTextField(String anyTextField) {\n+    anyTextFieldsCache.add(anyTextField);\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public void removeAnyTextField(String anyTextField) {\n+    anyTextFieldsCache.remove(anyTextField);\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public void clearAnyTextFieldCache() {\n+    anyTextFieldsCache.clear();\n+    filteredAnyTextFieldsCache.clear();\n+  }\n+\n+  public Set<String> getAnyTextFieldsCache() {\n+    return anyTextFieldsCache;\n+  }\n+\n+  public Set<String> getFilteredAnyTextFields() {\n+    return filteredAnyTextFieldsCache;\n+  }\n+\n+  private void filterAnyTextFieldCache() {\n+    Set<String> filteredList = new HashSet<>();\n+\n+    ConfigurationStore config = ConfigurationStore.getInstance();\n+    List<String> anyTextFieldWhitelist = config.getAnyTextFieldWhitelist();\n+    List<String> anyTextFieldBlacklist = config.getAnyTextFieldBlacklist();\n+    if (!anyTextFieldWhitelist.isEmpty()) {\n+      for (String whitelistField : anyTextFieldWhitelist) {\n+        String whitelist;\n+        if (!whitelistField.endsWith(SchemaFields.TEXT_SUFFIX)) {\n+          whitelist = whitelistField + SchemaFields.TEXT_SUFFIX;\n+        } else {\n+          whitelist = whitelistField;\n+        }\n+        filteredList.addAll(\n+            anyTextFieldsCache\n+                .stream()\n+                .filter(field -> field.matches(whitelist))\n+                .collect(Collectors.toList()));\n+      }\n+    } else if (!anyTextFieldBlacklist.isEmpty()) {\n+      filteredList.addAll(anyTextFieldsCache);\n+      for (String blacklistField : anyTextFieldBlacklist) {\n+        String blacklist;\n+        if (!blacklistField.endsWith(SchemaFields.TEXT_SUFFIX)) {\n+          blacklist = blacklistField + SchemaFields.TEXT_SUFFIX;\n+        } else {\n+          blacklist = blacklistField;\n+        }\n+        filteredList.removeAll(\n+            anyTextFieldsCache\n+                .stream()\n+                .filter(field -> field.matches(blacklist))\n+                .collect(Collectors.toList()));\n+      }\n+    } else {\n+      filteredList.addAll(anyTextFieldsCache);\n+    }", "originalCommit": "aadd3a0e9b31d02d16535ee0b62fd58d8d1b5ab7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODIxODE2Mw==", "url": "https://github.com/codice/ddf/pull/5941#discussion_r398218163", "bodyText": "Your solution would allow non-whitelisted fields to be added to the anyText expansion since it starts with the full list, removes any blacklisted items, and then re-adds any whitelisted items.   That is really an implementation of a blacklist exception.  Wouldn't that be confusing to an admin where they provide a whitelist but still see non-whitelisted fields as part of the queries?", "author": "derekwilhelm", "createdAt": "2020-03-25T22:50:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE3ODA3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODIyNjk2Mw==", "url": "https://github.com/codice/ddf/pull/5941#discussion_r398226963", "bodyText": "Yeah, that's the intention in my solution.  You start with the full list, blacklist things, then add things there are exceptions for.\nI don't think it's confusing, it's a common pattern when both a blacklist and a whitelist are allowed.\nI would argue the current behavior is confusing, since we allow both a blacklist and a whitelist to be defined (with no warnings), and then ultimately only use the whitelist.", "author": "andrewkfiedler", "createdAt": "2020-03-25T23:14:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE3ODA3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODIzMzY0MQ==", "url": "https://github.com/codice/ddf/pull/5941#discussion_r398233641", "bodyText": "If metatypes would allow me to force selecting only one of the lists at a time I would have done it for clarity.  I get your point.  Regardless of solution, it needs to identify to the user what the behavior is.  I will update it to allow both and add a comment to the whitelist description that will indicate it becomes a blacklist exception if both lists are provided instead of a pure whitelist.", "author": "derekwilhelm", "createdAt": "2020-03-25T23:34:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE3ODA3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODI1NDcyNw==", "url": "https://github.com/codice/ddf/pull/5941#discussion_r398254727", "bodyText": "Sounds good.\nI feel you on the metatypes, they feel like crude tools when it comes to the reality of configurations.\nI might take a bit of time after we merge this into master to see if we can offer a special view in the new Admin UI for this configuration, might help ease the burden on admins.  I've been meaning to see if we can make a simple pattern for replacing the default configuration views.", "author": "andrewkfiedler", "createdAt": "2020-03-26T00:44:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODE3ODA3Mw=="}], "type": "inlineReview"}, {"oid": "e0281f9c3e17201dfa9a40fb245a2df45489d761", "url": "https://github.com/codice/ddf/commit/e0281f9c3e17201dfa9a40fb245a2df45489d761", "message": "Allow both blacklist and whitelist at the same time", "committedDate": "2020-03-25T23:57:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY2MjMxMg==", "url": "https://github.com/codice/ddf/pull/5941#discussion_r398662312", "body": ":pencil2: Ideally this `ConfigurationStore` would only have configuration as its responsibility.  I would recommend extracting the anyText field cache related fields, methods, and logic to a new class.", "bodyText": "\u270f\ufe0f Ideally this ConfigurationStore would only have configuration as its responsibility.  I would recommend extracting the anyText field cache related fields, methods, and logic to a new class.", "bodyHTML": "<p dir=\"auto\"><g-emoji class=\"g-emoji\" alias=\"pencil2\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/270f.png\">\u270f\ufe0f</g-emoji> Ideally this <code>ConfigurationStore</code> would only have configuration as its responsibility.  I would recommend extracting the anyText field cache related fields, methods, and logic to a new class.</p>", "author": "pklinef", "createdAt": "2020-03-26T15:26:31Z", "path": "catalog/core/catalog-core-solr/src/main/java/ddf/catalog/source/solr/ConfigurationStore.java", "diffHunk": "@@ -83,4 +96,127 @@ public void setInMemory(boolean isInMemory) {\n   public void setForceAutoCommit(boolean forceAutoCommit) {\n     this.forceAutoCommit = forceAutoCommit;\n   }\n+\n+  public void setAnyTextFieldWhitelist(List<String> fieldWhitelist) {\n+    this.anyTextFieldWhitelist.clear();\n+    if (fieldWhitelist != null) {\n+      this.anyTextFieldWhitelist.addAll(fieldWhitelist);\n+    }\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public List<String> getAnyTextFieldWhitelist() {\n+    return new ArrayList<>(anyTextFieldWhitelist);\n+  }\n+\n+  public void addAnyTextWhitelistField(String whitelistField) {\n+    if (whitelistField != null) {\n+      this.anyTextFieldWhitelist.add(whitelistField);\n+    }\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public void removeAnyTextWhiteListField(String whitelistField) {\n+    this.anyTextFieldWhitelist.remove(whitelistField);\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public void setAnyTextFieldBlacklist(List<String> fieldBlacklist) {\n+    this.anyTextFieldBlacklist.clear();\n+    if (fieldBlacklist != null) {\n+      this.anyTextFieldBlacklist.addAll(fieldBlacklist);\n+    }\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public List<String> getAnyTextFieldBlacklist() {\n+    return new ArrayList<>(anyTextFieldBlacklist);\n+  }\n+\n+  public void addAnyTextBlacklistField(String blacklistField) {\n+    this.anyTextFieldBlacklist.add(blacklistField);\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public void removeAnyTextBlacklistField(String blacklistField) {\n+    this.anyTextFieldBlacklist.remove(blacklistField);\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public void addAnyTextField(String anyTextField) {\n+    anyTextFieldsCache.add(anyTextField);\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public void removeAnyTextField(String anyTextField) {\n+    anyTextFieldsCache.remove(anyTextField);\n+\n+    filterAnyTextFieldCache();\n+  }\n+\n+  public void clearAnyTextFieldCache() {\n+    anyTextFieldsCache.clear();\n+    filteredAnyTextFieldsCache.clear();\n+  }\n+\n+  public Set<String> getAnyTextFieldsCache() {\n+    return anyTextFieldsCache;\n+  }\n+\n+  public Set<String> getFilteredAnyTextFields() {\n+    return filteredAnyTextFieldsCache;\n+  }\n+\n+  private void filterAnyTextFieldCache() {", "originalCommit": "e0281f9c3e17201dfa9a40fb245a2df45489d761", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODc3MDYwNQ==", "url": "https://github.com/codice/ddf/pull/5941#discussion_r398770605", "bodyText": "I would be good with this being fixed on the master branch.", "author": "pklinef", "createdAt": "2020-03-26T17:47:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY2MjMxMg=="}], "type": "inlineReview"}, {"oid": "eaac250421ab15c6053104765b01b9f9bbc27281", "url": "https://github.com/codice/ddf/commit/eaac250421ab15c6053104765b01b9f9bbc27281", "message": "Update unit tests", "committedDate": "2020-03-26T16:40:14Z", "type": "commit"}]}