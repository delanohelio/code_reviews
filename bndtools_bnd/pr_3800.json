{"pr_number": 3800, "pr_title": "fixed support for current java Versions in templates", "pr_author": "juergen-albert", "pr_createdAt": "2020-02-21T10:44:00Z", "pr_url": "https://github.com/bndtools/bnd/pull/3800", "timeline": [{"oid": "2f2657f7dd67878758f4ff653e17223bad11567a", "url": "https://github.com/bndtools/bnd/commit/2f2657f7dd67878758f4ff653e17223bad11567a", "message": "fixed support for current java Versions is templates\n\nFixes #3798 by replacing the bndtools specic JavaLevel Enum with the\nusage of the EE enum\n\nSigned-off-by: Juergen Albert <j.albert@data-in-motion.biz>", "committedDate": "2020-02-21T12:53:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjk1MTE5OA==", "url": "https://github.com/bndtools/bnd/pull/3800#discussion_r382951198", "body": "There is a slight behavioral difference here. `JavaLevel.fromLabel` would throw an IllegalArgumentException if the jre name was unknown. `EE.parse` will return null which will lead to an NPE when `getVersionLabel()` is called. So I think you need to check for null from `EE.parse` and throw an IllegalArgumentException then to preserve the semantics of this method.\r\n\r\n```java\r\nEE ee = EE.parse(jreName);\r\nif (ee == null) {\r\n  throw new IllegalArgumentException(\"Unrecognized Java compliance level: \" + jreName);\r\n}\r\nreturn ee.getVersionLabel();\r\n```", "bodyText": "There is a slight behavioral difference here. JavaLevel.fromLabel would throw an IllegalArgumentException if the jre name was unknown. EE.parse will return null which will lead to an NPE when getVersionLabel() is called. So I think you need to check for null from EE.parse and throw an IllegalArgumentException then to preserve the semantics of this method.\nEE ee = EE.parse(jreName);\nif (ee == null) {\n  throw new IllegalArgumentException(\"Unrecognized Java compliance level: \" + jreName);\n}\nreturn ee.getVersionLabel();", "bodyHTML": "<p dir=\"auto\">There is a slight behavioral difference here. <code>JavaLevel.fromLabel</code> would throw an IllegalArgumentException if the jre name was unknown. <code>EE.parse</code> will return null which will lead to an NPE when <code>getVersionLabel()</code> is called. So I think you need to check for null from <code>EE.parse</code> and throw an IllegalArgumentException then to preserve the semantics of this method.</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"EE ee = EE.parse(jreName);\nif (ee == null) {\n  throw new IllegalArgumentException(&quot;Unrecognized Java compliance level: &quot; + jreName);\n}\nreturn ee.getVersionLabel();\"><pre><span class=\"pl-smi\">EE</span> ee <span class=\"pl-k\">=</span> <span class=\"pl-c1\">EE</span><span class=\"pl-k\">.</span>parse(jreName);\n<span class=\"pl-k\">if</span> (ee <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>) {\n  <span class=\"pl-k\">throw</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">IllegalArgumentException</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Unrecognized Java compliance level: <span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">+</span> jreName);\n}\n<span class=\"pl-k\">return</span> ee<span class=\"pl-k\">.</span>getVersionLabel();</pre></div>", "author": "bjhargrave", "createdAt": "2020-02-23T00:03:08Z", "path": "bndtools.utils/src/org/bndtools/utils/javaproject/JavaProjectUtils.java", "diffHunk": "@@ -106,8 +77,8 @@ public static String getJavaLevel(IJavaProject project) throws Exception {\n \t\t\t\t\tcontinue;\n \t\t\t\tif (PATH_JRE_CONTAINER.equals(path.segment(0)) && PATH_JRE_STANDARD_VM.equals(path.segment(1))) {\n \t\t\t\t\tString jreName = path.segment(2);\n-\t\t\t\t\treturn JavaLevel.fromLabel(jreName)\n-\t\t\t\t\t\t.getLevel();\n+\t\t\t\t\treturn EE.parse(jreName)", "originalCommit": "2f2657f7dd67878758f4ff653e17223bad11567a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "30a1c894feb79cb874adb4fe54f57c10fc6312fc", "url": "https://github.com/bndtools/bnd/commit/30a1c894feb79cb874adb4fe54f57c10fc6312fc", "message": "fixed support for current java Versions in templates\n\nFixes #3798 by replacing the bndtools specific JavaLevel Enum with the\nusage of the EE Enum\n\nSigned-off-by: Juergen Albert <j.albert@data-in-motion.biz>", "committedDate": "2020-02-24T09:11:21Z", "type": "commit"}, {"oid": "30a1c894feb79cb874adb4fe54f57c10fc6312fc", "url": "https://github.com/bndtools/bnd/commit/30a1c894feb79cb874adb4fe54f57c10fc6312fc", "message": "fixed support for current java Versions in templates\n\nFixes #3798 by replacing the bndtools specific JavaLevel Enum with the\nusage of the EE Enum\n\nSigned-off-by: Juergen Albert <j.albert@data-in-motion.biz>", "committedDate": "2020-02-24T09:11:21Z", "type": "forcePushed"}]}