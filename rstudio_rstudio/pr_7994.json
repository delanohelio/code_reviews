{"pr_number": 7994, "pr_title": "Open source doc in new column", "pr_author": "melissa-barca", "pr_createdAt": "2020-10-07T16:25:11Z", "pr_url": "https://github.com/rstudio/rstudio/pull/7994", "merge_commit": "4e97d89747bc46f815663b860e808a66e1cd63ee", "timeline": [{"oid": "0ae5221b6f882fe5e5c6d8ce6623841b5b3a1fa0", "url": "https://github.com/rstudio/rstudio/commit/0ae5221b6f882fe5e5c6d8ce6623841b5b3a1fa0", "message": "add command to open source doc in new column", "committedDate": "2020-10-06T15:01:37Z", "type": "commit"}, {"oid": "43c8648eb37828cb697b6e24c8221f67cb773348", "url": "https://github.com/rstudio/rstudio/commit/43c8648eb37828cb697b6e24c8221f67cb773348", "message": "code clean up", "committedDate": "2020-10-06T15:14:14Z", "type": "commit"}, {"oid": "9da39447e9fede110542bf7d838e66d181d67415", "url": "https://github.com/rstudio/rstudio/commit/9da39447e9fede110542bf7d838e66d181d67415", "message": "fix exceptions", "committedDate": "2020-10-06T16:04:09Z", "type": "commit"}, {"oid": "dc805bee952488dac9dfd5573086e7780f094295", "url": "https://github.com/rstudio/rstudio/commit/dc805bee952488dac9dfd5573086e7780f094295", "message": "change keyboard command to fix conflict", "committedDate": "2020-10-07T21:59:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTM3NDY4NQ==", "url": "https://github.com/rstudio/rstudio/pull/7994#discussion_r501374685", "body": "This command needs to be disabled, and probably hidden, when the `allowSourceColumns` preference prevents it from working. I'd suggest handling that in the source column manager (i.e. bind a preference listener that sets the command to be enabled/visible based on the value of the pref). ", "bodyText": "This command needs to be disabled, and probably hidden, when the allowSourceColumns preference prevents it from working. I'd suggest handling that in the source column manager (i.e. bind a preference listener that sets the command to be enabled/visible based on the value of the pref).", "bodyHTML": "<p dir=\"auto\">This command needs to be disabled, and probably hidden, when the <code>allowSourceColumns</code> preference prevents it from working. I'd suggest handling that in the source column manager (i.e. bind a preference listener that sets the command to be enabled/visible based on the value of the pref).</p>", "author": "jmcphers", "createdAt": "2020-10-07T23:54:54Z", "path": "src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java", "diffHunk": "@@ -674,18 +675,51 @@ public void onFocusPreviousPane()\n    }\n \n    @Handler\n-    public void onNewSourceColumn()\n-    {\n-       if (!userPrefs_.allowSourceColumns().getValue())\n-          pGlobalDisplay_.get().showMessage(GlobalDisplay.MSG_INFO, \"Cannot Add Column\",\n-             \"Allow Source Columns preference is disabled.\");\n-       else if (additionalSourceCount_ >= MAX_COLUMN_COUNT)\n-          pGlobalDisplay_.get().showMessage(GlobalDisplay.MSG_INFO, \"Cannot Add Column\",\n-             \"You can't add more than \" + MAX_COLUMN_COUNT + \" columns.\");\n-       else\n-          createSourceColumn();\n-    }\n+   public void onNewSourceColumn()\n+   {\n+      if (validateNewColumnRequest())\n+         createAndDisplaySourceColumn();\n+   }\n+   \n+   @Handler\n+   public void onOpenSourceDocNewColumn()\n+   {\n+      if (validateNewColumnRequest())\n+      {\n+         ColumnName name = createSourceColumn();\n+         SourceColumn column = sourceColumnManager_.getByName(name.getName());\n+         column.incrementNewTabPending();\n+         panel_.addLeftWidget(\n+            createSourceColumnWindow(name.getName(),\n+               name.getAccessibleName()));\n+         sourceColumnManager_.setActive(column);\n+         Command onCancelled = () ->\n+         {\n+            column.decrementNewTabPending();\n+            closeSourceWindow(name.getName());\n+         };\n+         Command onCompleted = () -> column.decrementNewTabPending();\n+         source_.openSourceDoc(onCancelled, onCompleted);\n+      }\n+   }\n \n+   private boolean validateNewColumnRequest()\n+   {\n+      if (!userPrefs_.allowSourceColumns().getValue())\n+      {\n+         pGlobalDisplay_.get().showMessage(GlobalDisplay.MSG_INFO, \"Cannot Add Column\",\n+            \"Allow Source Columns preference is disabled.\");", "originalCommit": "dc805bee952488dac9dfd5573086e7780f094295", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTgxMjQ3NQ==", "url": "https://github.com/rstudio/rstudio/pull/7994#discussion_r501812475", "bodyText": "Good point, I've added a listener to SourceColumnManager to handle this as well as updated PaneManager to hide the commands when the max column count is reached.", "author": "melissa-barca", "createdAt": "2020-10-08T15:28:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTM3NDY4NQ=="}], "type": "inlineReview", "revised_code": {"commit": "e29ad4f3d7d2288b26436236916793dabf021af5", "changed_code": [{"header": "diff --git a/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java b/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\nindex cf9c099460..c0b90a3c5d 100644\n--- a/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\n+++ b/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\n", "chunk": "@@ -705,13 +713,7 @@ public class PaneManager\n \n    private boolean validateNewColumnRequest()\n    {\n-      if (!userPrefs_.allowSourceColumns().getValue())\n-      {\n-         pGlobalDisplay_.get().showMessage(GlobalDisplay.MSG_INFO, \"Cannot Add Column\",\n-            \"Allow Source Columns preference is disabled.\");\n-         return false;\n-      }\n-      else if (additionalSourceCount_ >= MAX_COLUMN_COUNT)\n+      if (additionalSourceCount_ >= MAX_COLUMN_COUNT)\n       {\n          pGlobalDisplay_.get().showMessage(GlobalDisplay.MSG_INFO, \"Cannot Add Column\",\n             \"You can't add more than \" + MAX_COLUMN_COUNT + \" columns.\");\n", "next_change": null}]}, "revised_code_in_main": {"commit": "4e97d89747bc46f815663b860e808a66e1cd63ee", "changed_code": [{"header": "diff --git a/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java b/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\nindex cf9c099460..aa24e2c29d 100644\n--- a/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\n+++ b/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\n", "chunk": "@@ -705,13 +712,7 @@ public class PaneManager\n \n    private boolean validateNewColumnRequest()\n    {\n-      if (!userPrefs_.allowSourceColumns().getValue())\n-      {\n-         pGlobalDisplay_.get().showMessage(GlobalDisplay.MSG_INFO, \"Cannot Add Column\",\n-            \"Allow Source Columns preference is disabled.\");\n-         return false;\n-      }\n-      else if (additionalSourceCount_ >= MAX_COLUMN_COUNT)\n+      if (additionalSourceCount_ >= MAX_COLUMN_COUNT)\n       {\n          pGlobalDisplay_.get().showMessage(GlobalDisplay.MSG_INFO, \"Cannot Add Column\",\n             \"You can't add more than \" + MAX_COLUMN_COUNT + \" columns.\");\n", "next_change": {"commit": "b84d2f0e3aa32762ce8fcd842391f62c6b9d2e51", "changed_code": [{"header": "diff --git a/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java b/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\nindex aa24e2c29d..9b13f1d46b 100644\n--- a/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\n+++ b/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\n", "chunk": "@@ -720,7 +714,7 @@ public class PaneManager\n       }\n       return true;\n    }\n-   \n+\n    private String getAdjacentWindow(LogicalWindow window, boolean before)\n    {\n       if (window.getNormal() == null)\n", "next_change": null}]}}]}, "commits_in_main": [{"oid": "4e97d89747bc46f815663b860e808a66e1cd63ee", "message": "Merge commit", "committedDate": null}, {"oid": "8b24ab85bae7cc15372d80458d3e2eb2c118deda", "committedDate": "2020-10-21 13:17:09 -0400", "message": "only sync columns on start up and when prompted"}, {"oid": "ddcd7191ec89c4da00e77afae7e9f27e61e87c36", "committedDate": "2021-01-03 21:03:43 -0800", "message": "bulk update copyright dates to 2021"}, {"oid": "b84d2f0e3aa32762ce8fcd842391f62c6b9d2e51", "committedDate": "2021-01-11 13:19:15 -0800", "message": "refactor final batch of events to single-file model"}, {"oid": "c20156a8f01be1f6e56a36900f650fe3657ec9ec", "committedDate": "2021-01-11 16:03:20 -0800", "message": "cleanup hard-tabs that have crept into source files"}, {"oid": "29f72fdfe03e8b08fc489dc743d60fb251b314c2", "committedDate": "2021-01-27 15:51:59 -0500", "message": "when restoring panes to \"normal\", keep panes without any tabs minimized"}, {"oid": "6dd9859082c8cc35f4cb08fc19cae4dae492f0b4", "committedDate": "2021-01-27 16:29:06 -0500", "message": "hide empty tab panes and show newly populated tab panes on preference updates"}, {"oid": "2847dc7389e03b1669af6d56c754f8b2aaf6a0b4", "committedDate": "2021-02-02 11:39:05 -0500", "message": "fix bugs when changes applied to Pane Layout"}, {"oid": "65e9ffbc258e241b6061e7e19d9a0bfb9ca5611d", "committedDate": "2021-02-10 12:19:55 -0800", "message": "move version label to left"}, {"oid": "8ad7d438183b5128e0ba87296a52216626e6a833", "committedDate": "2021-02-26 13:21:14 -0800", "message": "Revert \"Remove dead code for unused Tests tab\""}, {"oid": "4cd9558a762b640b689776c2b330f3b457028336", "committedDate": "2021-06-10 06:05:41 -0400", "message": "eliminate eclipse warnings"}, {"oid": "fb9ad8192df79004e1b0bdaf3a30fabcd89b6ab1", "committedDate": "2021-09-13 12:30:51 -0700", "message": "Add commands to open selected files in columns or active editor"}, {"oid": "ec5317c5a649efd12ae3a83b227743bc095da68e", "committedDate": "2021-09-14 08:49:32 -0700", "message": "Adjust indentations and some formatting to better follow standards."}, {"oid": "617ea23faf56b4f2287df443980386955ac741b2", "committedDate": "2021-09-27 09:14:29 -0400", "message": "initial stub for presentation pane"}, {"oid": "47170a63bec3428b18ff5c033cf90e00584bc360", "committedDate": "2021-09-29 13:46:47 -0400", "message": "use \"presentations\" rather than \"presentation2\" for compatibility with pane config ui"}, {"oid": "d8d2472a2e2e15cb87ebf0ab53edf089bb3c2ea8", "committedDate": "2021-09-29 21:20:50 -0400", "message": "focus presentation tab when explicitly activated"}, {"oid": "2bfe6ba6be08889e2793e9e2cb659846331de31e", "committedDate": "2021-11-04 11:27:07 -0700", "message": "remove invocations of isFlat"}, {"oid": "6eac0da598765e961f297ddfce4507031ce69073", "committedDate": "2021-12-02 20:02:54 -0500", "message": "eliminate eclipse warnings"}, {"oid": "17c431c402b5ed6a0639c45bf1aff3e620d9c2fa", "committedDate": "2021-12-07 11:33:51 -0500", "message": "feat(i18n): i18n-ify missed literals"}, {"oid": "04891e0ce1843c68ee6908695cc05161dc386735", "committedDate": "2021-12-07 14:02:01 -0500", "message": "Merge branch 'main' into rohan-i18nify-client-workbench-pt1"}, {"oid": "463bc58d8787c544f90fab29e4414ca967e3961a", "committedDate": "2021-12-08 08:17:12 -0500", "message": "fix(i18n): Implement change requests"}, {"oid": "8f85b6b8ed4e7db1ac167b2007d17e26c947e4fd", "committedDate": "2022-01-03 16:05:46 -0800", "message": "bump copyright to 2022"}, {"oid": "893ffe22120efb2e7dddccc09d74641623072313", "committedDate": "2022-04-19 15:41:13 -0600", "message": "console and terminal"}, {"oid": "7d394bbba5f7ebdf46d7224ddc8b7c9295b47ec2", "committedDate": "2022-04-25 15:47:12 -0600", "message": "use constants for internal quadrant names"}, {"oid": "154b5be39c20b7292b5804e77c7c2953d6d05d86", "committedDate": "2022-04-25 16:16:45 -0600", "message": "constants for pane/tab names"}, {"oid": "72451ff653c5eaf5bc372d45dc0410930745ea27", "committedDate": "2022-04-25 16:54:02 -0600", "message": "use pane constants instead of string literals"}, {"oid": "d48ff068d8c84716fc5836df19abeb8f44175f7b", "committedDate": "2022-09-13 13:22:13 -0400", "message": "Update copyright to Posit"}, {"oid": "fdfd3c23cf2889f5553cfc1ed49091b6d9d03430", "committedDate": "2022-09-13 13:22:15 -0400", "message": "Posit Software PBC"}, {"oid": "5ecd209673e476549955cc5c8b2f636269c61712", "committedDate": "2022-09-15 10:45:30 -0400", "message": "more rebranding copyright update"}]}, {"oid": "e29ad4f3d7d2288b26436236916793dabf021af5", "url": "https://github.com/rstudio/rstudio/commit/e29ad4f3d7d2288b26436236916793dabf021af5", "message": "disable and hide multiple source column commands when `Allow Source Columns` is off.", "committedDate": "2020-10-08T15:26:26Z", "type": "commit"}, {"oid": "9ca69c40b31564e15f89b44bb6b0352e92d30bed", "url": "https://github.com/rstudio/rstudio/commit/9ca69c40b31564e15f89b44bb6b0352e92d30bed", "message": "add image for Open In New Column command", "committedDate": "2020-10-08T15:27:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg0NjQwOQ==", "url": "https://github.com/rstudio/rstudio/pull/7994#discussion_r501846409", "body": "Here and below: it makes sense to disable the first two commands if we're already maxed out for columns (since they create columns), but it seems to me like the third shouldn't be affected. What do you think?", "bodyText": "Here and below: it makes sense to disable the first two commands if we're already maxed out for columns (since they create columns), but it seems to me like the third shouldn't be affected. What do you think?", "bodyHTML": "<p dir=\"auto\">Here and below: it makes sense to disable the first two commands if we're already maxed out for columns (since they create columns), but it seems to me like the third shouldn't be affected. What do you think?</p>", "author": "jmcphers", "createdAt": "2020-10-08T16:17:03Z", "path": "src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java", "diffHunk": "@@ -382,6 +382,14 @@ else if (numDocs > 0 && window.getState() == WindowState.HIDE)\n          hiddenTabs_ = tabNamesToTabs(evt.getValue().getHiddenTabSet());\n          populateTabPanel(hiddenTabs_, hiddenTabSetTabPanel_, hiddenTabSetMinPanel_);\n \n+         // manage source column commands\n+         boolean visible = userPrefs.allowSourceColumns().getValue() &&\n+            (userPrefs.panes().getValue().getAdditionalSourceColumns() < MAX_COLUMN_COUNT);\n+         \n+         commands_.newSourceColumn().setVisible(visible);\n+         commands_.openSourceDocNewColumn().setVisible(visible);\n+         commands_.focusSourceColumnSeparator().setVisible(visible);", "originalCommit": "e29ad4f3d7d2288b26436236916793dabf021af5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg2MDEzMQ==", "url": "https://github.com/rstudio/rstudio/pull/7994#discussion_r501860131", "bodyText": "You're right, fixed it.", "author": "melissa-barca", "createdAt": "2020-10-08T16:38:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg0NjQwOQ=="}], "type": "inlineReview", "revised_code": {"commit": "15d03041a4b6c9fb89057886b90e434abd44ac06", "changed_code": [{"header": "diff --git a/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java b/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\nindex c0b90a3c5d..aa24e2c29d 100644\n--- a/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\n+++ b/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\n", "chunk": "@@ -388,7 +388,6 @@ public class PaneManager\n          \n          commands_.newSourceColumn().setVisible(visible);\n          commands_.openSourceDocNewColumn().setVisible(visible);\n-         commands_.focusSourceColumnSeparator().setVisible(visible);\n \n          manageLayoutCommands();\n       });\n", "next_change": null}]}, "revised_code_in_main": {"commit": "4e97d89747bc46f815663b860e808a66e1cd63ee", "changed_code": [{"header": "diff --git a/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java b/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\nindex c0b90a3c5d..aa24e2c29d 100644\n--- a/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\n+++ b/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\n", "chunk": "@@ -388,7 +388,6 @@ public class PaneManager\n          \n          commands_.newSourceColumn().setVisible(visible);\n          commands_.openSourceDocNewColumn().setVisible(visible);\n-         commands_.focusSourceColumnSeparator().setVisible(visible);\n \n          manageLayoutCommands();\n       });\n", "next_change": {"commit": "b84d2f0e3aa32762ce8fcd842391f62c6b9d2e51", "changed_code": [{"header": "diff --git a/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java b/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\nindex aa24e2c29d..9b13f1d46b 100644\n--- a/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\n+++ b/src/gwt/src/org/rstudio/studio/client/workbench/ui/PaneManager.java\n", "chunk": "@@ -385,7 +384,7 @@ public class PaneManager\n          // manage source column commands\n          boolean visible = userPrefs.allowSourceColumns().getValue() &&\n             (userPrefs.panes().getValue().getAdditionalSourceColumns() < MAX_COLUMN_COUNT);\n-         \n+\n          commands_.newSourceColumn().setVisible(visible);\n          commands_.openSourceDocNewColumn().setVisible(visible);\n \n", "next_change": null}]}}]}, "commits_in_main": [{"oid": "4e97d89747bc46f815663b860e808a66e1cd63ee", "message": "Merge commit", "committedDate": null}, {"oid": "8b24ab85bae7cc15372d80458d3e2eb2c118deda", "committedDate": "2020-10-21 13:17:09 -0400", "message": "only sync columns on start up and when prompted"}, {"oid": "ddcd7191ec89c4da00e77afae7e9f27e61e87c36", "committedDate": "2021-01-03 21:03:43 -0800", "message": "bulk update copyright dates to 2021"}, {"oid": "b84d2f0e3aa32762ce8fcd842391f62c6b9d2e51", "committedDate": "2021-01-11 13:19:15 -0800", "message": "refactor final batch of events to single-file model"}, {"oid": "c20156a8f01be1f6e56a36900f650fe3657ec9ec", "committedDate": "2021-01-11 16:03:20 -0800", "message": "cleanup hard-tabs that have crept into source files"}, {"oid": "29f72fdfe03e8b08fc489dc743d60fb251b314c2", "committedDate": "2021-01-27 15:51:59 -0500", "message": "when restoring panes to \"normal\", keep panes without any tabs minimized"}, {"oid": "6dd9859082c8cc35f4cb08fc19cae4dae492f0b4", "committedDate": "2021-01-27 16:29:06 -0500", "message": "hide empty tab panes and show newly populated tab panes on preference updates"}, {"oid": "2847dc7389e03b1669af6d56c754f8b2aaf6a0b4", "committedDate": "2021-02-02 11:39:05 -0500", "message": "fix bugs when changes applied to Pane Layout"}, {"oid": "65e9ffbc258e241b6061e7e19d9a0bfb9ca5611d", "committedDate": "2021-02-10 12:19:55 -0800", "message": "move version label to left"}, {"oid": "8ad7d438183b5128e0ba87296a52216626e6a833", "committedDate": "2021-02-26 13:21:14 -0800", "message": "Revert \"Remove dead code for unused Tests tab\""}, {"oid": "4cd9558a762b640b689776c2b330f3b457028336", "committedDate": "2021-06-10 06:05:41 -0400", "message": "eliminate eclipse warnings"}, {"oid": "fb9ad8192df79004e1b0bdaf3a30fabcd89b6ab1", "committedDate": "2021-09-13 12:30:51 -0700", "message": "Add commands to open selected files in columns or active editor"}, {"oid": "ec5317c5a649efd12ae3a83b227743bc095da68e", "committedDate": "2021-09-14 08:49:32 -0700", "message": "Adjust indentations and some formatting to better follow standards."}, {"oid": "617ea23faf56b4f2287df443980386955ac741b2", "committedDate": "2021-09-27 09:14:29 -0400", "message": "initial stub for presentation pane"}, {"oid": "47170a63bec3428b18ff5c033cf90e00584bc360", "committedDate": "2021-09-29 13:46:47 -0400", "message": "use \"presentations\" rather than \"presentation2\" for compatibility with pane config ui"}, {"oid": "d8d2472a2e2e15cb87ebf0ab53edf089bb3c2ea8", "committedDate": "2021-09-29 21:20:50 -0400", "message": "focus presentation tab when explicitly activated"}, {"oid": "2bfe6ba6be08889e2793e9e2cb659846331de31e", "committedDate": "2021-11-04 11:27:07 -0700", "message": "remove invocations of isFlat"}, {"oid": "6eac0da598765e961f297ddfce4507031ce69073", "committedDate": "2021-12-02 20:02:54 -0500", "message": "eliminate eclipse warnings"}, {"oid": "17c431c402b5ed6a0639c45bf1aff3e620d9c2fa", "committedDate": "2021-12-07 11:33:51 -0500", "message": "feat(i18n): i18n-ify missed literals"}, {"oid": "04891e0ce1843c68ee6908695cc05161dc386735", "committedDate": "2021-12-07 14:02:01 -0500", "message": "Merge branch 'main' into rohan-i18nify-client-workbench-pt1"}, {"oid": "463bc58d8787c544f90fab29e4414ca967e3961a", "committedDate": "2021-12-08 08:17:12 -0500", "message": "fix(i18n): Implement change requests"}, {"oid": "8f85b6b8ed4e7db1ac167b2007d17e26c947e4fd", "committedDate": "2022-01-03 16:05:46 -0800", "message": "bump copyright to 2022"}, {"oid": "893ffe22120efb2e7dddccc09d74641623072313", "committedDate": "2022-04-19 15:41:13 -0600", "message": "console and terminal"}, {"oid": "7d394bbba5f7ebdf46d7224ddc8b7c9295b47ec2", "committedDate": "2022-04-25 15:47:12 -0600", "message": "use constants for internal quadrant names"}, {"oid": "154b5be39c20b7292b5804e77c7c2953d6d05d86", "committedDate": "2022-04-25 16:16:45 -0600", "message": "constants for pane/tab names"}, {"oid": "72451ff653c5eaf5bc372d45dc0410930745ea27", "committedDate": "2022-04-25 16:54:02 -0600", "message": "use pane constants instead of string literals"}, {"oid": "d48ff068d8c84716fc5836df19abeb8f44175f7b", "committedDate": "2022-09-13 13:22:13 -0400", "message": "Update copyright to Posit"}, {"oid": "fdfd3c23cf2889f5553cfc1ed49091b6d9d03430", "committedDate": "2022-09-13 13:22:15 -0400", "message": "Posit Software PBC"}, {"oid": "5ecd209673e476549955cc5c8b2f636269c61712", "committedDate": "2022-09-15 10:45:30 -0400", "message": "more rebranding copyright update"}]}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg0NzM3Ng==", "url": "https://github.com/rstudio/rstudio/pull/7994#discussion_r501847376", "body": "It's not totally clear to me why we need this code in both places ... doesn't this handler run at startup? (if not, maybe make a function that's called both at startup and in the value change handler?)", "bodyText": "It's not totally clear to me why we need this code in both places ... doesn't this handler run at startup? (if not, maybe make a function that's called both at startup and in the value change handler?)", "bodyHTML": "<p dir=\"auto\">It's not totally clear to me why we need this code in both places ... doesn't this handler run at startup? (if not, maybe make a function that's called both at startup and in the value change handler?)</p>", "author": "jmcphers", "createdAt": "2020-10-08T16:18:37Z", "path": "src/gwt/src/org/rstudio/studio/client/workbench/views/source/SourceColumnManager.java", "diffHunk": "@@ -242,6 +243,23 @@ public void onSwitchToDoc(SwitchToDocEvent event)\n          }\n       });\n \n+      userPrefs.allowSourceColumns().addValueChangeHandler(event ->\n+      {\n+         // PaneManager helps manage these commands so when modifying this code, update ", "originalCommit": "e29ad4f3d7d2288b26436236916793dabf021af5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg1NjE4NA==", "url": "https://github.com/rstudio/rstudio/pull/7994#discussion_r501856184", "bodyText": "PaneManager just needs to help with commands that need to be adjusted based on the max column count. It tracks this because it's actually responsible for adding and removing the windows that contain the columns. I'll update the comment to be more specific. I was grouping all the commands into that category when I shouldn't have been.", "author": "melissa-barca", "createdAt": "2020-10-08T16:32:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg0NzM3Ng=="}], "type": "inlineReview", "revised_code": {"commit": "15d03041a4b6c9fb89057886b90e434abd44ac06", "changed_code": [{"header": "diff --git a/src/gwt/src/org/rstudio/studio/client/workbench/views/source/SourceColumnManager.java b/src/gwt/src/org/rstudio/studio/client/workbench/views/source/SourceColumnManager.java\nindex dfa6f56ccc..85a14324a7 100644\n--- a/src/gwt/src/org/rstudio/studio/client/workbench/views/source/SourceColumnManager.java\n+++ b/src/gwt/src/org/rstudio/studio/client/workbench/views/source/SourceColumnManager.java\n", "chunk": "@@ -245,9 +245,13 @@ public class SourceColumnManager implements CommandPaletteEntrySource,\n \n       userPrefs.allowSourceColumns().addValueChangeHandler(event ->\n       {\n-         // PaneManager helps manage these commands so when modifying this code, update \n-         // the change handler there as well.\n          boolean enabled = userPrefs.allowSourceColumns().getValue();\n+         commands_.focusSourceColumnSeparator().setEnabled(enabled);\n+         commands_.focusSourceColumnSeparator().setVisible(enabled);\n+\n+         // The visibility of the following commands is in part determined by if we've reached \n+         // the max number of source columns allowed. PaneManager helps manage these commands so\n+         // when modifying this code, update the change handler there as well.\n          boolean visible = enabled && columnList_.size() <= PaneManager.MAX_COLUMN_COUNT + 1;\n \n          commands_.newSourceColumn().setEnabled(enabled);\n", "next_change": null}]}, "revised_code_in_main": {"commit": "4e97d89747bc46f815663b860e808a66e1cd63ee", "changed_code": [{"header": "diff --git a/src/gwt/src/org/rstudio/studio/client/workbench/views/source/SourceColumnManager.java b/src/gwt/src/org/rstudio/studio/client/workbench/views/source/SourceColumnManager.java\nindex dfa6f56ccc..85a14324a7 100644\n--- a/src/gwt/src/org/rstudio/studio/client/workbench/views/source/SourceColumnManager.java\n+++ b/src/gwt/src/org/rstudio/studio/client/workbench/views/source/SourceColumnManager.java\n", "chunk": "@@ -245,9 +245,13 @@ public class SourceColumnManager implements CommandPaletteEntrySource,\n \n       userPrefs.allowSourceColumns().addValueChangeHandler(event ->\n       {\n-         // PaneManager helps manage these commands so when modifying this code, update \n-         // the change handler there as well.\n          boolean enabled = userPrefs.allowSourceColumns().getValue();\n+         commands_.focusSourceColumnSeparator().setEnabled(enabled);\n+         commands_.focusSourceColumnSeparator().setVisible(enabled);\n+\n+         // The visibility of the following commands is in part determined by if we've reached \n+         // the max number of source columns allowed. PaneManager helps manage these commands so\n+         // when modifying this code, update the change handler there as well.\n          boolean visible = enabled && columnList_.size() <= PaneManager.MAX_COLUMN_COUNT + 1;\n \n          commands_.newSourceColumn().setEnabled(enabled);\n", "next_change": {"commit": "b84d2f0e3aa32762ce8fcd842391f62c6b9d2e51", "changed_code": [{"header": "diff --git a/src/gwt/src/org/rstudio/studio/client/workbench/views/source/SourceColumnManager.java b/src/gwt/src/org/rstudio/studio/client/workbench/views/source/SourceColumnManager.java\nindex 85a14324a7..0611da3908 100644\n--- a/src/gwt/src/org/rstudio/studio/client/workbench/views/source/SourceColumnManager.java\n+++ b/src/gwt/src/org/rstudio/studio/client/workbench/views/source/SourceColumnManager.java\n", "chunk": "@@ -249,17 +268,17 @@ public class SourceColumnManager implements CommandPaletteEntrySource,\n          commands_.focusSourceColumnSeparator().setEnabled(enabled);\n          commands_.focusSourceColumnSeparator().setVisible(enabled);\n \n-         // The visibility of the following commands is in part determined by if we've reached \n+         // The visibility of the following commands is in part determined by if we've reached\n          // the max number of source columns allowed. PaneManager helps manage these commands so\n          // when modifying this code, update the change handler there as well.\n          boolean visible = enabled && columnList_.size() <= PaneManager.MAX_COLUMN_COUNT + 1;\n \n          commands_.newSourceColumn().setEnabled(enabled);\n          commands_.newSourceColumn().setVisible(visible);\n-           \n+\n          commands_.openSourceDocNewColumn().setEnabled(enabled);\n          commands_.openSourceDocNewColumn().setVisible(visible);\n-         \n+\n       });\n \n       sourceNavigationHistory_.addChangeHandler(event -> manageSourceNavigationCommands());\n", "next_change": null}]}}]}, "commits_in_main": [{"oid": "4e97d89747bc46f815663b860e808a66e1cd63ee", "message": "Merge commit", "committedDate": null}, {"oid": "85f303c788acf84fda1ee4a7881cd1cdf7afaa5a", "committedDate": "2020-10-16 13:52:40 -0700", "message": "reset active editor before closing all other source docs (#8095)"}, {"oid": "50b7b9969488902bd715450cd7f706baadc58e0a", "committedDate": "2020-10-19 14:02:18 -0700", "message": "prevent exception with Close All (#8109)"}, {"oid": "757a1ac15a1f66bad843844983274e3ab374bf4c", "committedDate": "2020-10-19 18:30:41 -0400", "message": "consolidate disownDoc functions so they both reset the active editor"}, {"oid": "2f7fbf2606bfb79880de22860597ba8c06252bbf", "committedDate": "2020-10-21 09:29:27 -0400", "message": "Use modal return focus handlers in ModalPopupPanel"}, {"oid": "9fe064cff90275090287ceb1127c4baf13264a7e", "committedDate": "2020-10-30 13:08:49 -0700", "message": "update save commands on window focus"}, {"oid": "6758f67641e7316a9d2cc27909baf89de63cfdba", "committedDate": "2020-11-06 13:24:29 -0800", "message": "Fix Close All Except Current with unsaved files (#8311)"}, {"oid": "082a93178db271ceee256bbccea69279276a566a", "committedDate": "2020-11-11 18:44:36 -0800", "message": "add context-menu to document tabs"}, {"oid": "cba501a6f653461986b0d155e6dd74aa48b89c51", "committedDate": "2020-11-12 10:04:17 -0500", "message": "if files are moves to the main source pane, ensure it is visible"}, {"oid": "33475d2b73a17538a51fdea6e645430e93f1f423", "committedDate": "2020-11-12 15:50:13 -0800", "message": "Merge branch 'v1.4-juliet-rose' into feature/doc-tab-context-menu"}, {"oid": "2d304def6c733523abaa1d02fc004d819dfd7079", "committedDate": "2020-11-14 19:22:20 -0800", "message": "fix vim close-all command"}, {"oid": "a8b22e4cccbbb7e77e0da5d6e31050f088247ac6", "committedDate": "2020-11-15 11:53:57 -0800", "message": "eliminate excludeActive flag and just use excludeDocId"}, {"oid": "bfc2790bde0b437c9cb2c1eca18483190825d4fb", "committedDate": "2020-11-16 09:29:28 -0800", "message": "Merge remote-tracking branch 'origin/v1.4-juliet-rose' into feature/doc-tab-context-menu"}, {"oid": "117e969ae79816a20b09de6543da391df0ae5d1a", "committedDate": "2020-11-18 12:07:53 -0800", "message": "provide an internal API for closing all source tabs without saving"}, {"oid": "b2a503edc549ee27bebe37cf281df63d64741c46", "committedDate": "2020-11-18 13:45:38 -0800", "message": "Merge remote-tracking branch 'origin/master' into v1.4-juliet-rose"}, {"oid": "ac764319c6647365cdc6e65d90949356c1c668b6", "committedDate": "2020-11-19 13:44:12 -0500", "message": "fix closeAllSourceBuffersWithoutSaving to silently close modified unsaved files (#8440)"}, {"oid": "a7aff7df4ce08755a7a86c24315742bc88b78cc8", "committedDate": "2020-11-19 17:59:37 -0800", "message": "Merge remote-tracking branch 'origin/master' into v1.4-juliet-rose"}, {"oid": "cf1d182b0ba6718de81a6c9493e1df5e4bd786a8", "committedDate": "2020-11-20 14:45:11 -0800", "message": "fixup code after merging master to v1.4-juliet-rose"}, {"oid": "71c6b9d4399e09d71e0328b3a4e9f8a89912a98a", "committedDate": "2020-12-16 14:47:04 -0800", "message": "refactor palette entry providers"}, {"oid": "ddcd7191ec89c4da00e77afae7e9f27e61e87c36", "committedDate": "2021-01-03 21:03:43 -0800", "message": "bulk update copyright dates to 2021"}, {"oid": "c2f82509d3fb8755ec89a4d2b41bda7578379e5d", "committedDate": "2021-01-04 09:28:07 -0800", "message": "Merge remote-tracking branch 'origin/master' into v1.4-juliet-rose"}, {"oid": "011d10e29dd1985701b8f53cf03c8df506702628", "committedDate": "2021-01-08 15:07:55 -0800", "message": "mechanical refactor, replace explicit type with <>"}, {"oid": "b84d2f0e3aa32762ce8fcd842391f62c6b9d2e51", "committedDate": "2021-01-11 13:19:15 -0800", "message": "refactor final batch of events to single-file model"}, {"oid": "9d73a1d6b7aea914b472773d629b02aa6e367da6", "committedDate": "2021-02-03 16:42:25 -0800", "message": "ensure Close of modified file via context menu prompts to save"}, {"oid": "5d42b475a6e8428415ba8aeee669f24593730f75", "committedDate": "2021-02-04 15:30:30 -0800", "message": "fix issue with close all other context menu closing everything"}, {"oid": "cb8772e26d47b19bb48bd726dc4c5a21967117ee", "committedDate": "2021-02-05 09:59:12 -0800", "message": "remove unnecessary check of activeColumn_"}, {"oid": "ca311da5b1ab819312cfce7521c3a314d4ffd78e", "committedDate": "2021-06-06 09:55:38 -0400", "message": "initial work on qmd"}, {"oid": "bbf5295aa655968f27e990059ac09f802c7d24d1", "committedDate": "2021-06-07 13:36:14 -0400", "message": "remove qmd render work"}, {"oid": "e3c1eca5802d901b0ced605ae7700bbde848de96", "committedDate": "2021-06-07 13:39:51 -0400", "message": "qmd file type"}, {"oid": "c17d6c3db1d49c3ba7387ee18e5c732cb47f8de0", "committedDate": "2021-06-10 07:10:03 -0400", "message": "new quarto doc command"}, {"oid": "096019b6d8a80f19192153da62aca3bc5cbabed7", "committedDate": "2021-06-14 07:25:45 -0400", "message": "scaffold new qmd command"}, {"oid": "e25813f6c9430e1c69fe84580326384a040ae9a0", "committedDate": "2021-08-04 15:24:03 -0400", "message": "Fix for inability to run shiny interative docs from server.R"}, {"oid": "fb9ad8192df79004e1b0bdaf3a30fabcd89b6ab1", "committedDate": "2021-09-13 12:30:51 -0700", "message": "Add commands to open selected files in columns or active editor"}, {"oid": "5adc32552110ad8b1db8a02768ddc28b9ec52355", "committedDate": "2021-09-17 14:16:51 -0400", "message": "respect editor mode preference in quarto project/document yaml"}, {"oid": "a61564f6586b6d44685987f896c877a7fdd731a2", "committedDate": "2021-09-20 11:52:25 -0400", "message": "visual editor option for new quarto project"}, {"oid": "1e0110b12753eb69605c35c4f4e5ec24a2e63f48", "committedDate": "2021-09-20 08:55:04 -0700", "message": "Merge pull request #9834 from rstudio/feature/open-files-in-columns"}, {"oid": "318c49a66b6fd23b51fb3564ea7172657e1e9550", "committedDate": "2021-10-10 08:36:35 -0400", "message": "separate command for new quarto pres"}, {"oid": "abf845993c9d2572ed7ec3d9feac5165a687ed79", "committedDate": "2021-10-10 11:25:01 -0400", "message": "use standard document templates for new quarto doc/pres"}, {"oid": "1e6c9fcec722466787cff508c621b277fad95b62", "committedDate": "2021-10-11 08:33:30 -0400", "message": "initial work on templates; move quarto commands to their own source file"}, {"oid": "2796e02ef717f802178653f645905a66af53413d", "committedDate": "2021-12-02 11:25:48 -0500", "message": "feat(i18n) workbench-views-source"}, {"oid": "7daf2b02615158a66682fe74132e3ab26a86a171", "committedDate": "2021-12-06 20:39:06 -0500", "message": "fix(address review requests"}, {"oid": "ac5c3175a17fee8b268a9a0957620b40db7740a6", "committedDate": "2021-12-10 15:23:24 -0500", "message": "fix(i18n): clean-up few literals and i18n-ify missed literals"}, {"oid": "8f85b6b8ed4e7db1ac167b2007d17e26c947e4fd", "committedDate": "2022-01-03 16:05:46 -0800", "message": "bump copyright to 2022"}, {"oid": "305872a66d909531b299f3ebf113bfa9796be2c3", "committedDate": "2022-02-11 13:21:08 -0800", "message": "`.rs.api.documentOpen()` scrolls into view (#10545)"}, {"oid": "ec781aad4a3be2398a2ec0cb8b7678934ed59ff4", "committedDate": "2022-04-06 11:58:07 -0700", "message": "allow request for editor context by id (#10872)"}, {"oid": "2a15d3000f7f2e246040f04f5a1f69bcc684dd74", "committedDate": "2022-05-31 11:50:46 -0400", "message": "more string updates"}, {"oid": "5eb4d4917baea5125d13c2176027b95281816220", "committedDate": "2022-06-27 11:10:45 -0700", "message": "use standard loop so that early return actually returns (#11501)"}, {"oid": "a6863002e56a26f54e2ecfe944e15cafabc331f9", "committedDate": "2022-08-23 12:52:42 +0200", "message": "Live updates for object explorer (#11781)"}, {"oid": "d48ff068d8c84716fc5836df19abeb8f44175f7b", "committedDate": "2022-09-13 13:22:13 -0400", "message": "Update copyright to Posit"}, {"oid": "fdfd3c23cf2889f5553cfc1ed49091b6d9d03430", "committedDate": "2022-09-13 13:22:15 -0400", "message": "Posit Software PBC"}, {"oid": "39cca8f93b347c05e03921ff9ed1527fb1e9af42", "committedDate": "2022-09-13 11:44:12 -0700", "message": "switch from data viewer and object  explorer viewer if object type changes (#11910)"}, {"oid": "9ce4a0fec4e7cc608995581eac809d0fe22c68cb", "committedDate": "2022-09-14 10:17:32 -0400", "message": "Merge pull request #11765 from rstudio/feature/rebrand_company_name"}, {"oid": "5ecd209673e476549955cc5c8b2f636269c61712", "committedDate": "2022-09-15 10:45:30 -0400", "message": "more rebranding copyright update"}, {"oid": "1e2190f9ebb052d4e8e1dbd46be619972dbc2336", "committedDate": "2022-11-25 10:49:39 +0100", "message": "glimpse for `COLUMN` and `DATAFRAME` completion popups (#12309)"}]}, {"oid": "15d03041a4b6c9fb89057886b90e434abd44ac06", "url": "https://github.com/rstudio/rstudio/commit/15d03041a4b6c9fb89057886b90e434abd44ac06", "message": "don't adjust command when source column max is reached", "committedDate": "2020-10-08T16:37:55Z", "type": "commit"}, {"oid": "082296521091a285251da6839e8f5847ffaed372", "url": "https://github.com/rstudio/rstudio/commit/082296521091a285251da6839e8f5847ffaed372", "message": "remove keyboard shortcut", "committedDate": "2020-10-12T17:33:16Z", "type": "commit"}]}