{"pr_number": 1620, "pr_title": "Hive: Fix TestHiveMetastore worker exhaustion", "pr_author": "pvary", "pr_createdAt": "2020-10-16T09:13:11Z", "pr_url": "https://github.com/apache/iceberg/pull/1620", "timeline": [{"oid": "877e145ecd4d06a34afd0c073ffb9a2cc767b2ef", "url": "https://github.com/apache/iceberg/commit/877e145ecd4d06a34afd0c073ffb9a2cc767b2ef", "message": "Fix TestHiveMetastore worker exhaustion", "committedDate": "2020-10-16T05:45:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjYwMTY4MQ==", "url": "https://github.com/apache/iceberg/pull/1620#discussion_r506601681", "body": "I don't think we should change these values for the majority of Hive tests, or at least Hive Metastore tests, because this has helped us track down connection leaks. It sounds like we should change these for HiveRunner tests, where we have less control of the connections. If Hive itself doesn't pool or close connections, then we would need to bump this up.\r\n\r\nCould you make this configurable so that we can set it for the tests that need it?", "bodyText": "I don't think we should change these values for the majority of Hive tests, or at least Hive Metastore tests, because this has helped us track down connection leaks. It sounds like we should change these for HiveRunner tests, where we have less control of the connections. If Hive itself doesn't pool or close connections, then we would need to bump this up.\nCould you make this configurable so that we can set it for the tests that need it?", "bodyHTML": "<p dir=\"auto\">I don't think we should change these values for the majority of Hive tests, or at least Hive Metastore tests, because this has helped us track down connection leaks. It sounds like we should change these for HiveRunner tests, where we have less control of the connections. If Hive itself doesn't pool or close connections, then we would need to bump this up.</p>\n<p dir=\"auto\">Could you make this configurable so that we can set it for the tests that need it?</p>", "author": "rdblue", "createdAt": "2020-10-16T16:55:03Z", "path": "hive-metastore/src/test/java/org/apache/iceberg/hive/TestHiveMetastore.java", "diffHunk": "@@ -166,8 +166,8 @@ private TServer newThriftServer(TServerSocket socket, HiveConf conf) throws Exce\n         .processor(new TSetIpAddressProcessor<>(handler))\n         .transportFactory(new TTransportFactory())\n         .protocolFactory(new TBinaryProtocol.Factory())\n-        .minWorkerThreads(3)\n-        .maxWorkerThreads(5);\n+        .minWorkerThreads(5)\n+        .maxWorkerThreads(15);", "originalCommit": "877e145ecd4d06a34afd0c073ffb9a2cc767b2ef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzUyOTIwOA==", "url": "https://github.com/apache/iceberg/pull/1620#discussion_r507529208", "bodyText": "Created the new PR: #1629", "author": "pvary", "createdAt": "2020-10-19T07:29:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjYwMTY4MQ=="}], "type": "inlineReview"}]}