{"pr_number": 1099, "pr_title": "Combine ManifestReaders into one parameterized class", "pr_author": "rdblue", "pr_createdAt": "2020-06-05T22:28:36Z", "pr_url": "https://github.com/apache/iceberg/pull/1099", "timeline": [{"oid": "e33a3bdaa199738a7f604136b64f1cc14b2f8a14", "url": "https://github.com/apache/iceberg/commit/e33a3bdaa199738a7f604136b64f1cc14b2f8a14", "message": "Combine ManifestReaders into one parameterized class.", "committedDate": "2020-06-05T22:24:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE5MjQ1MA==", "url": "https://github.com/apache/iceberg/pull/1099#discussion_r436192450", "body": "Note that these aren't public.", "bodyText": "Note that these aren't public.", "bodyHTML": "<p dir=\"auto\">Note that these aren't public.</p>", "author": "rdblue", "createdAt": "2020-06-05T22:30:14Z", "path": "core/src/main/java/org/apache/iceberg/ManifestFiles.java", "diffHunk": "@@ -133,13 +134,29 @@ public static DeleteManifestReader readDeleteManifest(ManifestFile manifest, Fil\n     throw new UnsupportedOperationException(\"Cannot write manifest for table version: \" + formatVersion);\n   }\n \n+  static ManifestReader<?> open(ManifestFile manifest, FileIO io) {", "originalCommit": "e33a3bdaa199738a7f604136b64f1cc14b2f8a14", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU2NzE4Nw==", "url": "https://github.com/apache/iceberg/pull/1099#discussion_r437567187", "body": "Does this mean we can only do rewrites if there are no `DeleteFile`'s?", "bodyText": "Does this mean we can only do rewrites if there are no DeleteFile's?", "bodyHTML": "<p dir=\"auto\">Does this mean we can only do rewrites if there are no <code>DeleteFile</code>'s?</p>", "author": "danielcweeks", "createdAt": "2020-06-09T16:35:16Z", "path": "core/src/main/java/org/apache/iceberg/BaseRewriteManifests.java", "diffHunk": "@@ -235,7 +235,7 @@ private void performRewrite(List<ManifestFile> currentManifests) {\n               keptManifests.add(manifest);\n             } else {\n               rewrittenManifests.add(manifest);\n-              try (ManifestReader reader = ManifestFiles.read(manifest, ops.io(), ops.current().specsById())\n+              try (ManifestReader<DataFile> reader = ManifestFiles.read(manifest, ops.io(), ops.current().specsById())", "originalCommit": "e33a3bdaa199738a7f604136b64f1cc14b2f8a14", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU4NTczNA==", "url": "https://github.com/apache/iceberg/pull/1099#discussion_r437585734", "bodyText": "Never mind, I see that the rewrite is only operating on the data manifests and not all manifests.", "author": "danielcweeks", "createdAt": "2020-06-09T17:05:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzU2NzE4Nw=="}], "type": "inlineReview"}]}