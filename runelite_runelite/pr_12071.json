{"pr_number": 12071, "pr_title": "Add ability to automatically screenshot Barbarian Assault high gamble rewards", "pr_author": "LA", "pr_createdAt": "2020-07-06T07:09:33Z", "pr_url": "https://github.com/runelite/runelite/pull/12071", "timeline": [{"oid": "b14db6f81197ca7b4458dbf976925bf0486a9151", "url": "https://github.com/runelite/runelite/commit/b14db6f81197ca7b4458dbf976925bf0486a9151", "message": "Add ability to automatically screenshot Barbarian Assault high gamble rewards", "committedDate": "2020-07-06T07:03:28Z", "type": "commit"}, {"oid": "ca9cfdbbd401ced81cecafb977a04f11afa63ad1", "url": "https://github.com/runelite/runelite/commit/ca9cfdbbd401ced81cecafb977a04f11afa63ad1", "message": "Fix spacing typo in parseBAHighGambleWidget comment", "committedDate": "2020-07-06T07:16:15Z", "type": "commit"}, {"oid": "8c58694123569ccf98dd8178177e64f86eb73dc3", "url": "https://github.com/runelite/runelite/commit/8c58694123569ccf98dd8178177e64f86eb73dc3", "message": "Fix Checkstyle violation", "committedDate": "2020-07-06T07:27:23Z", "type": "commit"}, {"oid": "4c1efdfd69f3b12d967410e6276e18e19847ba66", "url": "https://github.com/runelite/runelite/commit/4c1efdfd69f3b12d967410e6276e18e19847ba66", "message": "Change file name format for better ordering", "committedDate": "2020-07-06T08:00:42Z", "type": "commit"}, {"oid": "feb3fc6f012019aa51d49f5e1a473e9baebe12e7", "url": "https://github.com/runelite/runelite/commit/feb3fc6f012019aa51d49f5e1a473e9baebe12e7", "message": "Fix potential issue where onWidgetLoaded would not return if LEVEL_UP_GROUP_ID and screenshotHighGamble", "committedDate": "2020-07-06T19:03:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU0MDUyNw==", "url": "https://github.com/runelite/runelite/pull/12071#discussion_r450540527", "body": "What is an example of text you'd receive when doing a high gamble? That should be added to this plugin's test cases.", "bodyText": "What is an example of text you'd receive when doing a high gamble? That should be added to this plugin's test cases.", "bodyHTML": "<p dir=\"auto\">What is an example of text you'd receive when doing a high gamble? That should be added to this plugin's test cases.</p>", "author": "Nightfirecat", "createdAt": "2020-07-07T00:05:04Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -110,6 +110,7 @@\n \tprivate static final ImmutableList<String> PET_MESSAGES = ImmutableList.of(\"You have a funny feeling like you're being followed\",\n \t\t\"You feel something weird sneaking into your backpack\",\n \t\t\"You have a funny feeling like you would have been followed\");\n+\tprivate static final Pattern BA_HIGH_GAMBLE_REWARD_PATTERN = Pattern.compile(\"(.+)!<br>High level gamble count: <col=7f0000>(.+)</col>\");", "originalCommit": "feb3fc6f012019aa51d49f5e1a473e9baebe12e7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDU0MTAyNQ==", "url": "https://github.com/runelite/runelite/pull/12071#discussion_r450541025", "body": "This should be formatted `High Gamble(count)` like other screenshots. I don't think putting the reward in the filename is valuable.", "bodyText": "This should be formatted High Gamble(count) like other screenshots. I don't think putting the reward in the filename is valuable.", "bodyHTML": "<p dir=\"auto\">This should be formatted <code>High Gamble(count)</code> like other screenshots. I don't think putting the reward in the filename is valuable.</p>", "author": "Nightfirecat", "createdAt": "2020-07-07T00:06:48Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -626,12 +641,33 @@ else if (verb.contains(\"completely\"))\n \t\treturn \"Quest(\" + quest + ')';\n \t}\n \n+\t/**\n+\t * Parses the Barbarian Assault high gamble reward dialog text into a shortened string for filename usage.\n+\t *\n+\t * @param text The {@link Widget#getText() text} of the {@link WidgetInfo#DIALOG_SPRITE_TEXT} widget.\n+\t * @return Shortened string in the format \"(100) Watermelon seed (x50)\"\n+\t */\n+\tstatic String parseBAHighGambleWidget(final String text)\n+\t{\n+\t\tfinal Matcher highGambleMatch = BA_HIGH_GAMBLE_REWARD_PATTERN.matcher(text);\n+\t\tif (highGambleMatch.find())\n+\t\t{\n+\t\t\tString reward = highGambleMatch.group(1);\n+\t\t\tString gambleCount = highGambleMatch.group(2);\n+\n+\t\t\treturn String.format(\"(%s) %s\", gambleCount, reward);", "originalCommit": "feb3fc6f012019aa51d49f5e1a473e9baebe12e7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9ce69b1282fbde6edc94ea0ff820c585681e2693", "url": "https://github.com/runelite/runelite/commit/9ce69b1282fbde6edc94ea0ff820c585681e2693", "message": "Resolve PR comments", "committedDate": "2020-07-07T18:32:40Z", "type": "commit"}, {"oid": "487023b713007138b69b7a94493cf87c2527ccb6", "url": "https://github.com/runelite/runelite/commit/487023b713007138b69b7a94493cf87c2527ccb6", "message": "Remove unused high gamble reward variable", "committedDate": "2020-07-07T18:37:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ2OTk1MQ==", "url": "https://github.com/runelite/runelite/pull/12071#discussion_r460469951", "body": "Now that we're not capturing the reward, we can remove the capturing group and use `.group(1)` to get the gamble count. Alternatively, each of the groups should be given a name using the syntax `(?<name>pattern)` and the matcher changed to use [`Matcher.group(String name)`](https://docs.oracle.com/javase/8/docs/api/java/util/regex/Matcher.html#group-java.lang.String-) to fetch the captured text instead.\r\n```suggestion\r\n\tprivate static final Pattern BA_HIGH_GAMBLE_REWARD_PATTERN = Pattern.compile(\"(?<reward>.+)!<br>High level gamble count: <col=7f0000>(?<gambleCount>.+)</col>\");\r\n```", "bodyText": "Now that we're not capturing the reward, we can remove the capturing group and use .group(1) to get the gamble count. Alternatively, each of the groups should be given a name using the syntax (?<name>pattern) and the matcher changed to use Matcher.group(String name) to fetch the captured text instead.\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tprivate static final Pattern BA_HIGH_GAMBLE_REWARD_PATTERN = Pattern.compile(\"(.+)!<br>High level gamble count: <col=7f0000>(.+)</col>\");\n          \n          \n            \n            \tprivate static final Pattern BA_HIGH_GAMBLE_REWARD_PATTERN = Pattern.compile(\"(?<reward>.+)!<br>High level gamble count: <col=7f0000>(?<gambleCount>.+)</col>\");", "bodyHTML": "<p dir=\"auto\">Now that we're not capturing the reward, we can remove the capturing group and use <code>.group(1)</code> to get the gamble count. Alternatively, each of the groups should be given a name using the syntax <code>(?&lt;name&gt;pattern)</code> and the matcher changed to use <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/regex/Matcher.html#group-java.lang.String-\" rel=\"nofollow\"><code>Matcher.group(String name)</code></a> to fetch the captured text instead.</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t<span class=\"pl-k\">private</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">final</span> <span class=\"pl-smi\">Pattern</span> <span class=\"pl-c1\">BA_HIGH_GAMBLE_REWARD_PATTERN</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Pattern</span><span class=\"pl-k\">.</span>compile(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>(.+)!&lt;br&gt;High level gamble count: &lt;col=7f0000&gt;(.+)&lt;/col&gt;<span class=\"pl-pds\">\"</span></span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t<span class=\"pl-k\">private</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">final</span> <span class=\"pl-smi\">Pattern</span> <span class=\"pl-c1\">BA_HIGH_GAMBLE_REWARD_PATTERN</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Pattern</span><span class=\"pl-k\">.</span>compile(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>(<span class=\"x x-first x-last\">?&lt;reward&gt;</span>.+)!&lt;br&gt;High level gamble count: &lt;col=7f0000&gt;(<span class=\"x x-first x-last\">?&lt;gambleCount&gt;</span>.+)&lt;/col&gt;<span class=\"pl-pds\">\"</span></span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Nightfirecat", "createdAt": "2020-07-26T02:45:58Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java", "diffHunk": "@@ -110,6 +110,7 @@\n \tprivate static final ImmutableList<String> PET_MESSAGES = ImmutableList.of(\"You have a funny feeling like you're being followed\",\n \t\t\"You feel something weird sneaking into your backpack\",\n \t\t\"You have a funny feeling like you would have been followed\");\n+\tprivate static final Pattern BA_HIGH_GAMBLE_REWARD_PATTERN = Pattern.compile(\"(.+)!<br>High level gamble count: <col=7f0000>(.+)</col>\");", "originalCommit": "487023b713007138b69b7a94493cf87c2527ccb6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1c2f40b6d0e3d8b6d26371411075eeba3a1e6e76", "url": "https://github.com/runelite/runelite/commit/1c2f40b6d0e3d8b6d26371411075eeba3a1e6e76", "message": "Update runelite-client/src/main/java/net/runelite/client/plugins/screenshot/ScreenshotPlugin.java\n\nCo-authored-by: Jordan <Nightfirecat@users.noreply.github.com>", "committedDate": "2020-07-26T17:38:45Z", "type": "commit"}, {"oid": "35f0d7148bca1700cecaef4adf9866791d8d0982", "url": "https://github.com/runelite/runelite/commit/35f0d7148bca1700cecaef4adf9866791d8d0982", "message": "Use Matcher.group(String name) for BA High Gamble captured text", "committedDate": "2020-07-26T17:47:06Z", "type": "commit"}]}