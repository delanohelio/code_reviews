{"pr_number": 11036, "pr_title": "Revert Shift Anti-Drag and Disable in PvP Scenarios", "pr_author": "usa-usa-usa-usa", "pr_createdAt": "2020-03-18T04:13:14Z", "pr_url": "https://github.com/runelite/runelite/pull/11036", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTYwNg==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396201606", "body": "This should be referenced from the `ConfigGroup` in `AntiDragConfig`", "bodyText": "This should be referenced from the ConfigGroup in AntiDragConfig", "bodyHTML": "<p dir=\"auto\">This should be referenced from the <code>ConfigGroup</code> in <code>AntiDragConfig</code></p>", "author": "Adam-", "createdAt": "2020-03-23T03:53:08Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,32 +24,44 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n+import lombok.extern.slf4j.Slf4j;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.FocusChanged;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n-\tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false\n )\n+@Slf4j\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n-\tprivate static final int DEFAULT_DELAY = 5;\n+\tstatic final String CONFIG_GROUP = \"antiDrag\";", "originalCommit": "e5b319d8178c97c5764def3867fd3d4ca02d0f34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg3NzY5OA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396877698", "bodyText": "I'm sorry I am still trying to learn my way around github and understand the review process. Are you referring to line 55 - static final String CONFIG_GROUP = \"antiDrag\";? If so, are you suggesting referencing the ConfigGroup\nvia AntiDragConifg.class.getAnnotation(ConfigGroup.class).value()?", "author": "usa-usa-usa-usa", "createdAt": "2020-03-24T03:04:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTYwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg4MDM1NQ==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396880355", "bodyText": "He means that AntiDragConfig should also have its @ConfigGroup definition updated to reference this constant. So it would read like this:\n@ConfigGroup(AntiDragPlugin.CONFIG_GROUP)", "author": "Nightfirecat", "createdAt": "2020-03-24T03:15:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTYwNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTY2NQ==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396201665", "body": "```suggestion\r\n\t\treturn client.getVarbitValue(PVP_SPEC_ORB_DISABLED) == 1;\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\treturn client.getVarbitValue(8121) == 1;\n          \n          \n            \n            \t\treturn client.getVarbitValue(PVP_SPEC_ORB_DISABLED) == 1;", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t<span class=\"pl-k\">return</span> client<span class=\"pl-k\">.</span>getVarbitValue(<span class=\"pl-c1 x x-first x-last\">8121</span>) <span class=\"pl-k\">==</span> <span class=\"pl-c1\">1</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t<span class=\"pl-k\">return</span> client<span class=\"pl-k\">.</span>getVarbitValue(<span class=\"pl-c1 x x-first x-last\">PVP_SPEC_ORB_DISABLED</span>) <span class=\"pl-k\">==</span> <span class=\"pl-c1\">1</span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Adam-", "createdAt": "2020-03-23T03:53:23Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -125,4 +193,9 @@ private void setBankDragDelay(int delay)\n \t\t}\n \t}\n \n+\tpublic boolean inPvp()\n+\t{\n+\t\treturn client.getVarbitValue(8121) == 1;", "originalCommit": "e5b319d8178c97c5764def3867fd3d4ca02d0f34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg4NjcxMA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396886710", "bodyText": "Can I keep the Varbits.java file change and make this client.getVar(Varbits.PVP_SPEC_ORB_DISABLED) or is it better practice to not modify the varbits and just use client.getVarbitValue(8121)?", "author": "usa-usa-usa-usa", "createdAt": "2020-03-24T03:43:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTY2NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMTkzNw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396201937", "body": "This should keep a stored value for `isPvp` and check isPvp() against that, and then only run this code if that changes", "bodyText": "This should keep a stored value for isPvp and check isPvp() against that, and then only run this code if that changes", "bodyHTML": "<p dir=\"auto\">This should keep a stored value for <code>isPvp</code> and check isPvp() against that, and then only run this code if that changes</p>", "author": "Adam-", "createdAt": "2020-03-23T03:55:05Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,32 +110,74 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tclientThread.invoke(() ->\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n-\t\t}\n+\t\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT && !inPvp())\n+\t\t\t{\n+\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t}\n+\t\t});\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tclientThread.invoke(() ->\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\t\t{\n+\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t}\n+\t\t});\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onConfigChanged(ConfigChanged event)\n+\t{\n+\t\tif (event.getGroup().equals(CONFIG_GROUP))\n+\t\t{\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t\telse\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t\t}\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Subscribe\n-\tpublic void onFocusChanged(FocusChanged focusChanged)\n+\tpublic void onVarbitChanged(VarbitChanged varbitChanged)\n \t{\n-\t\tif (!focusChanged.isFocused())\n+\n+\t\tif (!inPvp() && !config.onShiftOnly())", "originalCommit": "e5b319d8178c97c5764def3867fd3d4ca02d0f34", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMjI3NA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396202274", "body": "This should be 1) check shift 2) check config 3) thread 4) check pvp 5) change drags, as it prevents an unnecessary clientThread.invoke() per key. The config checks and keyevent checks are fine on this thread.\r\n\r\nThe previous behavior also allowed shift click in pvp, which would be nice to not lose, so maybe don't check that?", "bodyText": "This should be 1) check shift 2) check config 3) thread 4) check pvp 5) change drags, as it prevents an unnecessary clientThread.invoke() per key. The config checks and keyevent checks are fine on this thread.\nThe previous behavior also allowed shift click in pvp, which would be nice to not lose, so maybe don't check that?", "bodyHTML": "<p dir=\"auto\">This should be 1) check shift 2) check config 3) thread 4) check pvp 5) change drags, as it prevents an unnecessary clientThread.invoke() per key. The config checks and keyevent checks are fine on this thread.</p>\n<p dir=\"auto\">The previous behavior also allowed shift click in pvp, which would be nice to not lose, so maybe don't check that?</p>", "author": "Adam-", "createdAt": "2020-03-23T03:56:58Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,32 +110,74 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tclientThread.invoke(() ->\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n-\t\t}\n+\t\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT && !inPvp())", "originalCommit": "e5b319d8178c97c5764def3867fd3d4ca02d0f34", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMjk0MA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396202940", "body": "This actually looks like a bug fix? I may take this independently/it should be in a separate commit.", "bodyText": "This actually looks like a bug fix? I may take this independently/it should be in a separate commit.", "bodyHTML": "<p dir=\"auto\">This actually looks like a bug fix? I may take this independently/it should be in a separate commit.</p>", "author": "Adam-", "createdAt": "2020-03-23T04:01:01Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -65,13 +77,27 @@ AntiDragConfig getConfig(ConfigManager configManager)\n \t@Override\n \tprotected void startUp() throws Exception\n \t{\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\tclientThread.invokeLater(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t});\n+\t\t}\n+\n \t\tkeyManager.registerKeyListener(this);\n \t}\n \n \t@Override\n \tprotected void shutDown() throws Exception\n \t{\n \t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\tsetBankDragDelay(DEFAULT_DELAY);", "originalCommit": "e5b319d8178c97c5764def3867fd3d4ca02d0f34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg4MjkyNA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396882924", "bodyText": "Referring to the shutdown behavior? This really is there because the original anti-drag plugin had it. I will test to validate. Also, sorry still trying to understand github and what the comments/suggestions are in reference to.", "author": "usa-usa-usa-usa", "createdAt": "2020-03-24T03:26:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMjk0MA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMzQyNA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r396203424", "body": "I can't figure out what this is here for. I don't think it's being used?", "bodyText": "I can't figure out what this is here for. I don't think it's being used?", "bodyHTML": "<p dir=\"auto\">I can't figure out what this is here for. I don't think it's being used?</p>", "author": "Adam-", "createdAt": "2020-03-23T04:03:34Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java", "diffHunk": "@@ -40,6 +40,24 @@\n \t)\n \tdefault int dragDelay()\n \t{\n-\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH; // one game tick\n+\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH;\n+\t}\n+\n+\t@ConfigItem(\n+\t\tkeyName = \"dragDelay\",\n+\t\tname = \"\",\n+\t\tdescription = \"\"\n+\t)\n+\tvoid dragDelay(int delay);", "originalCommit": "e5b319d8178c97c5764def3867fd3d4ca02d0f34", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU5MzAxMg==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397593012", "bodyText": "This was an accident. I have removed it.", "author": "usa-usa-usa-usa", "createdAt": "2020-03-25T03:40:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMzQyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODcwNzM5Nw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r398707397", "bodyText": "This still has not been removed. Why was this comment marked resolved?", "author": "Nightfirecat", "createdAt": "2020-03-26T16:22:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMzQyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTYwMTAzNA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r399601034", "bodyText": "Sorry. I did remove this error, but someone accidentally re-pushed it back out.", "author": "usa-usa-usa-usa", "createdAt": "2020-03-28T01:22:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwMzQyNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTQ0Ng==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581446", "body": "Why are the plugin description and tags removed?", "bodyText": "Why are the plugin description and tags removed?", "bodyHTML": "<p dir=\"auto\">Why are the plugin description and tags removed?</p>", "author": "Nightfirecat", "createdAt": "2020-03-25T02:55:03Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,32 +24,45 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n+import lombok.extern.slf4j.Slf4j;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.FocusChanged;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n-\tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}", "originalCommit": "29d145eaabb09a0bc52892813c1f2a26969993a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTQ5Nw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581497", "body": "You're not using any `log` statements... Remove this.", "bodyText": "You're not using any log statements... Remove this.", "bodyHTML": "<p dir=\"auto\">You're not using any <code>log</code> statements... Remove this.</p>", "author": "Nightfirecat", "createdAt": "2020-03-25T02:55:15Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,32 +24,45 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n+import lombok.extern.slf4j.Slf4j;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.FocusChanged;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n-\tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false\n )\n+@Slf4j", "originalCommit": "29d145eaabb09a0bc52892813c1f2a26969993a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTYzNg==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581636", "body": "Is this being used outside the plugin? Seems like it can remain `private`.", "bodyText": "Is this being used outside the plugin? Seems like it can remain private.", "bodyHTML": "<p dir=\"auto\">Is this being used outside the plugin? Seems like it can remain <code>private</code>.</p>", "author": "Nightfirecat", "createdAt": "2020-03-25T02:55:45Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,32 +24,45 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n+import lombok.extern.slf4j.Slf4j;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n-import net.runelite.api.events.FocusChanged;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n-\tdescription = \"Prevent dragging an item for a specified delay\",\n-\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false\n )\n+@Slf4j\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n-\tprivate static final int DEFAULT_DELAY = 5;\n+\tstatic final String CONFIG_GROUP = \"antiDrag\";\n+\n+\tstatic final int DEFAULT_DELAY = 5;", "originalCommit": "29d145eaabb09a0bc52892813c1f2a26969993a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTc4MQ==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581781", "body": "Why is the `FocusChanged` handler removed?", "bodyText": "Why is the FocusChanged handler removed?", "bodyHTML": "<p dir=\"auto\">Why is the <code>FocusChanged</code> handler removed?</p>", "author": "Nightfirecat", "createdAt": "2020-03-25T02:56:23Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,32 +111,76 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!inPvp()) {\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Subscribe\n-\tpublic void onFocusChanged(FocusChanged focusChanged)", "originalCommit": "29d145eaabb09a0bc52892813c1f2a26969993a3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU5MzE4Mw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397593183", "bodyText": "I removed it at first because I didn't understand why it was important to turn off delay when the client left focus. I have added it back.", "author": "usa-usa-usa-usa", "createdAt": "2020-03-25T03:41:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTc4MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MTkxNw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397581917", "body": "These blocks are duplicated numerous times in this plugin now. Move them to helper methods.", "bodyText": "These blocks are duplicated numerous times in this plugin now. Move them to helper methods.", "bodyHTML": "<p dir=\"auto\">These blocks are duplicated numerous times in this plugin now. Move them to helper methods.</p>", "author": "Nightfirecat", "createdAt": "2020-03-25T02:56:51Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,32 +111,76 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!inPvp()) {\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t});\n \t\t}\n \t}\n \n \t@Subscribe\n-\tpublic void onFocusChanged(FocusChanged focusChanged)\n+\tpublic void onConfigChanged(ConfigChanged event)\n \t{\n-\t\tif (!focusChanged.isFocused())\n+\t\tif (event.getGroup().equals(CONFIG_GROUP))\n+\t\t{\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\t\t\t\tsetBankDragDelay(config.dragDelay());\n+\t\t\t\t}\n+\t\t\t\telse\n+\t\t\t\t{\n+\t\t\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\t\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\t\t}", "originalCommit": "29d145eaabb09a0bc52892813c1f2a26969993a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzU4MjM2MA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r397582360", "body": "This should explain the expected function and values of this varbit, not just be a section header of sorts. (Not all other entries in this file are a good reference; I would expect this to look more like `GE_OFFER_CREATION_TYPE` on L542 than the sections above)", "bodyText": "This should explain the expected function and values of this varbit, not just be a section header of sorts. (Not all other entries in this file are a good reference; I would expect this to look more like GE_OFFER_CREATION_TYPE on L542 than the sections above)", "bodyHTML": "<p dir=\"auto\">This should explain the expected function and values of this varbit, not just be a section header of sorts. (Not all other entries in this file are a good reference; I would expect this to look more like <code>GE_OFFER_CREATION_TYPE</code> on L542 than the sections above)</p>", "author": "Nightfirecat", "createdAt": "2020-03-25T02:58:33Z", "path": "runelite-api/src/main/java/net/runelite/api/Varbits.java", "diffHunk": "@@ -563,7 +563,12 @@\n \tTWISTED_LEAGUE_RELIC_2(10050),\n \tTWISTED_LEAGUE_RELIC_3(10051),\n \tTWISTED_LEAGUE_RELIC_4(10052),\n-\tTWISTED_LEAGUE_RELIC_5(10053);\n+\tTWISTED_LEAGUE_RELIC_5(10053),\n+\n+\t/**\n+\t * PVP", "originalCommit": "29d145eaabb09a0bc52892813c1f2a26969993a3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODcwMDY1Ng==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r398700656", "body": "This can remain `static` in addition to being private.\r\n```suggestion\r\n\tprivate static final int DEFAULT_DELAY = 5;\r\n```", "bodyText": "This can remain static in addition to being private.\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tprivate final int DEFAULT_DELAY = 5;\n          \n          \n            \n            \tprivate static final int DEFAULT_DELAY = 5;", "bodyHTML": "<p dir=\"auto\">This can remain <code>static</code> in addition to being private.</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t<span class=\"pl-k\">private</span> <span class=\"pl-k\">final</span> <span class=\"pl-k\">int</span> <span class=\"pl-c1\">DEFAULT_DELAY</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">5</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t<span class=\"pl-k\">private</span> <span class=\"pl-k x x-first\">static</span><span class=\"x x-last\"> </span><span class=\"pl-k\">final</span> <span class=\"pl-k\">int</span> <span class=\"pl-c1\">DEFAULT_DELAY</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">5</span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Nightfirecat", "createdAt": "2020-03-26T16:14:35Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -48,14 +48,15 @@\n \n @PluginDescriptor(\n \tname = \"Anti Drag\",\n-\tenabledByDefault = false\n+\tenabledByDefault = false,\n+\tdescription = \"Prevent dragging an item for a specified delay\",\n+\ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n )\n-@Slf4j\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n \tstatic final String CONFIG_GROUP = \"antiDrag\";\n \n-\tstatic final int DEFAULT_DELAY = 5;\n+\tprivate final int DEFAULT_DELAY = 5;", "originalCommit": "52cca8ef2db1d395bdf793b5dc4adf6891d3c9b3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODcwNjU4Nw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r398706587", "body": "This javadoc does not match the implementation of `inPvp()`. I would expect it to read more like the following:\r\n```suggestion\r\n\t * Whether the Special Attack orb is disabled due to being in a PvP area\r\n\t *\r\n\t * 0 = Enabled (player is not in PvP)\r\n\t * 1 = Disabled (player in in PvP)\r\n\t *\r\n\t * @see https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb\r\n```", "bodyText": "This javadoc does not match the implementation of inPvp(). I would expect it to read more like the following:\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * Status of the PvP Spec Orb\n          \n          \n            \n            \t * 0 = Disabled\n          \n          \n            \n            \t * 1 = Enabled\n          \n          \n            \n            \t * Whether the Special Attack orb is disabled due to being in a PvP area\n          \n          \n            \n            \t *\n          \n          \n            \n            \t * 0 = Enabled (player is not in PvP)\n          \n          \n            \n            \t * 1 = Disabled (player in in PvP)\n          \n          \n            \n            \t *\n          \n          \n            \n            \t * @see https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb", "bodyHTML": "<p dir=\"auto\">This javadoc does not match the implementation of <code>inPvp()</code>. I would expect it to read more like the following:</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t <span class=\"pl-k\">*</span> <span class=\"pl-smi\">Status</span> of the <span class=\"pl-smi\">PvP</span> <span class=\"pl-smi\">Spec</span> <span class=\"pl-smi\">Orb</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t <span class=\"pl-k\">*</span> <span class=\"pl-c1\">0</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Disabled</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t <span class=\"pl-k\">*</span> <span class=\"pl-c1\">1</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Enabled</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t <span class=\"pl-k\">*</span> <span class=\"pl-smi\">Whether</span> the <span class=\"pl-smi\">Special</span> <span class=\"pl-smi\">Attack</span> orb is disabled due to being in a <span class=\"pl-smi\">PvP</span> area</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t <span class=\"pl-k\">*</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t <span class=\"pl-k\">*</span> <span class=\"pl-c1\">0</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Enabled</span> (player is not in <span class=\"pl-smi\">PvP</span>)</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t <span class=\"pl-k\">*</span> <span class=\"pl-c1\">1</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Disabled</span> (player in in <span class=\"pl-smi\">PvP</span>)</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t <span class=\"pl-k\">*</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t <span class=\"pl-k\">*</span> <span class=\"pl-k\">@see</span> https<span class=\"pl-k\">:</span><span class=\"pl-c\"><span class=\"pl-c\">//</span>oldschool.runescape.wiki/w/Minimap#Special_attack_orb</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Nightfirecat", "createdAt": "2020-03-26T16:21:52Z", "path": "runelite-api/src/main/java/net/runelite/api/Varbits.java", "diffHunk": "@@ -563,7 +563,14 @@\n \tTWISTED_LEAGUE_RELIC_2(10050),\n \tTWISTED_LEAGUE_RELIC_3(10051),\n \tTWISTED_LEAGUE_RELIC_4(10052),\n-\tTWISTED_LEAGUE_RELIC_5(10053);\n+\tTWISTED_LEAGUE_RELIC_5(10053),\n+\n+\t/**\n+\t * Status of the PvP Spec Orb\n+\t * 0 = Disabled\n+\t * 1 = Enabled", "originalCommit": "4dccb11c844ed5f3c7e7588c8ebd2c1177c409ca", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODcwODI4Nw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r398708287", "body": "`lastInPvp` would be a much better var name, which would completely remove the need for this added comment.", "bodyText": "lastInPvp would be a much better var name, which would completely remove the need for this added comment.", "bodyHTML": "<p dir=\"auto\"><code>lastInPvp</code> would be a much better var name, which would completely remove the need for this added comment.</p>", "author": "Nightfirecat", "createdAt": "2020-03-26T16:23:59Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,54 +24,82 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false,\n \tdescription = \"Prevent dragging an item for a specified delay\",\n \ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n )\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n-\tprivate static final int DEFAULT_DELAY = 5;\n+\tstatic final String CONFIG_GROUP = \"antiDrag\";\n+\n+\tprivate final int DEFAULT_DELAY = 5;\n \n \t@Inject\n \tprivate Client client;\n \n+\t@Inject\n+\tprivate ClientThread clientThread;\n+\n \t@Inject\n \tprivate AntiDragConfig config;\n \n \t@Inject\n \tprivate KeyManager keyManager;\n \n+\tprivate boolean lastStatus; //true = was in PvP, false = was not in Pvp", "originalCommit": "4dccb11c844ed5f3c7e7588c8ebd2c1177c409ca", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3ODU5NQ==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400578595", "body": "Don't remove the comment on this line", "bodyText": "Don't remove the comment on this line", "bodyHTML": "<p dir=\"auto\">Don't remove the comment on this line</p>", "author": "Nightfirecat", "createdAt": "2020-03-31T00:48:14Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java", "diffHunk": "@@ -40,6 +40,17 @@\n \t)\n \tdefault int dragDelay()\n \t{\n-\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH; // one game tick", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3OTEwNA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400579104", "body": "This needs some extra description to clarify that the plugin still requires the use of Shift in PVP.", "bodyText": "This needs some extra description to clarify that the plugin still requires the use of Shift in PVP.", "bodyHTML": "<p dir=\"auto\">This needs some extra description to clarify that the plugin still requires the use of Shift in PVP.</p>", "author": "Nightfirecat", "createdAt": "2020-03-31T00:49:49Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragConfig.java", "diffHunk": "@@ -40,6 +40,17 @@\n \t)\n \tdefault int dragDelay()\n \t{\n-\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH; // one game tick\n+\t\treturn Constants.GAME_TICK_LENGTH / Constants.CLIENT_TICK_LENGTH;\n+\t}\n+\n+\t@ConfigItem(\n+\t\tkeyName = \"onShiftOnly\",\n+\t\tname = \"On Shift Only\",\n+\t\tdescription = \"Configures whether to only adjust the delay while holding shift\",", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3OTI5OA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400579298", "body": "These imports need to be reordered, they should still be in alphabetical order.", "bodyText": "These imports need to be reordered, they should still be in alphabetical order.", "bodyHTML": "<p dir=\"auto\">These imports need to be reordered, they should still be in alphabetical order.</p>", "author": "Nightfirecat", "createdAt": "2020-03-31T00:50:33Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,54 +24,82 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3OTUxOA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400579518", "body": "This also should be moved back where it was originally to maintain import ordering.", "bodyText": "This also should be moved back where it was originally to maintain import ordering.", "bodyHTML": "<p dir=\"auto\">This also should be moved back where it was originally to maintain import ordering.</p>", "author": "Nightfirecat", "createdAt": "2020-03-31T00:51:24Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,54 +24,82 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU3OTY3Ng==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400579676", "body": "```suggestion\r\n```", "bodyText": "Suggested change", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Nightfirecat", "createdAt": "2020-03-31T00:52:01Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -24,54 +24,82 @@\n  */\n package net.runelite.client.plugins.antidrag;\n \n-import com.google.inject.Provides;\n-import java.awt.event.KeyEvent;\n import javax.inject.Inject;\n-import net.runelite.api.Client;\n+import java.awt.event.KeyEvent;\n+import com.google.inject.Provides;\n+import net.runelite.api.GameState;\n+import net.runelite.api.Varbits;\n import net.runelite.api.events.FocusChanged;\n+import net.runelite.api.events.WidgetLoaded;\n import net.runelite.api.widgets.Widget;\n+import net.runelite.api.widgets.WidgetID;\n import net.runelite.api.widgets.WidgetInfo;\n-import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.callback.ClientThread;\n import net.runelite.client.eventbus.Subscribe;\n+import net.runelite.api.Client;\n+import net.runelite.api.events.VarbitChanged;\n+import net.runelite.client.config.ConfigManager;\n+import net.runelite.client.events.ConfigChanged;\n import net.runelite.client.input.KeyListener;\n import net.runelite.client.input.KeyManager;\n import net.runelite.client.plugins.Plugin;\n import net.runelite.client.plugins.PluginDescriptor;\n \n+\n @PluginDescriptor(\n-\tname = \"Shift Anti Drag\",\n+\tname = \"Anti Drag\",\n+\tenabledByDefault = false,\n \tdescription = \"Prevent dragging an item for a specified delay\",\n \ttags = {\"antidrag\", \"delay\", \"inventory\", \"items\"}\n )\n public class AntiDragPlugin extends Plugin implements KeyListener\n {\n+\tstatic final String CONFIG_GROUP = \"antiDrag\";\n+\n \tprivate static final int DEFAULT_DELAY = 5;\n \n \t@Inject\n \tprivate Client client;\n \n+\t@Inject\n+\tprivate ClientThread clientThread;\n+\n \t@Inject\n \tprivate AntiDragConfig config;\n \n \t@Inject\n \tprivate KeyManager keyManager;\n \n+\tprivate boolean lastInPvp;\n+\n \t@Provides\n \tAntiDragConfig getConfig(ConfigManager configManager)\n \t{\n \t\treturn configManager.getConfig(AntiDragConfig.class);\n \t}\n \n+", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU4MDM2Ng==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400580366", "body": "This should be indented only one level further\r\n```suggestion\r\n\t\t\tsetDragDelay();\r\n```", "bodyText": "This should be indented only one level further\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\t\tsetDragDelay();\n          \n          \n            \n            \t\t\tsetDragDelay();", "bodyHTML": "<p dir=\"auto\">This should be indented only one level further</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t\t<span class=\"x x-first x-last\">\t</span>setDragDelay();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t\tsetDragDelay();</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Nightfirecat", "createdAt": "2020-03-31T00:54:23Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +112,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\t\tsetDragDelay();", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU4MDgwMw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400580803", "body": "Use a non-inverted condition:\r\n\r\n```java\r\nif (config.onShiftOnly() || inPvp())\r\n{\r\n\tremoveDragDelay();\r\n}\r\nelse\r\n{\r\n\tsetDragDelay();\r\n}\r\n```", "bodyText": "Use a non-inverted condition:\nif (config.onShiftOnly() || inPvp())\n{\n\tremoveDragDelay();\n}\nelse\n{\n\tsetDragDelay();\n}", "bodyHTML": "<p dir=\"auto\">Use a non-inverted condition:</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"if (config.onShiftOnly() || inPvp())\n{\n\tremoveDragDelay();\n}\nelse\n{\n\tsetDragDelay();\n}\"><pre><span class=\"pl-k\">if</span> (config<span class=\"pl-k\">.</span>onShiftOnly() <span class=\"pl-k\">||</span> inPvp())\n{\n\tremoveDragDelay();\n}\n<span class=\"pl-k\">else</span>\n{\n\tsetDragDelay();\n}</pre></div>", "author": "Nightfirecat", "createdAt": "2020-03-31T00:56:05Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +112,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\t\tsetDragDelay();\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\t{\n+\t\t\tremoveDragDelay();\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onConfigChanged(ConfigChanged event)\n+\t{\n+\t\tif (event.getGroup().equals(CONFIG_GROUP))\n+\t\t{\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU4MDk0NQ==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400580945", "body": "This doesn't remove the drag delay, it only resets it to default values. `resetDragDelay()` would be a better name.", "bodyText": "This doesn't remove the drag delay, it only resets it to default values. resetDragDelay() would be a better name.", "bodyHTML": "<p dir=\"auto\">This doesn't remove the drag delay, it only resets it to default values. <code>resetDragDelay()</code> would be a better name.</p>", "author": "Nightfirecat", "createdAt": "2020-03-31T00:56:37Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -125,4 +208,21 @@ private void setBankDragDelay(int delay)\n \t\t}\n \t}\n \n+\tprivate boolean inPvp()\n+\t{\n+\t\treturn client.getVar(Varbits.PVP_SPEC_ORB) == 1;\n+\t}\n+\n+\tprivate void setDragDelay()\n+\t{\n+\t\tclient.setInventoryDragDelay(config.dragDelay());\n+\t\tsetBankDragDelay(config.dragDelay());\n+\t}\n+\n+\tprivate void removeDragDelay()", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU5MTY4NQ==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r400591685", "body": "Turns out my suggestion wasn't proper javadoc. This should be though.\r\n\r\n```suggestion\r\n\t * @see <a href=\"https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb\">The OSRS Wiki's Minimap page</a>\r\n```", "bodyText": "Turns out my suggestion wasn't proper javadoc. This should be though.\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * @see https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb\n          \n          \n            \n            \t * @see <a href=\"https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb\">The OSRS Wiki's Minimap page</a>", "bodyHTML": "<p dir=\"auto\">Turns out my suggestion wasn't proper javadoc. This should be though.</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t <span class=\"pl-k\">*</span> <span class=\"pl-k\">@see</span> https<span class=\"pl-k\">:</span><span class=\"pl-c\"><span class=\"pl-c\">//</span>oldschool.runescape.wiki/w/Minimap#Special_attack_orb</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t <span class=\"pl-k\">*</span> <span class=\"pl-k\">@see</span> <span class=\"pl-k x x-first\">&lt;</span><span class=\"x\">a href</span><span class=\"pl-k x\">=</span><span class=\"pl-s\"><span class=\"pl-pds x x-last\">\"</span>https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb<span class=\"pl-pds x x-first\">\"</span></span><span class=\"pl-k x\">&gt;</span><span class=\"pl-smi x\">The</span><span class=\"x\"> </span><span class=\"pl-c1 x\">OSRS</span><span class=\"x\"> </span><span class=\"pl-smi x\">Wiki</span><span class=\"pl-s\"><span class=\"pl-pds x\">'</span><span class=\"x x-last\">s Minimap page&lt;/a&gt;</span></span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Nightfirecat", "createdAt": "2020-03-31T01:34:37Z", "path": "runelite-api/src/main/java/net/runelite/api/Varbits.java", "diffHunk": "@@ -563,7 +563,17 @@\n \tTWISTED_LEAGUE_RELIC_2(10050),\n \tTWISTED_LEAGUE_RELIC_3(10051),\n \tTWISTED_LEAGUE_RELIC_4(10052),\n-\tTWISTED_LEAGUE_RELIC_5(10053);\n+\tTWISTED_LEAGUE_RELIC_5(10053),\n+\n+\t/**\n+\t * Whether the Special Attack orb is disabled due to being in a PvP area\n+\t *\n+\t * 0 = Enabled (player is not in PvP)\n+\t * 1 = Disabled (player in in PvP)\n+\t *\n+\t * @see https://oldschool.runescape.wiki/w/Minimap#Special_attack_orb", "originalCommit": "1eed4484084639d100ebfac82cc2ddc7c1b749d4", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0OTc2OQ==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r401949769", "body": "```suggestion\r\n\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n          \n          \n            \n            \t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t<span class=\"pl-k\">if</span> (<span class=\"x x-first\">config</span><span class=\"pl-k x\">.</span><span class=\"x\">onShiftOnly() </span><span class=\"pl-k x\">&amp;&amp;</span><span class=\"x x-last\"> </span>e<span class=\"pl-k\">.</span>getKeyCode() <span class=\"pl-k\">==</span> <span class=\"pl-smi\">KeyEvent</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>VK_SHIFT</span>)</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t<span class=\"pl-k\">if</span> (e<span class=\"pl-k\">.</span>getKeyCode() <span class=\"pl-k\">==</span> <span class=\"pl-smi\">KeyEvent</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>VK_SHIFT</span><span class=\"x x-first\"> </span><span class=\"pl-k x\">&amp;&amp;</span><span class=\"x\"> config</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">onShiftOnly()</span>)</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Adam-", "createdAt": "2020-04-01T22:34:58Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +110,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)", "originalCommit": "a149fc69cbf5ae388d7c8c62492b1e140c5e500b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTk0OTkzMw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r401949933", "body": "```suggestion\r\n\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n          \n          \n            \n            \t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t<span class=\"pl-k\">if</span> (<span class=\"x x-first\">config</span><span class=\"pl-k x\">.</span><span class=\"x\">onShiftOnly() </span><span class=\"pl-k x\">&amp;&amp;</span><span class=\"x x-last\"> </span>e<span class=\"pl-k\">.</span>getKeyCode() <span class=\"pl-k\">==</span> <span class=\"pl-smi\">KeyEvent</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>VK_SHIFT</span>)</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t<span class=\"pl-k\">if</span> (e<span class=\"pl-k\">.</span>getKeyCode() <span class=\"pl-k\">==</span> <span class=\"pl-smi\">KeyEvent</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>VK_SHIFT</span><span class=\"x x-first\"> </span><span class=\"pl-k x\">&amp;&amp;</span><span class=\"x\"> config</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">onShiftOnly()</span>)</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Adam-", "createdAt": "2020-04-01T22:35:25Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +110,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\tsetDragDelay();\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)", "originalCommit": "a149fc69cbf5ae388d7c8c62492b1e140c5e500b", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc0NTEzOA==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r403745138", "body": "This should probably be on the client thread", "bodyText": "This should probably be on the client thread", "bodyHTML": "<p dir=\"auto\">This should probably be on the client thread</p>", "author": "Adam-", "createdAt": "2020-04-05T19:18:43Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -65,13 +80,24 @@ AntiDragConfig getConfig(ConfigManager configManager)\n \t@Override\n \tprotected void startUp() throws Exception\n \t{\n+\t\tif (client.getGameState() == GameState.LOGGED_IN)\n+\t\t{\n+\t\t\tclientThread.invokeLater(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tsetDragDelay();\n+\t\t\t\t}\n+\t\t\t});\n+\t\t}\n+\n \t\tkeyManager.registerKeyListener(this);\n \t}\n \n \t@Override\n \tprotected void shutDown() throws Exception\n \t{\n-\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n+\t\tresetDragDelay();", "originalCommit": "9b61d8823e1b86d3aef3b271042c1690d7506acb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc0NTcxNg==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r403745716", "body": "Only the set (and probably the above resetDragDelay()) needs to be on client thread, the rest is fine off.", "bodyText": "Only the set (and probably the above resetDragDelay()) needs to be on client thread, the rest is fine off.", "bodyHTML": "<p dir=\"auto\">Only the set (and probably the above resetDragDelay()) needs to be on client thread, the rest is fine off.</p>", "author": "Adam-", "createdAt": "2020-04-05T19:23:56Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -84,31 +110,86 @@ public void keyTyped(KeyEvent e)\n \t@Override\n \tpublic void keyPressed(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (config.onShiftOnly() && e.getKeyCode() == KeyEvent.VK_SHIFT)\n \t\t{\n-\t\t\tfinal int delay = config.dragDelay();\n-\t\t\tclient.setInventoryDragDelay(delay);\n-\t\t\tsetBankDragDelay(delay);\n+\t\t\tsetDragDelay();\n \t\t}\n \t}\n \n \t@Override\n \tpublic void keyReleased(KeyEvent e)\n \t{\n-\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT)\n+\t\tif (e.getKeyCode() == KeyEvent.VK_SHIFT && config.onShiftOnly())\n+\t\t{\n+\t\t\tresetDragDelay();\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onConfigChanged(ConfigChanged event)\n+\t{\n+\t\tif (event.getGroup().equals(CONFIG_GROUP))\n+\t\t{\n+\t\t\tclientThread.invoke(() ->\n+\t\t\t{\n+\t\t\t\tif (config.onShiftOnly() || inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tresetDragDelay();\n+\t\t\t\t}\n+\t\t\t\telse\n+\t\t\t\t{\n+\t\t\t\t\tsetDragDelay();\n+\t\t\t\t}\n+\t\t\t});\n+\t\t}\n+\t}\n+\n+\t@Subscribe\n+\tpublic void onVarbitChanged(VarbitChanged varbitChanged)\n+\t{\n+\t\tboolean currentStatus = inPvp();\n+\n+\t\tif (currentStatus != lastInPvp)\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tif (!currentStatus && !config.onShiftOnly())\n+\t\t\t{\n+\t\t\t\tsetDragDelay();\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\n+\t\t\t\tresetDragDelay();\n+\t\t\t}\n+\n+\t\t\tlastInPvp = currentStatus;\n \t\t}\n+\n \t}\n \n \t@Subscribe\n \tpublic void onFocusChanged(FocusChanged focusChanged)\n \t{\n \t\tif (!focusChanged.isFocused())\n \t\t{\n-\t\t\tclient.setInventoryDragDelay(DEFAULT_DELAY);\n-\t\t\tsetBankDragDelay(DEFAULT_DELAY);\n+\t\t\tresetDragDelay();\n+\t\t}\n+\t\telse\n+\t\t{\n+\t\t\tclientThread.invokeLater(() ->\n+\t\t\t{\n+\t\t\t\tif (!config.onShiftOnly() && !inPvp())\n+\t\t\t\t{\n+\t\t\t\t\tsetDragDelay();", "originalCommit": "9b61d8823e1b86d3aef3b271042c1690d7506acb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzc0NTc2Nw==", "url": "https://github.com/runelite/runelite/pull/11036#discussion_r403745767", "body": "This is just `lastInPvp `?", "bodyText": "This is just lastInPvp ?", "bodyHTML": "<p dir=\"auto\">This is just <code>lastInPvp </code>?</p>", "author": "Adam-", "createdAt": "2020-04-05T19:24:08Z", "path": "runelite-client/src/main/java/net/runelite/client/plugins/antidrag/AntiDragPlugin.java", "diffHunk": "@@ -125,4 +206,21 @@ private void setBankDragDelay(int delay)\n \t\t}\n \t}\n \n+\tprivate boolean inPvp()\n+\t{\n+\t\treturn client.getVar(Varbits.PVP_SPEC_ORB) == 1;", "originalCommit": "9b61d8823e1b86d3aef3b271042c1690d7506acb", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "url": "https://github.com/runelite/runelite/commit/ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "message": "antidrag: add option to disable in pvp\n\nThis lifts the shift requirement by instead just disabling the feature\nin pvp\n\nCo-authored-by: jcwhisman <jcwhisman@gmail.com>", "committedDate": "2020-04-06T16:17:21Z", "type": "commit"}, {"oid": "ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "url": "https://github.com/runelite/runelite/commit/ea3d7c8ee2e61d196a5f1f7c0a2ca7a36cc44abc", "message": "antidrag: add option to disable in pvp\n\nThis lifts the shift requirement by instead just disabling the feature\nin pvp\n\nCo-authored-by: jcwhisman <jcwhisman@gmail.com>", "committedDate": "2020-04-06T16:17:21Z", "type": "forcePushed"}]}