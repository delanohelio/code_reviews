{"pr_number": 487, "pr_title": "optimize multiple track deletion", "pr_author": "pstorch", "pr_createdAt": "2020-10-31T22:10:46Z", "pr_url": "https://github.com/OpenTracksApp/OpenTracks/pull/487", "timeline": [{"oid": "c1146a453bbbcb4d99a14e678d3c151673a5a809", "url": "https://github.com/OpenTracksApp/OpenTracks/commit/c1146a453bbbcb4d99a14e678d3c151673a5a809", "message": "optimize multiple track deletion\n\nAfter #480 got implemented, we can now delete multiple tracks in one go and only cause DB vacuum once.", "committedDate": "2020-10-31T22:09:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTU0NjIwMQ==", "url": "https://github.com/OpenTracksApp/OpenTracks/pull/487#discussion_r515546201", "body": "Love this!\r\nWill update ShareContentprovider :+1: ", "bodyText": "Love this!\nWill update ShareContentprovider \ud83d\udc4d", "bodyHTML": "<p dir=\"auto\">Love this!<br>\nWill update ShareContentprovider <g-emoji class=\"g-emoji\" alias=\"+1\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/1f44d.png\">\ud83d\udc4d</g-emoji></p>", "author": "dennisguse", "createdAt": "2020-10-31T22:15:43Z", "path": "src/main/java/de/dennisguse/opentracks/content/provider/ContentProviderUtils.java", "diffHunk": "@@ -179,6 +180,17 @@ public void deleteAllTracks(Context context) {\n         FileUtils.deleteDirectoryRecurse(dir);\n     }\n \n+    public void deleteTracks(Context context, @NonNull List<Track.Id> trackIds) {\n+        // Delete track folder resources.\n+        for (Track.Id trackId : trackIds) {\n+            FileUtils.deleteDirectoryRecurse(FileUtils.getPhotoDir(context, trackId));\n+        }\n+\n+        // Delete track last since it triggers a database vacuum call\n+        String whereClause = String.format(TracksColumns._ID + \" IN (%s)\", TextUtils.join(\",\", Collections.nCopies(trackIds.size(), \"?\")));", "originalCommit": "c1146a453bbbcb4d99a14e678d3c151673a5a809", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}