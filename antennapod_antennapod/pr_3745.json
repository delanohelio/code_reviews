{"pr_number": 3745, "pr_title": "add summary to main settings/preferences screen", "pr_author": "tonytamsf", "pr_createdAt": "2020-01-09T04:11:27Z", "pr_url": "https://github.com/AntennaPod/AntennaPod/pull/3745", "merge_commit": "970cdd99054ac6e6b983c7f5664c5b6c5524107d", "timeline": [{"oid": "7df4f4578f448f2b85236577fcbbef3fea2abb3e", "url": "https://github.com/AntennaPod/AntennaPod/commit/7df4f4578f448f2b85236577fcbbef3fea2abb3e", "message": "add summary to main settings/preferences screen", "committedDate": "2020-01-09T04:08:48Z", "type": "commit"}, {"oid": "5cd87d5b0191b3bf60a649383d6d4e718146ce46", "url": "https://github.com/AntennaPod/AntennaPod/commit/5cd87d5b0191b3bf60a649383d6d4e718146ce46", "message": "wakey wakey GitHub Actions", "committedDate": "2020-01-09T06:29:08Z", "type": "commit"}, {"oid": "87376d67356fd0aa31b84c9f3e9dcf85ece23181", "url": "https://github.com/AntennaPod/AntennaPod/commit/87376d67356fd0aa31b84c9f3e9dcf85ece23181", "message": "fix tests to use clickPreference(), summary changes", "committedDate": "2020-01-09T16:23:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzODA0OA==", "url": "https://github.com/AntennaPod/AntennaPod/pull/3745#discussion_r364838048", "body": "Be careful. This is not a preference but an option in a dialog.", "bodyText": "Be careful. This is not a preference but an option in a dialog.", "bodyHTML": "<p dir=\"auto\">Be careful. This is not a preference but an option in a dialog.</p>", "author": "ByteHamster", "createdAt": "2020-01-09T16:30:42Z", "path": "app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java", "diffHunk": "@@ -80,7 +80,7 @@ public void testSwitchTheme() {\n         }\n         clickPreference(R.string.user_interface_label);\n         clickPreference(R.string.pref_set_theme_title);\n-        onView(withText(otherTheme)).perform(click());\n+        clickPreference(otherTheme);", "originalCommit": "87376d67356fd0aa31b84c9f3e9dcf85ece23181", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg0OTIzMw==", "url": "https://github.com/AntennaPod/AntennaPod/pull/3745#discussion_r364849233", "bodyText": "thanks @ByteHamster , still learning. fixed. \ud83e\udd1e that the tests will pass", "author": "tonytamsf", "createdAt": "2020-01-09T16:49:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzODA0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDg2OTY2Nw==", "url": "https://github.com/AntennaPod/AntennaPod/pull/3745#discussion_r364869667", "bodyText": "@ByteHamster Thanks for all the help, the automated tests have passed now.", "author": "tonytamsf", "createdAt": "2020-01-09T17:31:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDgzODA0OA=="}], "type": "inlineReview", "revised_code": {"commit": "b44b0a3e36528482162d40cb8c3a1163ee0b7b63", "changed_code": [{"header": "diff --git a/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java b/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java\nindex 54cf7e06d..1ea859191 100644\n--- a/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java\n+++ b/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java\n", "chunk": "@@ -80,7 +80,7 @@ public class PreferencesTest {\n         }\n         clickPreference(R.string.user_interface_label);\n         clickPreference(R.string.pref_set_theme_title);\n-        clickPreference(otherTheme);\n+        onView(withText(otherTheme)).perform(click());\n         Awaitility.await().atMost(1000, MILLISECONDS)\n                 .until(() -> UserPreferences.getTheme() != theme);\n     }\n", "next_change": null}]}, "revised_code_in_main": {"commit": "970cdd99054ac6e6b983c7f5664c5b6c5524107d", "changed_code": [{"header": "diff --git a/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java b/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java\nindex 54cf7e06d..7d3972378 100644\n--- a/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java\n+++ b/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java\n", "chunk": "@@ -80,7 +80,7 @@ public class PreferencesTest {\n         }\n         clickPreference(R.string.user_interface_label);\n         clickPreference(R.string.pref_set_theme_title);\n-        clickPreference(otherTheme);\n+        onView(withText(otherTheme)).perform(click());\n         Awaitility.await().atMost(1000, MILLISECONDS)\n                 .until(() -> UserPreferences.getTheme() != theme);\n     }\n", "next_change": {"commit": "d8a2dd5f83598fdde289e01994c5d2df1c6577fc", "changed_code": [{"header": "diff --git a/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java b/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java\nindex 7d3972378..a0f2c17ea 100644\n--- a/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java\n+++ b/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java\n", "chunk": "@@ -45,58 +49,46 @@ import static androidx.test.espresso.matcher.ViewMatchers.withText;\n import static de.test.antennapod.EspressoTestUtils.clickPreference;\n import static de.test.antennapod.EspressoTestUtils.waitForView;\n import static java.util.concurrent.TimeUnit.MILLISECONDS;\n-import static junit.framework.TestCase.assertTrue;\n-import static org.hamcrest.Matchers.allOf;\n+import static org.hamcrest.Matchers.anything;\n import static org.hamcrest.Matchers.endsWith;\n import static org.hamcrest.Matchers.not;\n+import static org.junit.Assert.assertTrue;\n \n @LargeTest\n public class PreferencesTest {\n     private Resources res;\n \n     @Rule\n-    public ActivityTestRule<PreferenceActivity> mActivityRule = new ActivityTestRule<>(PreferenceActivity.class, false, false);\n+    public ActivityTestRule<PreferenceActivity> activityTestRule =\n+            new ActivityTestRule<>(PreferenceActivity.class,\n+                    false,\n+                    false);\n+\n \n     @Before\n     public void setUp() {\n         EspressoTestUtils.clearDatabase();\n         EspressoTestUtils.clearPreferences();\n-        mActivityRule.launchActivity(new Intent());\n-        SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(mActivityRule.getActivity());\n+        activityTestRule.launchActivity(new Intent());\n+        SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(activityTestRule.getActivity());\n         prefs.edit().putBoolean(UserPreferences.PREF_ENABLE_AUTODL, true).commit();\n \n-        res = mActivityRule.getActivity().getResources();\n-        UserPreferences.init(mActivityRule.getActivity());\n+        res = activityTestRule.getActivity().getResources();\n+        UserPreferences.init(activityTestRule.getActivity());\n     }\n \n     @Test\n     public void testSwitchTheme() {\n-        final int theme = UserPreferences.getTheme();\n-        int otherTheme;\n-        if (theme == de.danoeh.antennapod.core.R.style.Theme_AntennaPod_Light) {\n-            otherTheme = R.string.pref_theme_title_dark;\n-        } else {\n-            otherTheme = R.string.pref_theme_title_light;\n-        }\n-        clickPreference(R.string.user_interface_label);\n-        clickPreference(R.string.pref_set_theme_title);\n-        onView(withText(otherTheme)).perform(click());\n-        Awaitility.await().atMost(1000, MILLISECONDS)\n-                .until(() -> UserPreferences.getTheme() != theme);\n-    }\n-\n-    @Test\n-    public void testSwitchThemeBack() {\n-        final int theme = UserPreferences.getTheme();\n-        int otherTheme;\n-        if (theme == de.danoeh.antennapod.core.R.style.Theme_AntennaPod_Light) {\n-            otherTheme = R.string.pref_theme_title_dark;\n+        final UserPreferences.ThemePreference theme = UserPreferences.getTheme();\n+        int otherThemeText;\n+        if (theme == UserPreferences.ThemePreference.DARK) {\n+            otherThemeText = R.string.pref_theme_title_light;\n         } else {\n-            otherTheme = R.string.pref_theme_title_light;\n+            otherThemeText = R.string.pref_theme_title_dark;\n         }\n         clickPreference(R.string.user_interface_label);\n         clickPreference(R.string.pref_set_theme_title);\n-        onView(withText(otherTheme)).perform(click());\n+        onView(withText(otherThemeText)).perform(click());\n         Awaitility.await().atMost(1000, MILLISECONDS)\n                 .until(() -> UserPreferences.getTheme() != theme);\n     }\n", "next_change": {"commit": "997860fe522e67dff087e4184a80fc9656de28d8", "changed_code": [{"header": "diff --git a/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java b/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java\nindex a0f2c17ea..b790bc005 100644\n--- a/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java\n+++ b/app/src/androidTest/java/de/test/antennapod/ui/PreferencesTest.java\n", "chunk": "@@ -77,22 +74,6 @@ public class PreferencesTest {\n         UserPreferences.init(activityTestRule.getActivity());\n     }\n \n-    @Test\n-    public void testSwitchTheme() {\n-        final UserPreferences.ThemePreference theme = UserPreferences.getTheme();\n-        int otherThemeText;\n-        if (theme == UserPreferences.ThemePreference.DARK) {\n-            otherThemeText = R.string.pref_theme_title_light;\n-        } else {\n-            otherThemeText = R.string.pref_theme_title_dark;\n-        }\n-        clickPreference(R.string.user_interface_label);\n-        clickPreference(R.string.pref_set_theme_title);\n-        onView(withText(otherThemeText)).perform(click());\n-        Awaitility.await().atMost(1000, MILLISECONDS)\n-                .until(() -> UserPreferences.getTheme() != theme);\n-    }\n-\n     @Test\n     public void testEnablePersistentPlaybackControls() {\n         final boolean persistNotify = UserPreferences.isPersistNotify();\n", "next_change": null}]}}]}}]}, "commits_in_main": [{"oid": "970cdd99054ac6e6b983c7f5664c5b6c5524107d", "message": "Merge commit", "committedDate": null}, {"oid": "855681e0ee73202ea139ab62661bb95405f79f5c", "committedDate": "2020-03-26 22:36:23 +0100", "message": "Removed WiFi filter on Android 10"}, {"oid": "17b9579dfea12b9b6289982e3fd4251ecf12b86d", "committedDate": "2020-07-16 17:01:53 +0200", "message": "New playback speed dialog"}, {"oid": "acb4832df62aeae6574169690d34a5c65f178a3c", "committedDate": "2020-08-29 00:10:50 -0400", "message": "Move remaining preference to AndroidX preference"}, {"oid": "943a5a7aff71cf29c701e94bdfcfb1c8b9639a6b", "committedDate": "2020-11-22 16:11:07 +0100", "message": "Fix usage of obsolete junit.framework.Assert method"}, {"oid": "08edd151f9bc01873128fa97c948841b65b6455c", "committedDate": "2021-02-05 11:15:22 +0100", "message": "Added new cleanup option: when not favorited"}, {"oid": "04ff51bd6768884cd638bd2b8969a13aa17b05d2", "committedDate": "2021-04-23 20:10:39 +0200", "message": "New feed update interval or time dialog"}, {"oid": "a73a932a7c773f09a9bb3965448fe3b4ccfe8ab2", "committedDate": "2021-10-12 21:14:08 +0200", "message": "Move speed dialog to the bottom (#5464)"}, {"oid": "44a7af8f737659d53aae1438a2e88b918caa0f41", "committedDate": "2021-10-13 22:27:45 +0200", "message": "Fewer default speed values"}, {"oid": "a93085a58d59b010c5c694f3cc808d3444000189", "committedDate": "2021-10-14 21:28:31 +0200", "message": "Use ff/rew as default notification buttons"}, {"oid": "b860ee33d0d5a3f0543697a3348bc1eb8f614965", "committedDate": "2021-10-16 07:50:58 +0200", "message": "Merge pull request #5469 from ByteHamster/compact-notification-button-default"}, {"oid": "3393bcdf350f60d006ce0de61d769f513490db82", "committedDate": "2022-01-22 19:46:08 +0100", "message": "Make emulator tests a bit more stable"}, {"oid": "069a2ca329a342ad0559a48719f49264d2610f00", "committedDate": "2022-04-26 17:57:42 +0200", "message": "Decouple preferences"}, {"oid": "5887a86cecea299e65569847f7dc02772934ec78", "committedDate": "2022-08-06 15:21:19 +0200", "message": "Remove favorites tab"}, {"oid": "ad9de4467bac4b8ca235010a6b8532621c3a03e1", "committedDate": "2022-09-10 16:09:26 +0200", "message": "Add 'default screen' setting (replaces 'back button behavior') (#6041)"}, {"oid": "d8a2dd5f83598fdde289e01994c5d2df1c6577fc", "committedDate": "2022-11-06 21:21:28 +0100", "message": "Move preferences to a new module"}, {"oid": "ef97411fbba3c229d63718966430469cb0f334b9", "committedDate": "2022-12-16 20:31:58 +0100", "message": "Migrate ListPreference to Material Design 3"}, {"oid": "997860fe522e67dff087e4184a80fc9656de28d8", "committedDate": "2023-02-18 14:51:55 +0100", "message": "Extra toggle for full black theme (#6328)"}, {"oid": "4f7f49e1e714ce41320fff569272a1423198b2f3", "committedDate": "2023-03-14 21:03:45 +0100", "message": "Move feed download to worker (#6375)"}, {"oid": "548f9e021ebdcfb3c09d5175c48b580b20012bb7", "committedDate": "2023-03-31 22:16:59 +0200", "message": "Random enqueue location (#6403)"}, {"oid": "8396a346707677ce22373a96e905bb1763d5cfb9", "committedDate": "2023-04-15 17:33:21 +0200", "message": "Replace Network+Storage preferences with Downloads (#6434)"}, {"oid": "6d7bfef8a5fe8180f13904739996bb2b8de8a0d4", "committedDate": "2023-05-05 23:09:03 +0200", "message": "Download Service Rewrite (#6420)"}]}, {"oid": "b44b0a3e36528482162d40cb8c3a1163ee0b7b63", "url": "https://github.com/AntennaPod/AntennaPod/commit/b44b0a3e36528482162d40cb8c3a1163ee0b7b63", "message": "revert back to onView().perform();", "committedDate": "2020-01-09T16:48:42Z", "type": "commit"}, {"oid": "e7a51361e9fc6e829af902b311f92ae703cf4b7c", "url": "https://github.com/AntennaPod/AntennaPod/commit/e7a51361e9fc6e829af902b311f92ae703cf4b7c", "message": "revert to onView() for theme testing", "committedDate": "2020-01-09T17:14:54Z", "type": "commit"}, {"oid": "05380c74db2de79c35fbf3d6b721b1e7133d0acf", "url": "https://github.com/AntennaPod/AntennaPod/commit/05380c74db2de79c35fbf3d6b721b1e7133d0acf", "message": "capital after comma", "committedDate": "2020-01-09T20:55:56Z", "type": "commit"}]}