{"pr_number": 8468, "pr_title": "Make handleFileUploadValidationAndData and sendUploadResponse protected", "pr_author": "jhult", "pr_createdAt": "2020-05-30T12:29:56Z", "pr_url": "https://github.com/vaadin/flow/pull/8468", "timeline": [{"oid": "0657cc2ace5429b53fa9c86d61d41399ea3ad622", "url": "https://github.com/vaadin/flow/commit/0657cc2ace5429b53fa9c86d61d41399ea3ad622", "message": "Make handleFileUploadValidationAndData and sendUploadResponse protected\n\nThis allows external code extending this class to reduce copy/pasting these and other private methods.", "committedDate": "2020-06-27T22:33:03Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjM2NTU2OA==", "url": "https://github.com/vaadin/flow/pull/8468#discussion_r496365568", "body": "```suggestion\r\n    /**\r\n     * Validate that stream target is in a valid state for receiving data\r\n     * and send stream to receiver. Handles cleanup and error in reading stream\r\n     *\r\n     * @param session\r\n     *         The session containing the stream variable\r\n     * @param inputStream\r\n     *         the request content input stream\r\n     * @param streamReceiver\r\n     *         the receiver containing the destination stream variable\r\n     * @param filename\r\n     *         name of the streamed file\r\n     * @param mimeType\r\n     *         file mime type\r\n     * @param contentLength\r\n     *         The length of the request content\r\n     * @param node\r\n     *         The owner of the stream\r\n     * @return true if upload successful, else false\r\n     * @throws UploadException\r\n     *         Thrown for illegal target node state\r\n     */\r\n    protected boolean handleFileUploadValidationAndData(VaadinSession session,\r\n```\r\n\r\nProtected methods need to have javadocs.", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                protected boolean handleFileUploadValidationAndData(VaadinSession session,\n          \n          \n            \n                /**\n          \n          \n            \n                 * Validate that stream target is in a valid state for receiving data\n          \n          \n            \n                 * and send stream to receiver. Handles cleanup and error in reading stream\n          \n          \n            \n                 *\n          \n          \n            \n                 * @param session\n          \n          \n            \n                 *         The session containing the stream variable\n          \n          \n            \n                 * @param inputStream\n          \n          \n            \n                 *         the request content input stream\n          \n          \n            \n                 * @param streamReceiver\n          \n          \n            \n                 *         the receiver containing the destination stream variable\n          \n          \n            \n                 * @param filename\n          \n          \n            \n                 *         name of the streamed file\n          \n          \n            \n                 * @param mimeType\n          \n          \n            \n                 *         file mime type\n          \n          \n            \n                 * @param contentLength\n          \n          \n            \n                 *         The length of the request content\n          \n          \n            \n                 * @param node\n          \n          \n            \n                 *         The owner of the stream\n          \n          \n            \n                 * @return true if upload successful, else false\n          \n          \n            \n                 * @throws UploadException\n          \n          \n            \n                 *         Thrown for illegal target node state\n          \n          \n            \n                 */\n          \n          \n            \n                protected boolean handleFileUploadValidationAndData(VaadinSession session,\n          \n      \n    \n    \n  \n\nProtected methods need to have javadocs.", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"351\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k x x-first\">protected</span><span class=\"x\"> </span><span class=\"pl-k x\">boolean</span><span class=\"x\"> handleFileUploadValidationAndData(</span><span class=\"pl-smi x\">VaadinSession</span><span class=\"x x-last\"> session,</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"351\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-c\"><span class=\"pl-c x x-first x-last\">/**</span></span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"352\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-smi\">Validate</span> that stream target is in a valid state <span class=\"pl-k\">for</span> receiving data</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"353\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> and send stream to receiver. <span class=\"pl-smi\">Handles</span> cleanup and error in reading stream</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"354\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"355\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-k\">@param</span> session</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"356\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span>         <span class=\"pl-smi\">The</span> session containing the stream variable</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"357\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-k\">@param</span> inputStream</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"358\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span>         the request content input stream</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"359\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-k\">@param</span> streamReceiver</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"360\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span>         the receiver containing the destination stream variable</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"361\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-k\">@param</span> filename</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"362\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span>         name of the streamed file</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"363\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-k\">@param</span> mimeType</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"364\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span>         file mime type</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"365\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-k\">@param</span> contentLength</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"366\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span>         <span class=\"pl-smi\">The</span> length of the request content</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"367\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-k\">@param</span> node</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"368\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span>         <span class=\"pl-smi\">The</span> owner of the stream</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"369\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-k\">@return</span> <span class=\"pl-c1\">true</span> <span class=\"pl-k\">if</span> upload successful, <span class=\"pl-k\">else</span> <span class=\"pl-c1\">false</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"370\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-k\">@throws</span> <span class=\"pl-smi\">UploadException</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"371\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span>         <span class=\"pl-smi\">Thrown</span> <span class=\"pl-k\">for</span> illegal target node state</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"372\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*/</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"373\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">protected</span> <span class=\"pl-k\">boolean</span> handleFileUploadValidationAndData(<span class=\"pl-smi\">VaadinSession</span> session,</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n\n<p dir=\"auto\">Protected methods need to have javadocs.</p>", "author": "caalador", "createdAt": "2020-09-29T04:05:55Z", "path": "flow-server/src/main/java/com/vaadin/flow/server/communication/StreamReceiverHandler.java", "diffHunk": "@@ -326,7 +326,7 @@ protected void doHandleXhrFilePost(VaadinSession session,\n         sendUploadResponse(response, success);\n     }\n \n-    private boolean handleFileUploadValidationAndData(VaadinSession session,\n+    protected boolean handleFileUploadValidationAndData(VaadinSession session,", "originalCommit": "0657cc2ace5429b53fa9c86d61d41399ea3ad622", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "9ada1c2a7e01ba0c9664e3d573a7fd0817f29f8e", "url": "https://github.com/vaadin/flow/commit/9ada1c2a7e01ba0c9664e3d573a7fd0817f29f8e", "message": "Make handleFileUploadValidationAndData and sendUploadResponse protected\n\nThis allows external code extending this class to reduce copy/pasting these and other private methods.\n\nAdd Javadoc for StreamReceiverHandler for protected `handleFileUploadValidationAndData` method\n\nCo-authored-by: caalador <mikael.grankvist@gmail.com>", "committedDate": "2020-10-07T10:27:53Z", "type": "commit"}, {"oid": "9ada1c2a7e01ba0c9664e3d573a7fd0817f29f8e", "url": "https://github.com/vaadin/flow/commit/9ada1c2a7e01ba0c9664e3d573a7fd0817f29f8e", "message": "Make handleFileUploadValidationAndData and sendUploadResponse protected\n\nThis allows external code extending this class to reduce copy/pasting these and other private methods.\n\nAdd Javadoc for StreamReceiverHandler for protected `handleFileUploadValidationAndData` method\n\nCo-authored-by: caalador <mikael.grankvist@gmail.com>", "committedDate": "2020-10-07T10:27:53Z", "type": "forcePushed"}]}