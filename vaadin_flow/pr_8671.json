{"pr_number": 8671, "pr_title": "Fix hierarchy for HasHierarchicalDataProvider", "pr_author": "pleku", "pr_createdAt": "2020-07-01T09:41:24Z", "pr_url": "https://github.com/vaadin/flow/pull/8671", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODI3NDExMA==", "url": "https://github.com/vaadin/flow/pull/8671#discussion_r448274110", "body": "![INFO](https://sonarsource.github.io/sonar-github/severity-info.png 'Severity: INFO') Do not forget to remove this deprecated code someday. [![rule](https://sonarsource.github.io/sonar-github/rule.png)](https://sonar.projects.vaadin.com/coding_rules#rule_key=squid%3AS1133)\n", "bodyText": "Do not forget to remove this deprecated code someday.", "bodyHTML": "<p dir=\"auto\"><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://camo.githubusercontent.com/a59bbc935b09d221e76be76443469ac9de22f19c879fed4fa25b4eb03ad53f5a/68747470733a2f2f736f6e6172736f757263652e6769746875622e696f2f736f6e61722d6769746875622f73657665726974792d696e666f2e706e67\"><img src=\"https://camo.githubusercontent.com/a59bbc935b09d221e76be76443469ac9de22f19c879fed4fa25b4eb03ad53f5a/68747470733a2f2f736f6e6172736f757263652e6769746875622e696f2f736f6e61722d6769746875622f73657665726974792d696e666f2e706e67\" alt=\"INFO\" title=\"Severity: INFO\" data-canonical-src=\"https://sonarsource.github.io/sonar-github/severity-info.png\" style=\"max-width: 100%;\"></a> Do not forget to remove this deprecated code someday. <a href=\"https://sonar.projects.vaadin.com/coding_rules#rule_key=squid%3AS1133\" rel=\"nofollow\"><img src=\"https://camo.githubusercontent.com/90a66c56e56d5e4647676830313fa0693466067889c4c7dc2d7519da5a924230/68747470733a2f2f736f6e6172736f757263652e6769746875622e696f2f736f6e61722d6769746875622f72756c652e706e67\" alt=\"rule\" data-canonical-src=\"https://sonarsource.github.io/sonar-github/rule.png\" style=\"max-width: 100%;\"></a></p>", "author": "vaadin-bot", "createdAt": "2020-07-01T10:37:25Z", "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/hierarchy/HasHierarchicalDataProvider.java", "diffHunk": "@@ -157,108 +158,26 @@ public default void setItems(Stream<T> rootItems,\n     }\n \n     /**\n-     * Sets the data items of this component provided as a collection.\n+     * Sets the data provider for this listing. The data provider is queried for\n+     * displayed items as needed.\n      * <p>\n-     * The provided items are wrapped into a {@link TreeDataProvider} backed by\n-     * a flat {@link TreeData} structure. The data provider instance is used as\n-     * a parameter for the {@link #setDataProvider(DataProvider)} method. It\n-     * means that the items collection can be accessed later on via\n-     * {@link #getTreeData()}:\n-     *\n-     * <pre>\n-     * <code>\n-     * HasHierarchicalDataProvider&lt;String&gt; treeGrid = new TreeGrid&lt;&gt;();\n-     * treeGrid.setItems(Arrays.asList(\"a\",\"b\"));\n-     * ...\n-     *\n-     * TreeData&lt;String&gt; data = treeGrid.getTreeData();\n-     * </code>\n-     * </pre>\n-     * <p>\n-     * The returned {@link TreeData} instance may be used as-is to add, remove\n-     * or modify items in the hierarchy. These modifications to the object are\n-     * not automatically reflected back to the TreeGrid. Items modified should\n-     * be refreshed with {@link HierarchicalDataProvider#refreshItem(Object)}\n-     * and when adding or removing items\n-     * {@link HierarchicalDataProvider#refreshAll()} should be called.\n-     *\n-     * @param items\n-     *            the data items to display, not {@code null}\n+     * <em>NOTE:</em> This method is here for backwards compatibility, but the\n+     * implementation for it will most likely throw if the data provider is not\n+     * a {@link HierarchicalDataProvider}.\n+     * \n+     * @param dataProvider\n+     *            the data provider, not null\n+     * @deprecated Use {@link #setDataProvider(HierarchicalDataProvider)}\n+     *             instead as the data should be hierarchical\n      */\n-    @Override\n-    public default void setItems(Collection<T> items) {\n-        Objects.requireNonNull(items, \"Given collection may not be null\");\n-        setDataProvider(new TreeDataProvider<>(\n-                new TreeData<T>().addItems(null, items)));\n-    }\n+    void setDataProvider(DataProvider<T, ?> dataProvider);", "originalCommit": "85fdde25b69d79ca33607e9d30b494dbe530ae18", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "cf401d2bf9b58466579d6199ad8fe4beaee54bfa", "url": "https://github.com/vaadin/flow/commit/cf401d2bf9b58466579d6199ad8fe4beaee54bfa", "message": "Fix hierarchy for HasHierarchicalDataProvider\n\nHasHierarchicalDataProvider cannot extend HasDataProvider anymore.\nRemoves \"flat data\" API from HasHierarchicalDataProvider so it does not\ncause compile errors for tree grid which extends grid and implements\nHasHierarchicalDataProvider. This is a breaking change.\n\nGrid part in https://github.com/vaadin/vaadin-grid-flow/pull/1057\n\nPart of vaadin/vaadin-grid-flow#1027", "committedDate": "2020-07-01T13:42:30Z", "type": "commit"}, {"oid": "cf401d2bf9b58466579d6199ad8fe4beaee54bfa", "url": "https://github.com/vaadin/flow/commit/cf401d2bf9b58466579d6199ad8fe4beaee54bfa", "message": "Fix hierarchy for HasHierarchicalDataProvider\n\nHasHierarchicalDataProvider cannot extend HasDataProvider anymore.\nRemoves \"flat data\" API from HasHierarchicalDataProvider so it does not\ncause compile errors for tree grid which extends grid and implements\nHasHierarchicalDataProvider. This is a breaking change.\n\nGrid part in https://github.com/vaadin/vaadin-grid-flow/pull/1057\n\nPart of vaadin/vaadin-grid-flow#1027", "committedDate": "2020-07-01T13:42:30Z", "type": "forcePushed"}]}