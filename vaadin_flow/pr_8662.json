{"pr_number": 8662, "pr_title": "Use ItemCount instead of size and RowCount #8651", "pr_author": "mshabarov", "pr_createdAt": "2020-06-30T14:22:53Z", "pr_url": "https://github.com/vaadin/flow/pull/8662", "timeline": [{"oid": "129b62c61932c8bb7e0ccdc5564dff38329d400b", "url": "https://github.com/vaadin/flow/commit/129b62c61932c8bb7e0ccdc5564dff38329d400b", "message": "Use ItemCount instead of size and RowCount #8651", "committedDate": "2020-06-30T15:32:30Z", "type": "commit"}, {"oid": "4dafd0a3f85ec24886e1e39a662556ab2ee483d9", "url": "https://github.com/vaadin/flow/commit/4dafd0a3f85ec24886e1e39a662556ab2ee483d9", "message": "HasLazyDataViewTest fix", "committedDate": "2020-06-30T15:42:32Z", "type": "commit"}, {"oid": "4dafd0a3f85ec24886e1e39a662556ab2ee483d9", "url": "https://github.com/vaadin/flow/commit/4dafd0a3f85ec24886e1e39a662556ab2ee483d9", "message": "HasLazyDataViewTest fix", "committedDate": "2020-06-30T15:42:32Z", "type": "forcePushed"}, {"oid": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "url": "https://github.com/vaadin/flow/commit/dff3421e97f889d4b415351ae7a6f3b047f9dec1", "message": "Check the size via datacommunicator API", "committedDate": "2020-06-30T15:49:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgyNjg0OQ==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r447826849", "body": "```suggestion\r\n * Event describing the item count change for a component.\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Event describing the data item count change for a component data set.\n          \n          \n            \n             * Event describing the item count change for a component.", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"> <span class=\"pl-k\">*</span> <span class=\"pl-smi\">Event</span> describing the <span class=\"x x-first x-last\">data </span>item count change <span class=\"pl-k\">for</span> a component<span class=\"x x-first x-last\"> data set</span>.</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\"> <span class=\"pl-k\">*</span> <span class=\"pl-smi\">Event</span> describing the item count change <span class=\"pl-k\">for</span> a component.</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "pleku", "createdAt": "2020-06-30T16:40:28Z", "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/ItemCountChangeEvent.java", "diffHunk": "@@ -19,37 +19,34 @@\n import com.vaadin.flow.component.ComponentEvent;\n \n /**\n- * Event describing the data size change for a component data set.\n- * The SizeChangedEvent will fired from beforeClientResponse so changes done\n- * during the server round trip will only receive one event.\n+ * Event describing the data item count change for a component data set.", "originalCommit": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxMjE3OQ==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r448212179", "bodyText": "done", "author": "mshabarov", "createdAt": "2020-07-01T08:44:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgyNjg0OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgyOTExNA==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r447829114", "body": "> The ItemCountChangedEvent will fired from beforeClientResponse so changes\r\n\r\nI think this means absolutely nothing for majority of the users so should be fixed since you're touching the line", "bodyText": "The ItemCountChangedEvent will fired from beforeClientResponse so changes\n\nI think this means absolutely nothing for majority of the users so should be fixed since you're touching the line", "bodyHTML": "<blockquote>\n<p dir=\"auto\">The ItemCountChangedEvent will fired from beforeClientResponse so changes</p>\n</blockquote>\n<p dir=\"auto\">I think this means absolutely nothing for majority of the users so should be fixed since you're touching the line</p>", "author": "pleku", "createdAt": "2020-06-30T16:43:49Z", "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/ItemCountChangeEvent.java", "diffHunk": "@@ -19,37 +19,34 @@\n import com.vaadin.flow.component.ComponentEvent;\n \n /**\n- * Event describing the data size change for a component data set.\n- * The SizeChangedEvent will fired from beforeClientResponse so changes done\n- * during the server round trip will only receive one event.\n+ * Event describing the data item count change for a component data set.\n+ * The ItemCountChangedEvent will fired from beforeClientResponse so changes", "originalCommit": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxMjI3Ng==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r448212276", "bodyText": "done", "author": "mshabarov", "createdAt": "2020-07-01T08:44:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgyOTExNA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzMTE2OA==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r447831168", "body": "```suggestion\r\n * Listener interface for getting updates on item count changes. The\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             * Listener interface for getting updates on data item count changes. The\n          \n          \n            \n             * Listener interface for getting updates on item count changes. The", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"> <span class=\"pl-k\">*</span> Listener <span class=\"pl-k\">interface</span> <span class=\"pl-en\">for</span> getting updates on <span class=\"x x-first x-last\">data </span>item count changes. The</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\"> <span class=\"pl-k\">*</span> Listener <span class=\"pl-k\">interface</span> <span class=\"pl-en\">for</span> getting updates on item count changes. The</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "pleku", "createdAt": "2020-06-30T16:47:02Z", "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/ItemCountChangeListener.java", "diffHunk": "@@ -18,24 +18,24 @@\n import java.io.Serializable;\n \n /**\n- * Listener interface for getting updates on data set size changes. The\n- * sizeChanged method will be called on beforeClientResponse so changes done\n+ * Listener interface for getting updates on data item count changes. The", "originalCommit": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxMjMxMw==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r448212313", "bodyText": "done", "author": "mshabarov", "createdAt": "2020-07-01T08:45:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzMTE2OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzMTQyNQ==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r447831425", "body": "Again, \"called on beforeClientResponse\" really means nothing to the majority of the users", "bodyText": "Again, \"called on beforeClientResponse\" really means nothing to the majority of the users", "bodyHTML": "<p dir=\"auto\">Again, \"called on beforeClientResponse\" really means nothing to the majority of the users</p>", "author": "pleku", "createdAt": "2020-06-30T16:47:28Z", "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/ItemCountChangeListener.java", "diffHunk": "@@ -18,24 +18,24 @@\n import java.io.Serializable;\n \n /**\n- * Listener interface for getting updates on data set size changes. The\n- * sizeChanged method will be called on beforeClientResponse so changes done\n+ * Listener interface for getting updates on data item count changes. The\n+ * itemCountChanged method will be called on beforeClientResponse so changes done", "originalCommit": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxMjM5MQ==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r448212391", "bodyText": "done", "author": "mshabarov", "createdAt": "2020-07-01T08:45:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzMTQyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzMTgwMg==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r447831802", "body": "```suggestion\r\n     * in the backend. Use this when it is cheap to get the exact item\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * (items) in the backend. Use this when it is cheap to get the exact item\n          \n          \n            \n                 * in the backend. Use this when it is cheap to get the exact item", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">     <span class=\"pl-k\">*</span> <span class=\"x x-first x-last\">(items) </span>in the backend. <span class=\"pl-smi\">Use</span> <span class=\"pl-c1\">this</span> when it is cheap to get the exact item</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> in the backend. <span class=\"pl-smi\">Use</span> <span class=\"pl-c1\">this</span> when it is cheap to get the exact item</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "pleku", "createdAt": "2020-06-30T16:48:04Z", "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/LazyDataView.java", "diffHunk": "@@ -25,7 +25,7 @@\n public interface LazyDataView<T> extends DataView<T> {\n \n     /**\n-     * Sets a callback that the component uses to get the exact rows count\n+     * Sets a callback that the component uses to get the exact item count\n      * (items) in the backend. Use this when it is cheap to get the exact item", "originalCommit": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxMjQzOQ==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r448212439", "bodyText": "done", "author": "mshabarov", "createdAt": "2020-07-01T08:45:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzMTgwMg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzMzUzNg==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r447833536", "body": "```suggestion\r\n     * Get the full item count with filters if any set. As the item count\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Get the full data item count with filters if any set. As the item count\n          \n          \n            \n                 * Get the full item count with filters if any set. As the item count", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">     <span class=\"pl-k\">*</span> <span class=\"pl-smi\">Get</span> the full <span class=\"x x-first x-last\">data </span>item count with filters <span class=\"pl-k\">if</span> any set. <span class=\"pl-smi\">As</span> the item count</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-smi\">Get</span> the full item count with filters <span class=\"pl-k\">if</span> any set. <span class=\"pl-smi\">As</span> the item count</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "pleku", "createdAt": "2020-06-30T16:50:49Z", "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/ListDataView.java", "diffHunk": "@@ -34,6 +35,17 @@\n  */\n public interface ListDataView<T, V extends ListDataView<T, ?>>\n         extends DataView<T> {\n+    /**\n+     * Get the full data item count with filters if any set. As the item count", "originalCommit": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxMjUxMQ==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r448212511", "bodyText": "done", "author": "mshabarov", "createdAt": "2020-07-01T08:45:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzMzUzNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzNDgyNA==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r447834824", "body": "This will need fixing in https://github.com/vaadin/flow/issues/8655 as I supposed it now works by accident since the filters go to the data provider ", "bodyText": "This will need fixing in #8655 as I supposed it now works by accident since the filters go to the data provider", "bodyHTML": "<p dir=\"auto\">This will need fixing in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"648008394\" data-permission-text=\"Title is private\" data-url=\"https://github.com/vaadin/flow/issues/8655\" data-hovercard-type=\"issue\" data-hovercard-url=\"/vaadin/flow/issues/8655/hovercard\" href=\"https://github.com/vaadin/flow/issues/8655\">#8655</a> as I supposed it now works by accident since the filters go to the data provider</p>", "author": "pleku", "createdAt": "2020-06-30T16:52:47Z", "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/AbstractListDataView.java", "diffHunk": "@@ -67,6 +67,11 @@ public AbstractListDataView(\n         super(dataProviderSupplier, component);\n     }\n \n+    @Override\n+    public int getItemCount() {\n+        return getDataProvider().size(new Query<>());", "originalCommit": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzNjI0NA==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r447836244", "body": "```suggestion\r\n     * Add an item count change listener that is fired when the item\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Add an item count change listener that is fired when the data item\n          \n          \n            \n                 * Add an item count change listener that is fired when the item", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">     <span class=\"pl-k\">*</span> <span class=\"pl-smi\">Add</span> an item count change listener that is fired when the <span class=\"x x-first x-last\">data </span>item</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">     <span class=\"pl-k\">*</span> <span class=\"pl-smi\">Add</span> an item count change listener that is fired when the item</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "pleku", "createdAt": "2020-06-30T16:55:00Z", "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataView.java", "diffHunk": "@@ -78,19 +67,19 @@\n     boolean contains(T item);\n \n     /**\n-     * Add a size change listener that is fired when the data set size changes.\n-     * This can happen for instance when filtering the data set.\n+     * Add an item count change listener that is fired when the data item", "originalCommit": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxNDM3Mw==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r448214373", "bodyText": "done", "author": "mshabarov", "createdAt": "2020-07-01T08:48:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzNjI0NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzODg1Ng==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r447838856", "body": "You should refactor this instead to use `ItemCountChangeListener` to verify the correct size", "bodyText": "You should refactor this instead to use ItemCountChangeListener to verify the correct size", "bodyHTML": "<p dir=\"auto\">You should refactor this instead to use <code>ItemCountChangeListener</code> to verify the correct size</p>", "author": "pleku", "createdAt": "2020-06-30T16:58:56Z", "path": "flow-data/src/test/java/com/vaadin/flow/data/provider/AbstractLazyDataViewTest.java", "diffHunk": "@@ -160,57 +160,6 @@ public void contains_itemsNotFetched_canCheckForItemWithBeforeClientResponse() {\n                 capturedContains.get());\n     }\n \n-    @Test\n-    public void size_withDefinedSize() {", "originalCommit": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxNDY5Ng==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r448214696", "bodyText": "done", "author": "mshabarov", "createdAt": "2020-07-01T08:49:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzODg1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzODkxNw==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r447838917", "body": "You should refactor this instead to use `ItemCountChangeListener` to verify the correct size", "bodyText": "You should refactor this instead to use ItemCountChangeListener to verify the correct size", "bodyHTML": "<p dir=\"auto\">You should refactor this instead to use <code>ItemCountChangeListener</code> to verify the correct size</p>", "author": "pleku", "createdAt": "2020-06-30T16:59:01Z", "path": "flow-data/src/test/java/com/vaadin/flow/data/provider/AbstractLazyDataViewTest.java", "diffHunk": "@@ -160,57 +160,6 @@ public void contains_itemsNotFetched_canCheckForItemWithBeforeClientResponse() {\n                 capturedContains.get());\n     }\n \n-    @Test\n-    public void size_withDefinedSize() {\n-        dataCommunicator.setRequestedRange(0, 50);\n-        Assert.assertEquals(\"Invalid size reported\", 3, dataView.getSize());\n-\n-        dataView.setRowCountCallback(query -> 5);\n-\n-        Assert.assertEquals(\"Invalid size reported\", 5, dataView.getSize());\n-    }\n-\n-    @Test\n-    public void size_withUndefinedSize() {", "originalCommit": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxNDc2MA==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r448214760", "bodyText": "done", "author": "mshabarov", "createdAt": "2020-07-01T08:49:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzgzODkxNw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0MzA2MQ==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r447843061", "body": "```suggestion\r\n    public void setCountCallback_itemCountEstimatesWereSet_overridesItemCountEstimates() {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public void setSizeCallback_itemCountEstimatesWereSet_overridesItemCountEstimates() {\n          \n          \n            \n                public void setCountCallback_itemCountEstimatesWereSet_overridesItemCountEstimates() {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"x x-first x-last\">setSizeCallback_itemCountEstimatesWereSet_overridesItemCountEstimates</span>() {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"x x-first x-last\">setCountCallback_itemCountEstimatesWereSet_overridesItemCountEstimates</span>() {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "pleku", "createdAt": "2020-06-30T17:05:23Z", "path": "flow-data/src/test/java/com/vaadin/flow/data/provider/DataCommunicatorTest.java", "diffHunk": "@@ -393,23 +393,23 @@ public void setSizeCallback_null_throws() {\n     }\n \n     @Test\n-    public void setSizeCallback_rowCountEstimatesWereSet_overridesRowCountEstimates() {\n+    public void setSizeCallback_itemCountEstimatesWereSet_overridesItemCountEstimates() {", "originalCommit": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxNDgxNA==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r448214814", "bodyText": "done", "author": "mshabarov", "createdAt": "2020-07-01T08:49:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0MzA2MQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0NDM3NA==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r447844374", "body": "Tests names in this class could refer to `CountEstimate` too instead of `sizeEstimate` ", "bodyText": "Tests names in this class could refer to CountEstimate too instead of sizeEstimate", "bodyHTML": "<p dir=\"auto\">Tests names in this class could refer to <code>CountEstimate</code> too instead of <code>sizeEstimate</code></p>", "author": "pleku", "createdAt": "2020-06-30T17:07:00Z", "path": "flow-data/src/test/java/com/vaadin/flow/data/provider/DataCommunicatorTest.java", "diffHunk": "@@ -438,7 +438,7 @@ public void setInitialSizeEstimate_usedInitiallyThenDiscarded() {\n         dataCommunicator.setDataProvider(dataProvider, null);", "originalCommit": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxNDg2NQ==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r448214865", "bodyText": "done", "author": "mshabarov", "createdAt": "2020-07-01T08:49:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0NDM3NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0NTQxMA==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r447845410", "body": "I would rename this method now too", "bodyText": "I would rename this method now too", "bodyHTML": "<p dir=\"auto\">I would rename this method now too</p>", "author": "pleku", "createdAt": "2020-06-30T17:08:33Z", "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataCommunicator.java", "diffHunk": "@@ -782,21 +782,21 @@ private void flush() {\n     }\n \n     /**\n-     * Fire a size change event if the last event was fired for a different size\n-     * from the last sent one.\n+     * Fire a item count change event if the last event was fired for a\n+     * different size from the last sent one.\n      *\n-     * @param dataSize\n-     *            data size to send\n+     * @param itemCount\n+     *            data item count to send\n      */\n-    private void fireSizeEvent(int dataSize) {\n-        if (lastSent != dataSize) {\n+    private void fireSizeEvent(int itemCount) {", "originalCommit": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxNDkxMQ==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r448214911", "bodyText": "done", "author": "mshabarov", "createdAt": "2020-07-01T08:49:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0NTQxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0NTcxMQ==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r447845711", "body": "The `getDataSize` method should be renamed too", "bodyText": "The getDataSize method should be renamed too", "bodyHTML": "<p dir=\"auto\">The <code>getDataSize</code> method should be renamed too</p>", "author": "pleku", "createdAt": "2020-06-30T17:09:07Z", "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataCommunicator.java", "diffHunk": "@@ -397,79 +397,79 @@ public void setCountCallback(\n     }\n \n     /**\n-     * Sets the row count estimate to use and switches component to undefined\n+     * Sets the item count estimate to use and switches component to undefined\n      * size. Any previously set count callback is cleared. The new estimate is\n      * applied if the actual count has not been discovered and if the estimate\n      * is greater than the number of requested items. Otherwise it is not\n      * applied until there has been a reset.\n      * <p>\n-     * <em>NOTE:</em> setting row count estimate that is less than two pages\n+     * <em>NOTE:</em> setting item count estimate that is less than two pages\n      * (set with {@link #setPageSize(int)}) can cause extra requests initially\n      * or after a reset.\n      * \n-     * @param rowCountEstimate\n-     *            the row count estimate to be used\n+     * @param itemCountEstimate\n+     *            the item count estimate to be used\n      */\n-    public void setRowCountEstimate(int rowCountEstimate) {\n-        if (rowCountEstimate < 1) {\n+    public void setItemCountEstimate(int itemCountEstimate) {\n+        if (itemCountEstimate < 1) {\n             throw new IllegalArgumentException(\n-                    \"Given row count estimate cannot be less than 1.\");\n+                    \"Given item count estimate cannot be less than 1.\");\n         }\n-        this.rowCountEstimate = rowCountEstimate;\n+        this.itemCountEstimate = itemCountEstimate;\n         this.countCallback = null;\n         definedSize = false;\n         if (!skipSizeCheckUntilReset\n-                && requestedRange.getEnd() < rowCountEstimate) {\n+                && requestedRange.getEnd() < itemCountEstimate) {\n             sizeReset = true;\n             requestFlush();\n         }\n     }\n ", "originalCommit": "dff3421e97f889d4b415351ae7a6f3b047f9dec1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIxNDk3NQ==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r448214975", "bodyText": "done", "author": "mshabarov", "createdAt": "2020-07-01T08:49:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg0NTcxMQ=="}], "type": "inlineReview"}, {"oid": "44bb49b24765b127cc5d29d48d53191b772f5f7b", "url": "https://github.com/vaadin/flow/commit/44bb49b24765b127cc5d29d48d53191b772f5f7b", "message": "Fix naming and refactor the tests", "committedDate": "2020-07-01T08:14:01Z", "type": "commit"}, {"oid": "a740e5b8a5bc676a79c1b024bcc7173d43d4d85f", "url": "https://github.com/vaadin/flow/commit/a740e5b8a5bc676a79c1b024bcc7173d43d4d85f", "message": "Improve item count change event javadoc", "committedDate": "2020-07-01T08:43:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODIyNDE1OQ==", "url": "https://github.com/vaadin/flow/pull/8662#discussion_r448224159", "body": "![INFO](https://sonarsource.github.io/sonar-github/severity-info.png 'Severity: INFO') Complete the task associated to this TODO comment. [![rule](https://sonarsource.github.io/sonar-github/rule.png)](https://sonar.projects.vaadin.com/coding_rules#rule_key=squid%3AS1135)\n", "bodyText": "Complete the task associated to this TODO comment.", "bodyHTML": "<p dir=\"auto\"><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://camo.githubusercontent.com/a59bbc935b09d221e76be76443469ac9de22f19c879fed4fa25b4eb03ad53f5a/68747470733a2f2f736f6e6172736f757263652e6769746875622e696f2f736f6e61722d6769746875622f73657665726974792d696e666f2e706e67\"><img src=\"https://camo.githubusercontent.com/a59bbc935b09d221e76be76443469ac9de22f19c879fed4fa25b4eb03ad53f5a/68747470733a2f2f736f6e6172736f757263652e6769746875622e696f2f736f6e61722d6769746875622f73657665726974792d696e666f2e706e67\" alt=\"INFO\" title=\"Severity: INFO\" data-canonical-src=\"https://sonarsource.github.io/sonar-github/severity-info.png\" style=\"max-width: 100%;\"></a> Complete the task associated to this TODO comment. <a href=\"https://sonar.projects.vaadin.com/coding_rules#rule_key=squid%3AS1135\" rel=\"nofollow\"><img src=\"https://camo.githubusercontent.com/90a66c56e56d5e4647676830313fa0693466067889c4c7dc2d7519da5a924230/68747470733a2f2f736f6e6172736f757263652e6769746875622e696f2f736f6e61722d6769746875622f72756c652e706e67\" alt=\"rule\" data-canonical-src=\"https://sonarsource.github.io/sonar-github/rule.png\" style=\"max-width: 100%;\"></a></p>", "author": "vaadin-bot", "createdAt": "2020-07-01T09:05:29Z", "path": "flow-data/src/main/java/com/vaadin/flow/data/provider/DataCommunicator.java", "diffHunk": "@@ -284,12 +284,12 @@ public void confirmUpdate(int updateId) {\n     }\n \n     /**\n-     * This is the latest DataProvider size informed to the client or fetched\n-     * from the DataProvider if client data has not been sent.\n+     * This is the latest DataProvider item count informed to the client or\n+     * fetched from the DataProvider if client data has not been sent.\n      *\n-     * @return size of available data\n+     * @return count of available items\n      */\n-    public int getDataSize() {\n+    public int getItemCount() {\n         if (isDefinedSize()\n                 && (resendEntireRange || assumeEmptyClient || sizeReset)) {\n             // TODO it could be possible to cache the value returned here", "originalCommit": "a740e5b8a5bc676a79c1b024bcc7173d43d4d85f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}