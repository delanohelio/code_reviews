{"pr_number": 3191, "pr_title": "Fix #3190: fix mob breeding cooldown", "pr_author": "PolyacovYury", "pr_createdAt": "2020-10-15T10:40:46Z", "pr_url": "https://github.com/SpongePowered/Sponge/pull/3191", "timeline": [{"oid": "1e252b23b95b3bac96cd6299a7043e3d5429f308", "url": "https://github.com/SpongePowered/Sponge/commit/1e252b23b95b3bac96cd6299a7043e3d5429f308", "message": "Fix #3190: fix mob breeding cooldown", "committedDate": "2020-10-15T10:39:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc5MDgyNQ==", "url": "https://github.com/SpongePowered/Sponge/pull/3191#discussion_r505790825", "body": "Rather than do this which is confusing to read, I'd much rather make this a simple if statement - something like:\r\n\r\n```java\r\nif (age > 0) {\r\n    this.setGrowingAge(Math.max(0, age - diff));\r\n} else {\r\n    this.setGrowingAge(Math.min(0, age + diff));\r\n}\r\n```\r\n\r\nThat way it's a lot clearer about what's happening. Could also have a branch that bypasses these things completely if `diff = 0`", "bodyText": "Rather than do this which is confusing to read, I'd much rather make this a simple if statement - something like:\nif (age > 0) {\n    this.setGrowingAge(Math.max(0, age - diff));\n} else {\n    this.setGrowingAge(Math.min(0, age + diff));\n}\nThat way it's a lot clearer about what's happening. Could also have a branch that bypasses these things completely if diff = 0", "bodyHTML": "<p dir=\"auto\">Rather than do this which is confusing to read, I'd much rather make this a simple if statement - something like:</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"if (age &gt; 0) {\n    this.setGrowingAge(Math.max(0, age - diff));\n} else {\n    this.setGrowingAge(Math.min(0, age + diff));\n}\n\"><pre><span class=\"pl-k\">if</span> (age <span class=\"pl-k\">&gt;</span> <span class=\"pl-c1\">0</span>) {\n    <span class=\"pl-c1\">this</span><span class=\"pl-k\">.</span>setGrowingAge(<span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>max(<span class=\"pl-c1\">0</span>, age <span class=\"pl-k\">-</span> diff));\n} <span class=\"pl-k\">else</span> {\n    <span class=\"pl-c1\">this</span><span class=\"pl-k\">.</span>setGrowingAge(<span class=\"pl-smi\">Math</span><span class=\"pl-k\">.</span>min(<span class=\"pl-c1\">0</span>, age <span class=\"pl-k\">+</span> diff));\n}</pre></div>\n<p dir=\"auto\">That way it's a lot clearer about what's happening. Could also have a branch that bypasses these things completely if <code>diff = 0</code></p>", "author": "dualspiral", "createdAt": "2020-10-15T19:34:34Z", "path": "src/main/java/org/spongepowered/common/mixin/realtime/entity/EntityAgeableMixin_RealTime.java", "diffHunk": "@@ -45,7 +45,10 @@\n         }\n         // Subtract the one the original update method added\n         final int diff = (int) ((RealTimeTrackingBridge) this.world).realTimeBridge$getRealTimeTicks() - 1;\n-        this.setGrowingAge(Math.min(0, age + diff));\n+        // age is positive ? subtract : add\n+        final int new_age = age - (int) Math.signum(age) * diff;", "originalCommit": "1e252b23b95b3bac96cd6299a7043e3d5429f308", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjE2NzE0NA==", "url": "https://github.com/SpongePowered/Sponge/pull/3191#discussion_r506167144", "bodyText": "Agreed. Didn't think of that for some reason :D", "author": "PolyacovYury", "createdAt": "2020-10-16T08:27:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc5MDgyNQ=="}], "type": "inlineReview"}, {"oid": "bf05e42411ec342e9f5fe1e2cc0947b992c44fb5", "url": "https://github.com/SpongePowered/Sponge/commit/bf05e42411ec342e9f5fe1e2cc0947b992c44fb5", "message": "This is, indeed, less confusing to read. Thx, @dualspiral", "committedDate": "2020-10-16T08:31:35Z", "type": "commit"}]}