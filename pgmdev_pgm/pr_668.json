{"pr_number": 668, "pr_title": "Improve freeze alert broadcast", "pr_author": "applenick", "pr_createdAt": "2020-10-01T06:32:45Z", "pr_url": "https://github.com/PGMDev/PGM/pull/668", "timeline": [{"oid": "a3fd684c67c74df591a426c9da86484532e579d9", "url": "https://github.com/PGMDev/PGM/commit/a3fd684c67c74df591a426c9da86484532e579d9", "message": "Improve freeze alert broadcast\n* Adds an interactive click to reverse freeze action\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-10-01T05:53:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODI5MTc4Mg==", "url": "https://github.com/PGMDev/PGM/pull/668#discussion_r498291782", "body": "Is this mixed up?\r\nConstuctor calls for `senderName`, `targetName`. Seems like you are sending `targetName` and then `senderName` rn\r\nAlso considered just having a constructor `MatchPlayer sender, MatchPlayer target, boolean frozen` ?\r\n\r\nso a method `Component createInteractiveFreezeBroadcast` could be something like\r\n```java\r\n return TextComponent.builder()\r\n.append(\r\n              TranslatableComponent.of(\r\n                  String.format(\"moderation.freeze.broadcast.%s\", frozen ? \"frozen\" : \"thaw\"),\r\n                  TextColor.GRAY,\r\n                  sender.getName(NameStyle.CONCISE),\r\n                  target.getName(NameStyle.CONCISE))\r\n          .hoverEvent(\r\n              HoverEvent.showText(\r\n                  TranslatableComponent.of(\"moderation.freeze.broadcast.hover\", TextColor.GRAY)))\r\n          .clickEvent(ClickEvent.runCommand(\"/f \" + target.getBukkit().getName())\r\n          .build();\r\n```\r\nThe thing i think is weird is passing a `targetName` and a `username`", "bodyText": "Is this mixed up?\nConstuctor calls for senderName, targetName. Seems like you are sending targetName and then senderName rn\nAlso considered just having a constructor MatchPlayer sender, MatchPlayer target, boolean frozen ?\nso a method Component createInteractiveFreezeBroadcast could be something like\n return TextComponent.builder()\n.append(\n              TranslatableComponent.of(\n                  String.format(\"moderation.freeze.broadcast.%s\", frozen ? \"frozen\" : \"thaw\"),\n                  TextColor.GRAY,\n                  sender.getName(NameStyle.CONCISE),\n                  target.getName(NameStyle.CONCISE))\n          .hoverEvent(\n              HoverEvent.showText(\n                  TranslatableComponent.of(\"moderation.freeze.broadcast.hover\", TextColor.GRAY)))\n          .clickEvent(ClickEvent.runCommand(\"/f \" + target.getBukkit().getName())\n          .build();\nThe thing i think is weird is passing a targetName and a username", "bodyHTML": "<p dir=\"auto\">Is this mixed up?<br>\nConstuctor calls for <code>senderName</code>, <code>targetName</code>. Seems like you are sending <code>targetName</code> and then <code>senderName</code> rn<br>\nAlso considered just having a constructor <code>MatchPlayer sender, MatchPlayer target, boolean frozen</code> ?</p>\n<p dir=\"auto\">so a method <code>Component createInteractiveFreezeBroadcast</code> could be something like</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\" return TextComponent.builder()\n.append(\n              TranslatableComponent.of(\n                  String.format(&quot;moderation.freeze.broadcast.%s&quot;, frozen ? &quot;frozen&quot; : &quot;thaw&quot;),\n                  TextColor.GRAY,\n                  sender.getName(NameStyle.CONCISE),\n                  target.getName(NameStyle.CONCISE))\n          .hoverEvent(\n              HoverEvent.showText(\n                  TranslatableComponent.of(&quot;moderation.freeze.broadcast.hover&quot;, TextColor.GRAY)))\n          .clickEvent(ClickEvent.runCommand(&quot;/f &quot; + target.getBukkit().getName())\n          .build();\"><pre> <span class=\"pl-k\">return</span> <span class=\"pl-smi\">TextComponent</span><span class=\"pl-k\">.</span>builder()\n.append(\n              <span class=\"pl-smi\">TranslatableComponent</span><span class=\"pl-k\">.</span>of(\n                  <span class=\"pl-smi\">String</span><span class=\"pl-k\">.</span>format(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>moderation.freeze.broadcast.%s<span class=\"pl-pds\">\"</span></span>, frozen <span class=\"pl-k\">?</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>frozen<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>thaw<span class=\"pl-pds\">\"</span></span>),\n                  <span class=\"pl-smi\">TextColor</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>GRAY</span>,\n                  sender<span class=\"pl-k\">.</span>getName(<span class=\"pl-smi\">NameStyle</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>CONCISE</span>),\n                  target<span class=\"pl-k\">.</span>getName(<span class=\"pl-smi\">NameStyle</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>CONCISE</span>))\n          .hoverEvent(\n              <span class=\"pl-smi\">HoverEvent</span><span class=\"pl-k\">.</span>showText(\n                  <span class=\"pl-smi\">TranslatableComponent</span><span class=\"pl-k\">.</span>of(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>moderation.freeze.broadcast.hover<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">TextColor</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>GRAY</span>)))\n          .clickEvent(<span class=\"pl-smi\">ClickEvent</span><span class=\"pl-k\">.</span>runCommand(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/f <span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">+</span> target<span class=\"pl-k\">.</span>getBukkit()<span class=\"pl-k\">.</span>getName())\n          .build();</pre></div>\n<p dir=\"auto\">The thing i think is weird is passing a <code>targetName</code> and a <code>username</code></p>", "author": "KingOfSquares", "createdAt": "2020-10-01T14:32:43Z", "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -369,14 +368,27 @@ private void thaw(MatchPlayer freezee, Component senderName, boolean silent) {\n       freezee.sendMessage(thawedTitle.color(TextColor.GREEN).build());\n \n       ChatDispatcher.broadcastAdminChatMessage(\n-          TranslatableComponent.of(\n-              \"moderation.freeze.broadcast.thaw\",\n-              TextColor.GRAY,\n-              senderName,\n-              freezee.getName(NameStyle.CONCISE)),\n+          createInteractiveBroadcast(\n+              freezee.getName(NameStyle.CONCISE), senderName, freezee.getBukkit().getName(), false),\n           match);\n     }\n \n+    private Component createInteractiveBroadcast(\n+        Component senderName, Component targetName, String username, boolean frozen) {\n+      return TextComponent.builder()", "originalCommit": "a3fd684c67c74df591a426c9da86484532e579d9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ2MTMxOQ==", "url": "https://github.com/PGMDev/PGM/pull/668#discussion_r498461319", "bodyText": "Hey Simon!\nThanks for the feedback, I see what I did xD I'll be making some changes later in the day to make this method more precise. Thanks!", "author": "applenick", "createdAt": "2020-10-01T19:14:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODI5MTc4Mg=="}], "type": "inlineReview"}, {"oid": "c18f54a20b4272334abce029d5d4686fd430469f", "url": "https://github.com/PGMDev/PGM/commit/c18f54a20b4272334abce029d5d4686fd430469f", "message": "Clean up interactive broadcast method\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-10-02T22:47:47Z", "type": "commit"}]}