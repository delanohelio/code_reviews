{"pr_number": 537, "pr_title": "Allow voting book to be forced open", "pr_author": "Pugzy", "pr_createdAt": "2020-06-14T14:30:47Z", "pr_url": "https://github.com/PGMDev/PGM/pull/537", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgzNjU1Ng==", "url": "https://github.com/PGMDev/PGM/pull/537#discussion_r439836556", "body": "I don't think this needs to be a parameter for the command\r\n```suggestion\r\n```", "bodyText": "I don't think this needs to be a parameter for the command\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  @Switch('f') boolean force,", "bodyHTML": "<p dir=\"auto\">I don't think this needs to be a parameter for the command</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"><span class=\"x x-first\">      </span><span class=\"pl-k x\">@Switch</span><span class=\"x\">(</span><span class=\"pl-s\"><span class=\"pl-pds x\">'</span><span class=\"x\">f</span><span class=\"pl-pds x\">'</span></span><span class=\"x\">) </span><span class=\"pl-k x\">boolean</span><span class=\"x x-last\"> force,</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Pablete1234", "createdAt": "2020-06-14T14:40:04Z", "path": "core/src/main/java/tc/oc/pgm/command/MapPoolCommand.java", "diffHunk": "@@ -275,7 +275,11 @@ public static void skip(\n \n   @Command(aliases = \"votenext\", desc = \"Vote for the next map\", usage = \"map\")\n   public static void voteNext(\n-      MatchPlayer player, CommandSender sender, MapOrder mapOrder, @Text MapInfo map)\n+      MatchPlayer player,\n+      CommandSender sender,\n+      MapOrder mapOrder,\n+      @Switch('f') boolean force,", "originalCommit": "6a978c61c502990487162eda2b21b2e9788e2047", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgzODE5OA==", "url": "https://github.com/PGMDev/PGM/pull/537#discussion_r439838198", "bodyText": "If I do votenext The Nile I don't want the book to popup.", "author": "Pugzy", "createdAt": "2020-06-14T14:58:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgzNjU1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg0MDQxMg==", "url": "https://github.com/PGMDev/PGM/pull/537#discussion_r439840412", "bodyText": "Without seeing the book, you can't even know The Nile is an option, neither will you know if it's been voted for or against. The command is an implementation detail for how the book works, never intended to be used standalone. If you wish to make it a command make it so that skipping the -f flag will display voting messages in chat that can replace the functionality of the book.", "author": "Pablete1234", "createdAt": "2020-06-14T15:22:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgzNjU1Ng=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgzNjU3OA==", "url": "https://github.com/PGMDev/PGM/pull/537#discussion_r439836578", "body": "```suggestion\r\n    poll.sendBook(player, true);\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                poll.sendBook(player, force);\n          \n          \n            \n                poll.sendBook(player, true);", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    poll<span class=\"pl-k\">.</span>sendBook(player, <span class=\"x x-first x-last\">force</span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    poll<span class=\"pl-k\">.</span>sendBook(player, <span class=\"pl-c1 x x-first x-last\">true</span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Pablete1234", "createdAt": "2020-06-14T14:40:20Z", "path": "core/src/main/java/tc/oc/pgm/command/MapPoolCommand.java", "diffHunk": "@@ -291,7 +295,7 @@ public static void voteNext(\n             voteResult ? TextColor.GREEN : TextColor.RED,\n             map.getStyledName(MapNameStyle.COLOR));\n     player.sendMessage(voteAction);\n-    poll.sendBook(player);\n+    poll.sendBook(player, force);", "originalCommit": "6a978c61c502990487162eda2b21b2e9788e2047", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgzNjU5Nw==", "url": "https://github.com/PGMDev/PGM/pull/537#discussion_r439836597", "body": "```suggestion\r\n        .clickEvent(ClickEvent.runCommand(\"/votenext \" + map.getName()))\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    .clickEvent(ClickEvent.runCommand(\"/votenext -f \" + map.getName()))\n          \n          \n            \n                    .clickEvent(ClickEvent.runCommand(\"/votenext \" + map.getName()))", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        .clickEvent(<span class=\"pl-smi\">ClickEvent</span><span class=\"pl-k\">.</span>runCommand(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/votenext <span class=\"x x-first x-last\">-f </span><span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">+</span> map<span class=\"pl-k\">.</span>getName()))</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        .clickEvent(<span class=\"pl-smi\">ClickEvent</span><span class=\"pl-k\">.</span>runCommand(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/votenext <span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">+</span> map<span class=\"pl-k\">.</span>getName()))</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Pablete1234", "createdAt": "2020-06-14T14:40:39Z", "path": "core/src/main/java/tc/oc/pgm/rotation/MapPoll.java", "diffHunk": "@@ -180,7 +180,7 @@ private Component getMapBookComponent(MatchPlayer viewer, MapInfo map) {\n                 TextComponent.of(\n                     map.getTags().stream().map(MapTag::toString).collect(Collectors.joining(\" \")),\n                     TextColor.YELLOW)))\n-        .clickEvent(ClickEvent.runCommand(\"/votenext \" + map.getName()))\n+        .clickEvent(ClickEvent.runCommand(\"/votenext -f \" + map.getName()))", "originalCommit": "6a978c61c502990487162eda2b21b2e9788e2047", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg1NDE1NA==", "url": "https://github.com/PGMDev/PGM/pull/537#discussion_r439854154", "bodyText": "How about -o for open. I think we may want to keep the flag, to allow running the command without opening the book.", "author": "Electroid", "createdAt": "2020-06-14T18:06:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgzNjU5Nw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgzNjYyMw==", "url": "https://github.com/PGMDev/PGM/pull/537#discussion_r439836623", "body": "```suggestion\r\n  public void sendBook(MatchPlayer viewer, boolean forceOpen) {\r\n```\r\nforce in this context could mean if the book is forced, i think making it more explicit can help", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              public void sendBook(MatchPlayer viewer, boolean force) {\n          \n          \n            \n              public void sendBook(MatchPlayer viewer, boolean forceOpen) {\n          \n      \n    \n    \n  \n\nforce in this context could mean if the book is forced, i think making it more explicit can help", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">  <span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> sendBook(<span class=\"pl-smi\">MatchPlayer</span> viewer, <span class=\"pl-k\">boolean</span> <span class=\"x x-first x-last\">force</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">  <span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> sendBook(<span class=\"pl-smi\">MatchPlayer</span> viewer, <span class=\"pl-k\">boolean</span> <span class=\"x x-first x-last\">forceOpen</span>) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n\n<p dir=\"auto\">force in this context could mean if the book is forced, i think making it more explicit can help</p>", "author": "Pablete1234", "createdAt": "2020-06-14T14:40:52Z", "path": "core/src/main/java/tc/oc/pgm/rotation/MapPoll.java", "diffHunk": "@@ -136,7 +136,7 @@ private Component getMapChatComponent(MatchPlayer viewer, MapInfo map, boolean w\n         .build();\n   }\n \n-  public void sendBook(MatchPlayer viewer) {\n+  public void sendBook(MatchPlayer viewer, boolean force) {", "originalCommit": "6a978c61c502990487162eda2b21b2e9788e2047", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "bd8af55d0038782849a8e66d16cb15490aaf0c80", "url": "https://github.com/PGMDev/PGM/commit/bd8af55d0038782849a8e66d16cb15490aaf0c80", "message": "Allow voting book to be forced open\n\nSigned-off-by: Pugzy <pugzy@mail.com>", "committedDate": "2020-06-14T15:10:03Z", "type": "forcePushed"}, {"oid": "089012c830267dc4d1c42e9fc52711548e1e597b", "url": "https://github.com/PGMDev/PGM/commit/089012c830267dc4d1c42e9fc52711548e1e597b", "message": "Allow voting book to be forced open\n\nSigned-off-by: Pugzy <pugzy@mail.com>", "committedDate": "2020-06-15T18:19:31Z", "type": "commit"}, {"oid": "089012c830267dc4d1c42e9fc52711548e1e597b", "url": "https://github.com/PGMDev/PGM/commit/089012c830267dc4d1c42e9fc52711548e1e597b", "message": "Allow voting book to be forced open\n\nSigned-off-by: Pugzy <pugzy@mail.com>", "committedDate": "2020-06-15T18:19:31Z", "type": "forcePushed"}]}