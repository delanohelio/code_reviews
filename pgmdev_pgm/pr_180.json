{"pr_number": 180, "pr_title": "Add basic report command with alert and event", "pr_author": "Pugzy", "pr_createdAt": "2020-01-02T22:03:38Z", "pr_url": "https://github.com/PGMDev/PGM/pull/180", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY0OTI3OA==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r362649278", "body": "I think this should be defined in a constant?", "bodyText": "I think this should be defined in a constant?", "bodyHTML": "<p dir=\"auto\">I think this should be defined in a constant?</p>", "author": "TheMolkaPL", "createdAt": "2020-01-02T22:11:00Z", "path": "src/main/java/tc/oc/pgm/commands/ReportCommands.java", "diffHunk": "@@ -0,0 +1,51 @@\n+package tc.oc.pgm.commands;\n+\n+import app.ashcon.intake.Command;\n+import app.ashcon.intake.parametric.annotation.Text;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.entity.Player;\n+import tc.oc.component.Component;\n+import tc.oc.component.types.PersonalizedText;\n+import tc.oc.named.NameStyle;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.events.PlayerReportEvent;\n+import tc.oc.util.components.Components;\n+\n+public class ReportCommands {\n+\n+  @Command(\n+      aliases = {\"report\"},\n+      usage = \"<player> <reason>\",\n+      desc = \"Report a player who is breaking the rules\")\n+  public static void report(MatchPlayer sender, Match match, Player player, @Text String reason) {\n+    MatchPlayer accused = match.getPlayer(player);\n+    match.callEvent(new PlayerReportEvent(sender, accused, reason));\n+\n+    final Component component =\n+        new PersonalizedText(\n+            Components.format(\n+                \"[\"\n+                    + ChatColor.GOLD\n+                    + \"R\"\n+                    + ChatColor.WHITE\n+                    + \"] \"\n+                    + ChatColor.DARK_AQUA\n+                    + \"{0}\"\n+                    + ChatColor.YELLOW\n+                    + \" \\u2794 \"\n+                    + ChatColor.DARK_AQUA\n+                    + \"{1}\"\n+                    + ChatColor.YELLOW\n+                    + \": \"\n+                    + \"{2}\",", "originalCommit": "9b4f4a3aed98bee19290cc539b8aff1445191421", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1MzA4Nw==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r363053087", "bodyText": "Moved to components rather than a string.", "author": "Pugzy", "createdAt": "2020-01-04T20:15:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY0OTI3OA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY0OTU1NQ==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r362649555", "body": "Should be cancelable.", "bodyText": "Should be cancelable.", "bodyHTML": "<p dir=\"auto\">Should be cancelable.</p>", "author": "TheMolkaPL", "createdAt": "2020-01-02T22:11:57Z", "path": "src/main/java/tc/oc/pgm/events/PlayerReportEvent.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package tc.oc.pgm.events;\n+\n+import org.bukkit.event.HandlerList;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.MatchPlayerEvent;\n+\n+/** Called immediately AFTER a player runs the report command. */\n+public class PlayerReportEvent extends MatchPlayerEvent {", "originalCommit": "9b4f4a3aed98bee19290cc539b8aff1445191421", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY0OTc5MQ==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r362649791", "body": "```java\r\nthis.sender = checkNotNull(sender);\r\nthis.reason = checkNotNull(reason);\r\n```", "bodyText": "this.sender = checkNotNull(sender);\nthis.reason = checkNotNull(reason);", "bodyHTML": "<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"this.sender = checkNotNull(sender);\nthis.reason = checkNotNull(reason);\"><pre><span class=\"pl-c1\">this</span><span class=\"pl-k\">.</span>sender <span class=\"pl-k\">=</span> checkNotNull(sender);\n<span class=\"pl-c1\">this</span><span class=\"pl-k\">.</span>reason <span class=\"pl-k\">=</span> checkNotNull(reason);</pre></div>", "author": "TheMolkaPL", "createdAt": "2020-01-02T22:12:49Z", "path": "src/main/java/tc/oc/pgm/events/PlayerReportEvent.java", "diffHunk": "@@ -0,0 +1,37 @@\n+package tc.oc.pgm.events;\n+\n+import org.bukkit.event.HandlerList;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.api.player.event.MatchPlayerEvent;\n+\n+/** Called immediately AFTER a player runs the report command. */\n+public class PlayerReportEvent extends MatchPlayerEvent {\n+\n+  private final MatchPlayer sender;\n+  private final String reason;\n+\n+  public PlayerReportEvent(MatchPlayer sender, MatchPlayer player, String reason) {\n+    super(player);\n+    this.sender = sender;\n+    this.reason = reason;", "originalCommit": "9b4f4a3aed98bee19290cc539b8aff1445191421", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY1MDA1NA==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r362650054", "body": "Before sending to players please log this in a logger.", "bodyText": "Before sending to players please log this in a logger.", "bodyHTML": "<p dir=\"auto\">Before sending to players please log this in a logger.</p>", "author": "TheMolkaPL", "createdAt": "2020-01-02T22:13:38Z", "path": "src/main/java/tc/oc/pgm/commands/ReportCommands.java", "diffHunk": "@@ -0,0 +1,51 @@\n+package tc.oc.pgm.commands;\n+\n+import app.ashcon.intake.Command;\n+import app.ashcon.intake.parametric.annotation.Text;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.entity.Player;\n+import tc.oc.component.Component;\n+import tc.oc.component.types.PersonalizedText;\n+import tc.oc.named.NameStyle;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.events.PlayerReportEvent;\n+import tc.oc.util.components.Components;\n+\n+public class ReportCommands {\n+\n+  @Command(\n+      aliases = {\"report\"},\n+      usage = \"<player> <reason>\",\n+      desc = \"Report a player who is breaking the rules\")\n+  public static void report(MatchPlayer sender, Match match, Player player, @Text String reason) {\n+    MatchPlayer accused = match.getPlayer(player);\n+    match.callEvent(new PlayerReportEvent(sender, accused, reason));\n+\n+    final Component component =\n+        new PersonalizedText(\n+            Components.format(\n+                \"[\"\n+                    + ChatColor.GOLD\n+                    + \"R\"\n+                    + ChatColor.WHITE\n+                    + \"] \"\n+                    + ChatColor.DARK_AQUA\n+                    + \"{0}\"\n+                    + ChatColor.YELLOW\n+                    + \" \\u2794 \"\n+                    + ChatColor.DARK_AQUA\n+                    + \"{1}\"\n+                    + ChatColor.YELLOW\n+                    + \": \"\n+                    + \"{2}\",\n+                sender.getStyledName(NameStyle.FANCY),\n+                accused.getStyledName(NameStyle.FANCY),\n+                new PersonalizedText(reason.trim())));\n+\n+    match.getPlayers().stream()", "originalCommit": "9b4f4a3aed98bee19290cc539b8aff1445191421", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjg5OTI2MQ==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r362899261", "bodyText": "Sending to console is good for this", "author": "Electroid", "createdAt": "2020-01-03T17:47:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY1MDA1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1NzEwOA==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r363057108", "bodyText": "Now sending to console with [A] prefix removed.", "author": "Pugzy", "createdAt": "2020-01-04T21:51:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjY1MDA1NA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjg2Nzg1Mg==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r362867852", "body": "I think this would fit better as just ModerationCommands, for when other commands are added", "bodyText": "I think this would fit better as just ModerationCommands, for when other commands are added", "bodyHTML": "<p dir=\"auto\">I think this would fit better as just ModerationCommands, for when other commands are added</p>", "author": "Pablete1234", "createdAt": "2020-01-03T16:17:20Z", "path": "src/main/java/tc/oc/pgm/commands/ReportCommands.java", "diffHunk": "@@ -0,0 +1,51 @@\n+package tc.oc.pgm.commands;\n+\n+import app.ashcon.intake.Command;\n+import app.ashcon.intake.parametric.annotation.Text;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.entity.Player;\n+import tc.oc.component.Component;\n+import tc.oc.component.types.PersonalizedText;\n+import tc.oc.named.NameStyle;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.events.PlayerReportEvent;\n+import tc.oc.util.components.Components;\n+\n+public class ReportCommands {", "originalCommit": "9b4f4a3aed98bee19290cc539b8aff1445191421", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1MzA3MA==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r363053070", "bodyText": "Renamed", "author": "Pugzy", "createdAt": "2020-01-04T20:14:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjg2Nzg1Mg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjg3MDY3Mw==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r362870673", "body": "I'm pretty sure this would be shorter if you used the text component stuff instead of string concat:\r\n```java\r\nnew PersonalizedComponent(\r\n  new PersonalizedComponent(\"[\"),\r\n  new PersonalizedComponent(\"A\", ChatColor.GOLD),\r\n  new PersonalizedComponent(\"] \"),\r\n  sender.getStyledName(NameStyle.FANCY),\r\n  new PersonalizedComponent(\" \\u2794 \", ChatColor.YELLOW),\r\n...\r\n```", "bodyText": "I'm pretty sure this would be shorter if you used the text component stuff instead of string concat:\nnew PersonalizedComponent(\n  new PersonalizedComponent(\"[\"),\n  new PersonalizedComponent(\"A\", ChatColor.GOLD),\n  new PersonalizedComponent(\"] \"),\n  sender.getStyledName(NameStyle.FANCY),\n  new PersonalizedComponent(\" \\u2794 \", ChatColor.YELLOW),\n...", "bodyHTML": "<p dir=\"auto\">I'm pretty sure this would be shorter if you used the text component stuff instead of string concat:</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"new PersonalizedComponent(\n  new PersonalizedComponent(&quot;[&quot;),\n  new PersonalizedComponent(&quot;A&quot;, ChatColor.GOLD),\n  new PersonalizedComponent(&quot;] &quot;),\n  sender.getStyledName(NameStyle.FANCY),\n  new PersonalizedComponent(&quot; \\u2794 &quot;, ChatColor.YELLOW),\n...\"><pre><span class=\"pl-k\">new</span> <span class=\"pl-smi\">PersonalizedComponent</span>(\n  <span class=\"pl-k\">new</span> <span class=\"pl-smi\">PersonalizedComponent</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>[<span class=\"pl-pds\">\"</span></span>),\n  <span class=\"pl-k\">new</span> <span class=\"pl-smi\">PersonalizedComponent</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>A<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">ChatColor</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>GOLD</span>),\n  <span class=\"pl-k\">new</span> <span class=\"pl-smi\">PersonalizedComponent</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>] <span class=\"pl-pds\">\"</span></span>),\n  sender<span class=\"pl-k\">.</span>getStyledName(<span class=\"pl-smi\">NameStyle</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>FANCY</span>),\n  <span class=\"pl-k\">new</span> <span class=\"pl-smi\">PersonalizedComponent</span>(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span> <span class=\"pl-cce\">\\u</span>2794 <span class=\"pl-pds\">\"</span></span>, <span class=\"pl-smi\">ChatColor</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>YELLOW</span>),\n<span class=\"pl-c1\">...</span></pre></div>", "author": "Pablete1234", "createdAt": "2020-01-03T16:25:18Z", "path": "src/main/java/tc/oc/pgm/commands/ReportCommands.java", "diffHunk": "@@ -0,0 +1,51 @@\n+package tc.oc.pgm.commands;\n+\n+import app.ashcon.intake.Command;\n+import app.ashcon.intake.parametric.annotation.Text;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.entity.Player;\n+import tc.oc.component.Component;\n+import tc.oc.component.types.PersonalizedText;\n+import tc.oc.named.NameStyle;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.events.PlayerReportEvent;\n+import tc.oc.util.components.Components;\n+\n+public class ReportCommands {\n+\n+  @Command(\n+      aliases = {\"report\"},\n+      usage = \"<player> <reason>\",\n+      desc = \"Report a player who is breaking the rules\")\n+  public static void report(MatchPlayer sender, Match match, Player player, @Text String reason) {\n+    MatchPlayer accused = match.getPlayer(player);\n+    match.callEvent(new PlayerReportEvent(sender, accused, reason));\n+\n+    final Component component =\n+        new PersonalizedText(\n+            Components.format(\n+                \"[\"\n+                    + ChatColor.GOLD\n+                    + \"R\"\n+                    + ChatColor.WHITE\n+                    + \"] \"\n+                    + ChatColor.DARK_AQUA\n+                    + \"{0}\"\n+                    + ChatColor.YELLOW\n+                    + \" \\u2794 \"\n+                    + ChatColor.DARK_AQUA\n+                    + \"{1}\"\n+                    + ChatColor.YELLOW\n+                    + \": \"\n+                    + \"{2}\",", "originalCommit": "9b4f4a3aed98bee19290cc539b8aff1445191421", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1MzA2Ng==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r363053066", "bodyText": "Changed to components.", "author": "Pugzy", "createdAt": "2020-01-04T20:14:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2Mjg3MDY3Mw=="}], "type": "inlineReview"}, {"oid": "492452deb0ec464714b77600147038f416448b3a", "url": "https://github.com/PGMDev/PGM/commit/492452deb0ec464714b77600147038f416448b3a", "message": "Add basic report command with alert and event\n\nSigned-off-by: Pugzy <pugzy@mail.com>", "committedDate": "2020-01-04T20:03:24Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1MzQwNQ==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r363053405", "body": "It would be cleaner with\r\n\r\n```java\r\nif (event.isCancelled()) return;\r\n```", "bodyText": "It would be cleaner with\nif (event.isCancelled()) return;", "bodyHTML": "<p dir=\"auto\">It would be cleaner with</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"if (event.isCancelled()) return;\"><pre><span class=\"pl-k\">if</span> (event<span class=\"pl-k\">.</span>isCancelled()) <span class=\"pl-k\">return</span>;</pre></div>", "author": "TheMolkaPL", "createdAt": "2020-01-04T20:23:03Z", "path": "src/main/java/tc/oc/pgm/commands/ModerationCommands.java", "diffHunk": "@@ -0,0 +1,55 @@\n+package tc.oc.pgm.commands;\n+\n+import app.ashcon.intake.Command;\n+import app.ashcon.intake.parametric.annotation.Text;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.entity.Player;\n+import tc.oc.component.Component;\n+import tc.oc.component.types.PersonalizedText;\n+import tc.oc.component.types.PersonalizedTranslatable;\n+import tc.oc.named.NameStyle;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.chat.Audience;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.events.PlayerReportEvent;\n+\n+public class ModerationCommands {\n+\n+  @Command(\n+      aliases = {\"report\"},\n+      usage = \"<player> <reason>\",\n+      desc = \"Report a player who is breaking the rules\")\n+  public static void report(MatchPlayer sender, Match match, Player player, @Text String reason) {\n+    MatchPlayer accused = match.getPlayer(player);\n+    PlayerReportEvent event = new PlayerReportEvent(sender, accused, reason);\n+    match.callEvent(event);\n+\n+    if (!event.isCancelled()) {", "originalCommit": "492452deb0ec464714b77600147038f416448b3a", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "a3db0124601ee75285f5ea55966065745a14d844", "url": "https://github.com/PGMDev/PGM/commit/a3db0124601ee75285f5ea55966065745a14d844", "message": "Add basic report command with alert and event\n\nSigned-off-by: Pugzy <pugzy@mail.com>", "committedDate": "2020-01-04T21:50:33Z", "type": "commit"}, {"oid": "a3db0124601ee75285f5ea55966065745a14d844", "url": "https://github.com/PGMDev/PGM/commit/a3db0124601ee75285f5ea55966065745a14d844", "message": "Add basic report command with alert and event\n\nSigned-off-by: Pugzy <pugzy@mail.com>", "committedDate": "2020-01-04T21:50:33Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1NzUwNQ==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r363057505", "body": "What will happen if the player is in another match? i don't think the Match should be a parameter for this command, you should make use of the MatchManager to get the MatchPlayer", "bodyText": "What will happen if the player is in another match? i don't think the Match should be a parameter for this command, you should make use of the MatchManager to get the MatchPlayer", "bodyHTML": "<p dir=\"auto\">What will happen if the player is in another match? i don't think the Match should be a parameter for this command, you should make use of the MatchManager to get the MatchPlayer</p>", "author": "Pablete1234", "createdAt": "2020-01-04T22:03:43Z", "path": "src/main/java/tc/oc/pgm/commands/ModerationCommands.java", "diffHunk": "@@ -0,0 +1,70 @@\n+package tc.oc.pgm.commands;\n+\n+import app.ashcon.intake.Command;\n+import app.ashcon.intake.parametric.annotation.Text;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Player;\n+import tc.oc.component.Component;\n+import tc.oc.component.types.PersonalizedText;\n+import tc.oc.component.types.PersonalizedTranslatable;\n+import tc.oc.named.NameStyle;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.chat.Audience;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.events.PlayerReportEvent;\n+\n+public class ModerationCommands {\n+\n+  @Command(\n+      aliases = {\"report\"},\n+      usage = \"<player> <reason>\",\n+      desc = \"Report a player who is breaking the rules\")\n+  public static void report(\n+      CommandSender commandSender,\n+      MatchPlayer matchPlayer,\n+      Match match,\n+      Player player,\n+      @Text String reason) {\n+    MatchPlayer accused = match.getPlayer(player);", "originalCommit": "a3db0124601ee75285f5ea55966065745a14d844", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1Nzk1NQ==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r363057955", "bodyText": "I think the report should be scoped to the Match. The issue here is you need to check that accused != null", "author": "Electroid", "createdAt": "2020-01-04T22:15:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1NzUwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1OTA2OA==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r363059068", "bodyText": "What will happen if the player is in another match?\n\nWe don't have the ability to run multiple matches at the moment and I don't think every new change needs to unnecessary pander to this idea.\nRegardless you shouldn't be reporting players from alternative matches because as you said yourself they should act independently. The audiences that it broadcast the notification message to could be server-wide as moderators may wish to switch match to investigate.\n\nyou need to check that accused != null\n\nWhen would the accused not be a player? The command framework seems pretty hell-bent on making sure the correct arguments are passed to the function.", "author": "Pugzy", "createdAt": "2020-01-04T22:49:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1NzUwNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1Nzk3OQ==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r363057979", "body": "`matchPlayer.sendMessage`", "bodyText": "matchPlayer.sendMessage", "bodyHTML": "<p dir=\"auto\"><code>matchPlayer.sendMessage</code></p>", "author": "Electroid", "createdAt": "2020-01-04T22:16:10Z", "path": "src/main/java/tc/oc/pgm/commands/ModerationCommands.java", "diffHunk": "@@ -0,0 +1,70 @@\n+package tc.oc.pgm.commands;\n+\n+import app.ashcon.intake.Command;\n+import app.ashcon.intake.parametric.annotation.Text;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Player;\n+import tc.oc.component.Component;\n+import tc.oc.component.types.PersonalizedText;\n+import tc.oc.component.types.PersonalizedTranslatable;\n+import tc.oc.named.NameStyle;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.chat.Audience;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.events.PlayerReportEvent;\n+\n+public class ModerationCommands {\n+\n+  @Command(\n+      aliases = {\"report\"},\n+      usage = \"<player> <reason>\",\n+      desc = \"Report a player who is breaking the rules\")\n+  public static void report(\n+      CommandSender commandSender,\n+      MatchPlayer matchPlayer,\n+      Match match,\n+      Player player,\n+      @Text String reason) {\n+    MatchPlayer accused = match.getPlayer(player);\n+    PlayerReportEvent event = new PlayerReportEvent(commandSender, accused, reason);\n+    match.callEvent(event);\n+\n+    if (event.isCancelled()) {\n+      if (event.getCancelMessage() != null) {\n+        commandSender.sendMessage(event.getCancelMessage());", "originalCommit": "a3db0124601ee75285f5ea55966065745a14d844", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1OTE2NA==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r363059164", "bodyText": "The use of CommandSender allows for console reports. I can remove this feature if someone lets me know how to prevent Console from running the command as requested previously in a discussion with Molka.", "author": "Pugzy", "createdAt": "2020-01-04T22:52:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1Nzk3OQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MzA1Nzk5Mg==", "url": "https://github.com/PGMDev/PGM/pull/180#discussion_r363057992", "body": "`matchPlayer.sendMessage`", "bodyText": "matchPlayer.sendMessage", "bodyHTML": "<p dir=\"auto\"><code>matchPlayer.sendMessage</code></p>", "author": "Electroid", "createdAt": "2020-01-04T22:16:25Z", "path": "src/main/java/tc/oc/pgm/commands/ModerationCommands.java", "diffHunk": "@@ -0,0 +1,70 @@\n+package tc.oc.pgm.commands;\n+\n+import app.ashcon.intake.Command;\n+import app.ashcon.intake.parametric.annotation.Text;\n+import net.md_5.bungee.api.ChatColor;\n+import org.bukkit.Bukkit;\n+import org.bukkit.command.CommandSender;\n+import org.bukkit.entity.Player;\n+import tc.oc.component.Component;\n+import tc.oc.component.types.PersonalizedText;\n+import tc.oc.component.types.PersonalizedTranslatable;\n+import tc.oc.named.NameStyle;\n+import tc.oc.pgm.api.Permissions;\n+import tc.oc.pgm.api.chat.Audience;\n+import tc.oc.pgm.api.match.Match;\n+import tc.oc.pgm.api.player.MatchPlayer;\n+import tc.oc.pgm.events.PlayerReportEvent;\n+\n+public class ModerationCommands {\n+\n+  @Command(\n+      aliases = {\"report\"},\n+      usage = \"<player> <reason>\",\n+      desc = \"Report a player who is breaking the rules\")\n+  public static void report(\n+      CommandSender commandSender,\n+      MatchPlayer matchPlayer,\n+      Match match,\n+      Player player,\n+      @Text String reason) {\n+    MatchPlayer accused = match.getPlayer(player);\n+    PlayerReportEvent event = new PlayerReportEvent(commandSender, accused, reason);\n+    match.callEvent(event);\n+\n+    if (event.isCancelled()) {\n+      if (event.getCancelMessage() != null) {\n+        commandSender.sendMessage(event.getCancelMessage());\n+      }\n+      return;\n+    }\n+\n+    commandSender.sendMessage(", "originalCommit": "a3db0124601ee75285f5ea55966065745a14d844", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "de5b33cab891ad07287fc6497d4eb81aeceda517", "url": "https://github.com/PGMDev/PGM/commit/de5b33cab891ad07287fc6497d4eb81aeceda517", "message": "Merge branch 'master' into report-command", "committedDate": "2020-01-05T11:49:39Z", "type": "commit"}]}