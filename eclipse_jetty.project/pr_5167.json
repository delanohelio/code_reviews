{"pr_number": 5167, "pr_title": "Issue #4996 - Regularlize logging", "pr_author": "janbartel", "pr_createdAt": "2020-08-18T11:05:14Z", "pr_url": "https://github.com/eclipse/jetty.project/pull/5167", "timeline": [{"oid": "6ffcf4049576884ec960e306dfb8b5bb83ba0433", "url": "https://github.com/eclipse/jetty.project/commit/6ffcf4049576884ec960e306dfb8b5bb83ba0433", "message": "Issue #4996 Regularize logging\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-08-05T12:02:27Z", "type": "commit"}, {"oid": "b1aaeb5305cfa212e23a1f7695881e433f8207eb", "url": "https://github.com/eclipse/jetty.project/commit/b1aaeb5305cfa212e23a1f7695881e433f8207eb", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10.0.x-4996-regularlize-logging", "committedDate": "2020-08-05T13:32:48Z", "type": "commit"}, {"oid": "e9ede176ee6aa872dece7e6ee19dc96e7dbddb71", "url": "https://github.com/eclipse/jetty.project/commit/e9ede176ee6aa872dece7e6ee19dc96e7dbddb71", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10.0.x-4996-regularlize-logging\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-08-17T09:31:42Z", "type": "commit"}, {"oid": "b3b69b2523088435ec5d2e4472e6781a87c55cd8", "url": "https://github.com/eclipse/jetty.project/commit/b3b69b2523088435ec5d2e4472e6781a87c55cd8", "message": "Issue # 4996 update", "committedDate": "2020-08-17T09:44:18Z", "type": "commit"}, {"oid": "d8bef172b788da7a65a6327a02a2d3e78ba1948c", "url": "https://github.com/eclipse/jetty.project/commit/d8bef172b788da7a65a6327a02a2d3e78ba1948c", "message": "Issue #4996 update\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-08-17T10:01:15Z", "type": "commit"}, {"oid": "14cc593c69a064833ee4c99c64d7de95eb6ef1d3", "url": "https://github.com/eclipse/jetty.project/commit/14cc593c69a064833ee4c99c64d7de95eb6ef1d3", "message": "Issue #4996 Add doco\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-08-17T10:25:39Z", "type": "commit"}, {"oid": "6fd67f302dd64ccc6a45071fd4cac22bf6e05073", "url": "https://github.com/eclipse/jetty.project/commit/6fd67f302dd64ccc6a45071fd4cac22bf6e05073", "message": "Issue #4996 Finish fixing LOG.debug statements\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-08-18T09:32:03Z", "type": "commit"}, {"oid": "a4f5ec472d0766ca383e7931650f2bf37b27b7c2", "url": "https://github.com/eclipse/jetty.project/commit/a4f5ec472d0766ca383e7931650f2bf37b27b7c2", "message": "Issue #4996 Fix LOG.info statements\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-08-18T10:20:11Z", "type": "commit"}, {"oid": "5363cad55c506a5fb91e6f11ad855802bddab12e", "url": "https://github.com/eclipse/jetty.project/commit/5363cad55c506a5fb91e6f11ad855802bddab12e", "message": "Issue #4996 Fix LOG.warns\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-08-18T10:44:13Z", "type": "commit"}, {"oid": "461a7ebde5fa8ead524f0f35584b66d7f4168e00", "url": "https://github.com/eclipse/jetty.project/commit/461a7ebde5fa8ead524f0f35584b66d7f4168e00", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10.0.x-4996-regularlize-logging", "committedDate": "2020-08-18T10:58:05Z", "type": "commit"}, {"oid": "fe68ba1b2640396a5a8957f5d25dd05e28f981fc", "url": "https://github.com/eclipse/jetty.project/commit/fe68ba1b2640396a5a8957f5d25dd05e28f981fc", "message": "Issue #4996 More fixes\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-08-19T10:13:32Z", "type": "commit"}, {"oid": "a79b1c812fc7dc5e182080a6631e312a31b35725", "url": "https://github.com/eclipse/jetty.project/commit/a79b1c812fc7dc5e182080a6631e312a31b35725", "message": "Issue #4996 - Fixing Logging parameter usage (mismatched counts)\n\nSigned-off-by: Joakim Erdfelt <joakim.erdfelt@gmail.com>", "committedDate": "2020-08-20T19:28:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIyMDMzNg==", "url": "https://github.com/eclipse/jetty.project/pull/5167#discussion_r474220336", "body": "This last parameter was just a guess.", "bodyText": "This last parameter was just a guess.", "bodyHTML": "<p dir=\"auto\">This last parameter was just a guess.</p>", "author": "joakime", "createdAt": "2020-08-20T19:30:10Z", "path": "jetty-http2/http2-hpack/src/main/java/org/eclipse/jetty/http2/hpack/HpackEncoder.java", "diffHunk": "@@ -265,7 +265,7 @@ else if (metadata.isResponse())\n             // Check size\n             if (_maxHeaderListSize > 0 && _headerListSize > _maxHeaderListSize)\n             {\n-                LOG.warn(\"Header list size too large {} > {} for {}\", _headerListSize, _maxHeaderListSize);\n+                LOG.warn(\"Header list size too large {} > {} for {}\", _headerListSize, _maxHeaderListSize, metadata);", "originalCommit": "a79b1c812fc7dc5e182080a6631e312a31b35725", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIyMDcyMA==", "url": "https://github.com/eclipse/jetty.project/pull/5167#discussion_r474220720", "body": "I got rid of `c={}`, as I have no idea what `c` could have been.", "bodyText": "I got rid of c={}, as I have no idea what c could have been.", "bodyHTML": "<p dir=\"auto\">I got rid of <code>c={}</code>, as I have no idea what <code>c</code> could have been.</p>", "author": "joakime", "createdAt": "2020-08-20T19:30:40Z", "path": "jetty-server/src/main/java/org/eclipse/jetty/server/PushBuilderImpl.java", "diffHunk": "@@ -68,7 +68,7 @@ public PushBuilderImpl(Request request, HttpFields fields, String method, String\n         _sessionId = sessionId;\n         _fields.add(JETTY_PUSH);\n         if (LOG.isDebugEnabled())\n-            LOG.debug(\"PushBuilder({} {}?{} s={} c={})\", _method, _request.getRequestURI(), _queryString, _sessionId);\n+            LOG.debug(\"PushBuilder({} {}?{} s={})\", _method, _request.getRequestURI(), _queryString, _sessionId);", "originalCommit": "a79b1c812fc7dc5e182080a6631e312a31b35725", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDUzNTc1NQ==", "url": "https://github.com/eclipse/jetty.project/pull/5167#discussion_r474535755", "bodyText": "Looks like the constructor used to have a boolean passed in, but it doesn't exist any more. Good catch.", "author": "janbartel", "createdAt": "2020-08-21T08:46:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIyMDcyMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIyMjIzNQ==", "url": "https://github.com/eclipse/jetty.project/pull/5167#discussion_r474222235", "body": "This one had base vs context resource, then resourcebase, then path.  Not sure what the correct step here should have been.\r\nAlmost thinking it should just be ...\r\n\r\n``` java\r\nLOG.debug(\"getResource({}) baseResource={}, context={}\", path, _baseResource, _context);\r\n```\r\n\r\nWDYT?", "bodyText": "This one had base vs context resource, then resourcebase, then path.  Not sure what the correct step here should have been.\nAlmost thinking it should just be ...\nLOG.debug(\"getResource({}) baseResource={}, context={}\", path, _baseResource, _context);\nWDYT?", "bodyHTML": "<p dir=\"auto\">This one had base vs context resource, then resourcebase, then path.  Not sure what the correct step here should have been.<br>\nAlmost thinking it should just be ...</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"LOG.debug(&quot;getResource({}) baseResource={}, context={}&quot;, path, _baseResource, _context);\"><pre><span class=\"pl-c1\">LOG</span><span class=\"pl-k\">.</span>debug(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>getResource({}) baseResource={}, context={}<span class=\"pl-pds\">\"</span></span>, path, _baseResource, _context);</pre></div>\n<p dir=\"auto\">WDYT?</p>", "author": "joakime", "createdAt": "2020-08-20T19:32:24Z", "path": "jetty-server/src/main/java/org/eclipse/jetty/server/handler/ResourceHandler.java", "diffHunk": "@@ -143,7 +143,7 @@ public MimeTypes getMimeTypes()\n     public Resource getResource(String path)\n     {\n         if (LOG.isDebugEnabled())\n-            LOG.debug(\"{} getResource({})\", _context == null ? _baseResource : _context, _baseResource, path);\n+            LOG.debug(\"{} getResource({})\", _context == null ? _baseResource : _context, path);", "originalCommit": "a79b1c812fc7dc5e182080a6631e312a31b35725", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDU0NDAxOA==", "url": "https://github.com/eclipse/jetty.project/pull/5167#discussion_r474544018", "bodyText": "I'm thinking it looks like we just want either the context, if there is one, or the baseResource otherwise, plus the path arg to the method, so the change in your commit is correct.", "author": "janbartel", "createdAt": "2020-08-21T08:54:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDIyMjIzNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDU0MDU2NA==", "url": "https://github.com/eclipse/jetty.project/pull/5167#discussion_r474540564", "body": "It looks like the intent was only to output the metadata if debug was enabled, so how about this instead:\r\n\r\n```suggestion\r\n                if (LOG.isDebugEnabled())\r\n                   LOG.warn(\"Header list size too large {} > {} metadata={}\", _headerListSize, _maxHeaderListSize, metadata);\r\n                else\r\n                    LOG.warn(\"Header list size too large {} > {}\", _headerListSize, _maxHeaderListSize);\r\n```", "bodyText": "It looks like the intent was only to output the metadata if debug was enabled, so how about this instead:\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if (LOG.isDebugEnabled())\n          \n          \n            \n                            if (LOG.isDebugEnabled())\n          \n          \n            \n                               LOG.warn(\"Header list size too large {} > {} metadata={}\", _headerListSize, _maxHeaderListSize, metadata);\n          \n          \n            \n                            else\n          \n          \n            \n                                LOG.warn(\"Header list size too large {} > {}\", _headerListSize, _maxHeaderListSize);", "bodyHTML": "<p dir=\"auto\">It looks like the intent was only to output the metadata if debug was enabled, so how about this instead:</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"268\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-k\">if</span> (<span class=\"pl-c1\">LOG</span><span class=\"pl-k\">.</span>isDebugEnabled())</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"268\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">if</span> (<span class=\"pl-c1\">LOG</span><span class=\"pl-k\">.</span>isDebugEnabled())</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"269\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                   <span class=\"pl-c1\">LOG</span><span class=\"pl-k\">.</span>warn(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Header list size too large {} &gt; {} metadata={}<span class=\"pl-pds\">\"</span></span>, _headerListSize, _maxHeaderListSize, metadata);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"270\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">else</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"271\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    <span class=\"pl-c1\">LOG</span><span class=\"pl-k\">.</span>warn(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Header list size too large {} &gt; {}<span class=\"pl-pds\">\"</span></span>, _headerListSize, _maxHeaderListSize);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "janbartel", "createdAt": "2020-08-21T08:51:20Z", "path": "jetty-http2/http2-hpack/src/main/java/org/eclipse/jetty/http2/hpack/HpackEncoder.java", "diffHunk": "@@ -265,7 +265,7 @@ else if (metadata.isResponse())\n             // Check size\n             if (_maxHeaderListSize > 0 && _headerListSize > _maxHeaderListSize)\n             {\n-                LOG.warn(\"Header list size too large {} > {} for {}\", _headerListSize, _maxHeaderListSize);\n+                LOG.warn(\"Header list size too large {} > {} for {}\", _headerListSize, _maxHeaderListSize, metadata);\n                 if (LOG.isDebugEnabled())", "originalCommit": "a79b1c812fc7dc5e182080a6631e312a31b35725", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1a63fa5997ae24d72b756a89fecd09f634b6a7bf", "url": "https://github.com/eclipse/jetty.project/commit/1a63fa5997ae24d72b756a89fecd09f634b6a7bf", "message": "Issue #4996 Updates post review.\n\nSigned-off-by: Jan Bartel <janb@webtide.com>", "committedDate": "2020-08-24T14:45:41Z", "type": "commit"}, {"oid": "2868d5ae8724ba0c32ecbc3d96379f62847700b0", "url": "https://github.com/eclipse/jetty.project/commit/2868d5ae8724ba0c32ecbc3d96379f62847700b0", "message": "Merge remote-tracking branch 'origin/jetty-10.0.x' into jetty-10.0.x-4996-regularlize-logging", "committedDate": "2020-08-24T15:12:22Z", "type": "commit"}]}