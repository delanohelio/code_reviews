{"pr_number": 11218, "pr_title": "[FLINK-16285][network] Refactor SingleInputGate#setInputChannel to remove IntermediateResultPartitionID argument", "pr_author": "zhijiangW", "pr_createdAt": "2020-02-26T05:37:14Z", "pr_url": "https://github.com/apache/flink/pull/11218", "timeline": [{"oid": "7b8f569390e60c187f3282763813b44a43ff9cc9", "url": "https://github.com/apache/flink/commit/7b8f569390e60c187f3282763813b44a43ff9cc9", "message": "[FLINK-16285][network] Refactor SingleInputGate#setInputChannel to remove IntermediateResultPartitionID argument\n\nThe IntermediateResultPartitionID info can be got directly from the respective InputChannel, so we can remove it from\nthe arguments of SingleInputGate#setInputChannel to cleanup the codes.\n\nIt is also helpful to simplify the unit tests and avoid passing the inconsistent IntermediateResultPartitionID with the\ninternal ResultPartitionID that the respective InputChannel maintains.", "committedDate": "2020-02-26T05:40:24Z", "type": "forcePushed"}, {"oid": "f4dc7cc2f0d9ad033deae23bbbdc3b2dd172af3d", "url": "https://github.com/apache/flink/commit/f4dc7cc2f0d9ad033deae23bbbdc3b2dd172af3d", "message": "[hotfix][tests] Remove the dead codes of StreamTestSingleInputGate and TestInputChannel", "committedDate": "2020-02-27T04:20:15Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEwNjM1Mw==", "url": "https://github.com/apache/flink/pull/11218#discussion_r385106353", "body": ":thumbsup: for removing potential inconsistency and extra argument\r\nJust two minor issues here:\r\n1. `checkNotNull` right before dereferencing doesn't make sense to me\r\n2. I think it's preferable to access `InputChannel.partitionId` through its getter", "bodyText": "\ud83d\udc4d for removing potential inconsistency and extra argument\nJust two minor issues here:\n\ncheckNotNull right before dereferencing doesn't make sense to me\nI think it's preferable to access InputChannel.partitionId through its getter", "bodyHTML": "<p dir=\"auto\"><g-emoji class=\"g-emoji\" alias=\"+1\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/1f44d.png\">\ud83d\udc4d</g-emoji> for removing potential inconsistency and extra argument<br>\nJust two minor issues here:</p>\n<ol dir=\"auto\">\n<li><code>checkNotNull</code> right before dereferencing doesn't make sense to me</li>\n<li>I think it's preferable to access <code>InputChannel.partitionId</code> through its getter</li>\n</ol>", "author": "rkhachatryan", "createdAt": "2020-02-27T12:51:44Z", "path": "flink-runtime/src/main/java/org/apache/flink/runtime/io/network/partition/consumer/SingleInputGate.java", "diffHunk": "@@ -322,9 +322,10 @@ public void assignExclusiveSegments() throws IOException {\n \t\t}\n \t}\n \n-\tpublic void setInputChannel(IntermediateResultPartitionID partitionId, InputChannel inputChannel) {\n+\tpublic void setInputChannel(InputChannel inputChannel) {\n+\t\tIntermediateResultPartitionID partitionId = checkNotNull(inputChannel).partitionId.getPartitionId();", "originalCommit": "f4dc7cc2f0d9ad033deae23bbbdc3b2dd172af3d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTE3NTQ1NA==", "url": "https://github.com/apache/flink/pull/11218#discussion_r385175454", "bodyText": "I would make checkNotNull in separate line and use getter for partitionId.", "author": "zhijiangW", "createdAt": "2020-02-27T15:08:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTEwNjM1Mw=="}], "type": "inlineReview"}, {"oid": "efe373d488de41bf51ed2e9294d6e8c581dd1961", "url": "https://github.com/apache/flink/commit/efe373d488de41bf51ed2e9294d6e8c581dd1961", "message": "[FLINK-16285][network] Refactor SingleInputGate#setInputChannel to remove IntermediateResultPartitionID argument\n\nThe IntermediateResultPartitionID info can be got directly from the respective InputChannel, so we can remove it from\nthe arguments of SingleInputGate#setInputChannel to cleanup the codes.\n\nIt is also helpful to simplify the unit tests and avoid passing the inconsistent IntermediateResultPartitionID with the\ninternal ResultPartitionID that the respective InputChannel maintains.", "committedDate": "2020-02-27T15:12:29Z", "type": "commit"}, {"oid": "0ece6d2f655ee073d66ade0f3681c0489ea8483c", "url": "https://github.com/apache/flink/commit/0ece6d2f655ee073d66ade0f3681c0489ea8483c", "message": "[hotfix][tests] Remove the dead codes of StreamTestSingleInputGate and TestInputChannel", "committedDate": "2020-02-27T15:13:03Z", "type": "commit"}, {"oid": "0ece6d2f655ee073d66ade0f3681c0489ea8483c", "url": "https://github.com/apache/flink/commit/0ece6d2f655ee073d66ade0f3681c0489ea8483c", "message": "[hotfix][tests] Remove the dead codes of StreamTestSingleInputGate and TestInputChannel", "committedDate": "2020-02-27T15:13:03Z", "type": "forcePushed"}]}