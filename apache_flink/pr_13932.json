{"pr_number": 13932, "pr_title": "[FLINK-19947][Connectors / Common]Support sink parallelism configuration for Print connector", "pr_author": "zhuxiaoshang", "pr_createdAt": "2020-11-05T06:24:51Z", "pr_url": "https://github.com/apache/flink/pull/13932", "timeline": [{"oid": "91b11d7775fa9eb986c9de33d23d275c3d8fcfbe", "url": "https://github.com/apache/flink/commit/91b11d7775fa9eb986c9de33d23d275c3d8fcfbe", "message": "[FLINK-19947][Connectors / Common]Support sink parallelism configuration to Print connector", "committedDate": "2020-12-09T12:10:16Z", "type": "commit"}, {"oid": "91b11d7775fa9eb986c9de33d23d275c3d8fcfbe", "url": "https://github.com/apache/flink/commit/91b11d7775fa9eb986c9de33d23d275c3d8fcfbe", "message": "[FLINK-19947][Connectors / Common]Support sink parallelism configuration to Print connector", "committedDate": "2020-12-09T12:10:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk1NzIxNQ==", "url": "https://github.com/apache/flink/pull/13932#discussion_r539957215", "body": "`Arrays.asList` -> `Collections.singletonList` \r\n", "bodyText": "Arrays.asList -> Collections.singletonList", "bodyHTML": "<p dir=\"auto\"><code>Arrays.asList</code> -&gt; <code>Collections.singletonList</code></p>", "author": "fsk119", "createdAt": "2020-12-10T08:08:57Z", "path": "flink-table/flink-table-planner-blink/src/test/java/org/apache/flink/table/planner/runtime/stream/table/PrintConnectorITCase.java", "diffHunk": "@@ -77,6 +77,31 @@ public void testStandardError() throws Exception {\n \t\ttest(true);\n \t}\n \n+\t@Test\n+\tpublic void testWithParallelism() throws Exception {\n+\t\ttEnv().executeSql(\"create table print_t (\" +\n+\t\t\t\t\"f0 int,\" +\n+\t\t\t\t\"f1 double\" +\n+\t\t\t\t\") with (\" +\n+\t\t\t\t\"'connector' = 'print',\" +\n+\t\t\t\t\"'print-identifier' = 'test_print',\" +\n+\t\t\t\t\"'sink.parallelism' = '2',\" +\n+\t\t\t\t\"'standard-error'='false')\");\n+\t\tDataType type = tEnv().from(\"print_t\").getSchema().toRowDataType();\n+\t\tRow row = Row.of(1, 1.1);\n+\t\ttEnv().fromValues(type, Arrays.asList(row)).executeInsert(\"print_t\").await();", "originalCommit": "91b11d7775fa9eb986c9de33d23d275c3d8fcfbe", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "5464e35dc08ff8d326e298987998e26441b92d92", "url": "https://github.com/apache/flink/commit/5464e35dc08ff8d326e298987998e26441b92d92", "message": "fix test", "committedDate": "2020-12-10T08:13:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDc1MDQ5Ng==", "url": "https://github.com/apache/flink/pull/13932#discussion_r540750496", "body": "```suggestion\r\n\t\tprivate final @Nullable Integer parallelism;\r\n```\r\n\r\nWould be better to add `@Nullable` annotation. \r\n\r\nSee the Flink Code Style Guideline: https://flink.apache.org/contributing/code-style-and-quality-java.html#java-optional", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tprivate final Integer parallelism;\n          \n          \n            \n            \t\tprivate final @Nullable Integer parallelism;\n          \n      \n    \n    \n  \n\nWould be better to add @Nullable annotation.\nSee the Flink Code Style Guideline: https://flink.apache.org/contributing/code-style-and-quality-java.html#java-optional", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t<span class=\"pl-k\">private</span> <span class=\"pl-k\">final</span> <span class=\"pl-smi\">Integer</span> parallelism;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\t<span class=\"pl-k\">private</span> <span class=\"pl-k\">final</span> <span class=\"pl-k x x-first\">@Nullable</span><span class=\"x x-last\"> </span><span class=\"pl-smi\">Integer</span> parallelism;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n\n<p dir=\"auto\">Would be better to add <code>@Nullable</code> annotation.</p>\n<p dir=\"auto\">See the Flink Code Style Guideline: <a href=\"https://flink.apache.org/contributing/code-style-and-quality-java.html#java-optional\" rel=\"nofollow\">https://flink.apache.org/contributing/code-style-and-quality-java.html#java-optional</a></p>", "author": "wuchong", "createdAt": "2020-12-11T07:45:59Z", "path": "flink-table/flink-table-api-java-bridge/src/main/java/org/apache/flink/table/factories/PrintTableSinkFactory.java", "diffHunk": "@@ -95,19 +96,22 @@ public DynamicTableSink createDynamicTableSink(Context context) {\n \t\treturn new PrintSink(\n \t\t\t\tcontext.getCatalogTable().getSchema().toPhysicalRowDataType(),\n \t\t\t\toptions.get(PRINT_IDENTIFIER),\n-\t\t\t\toptions.get(STANDARD_ERROR));\n+\t\t\t\toptions.get(STANDARD_ERROR),\n+\t\t\t\toptions.getOptional(FactoryUtil.SINK_PARALLELISM).orElse(null));\n \t}\n \n \tprivate static class PrintSink implements DynamicTableSink {\n \n \t\tprivate final DataType type;\n \t\tprivate final String printIdentifier;\n \t\tprivate final boolean stdErr;\n+\t\tprivate final Integer parallelism;", "originalCommit": "5464e35dc08ff8d326e298987998e26441b92d92", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "46501ddbb8fe78f1ae737862cd2f93d0ddc38793", "url": "https://github.com/apache/flink/commit/46501ddbb8fe78f1ae737862cd2f93d0ddc38793", "message": "Update flink-table/flink-table-api-java-bridge/src/main/java/org/apache/flink/table/factories/PrintTableSinkFactory.java\n\nCo-authored-by: Jark Wu <imjark@gmail.com>", "committedDate": "2020-12-11T09:01:34Z", "type": "commit"}, {"oid": "c1701d79d8f06f5c35eea38ca5ec82723fcfd194", "url": "https://github.com/apache/flink/commit/c1701d79d8f06f5c35eea38ca5ec82723fcfd194", "message": "Update PrintTableSinkFactory.java\n\nadd import javax.annotation.Nullable;", "committedDate": "2020-12-16T04:04:27Z", "type": "commit"}]}