{"pr_number": 8689, "pr_title": "SAK-43941 Profile: name pronunciation not saved", "pr_createdAt": "2020-10-14T12:22:39Z", "pr_url": "https://github.com/sakaiproject/sakai/pull/8689", "merge_commit": "68fc12e7a5597c5644bd0c90fecea66890cabb60", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDY5OTMxMA==", "url": "https://github.com/sakaiproject/sakai/pull/8689#discussion_r504699310", "body": "What about this?\r\nString errorMessage = userProfile.getPhoneticPronunciation() == null ? \"error.profile.save.phonetic.alert\" : \"error.profile.save.info.failed\";\r\nformFeedback.setDefaultModel(new ResourceModel(errorMessage));", "bodyText": "What about this?\nString errorMessage = userProfile.getPhoneticPronunciation() == null ? \"error.profile.save.phonetic.alert\" : \"error.profile.save.info.failed\";\nformFeedback.setDefaultModel(new ResourceModel(errorMessage));", "bodyHTML": "<p dir=\"auto\">What about this?<br>\nString errorMessage = userProfile.getPhoneticPronunciation() == null ? \"error.profile.save.phonetic.alert\" : \"error.profile.save.info.failed\";<br>\nformFeedback.setDefaultModel(new ResourceModel(errorMessage));</p>", "author": "mpellicer", "createdAt": "2020-10-14T13:57:04Z", "path": "profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java", "diffHunk": "@@ -203,7 +203,13 @@ protected void onSubmit(AjaxRequestTarget target, Form form) {\n                     }\n \n                 } else {\n-                    formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.info.failed\"));\n+                    UserProfile userProfile = (UserProfile) form.getModelObject();\n+                    \n+                    if (userProfile.getPhoneticPronunciation()==null) {\n+                        formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.phonetic.alert\"));", "originalCommit": "e06aff176a3690ec999c9e96d5f55ea893d44b3a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "02ff147cf48d62ef5f845348e249599bb4f0f0a8", "changed_code": [{"header": "diff --git a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\nindex 64ccac9bb8..592b8133da 100644\n--- a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n+++ b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n", "chunk": "@@ -203,13 +203,8 @@ public class MyNamePronunciationEdit extends Panel {\n                     }\n \n                 } else {\n-                    UserProfile userProfile = (UserProfile) form.getModelObject();\n+                    formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.info.failed\"));\n                     \n-                    if (userProfile.getPhoneticPronunciation()==null) {\n-                        formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.phonetic.alert\"));\n-                    } else {\n-                        formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.info.failed\"));\n-                    }\n                     formFeedback.add(new AttributeModifier(\"class\", true, new Model<>(\"save-failed-error\")));\n                     target.add(formFeedback);\n                 }\n", "next_change": {"commit": "c7df64fb0754cc7a94dce79691681714ac30f4e4", "changed_code": [{"header": "diff --git a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\nindex 592b8133da..1120b6aae1 100644\n--- a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n+++ b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n", "chunk": "@@ -204,7 +204,6 @@ public class MyNamePronunciationEdit extends Panel {\n \n                 } else {\n                     formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.info.failed\"));\n-                    \n                     formFeedback.add(new AttributeModifier(\"class\", true, new Model<>(\"save-failed-error\")));\n                     target.add(formFeedback);\n                 }\n", "next_change": null}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDY5OTU1OA==", "url": "https://github.com/sakaiproject/sakai/pull/8689#discussion_r504699558", "body": "userProfile.getPhoneticPronunciation() == null\r\n\r\nSpaces in the comparison.", "bodyText": "userProfile.getPhoneticPronunciation() == null\nSpaces in the comparison.", "bodyHTML": "<p dir=\"auto\">userProfile.getPhoneticPronunciation() == null</p>\n<p dir=\"auto\">Spaces in the comparison.</p>", "author": "mpellicer", "createdAt": "2020-10-14T13:57:21Z", "path": "profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java", "diffHunk": "@@ -247,6 +253,10 @@ private boolean save(Form form) {\n         //get the backing model\n         UserProfile userProfile = (UserProfile) form.getModelObject();\n \n+        if (userProfile.getPhoneticPronunciation()==null) {", "originalCommit": "e06aff176a3690ec999c9e96d5f55ea893d44b3a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "02ff147cf48d62ef5f845348e249599bb4f0f0a8", "changed_code": [{"header": "diff --git a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\nindex 64ccac9bb8..592b8133da 100644\n--- a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n+++ b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n", "chunk": "@@ -252,10 +247,6 @@ public class MyNamePronunciationEdit extends Panel {\n     private boolean save(Form form) {\n         //get the backing model\n         UserProfile userProfile = (UserProfile) form.getModelObject();\n-\n-        if (userProfile.getPhoneticPronunciation()==null) {\n-        \treturn false;\n-        } \n         \n         //get userId from the UserProfile (because admin could be editing), then get existing SakaiPerson for that userId\n         String userId = userProfile.getUserUuid();\n", "next_change": {"commit": "c7df64fb0754cc7a94dce79691681714ac30f4e4", "changed_code": [{"header": "diff --git a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\nindex 592b8133da..1120b6aae1 100644\n--- a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n+++ b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n", "chunk": "@@ -247,7 +246,7 @@ public class MyNamePronunciationEdit extends Panel {\n     private boolean save(Form form) {\n         //get the backing model\n         UserProfile userProfile = (UserProfile) form.getModelObject();\n-        \n+\n         //get userId from the UserProfile (because admin could be editing), then get existing SakaiPerson for that userId\n         String userId = userProfile.getUserUuid();\n         SakaiPerson sakaiPerson = sakaiProxy.getSakaiPerson(userId);\n", "next_change": null}]}}]}}, {"oid": "02ff147cf48d62ef5f845348e249599bb4f0f0a8", "url": "https://github.com/sakaiproject/sakai/commit/02ff147cf48d62ef5f845348e249599bb4f0f0a8", "message": "SAK-43941 Profile: name pronunciation not saved\n\n\nSAK-43941 Profile: name pronunciation not saved\n\n\nSAK-43941 Profile: name pronunciation not saved", "committedDate": "2020-10-15T12:00:38Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjEyMTMxMg==", "url": "https://github.com/sakaiproject/sakai/pull/8689#discussion_r506121312", "body": "Revert this change please.", "bodyText": "Revert this change please.", "bodyHTML": "<p dir=\"auto\">Revert this change please.</p>", "author": "mpellicer", "createdAt": "2020-10-16T07:27:55Z", "path": "profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java", "diffHunk": "@@ -204,6 +204,7 @@ protected void onSubmit(AjaxRequestTarget target, Form form) {\n \n                 } else {\n                     formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.info.failed\"));\n+                    ", "originalCommit": "02ff147cf48d62ef5f845348e249599bb4f0f0a8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c7df64fb0754cc7a94dce79691681714ac30f4e4", "changed_code": [{"header": "diff --git a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\nindex 592b8133da..1120b6aae1 100644\n--- a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n+++ b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n", "chunk": "@@ -204,7 +204,6 @@ public class MyNamePronunciationEdit extends Panel {\n \n                 } else {\n                     formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.info.failed\"));\n-                    \n                     formFeedback.add(new AttributeModifier(\"class\", true, new Model<>(\"save-failed-error\")));\n                     target.add(formFeedback);\n                 }\n", "next_change": null}]}, "revised_code_in_main": {"commit": "68fc12e7a5597c5644bd0c90fecea66890cabb60", "changed_code": [{"header": "diff --git a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\nindex 592b8133dab..1120b6aae19 100644\n--- a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n+++ b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n", "chunk": "@@ -204,7 +204,6 @@ public class MyNamePronunciationEdit extends Panel {\n \n                 } else {\n                     formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.info.failed\"));\n-                    \n                     formFeedback.add(new AttributeModifier(\"class\", true, new Model<>(\"save-failed-error\")));\n                     target.add(formFeedback);\n                 }\n", "next_change": {"commit": "1709efd7e2bd7b4d34180b4bcd0cfad38ec5b7c2", "changed_code": [{"header": "diff --git a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\nindex 1120b6aae19..12b255d38ca 100644\n--- a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n+++ b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n", "chunk": "@@ -204,7 +253,7 @@ public class MyNamePronunciationEdit extends Panel {\n \n                 } else {\n                     formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.info.failed\"));\n-                    formFeedback.add(new AttributeModifier(\"class\", true, new Model<>(\"save-failed-error\")));\n+                    formFeedback.add(new AttributeModifier(\"class\", new Model<>(\"save-failed-error\")));\n                     target.add(formFeedback);\n                 }\n             }\n", "next_change": null}]}}]}, "commits_in_main": [{"oid": "68fc12e7a5597c5644bd0c90fecea66890cabb60", "message": "Merge commit", "committedDate": null}, {"oid": "2194b1ef1312fe00cbd6a9d72b1465ae35797701", "committedDate": "2021-03-23 19:12:20 +0000", "message": "SAK-43510 Added pronouns field to profile tool (#8983)"}, {"oid": "1709efd7e2bd7b4d34180b4bcd0cfad38ec5b7c2", "committedDate": "2021-06-29 20:19:13 +0200", "message": "SAK-45707 AttributeModifier(String attribute, boolean => AttributeModifier(String, IModel) (#9418)"}]}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjEyMTQyNA==", "url": "https://github.com/sakaiproject/sakai/pull/8689#discussion_r506121424", "body": "Revert this change please.", "bodyText": "Revert this change please.", "bodyHTML": "<p dir=\"auto\">Revert this change please.</p>", "author": "mpellicer", "createdAt": "2020-10-16T07:28:00Z", "path": "profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java", "diffHunk": "@@ -246,7 +247,7 @@ protected void onSubmit(AjaxRequestTarget target, Form form) {\n     private boolean save(Form form) {\n         //get the backing model\n         UserProfile userProfile = (UserProfile) form.getModelObject();\n-\n+        ", "originalCommit": "02ff147cf48d62ef5f845348e249599bb4f0f0a8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c7df64fb0754cc7a94dce79691681714ac30f4e4", "changed_code": [{"header": "diff --git a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\nindex 592b8133da..1120b6aae1 100644\n--- a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n+++ b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n", "chunk": "@@ -247,7 +246,7 @@ public class MyNamePronunciationEdit extends Panel {\n     private boolean save(Form form) {\n         //get the backing model\n         UserProfile userProfile = (UserProfile) form.getModelObject();\n-        \n+\n         //get userId from the UserProfile (because admin could be editing), then get existing SakaiPerson for that userId\n         String userId = userProfile.getUserUuid();\n         SakaiPerson sakaiPerson = sakaiProxy.getSakaiPerson(userId);\n", "next_change": null}]}}, {"oid": "c7df64fb0754cc7a94dce79691681714ac30f4e4", "url": "https://github.com/sakaiproject/sakai/commit/c7df64fb0754cc7a94dce79691681714ac30f4e4", "message": "Revert \"SAK-43941 Profile: name pronunciation not saved\"\n\nThis reverts commit 02ff147cf48d62ef5f845348e249599bb4f0f0a8.\n\nSAK-43941 Profile: name pronunciation not saved", "committedDate": "2020-10-16T07:35:08Z", "type": "forcePushed"}, {"oid": "8c13b0eaaaa7a9141fbf89bc881e26b250238085", "url": "https://github.com/sakaiproject/sakai/commit/8c13b0eaaaa7a9141fbf89bc881e26b250238085", "message": "SAK-43941 Profile: name pronunciation not saved\n\n\nSAK-43941 Profile: name pronunciation not saved\n\n\nSAK-43941 Profile: name pronunciation not saved\n\n\nRevert \"SAK-43941 Profile: name pronunciation not saved\"\n\nThis reverts commit 02ff147cf48d62ef5f845348e249599bb4f0f0a8.\n\nSAK-43941 Profile: name pronunciation not saved", "committedDate": "2020-10-16T07:36:05Z", "type": "commit"}, {"oid": "8c13b0eaaaa7a9141fbf89bc881e26b250238085", "url": "https://github.com/sakaiproject/sakai/commit/8c13b0eaaaa7a9141fbf89bc881e26b250238085", "message": "SAK-43941 Profile: name pronunciation not saved\n\n\nSAK-43941 Profile: name pronunciation not saved\n\n\nSAK-43941 Profile: name pronunciation not saved\n\n\nRevert \"SAK-43941 Profile: name pronunciation not saved\"\n\nThis reverts commit 02ff147cf48d62ef5f845348e249599bb4f0f0a8.\n\nSAK-43941 Profile: name pronunciation not saved", "committedDate": "2020-10-16T07:36:05Z", "type": "forcePushed"}]}