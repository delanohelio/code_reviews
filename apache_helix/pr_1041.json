{"pr_number": 1041, "pr_title": "Change the error message to be meaningful naming", "pr_author": "junkaixue", "pr_createdAt": "2020-05-29T23:10:54Z", "pr_url": "https://github.com/apache/helix/pull/1041", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjgyMTU3Ng==", "url": "https://github.com/apache/helix/pull/1041#discussion_r432821576", "body": "There are other fields in the response json as below.\r\n```\r\n{\r\n  \"instance_stoppable_parallel\" : [ ],\r\n  \"instance_not_stoppable_with_reasons\" : {\r\n    \"localhost_8080\": [\r\n        \"CustomPartition:partion1\",\r\n        \"CustomPartition:partition2\"\r\n    ]\r\n  }\r\n}\r\n\r\n{\r\n  \"instance_stoppable_parallel\" : [ ],\r\n  \"instance_not_stoppable_with_reasons\" : {\r\n    \"localhost_8080\" : [ \"CustomInstance:localhost_8080\" ]\r\n  }\r\n}\r\n```\r\n\r\n Shall we make the keys format consistent: `custom_health_failure_instance: `? (`_instance` at the end indicates the value is an instance. And add a space after colon `:`?) It looks more consistent and clearer to me.\r\n```\r\n{\r\n  \"instance_stoppable_parallel\" : [ ],\r\n  \"instance_not_stoppable_with_reasons\" : {\r\n    \"localhost_8080\": [\r\n        \"custom_health_failure_partition: partion1\",\r\n        \"custom_health_failure_partition: partition2\"\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\nJust a thought: not sure if we have to consider backward-compatibility: if some tools are parsing the json response to determine stoppable, this change will break the tools. Internal code search doesn't show such code usage.", "bodyText": "There are other fields in the response json as below.\n{\n  \"instance_stoppable_parallel\" : [ ],\n  \"instance_not_stoppable_with_reasons\" : {\n    \"localhost_8080\": [\n        \"CustomPartition:partion1\",\n        \"CustomPartition:partition2\"\n    ]\n  }\n}\n\n{\n  \"instance_stoppable_parallel\" : [ ],\n  \"instance_not_stoppable_with_reasons\" : {\n    \"localhost_8080\" : [ \"CustomInstance:localhost_8080\" ]\n  }\n}\n\nShall we make the keys format consistent: custom_health_failure_instance: ? (_instance at the end indicates the value is an instance. And add a space after colon :?) It looks more consistent and clearer to me.\n{\n  \"instance_stoppable_parallel\" : [ ],\n  \"instance_not_stoppable_with_reasons\" : {\n    \"localhost_8080\": [\n        \"custom_health_failure_partition: partion1\",\n        \"custom_health_failure_partition: partition2\"\n    ]\n  }\n}\n\nJust a thought: not sure if we have to consider backward-compatibility: if some tools are parsing the json response to determine stoppable, this change will break the tools. Internal code search doesn't show such code usage.", "bodyHTML": "<p dir=\"auto\">There are other fields in the response json as below.</p>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n  &quot;instance_stoppable_parallel&quot; : [ ],\n  &quot;instance_not_stoppable_with_reasons&quot; : {\n    &quot;localhost_8080&quot;: [\n        &quot;CustomPartition:partion1&quot;,\n        &quot;CustomPartition:partition2&quot;\n    ]\n  }\n}\n\n{\n  &quot;instance_stoppable_parallel&quot; : [ ],\n  &quot;instance_not_stoppable_with_reasons&quot; : {\n    &quot;localhost_8080&quot; : [ &quot;CustomInstance:localhost_8080&quot; ]\n  }\n}\n\"><pre><code>{\n  \"instance_stoppable_parallel\" : [ ],\n  \"instance_not_stoppable_with_reasons\" : {\n    \"localhost_8080\": [\n        \"CustomPartition:partion1\",\n        \"CustomPartition:partition2\"\n    ]\n  }\n}\n\n{\n  \"instance_stoppable_parallel\" : [ ],\n  \"instance_not_stoppable_with_reasons\" : {\n    \"localhost_8080\" : [ \"CustomInstance:localhost_8080\" ]\n  }\n}\n</code></pre></div>\n<p dir=\"auto\">Shall we make the keys format consistent: <code>custom_health_failure_instance: </code>? (<code>_instance</code> at the end indicates the value is an instance. And add a space after colon <code>:</code>?) It looks more consistent and clearer to me.</p>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"{\n  &quot;instance_stoppable_parallel&quot; : [ ],\n  &quot;instance_not_stoppable_with_reasons&quot; : {\n    &quot;localhost_8080&quot;: [\n        &quot;custom_health_failure_partition: partion1&quot;,\n        &quot;custom_health_failure_partition: partition2&quot;\n    ]\n  }\n}\n\"><pre><code>{\n  \"instance_stoppable_parallel\" : [ ],\n  \"instance_not_stoppable_with_reasons\" : {\n    \"localhost_8080\": [\n        \"custom_health_failure_partition: partion1\",\n        \"custom_health_failure_partition: partition2\"\n    ]\n  }\n}\n</code></pre></div>\n<p dir=\"auto\">Just a thought: not sure if we have to consider backward-compatibility: if some tools are parsing the json response to determine stoppable, this change will break the tools. Internal code search doesn't show such code usage.</p>", "author": "huizhilu", "createdAt": "2020-05-30T08:09:10Z", "path": "helix-rest/src/main/java/org/apache/helix/rest/server/json/instance/StoppableCheck.java", "diffHunk": "@@ -30,8 +30,8 @@\n   // Category to differentiate which step the check fails\n   public enum Category {\n     HELIX_OWN_CHECK(\"Helix:\"),\n-    CUSTOM_INSTANCE_CHECK(\"CustomInstance:\"),\n-    CUSTOM_PARTITION_CHECK(\"CustomPartition:\");\n+    CUSTOM_INSTANCE_CHECK(\"CustomInstanceHealthFailure:\"),\n+    CUSTOM_PARTITION_CHECK(\"CustomPartitionHealthFailure:\");", "originalCommit": "f2e1e223b5399e40df43568b4606826b5a9d7427", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzQwOTIxNA==", "url": "https://github.com/apache/helix/pull/1041#discussion_r433409214", "bodyText": "Good suggestion.", "author": "junkaixue", "createdAt": "2020-06-01T18:23:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjgyMTU3Ng=="}], "type": "inlineReview"}, {"oid": "db54e3d753146a2e423109806a8f59933c2bcbc0", "url": "https://github.com/apache/helix/commit/db54e3d753146a2e423109806a8f59933c2bcbc0", "message": "Change the error message to be meaningful naming", "committedDate": "2020-06-01T18:23:23Z", "type": "commit"}, {"oid": "db54e3d753146a2e423109806a8f59933c2bcbc0", "url": "https://github.com/apache/helix/commit/db54e3d753146a2e423109806a8f59933c2bcbc0", "message": "Change the error message to be meaningful naming", "committedDate": "2020-06-01T18:23:23Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMyNDcxNw==", "url": "https://github.com/apache/helix/pull/1041#discussion_r434324717", "body": "Do you think lower case would be more consistent with other fields and easier to read? Adding a space after colon is clearer? ", "bodyText": "Do you think lower case would be more consistent with other fields and easier to read? Adding a space after colon is clearer?", "bodyHTML": "<p dir=\"auto\">Do you think lower case would be more consistent with other fields and easier to read? Adding a space after colon is clearer?</p>", "author": "huizhilu", "createdAt": "2020-06-03T05:57:59Z", "path": "helix-rest/src/main/java/org/apache/helix/rest/server/json/instance/StoppableCheck.java", "diffHunk": "@@ -29,9 +29,9 @@\n public class StoppableCheck {\n   // Category to differentiate which step the check fails\n   public enum Category {\n-    HELIX_OWN_CHECK(\"Helix:\"),\n-    CUSTOM_INSTANCE_CHECK(\"CustomInstance:\"),\n-    CUSTOM_PARTITION_CHECK(\"CustomPartition:\");\n+    HELIX_OWN_CHECK(\"HELIX:\"),\n+    CUSTOM_INSTANCE_CHECK(\"CUSTOM_INSTANCE_HEALTH_FAILURE:\"),", "originalCommit": "db54e3d753146a2e423109806a8f59933c2bcbc0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDg2NzI0Mw==", "url": "https://github.com/apache/helix/pull/1041#discussion_r434867243", "bodyText": "I would prefer to put the \":\" into the string formatting part later. The enum info should be cleaner the better.", "author": "jiajunwang", "createdAt": "2020-06-03T21:26:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMyNDcxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDg4ODAzNg==", "url": "https://github.com/apache/helix/pull/1041#discussion_r434888036", "bodyText": "Yeah.. I think the best way is to have a json class for this.. But that would need more work. Maybe we could do it later in helix rest improvement.", "author": "huizhilu", "createdAt": "2020-06-03T22:15:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMyNDcxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk3ODMyOA==", "url": "https://github.com/apache/helix/pull/1041#discussion_r434978328", "bodyText": "This require more factor work for the TODO as we discussed before. This change only helps make clear understanding of the error. Better to address in different PR.", "author": "junkaixue", "createdAt": "2020-06-04T03:56:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDMyNDcxNw=="}], "type": "inlineReview"}]}