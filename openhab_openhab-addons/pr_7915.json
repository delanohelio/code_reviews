{"pr_number": 7915, "pr_title": "[somfytahoma] improved silent mode control", "pr_author": "octa22", "pr_createdAt": "2020-06-13T15:18:03Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/7915", "timeline": [{"oid": "fdda2ad84c4a166124216bce3fce0b8d54210a74", "url": "https://github.com/openhab/openhab-addons/commit/fdda2ad84c4a166124216bce3fce0b8d54210a74", "message": "[somfytahoma] improved silent mode control\n\nSigned-off-by: Ondrej Pecta <opecta@gmail.com>", "committedDate": "2020-06-11T20:43:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTc2MzMxMA==", "url": "https://github.com/openhab/openhab-addons/pull/7915#discussion_r439763310", "body": "```suggestion\r\n                case COMMAND_UP:\r\n                case COMMAND_DOWN:\r\n                    if (CONTROL_SILENT.equals(channelUID.getId())) {\r\n                        // move the roller shutter to the specific position at low speed\r\n                        String param = \"[\" + (COMMAND_UP.equals(cmd) ? 0 : 100) + \", \\\"lowspeed\\\"]\";\r\n                        sendCommand(COMMAND_SET_CLOSURESPEED, param);\r\n                        break;\r\n                    }\r\n                    //fall through\r\n                default:\r\n                    sendCommand(cmd);\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            default:\n          \n          \n            \n                                if (CONTROL_SILENT.equals(channelUID.getId()) && (COMMAND_UP.equals(cmd) || COMMAND_DOWN.equals(cmd))) {\n          \n          \n            \n                                    // move the roller shutter to the specific position at low speed\n          \n          \n            \n                                    String param = \"[\" + (COMMAND_UP.equals(cmd) ? 0 : 100) + \", \\\"lowspeed\\\"]\";\n          \n          \n            \n                                    sendCommand(COMMAND_SET_CLOSURESPEED, param);\n          \n          \n            \n                                } else {\n          \n          \n            \n                                    sendCommand(cmd);\n          \n          \n            \n                                }\n          \n          \n            \n                            case COMMAND_UP:\n          \n          \n            \n                            case COMMAND_DOWN:\n          \n          \n            \n                                if (CONTROL_SILENT.equals(channelUID.getId())) {\n          \n          \n            \n                                    // move the roller shutter to the specific position at low speed\n          \n          \n            \n                                    String param = \"[\" + (COMMAND_UP.equals(cmd) ? 0 : 100) + \", \\\"lowspeed\\\"]\";\n          \n          \n            \n                                    sendCommand(COMMAND_SET_CLOSURESPEED, param);\n          \n          \n            \n                                    break;\n          \n          \n            \n                                }\n          \n          \n            \n                                //fall through\n          \n          \n            \n                            default:\n          \n          \n            \n                                sendCommand(cmd);", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"77\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-k\">default</span><span class=\"pl-k\">:</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"78\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    <span class=\"pl-k\">if</span> (<span class=\"pl-c1\">CONTROL_SILENT</span><span class=\"pl-k\">.</span>equals(channelUID<span class=\"pl-k\">.</span>getId()) <span class=\"pl-k\">&amp;&amp;</span> (<span class=\"pl-c1\">COMMAND_UP</span><span class=\"pl-k\">.</span>equals(cmd) <span class=\"pl-k\">||</span> <span class=\"pl-c1\">COMMAND_DOWN</span><span class=\"pl-k\">.</span>equals(cmd))) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"79\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                        <span class=\"pl-c\"><span class=\"pl-c\">//</span> move the roller shutter to the specific position at low speed</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"80\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                        <span class=\"pl-smi\">String</span> param <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>[<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">+</span> (<span class=\"pl-c1\">COMMAND_UP</span><span class=\"pl-k\">.</span>equals(cmd) <span class=\"pl-k\">?</span> <span class=\"pl-c1\">0</span> <span class=\"pl-k\">:</span> <span class=\"pl-c1\">100</span>) <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>, <span class=\"pl-cce\">\\\"</span>lowspeed<span class=\"pl-cce\">\\\"</span>]<span class=\"pl-pds\">\"</span></span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"81\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                        sendCommand(<span class=\"pl-c1\">COMMAND_SET_CLOSURESPEED</span>, param);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"82\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    } <span class=\"pl-k\">else</span> {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"83\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                        sendCommand(cmd);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"84\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"77\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">case</span> <span class=\"pl-c1\">COMMAND_UP</span><span class=\"pl-k\">:</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"78\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">case</span> <span class=\"pl-c1\">COMMAND_DOWN</span><span class=\"pl-k\">:</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"79\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    <span class=\"pl-k\">if</span> (<span class=\"pl-c1\">CONTROL_SILENT</span><span class=\"pl-k\">.</span>equals(channelUID<span class=\"pl-k\">.</span>getId())) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"80\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                        <span class=\"pl-c\"><span class=\"pl-c\">//</span> move the roller shutter to the specific position at low speed</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"81\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                        <span class=\"pl-smi\">String</span> param <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>[<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">+</span> (<span class=\"pl-c1\">COMMAND_UP</span><span class=\"pl-k\">.</span>equals(cmd) <span class=\"pl-k\">?</span> <span class=\"pl-c1\">0</span> <span class=\"pl-k\">:</span> <span class=\"pl-c1\">100</span>) <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>, <span class=\"pl-cce\">\\\"</span>lowspeed<span class=\"pl-cce\">\\\"</span>]<span class=\"pl-pds\">\"</span></span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"82\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                        sendCommand(<span class=\"pl-c1\">COMMAND_SET_CLOSURESPEED</span>, param);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"83\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                        <span class=\"pl-k\">break</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"84\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"85\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    <span class=\"pl-c\"><span class=\"pl-c\">//</span>fall through</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"86\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">default</span><span class=\"pl-k\">:</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"87\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    sendCommand(cmd);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "cpmeister", "createdAt": "2020-06-13T19:31:27Z", "path": "bundles/org.openhab.binding.somfytahoma/src/main/java/org/openhab/binding/somfytahoma/internal/handler/SomfyTahomaSilentRollerShutterHandler.java", "diffHunk": "@@ -45,25 +45,37 @@ public void handleCommand(ChannelUID channelUID, Command command) {\n             return;\n         } else {\n             String cmd = getTahomaCommand(command.toString());\n-            if (COMMAND_MY.equals(cmd)) {\n-                sendCommand(COMMAND_MY);\n-            } else if (COMMAND_STOP.equals(cmd)) {\n-                String executionId = getCurrentExecutions();\n-                if (executionId != null) {\n-                    // Check if the roller shutter is moving and STOP is sent => STOP it\n-                    cancelExecution(executionId);\n-                } else {\n+            switch (cmd) {\n+                case COMMAND_MY:\n                     sendCommand(COMMAND_MY);\n-                }\n-            } else {\n-                if (CONTROL_SILENT.equals(channelUID.getId()) && COMMAND_SET_CLOSURE.equals(cmd)) {\n-                    // move the roller shutter to the specific position at low speed\n-                    String param = \"[\" + command.toString() + \", \\\"lowspeed\\\"]\";\n-                    sendCommand(COMMAND_SET_CLOSURESPEED, param);\n-                } else {\n-                    String param = COMMAND_SET_CLOSURE.equals(cmd) ? \"[\" + toInteger(command) + \"]\" : \"[]\";\n-                    sendCommand(cmd, param);\n-                }\n+                    break;\n+                case COMMAND_STOP:\n+                    String executionId = getCurrentExecutions();\n+                    if (executionId != null) {\n+                        // Check if the roller shutter is moving and STOP is sent => STOP it\n+                        cancelExecution(executionId);\n+                    } else {\n+                        sendCommand(COMMAND_MY);\n+                    }\n+                    break;\n+                case COMMAND_SET_CLOSURE:\n+                    if (CONTROL_SILENT.equals(channelUID.getId())) {\n+                        // move the roller shutter to the specific position at low speed\n+                        String param = \"[\" + toInteger(command) + \", \\\"lowspeed\\\"]\";\n+                        sendCommand(COMMAND_SET_CLOSURESPEED, param);\n+                    } else {\n+                        String param = \"[\" + toInteger(command) + \"]\";\n+                        sendCommand(cmd, param);\n+                    }\n+                    break;\n+                default:\n+                    if (CONTROL_SILENT.equals(channelUID.getId()) && (COMMAND_UP.equals(cmd) || COMMAND_DOWN.equals(cmd))) {\n+                        // move the roller shutter to the specific position at low speed\n+                        String param = \"[\" + (COMMAND_UP.equals(cmd) ? 0 : 100) + \", \\\"lowspeed\\\"]\";\n+                        sendCommand(COMMAND_SET_CLOSURESPEED, param);\n+                    } else {\n+                        sendCommand(cmd);\n+                    }", "originalCommit": "fdda2ad84c4a166124216bce3fce0b8d54210a74", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTc2ODU4Nw==", "url": "https://github.com/openhab/openhab-addons/pull/7915#discussion_r439768587", "bodyText": "Great suggestion. thanks", "author": "octa22", "createdAt": "2020-06-13T20:55:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTc2MzMxMA=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTc2MzUzMg==", "url": "https://github.com/openhab/openhab-addons/pull/7915#discussion_r439763532", "body": "You can do similar fall through shenanigans here as well by moving the COMMAND_MY case around.\r\n```suggestion\r\n                case COMMAND_STOP:\r\n                    String executionId = getCurrentExecutions();\r\n                    if (executionId != null) {\r\n                        // Check if the roller shutter is moving and STOP is sent => STOP it\r\n                        cancelExecution(executionId);\r\n                        break;\r\n                    }\r\n                    //fall through\r\n                case COMMAND_MY:\r\n                    sendCommand(COMMAND_MY);\r\n                    break;\r\n```", "bodyText": "You can do similar fall through shenanigans here as well by moving the COMMAND_MY case around.\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            case COMMAND_STOP:\n          \n          \n            \n                                String executionId = getCurrentExecutions();\n          \n          \n            \n                                if (executionId != null) {\n          \n          \n            \n                                    // Check if the roller shutter is moving and STOP is sent => STOP it\n          \n          \n            \n                                    cancelExecution(executionId);\n          \n          \n            \n                                } else {\n          \n          \n            \n                                    sendCommand(COMMAND_MY);\n          \n          \n            \n                                }\n          \n          \n            \n                                break;\n          \n          \n            \n                            case COMMAND_STOP:\n          \n          \n            \n                                String executionId = getCurrentExecutions();\n          \n          \n            \n                                if (executionId != null) {\n          \n          \n            \n                                    // Check if the roller shutter is moving and STOP is sent => STOP it\n          \n          \n            \n                                    cancelExecution(executionId);\n          \n          \n            \n                                    break;\n          \n          \n            \n                                }\n          \n          \n            \n                                //fall through\n          \n          \n            \n                            case COMMAND_MY:\n          \n          \n            \n                                sendCommand(COMMAND_MY);\n          \n          \n            \n                                break;", "bodyHTML": "<p dir=\"auto\">You can do similar fall through shenanigans here as well by moving the COMMAND_MY case around.</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"59\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-k\">case</span> <span class=\"pl-c1\">COMMAND_STOP</span><span class=\"pl-k\">:</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"60\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    <span class=\"pl-smi\">String</span> executionId <span class=\"pl-k\">=</span> getCurrentExecutions();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"61\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    <span class=\"pl-k\">if</span> (executionId <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"62\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Check if the roller shutter is moving and STOP is sent =&gt; STOP it</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"63\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                        cancelExecution(executionId);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"64\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    } <span class=\"pl-k\">else</span> {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"65\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                        sendCommand(<span class=\"pl-c1\">COMMAND_MY</span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"66\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"67\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                    <span class=\"pl-k\">break</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"59\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">case</span> <span class=\"pl-c1\">COMMAND_STOP</span><span class=\"pl-k\">:</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"60\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    <span class=\"pl-smi\">String</span> executionId <span class=\"pl-k\">=</span> getCurrentExecutions();</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"61\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    <span class=\"pl-k\">if</span> (executionId <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"62\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                        <span class=\"pl-c\"><span class=\"pl-c\">//</span> Check if the roller shutter is moving and STOP is sent =&gt; STOP it</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"63\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                        cancelExecution(executionId);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"64\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                        <span class=\"pl-k\">break</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"65\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"66\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    <span class=\"pl-c\"><span class=\"pl-c\">//</span>fall through</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"67\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">case</span> <span class=\"pl-c1\">COMMAND_MY</span><span class=\"pl-k\">:</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"68\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    sendCommand(<span class=\"pl-c1\">COMMAND_MY</span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"69\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                    <span class=\"pl-k\">break</span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "cpmeister", "createdAt": "2020-06-13T19:35:08Z", "path": "bundles/org.openhab.binding.somfytahoma/src/main/java/org/openhab/binding/somfytahoma/internal/handler/SomfyTahomaSilentRollerShutterHandler.java", "diffHunk": "@@ -45,25 +45,37 @@ public void handleCommand(ChannelUID channelUID, Command command) {\n             return;\n         } else {\n             String cmd = getTahomaCommand(command.toString());\n-            if (COMMAND_MY.equals(cmd)) {\n-                sendCommand(COMMAND_MY);\n-            } else if (COMMAND_STOP.equals(cmd)) {\n-                String executionId = getCurrentExecutions();\n-                if (executionId != null) {\n-                    // Check if the roller shutter is moving and STOP is sent => STOP it\n-                    cancelExecution(executionId);\n-                } else {\n+            switch (cmd) {\n+                case COMMAND_MY:\n                     sendCommand(COMMAND_MY);\n-                }\n-            } else {\n-                if (CONTROL_SILENT.equals(channelUID.getId()) && COMMAND_SET_CLOSURE.equals(cmd)) {\n-                    // move the roller shutter to the specific position at low speed\n-                    String param = \"[\" + command.toString() + \", \\\"lowspeed\\\"]\";\n-                    sendCommand(COMMAND_SET_CLOSURESPEED, param);\n-                } else {\n-                    String param = COMMAND_SET_CLOSURE.equals(cmd) ? \"[\" + toInteger(command) + \"]\" : \"[]\";\n-                    sendCommand(cmd, param);\n-                }\n+                    break;\n+                case COMMAND_STOP:\n+                    String executionId = getCurrentExecutions();\n+                    if (executionId != null) {\n+                        // Check if the roller shutter is moving and STOP is sent => STOP it\n+                        cancelExecution(executionId);\n+                    } else {\n+                        sendCommand(COMMAND_MY);\n+                    }\n+                    break;", "originalCommit": "fdda2ad84c4a166124216bce3fce0b8d54210a74", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTc2ODYwMA==", "url": "https://github.com/openhab/openhab-addons/pull/7915#discussion_r439768600", "bodyText": "Great suggestion. thanks", "author": "octa22", "createdAt": "2020-06-13T20:56:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTc2MzUzMg=="}], "type": "inlineReview"}, {"oid": "24536e4bc72793c2747b9b230cb142fc926d362d", "url": "https://github.com/openhab/openhab-addons/commit/24536e4bc72793c2747b9b230cb142fc926d362d", "message": "[somfytahoma] implemented suggested changes from the code review\n\nSigned-off-by: Ondrej Pecta <opecta@gmail.com>", "committedDate": "2020-06-13T21:13:53Z", "type": "commit"}]}