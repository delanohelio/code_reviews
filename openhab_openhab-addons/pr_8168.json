{"pr_number": 8168, "pr_title": "[miio] improve viewer with coordinates", "pr_author": "marcelrv", "pr_createdAt": "2020-07-21T20:06:59Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/8168", "timeline": [{"oid": "00343a5bcdf3155b28810a435c09f2f8285e9411", "url": "https://github.com/openhab/openhab-addons/commit/00343a5bcdf3155b28810a435c09f2f8285e9411", "message": "[miio] improve viewer with coordinates\n\nPrint coordinates to allow finding the room clean details\n\nSigned-off-by: Marcel Verpaalen <marcel@verpaalen.com>", "committedDate": "2020-07-21T16:39:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODY0MTUxMw==", "url": "https://github.com/openhab/openhab-addons/pull/8168#discussion_r458641513", "body": "I think you should not directly write new lines, Just as done above use:\r\n```suggestion\r\n            pw.println();\r\n``` ", "bodyText": "I think you should not directly write new lines, Just as done above use:\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        pw.print(\"\\r\\n\");\n          \n          \n            \n                        pw.println();", "bodyHTML": "<p dir=\"auto\">I think you should not directly write new lines, Just as done above use:</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            pw<span class=\"pl-k\">.</span><span class=\"x x-first\">print(</span><span class=\"pl-s\"><span class=\"pl-pds x\">\"</span><span class=\"pl-cce x\">\\r\\n</span><span class=\"pl-pds x x-last\">\"</span></span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            pw<span class=\"pl-k\">.</span><span class=\"x x-first x-last\">println(</span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Hilbrand", "createdAt": "2020-07-22T08:56:18Z", "path": "bundles/org.openhab.binding.miio/src/main/java/org/openhab/binding/miio/internal/robot/RRMapFileParser.java", "diffHunk": "@@ -299,6 +300,16 @@ public String toString() {\n         return sw.toString();\n     }\n \n+    private void printAreaDetails(ArrayList<float[]> areas, PrintWriter pw) {\n+        areas.forEach(area -> {\n+            pw.printf(\"\\tArea details:\");\n+            for (int i = 0; i < area.length; i++) {\n+                pw.printf(\"\\t%.1f\", area[i]);\n+            }\n+            pw.print(\"\\r\\n\");", "originalCommit": "00343a5bcdf3155b28810a435c09f2f8285e9411", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA3NzAxNg==", "url": "https://github.com/openhab/openhab-addons/pull/8168#discussion_r459077016", "bodyText": "yes, agree. done", "author": "marcelrv", "createdAt": "2020-07-22T20:54:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODY0MTUxMw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODY0MjQ1Mw==", "url": "https://github.com/openhab/openhab-addons/pull/8168#discussion_r458642453", "body": "If there are more areas does it make sense to include some information about what area these details are about. With your change you would get several generic \"Area details\" printed next to each other.", "bodyText": "If there are more areas does it make sense to include some information about what area these details are about. With your change you would get several generic \"Area details\" printed next to each other.", "bodyHTML": "<p dir=\"auto\">If there are more areas does it make sense to include some information about what area these details are about. With your change you would get several generic \"Area details\" printed next to each other.</p>", "author": "Hilbrand", "createdAt": "2020-07-22T08:57:55Z", "path": "bundles/org.openhab.binding.miio/src/main/java/org/openhab/binding/miio/internal/robot/RRMapFileParser.java", "diffHunk": "@@ -299,6 +300,16 @@ public String toString() {\n         return sw.toString();\n     }\n \n+    private void printAreaDetails(ArrayList<float[]> areas, PrintWriter pw) {\n+        areas.forEach(area -> {\n+            pw.printf(\"\\tArea details:\");", "originalCommit": "00343a5bcdf3155b28810a435c09f2f8285e9411", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA3NzQ0Nw==", "url": "https://github.com/openhab/openhab-addons/pull/8168#discussion_r459077447", "bodyText": "Improved the text slightly to make it area coordinates to give hint on what the numbers are.", "author": "marcelrv", "createdAt": "2020-07-22T20:55:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODY0MjQ1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTA4MjE1NA==", "url": "https://github.com/openhab/openhab-addons/pull/8168#discussion_r459082154", "bodyText": "btw, in each case, just before this is called, it prints out the area type.\nNo Go zones:\t2\n\tArea coordinates:\t356.0\t218.0\t340.0\t218.0\t340.0\t207.0\t356.0\t207.0\n\tArea coordinates:\t329.0\t222.0\t321.0\t222.0\t321.0\t205.0\t329.0\t205.0\nWalls:\t1\n\tArea coordinates:\t274.0\t363.0\t273.0\t291.0\nZones:\t0", "author": "marcelrv", "createdAt": "2020-07-22T21:04:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODY0MjQ1Mw=="}], "type": "inlineReview"}, {"oid": "179af6e6d3f7d9f44cb763f92fe1bec45cfa9f7f", "url": "https://github.com/openhab/openhab-addons/commit/179af6e6d3f7d9f44cb763f92fe1bec45cfa9f7f", "message": "[miio] improve print text for maps\n\nSigned-off-by: Marcel Verpaalen <marcel@verpaalen.com>", "committedDate": "2020-07-22T20:53:57Z", "type": "commit"}, {"oid": "0cc1899ddbfdf78c62bf862c497502dd7c5e2b79", "url": "https://github.com/openhab/openhab-addons/commit/0cc1899ddbfdf78c62bf862c497502dd7c5e2b79", "message": "[miio] Improve mapviwer with goto coordinates calculation\n\nFurther calculation of the goto coordinates to be used for zone cleaning\n\nSigned-off-by: Marcel Verpaalen <marcel@verpaalen.com>", "committedDate": "2020-08-12T14:11:25Z", "type": "commit"}, {"oid": "1d62d48c518b379375cca15d7c39a2f8bb4df175", "url": "https://github.com/openhab/openhab-addons/commit/1d62d48c518b379375cca15d7c39a2f8bb4df175", "message": "[miio] Offline viewer provides zone clean command\n\n* Parser prints real coordinates (robot,goto, zones etc)\n* Offline viewer provides zone clean command\n* Offline viewer provides goto command\n* Offline viewer provides coordinates on mouseover\n\nSigned-off-by: Marcel Verpaalen <marcel@verpaalen.com>", "committedDate": "2020-08-14T15:46:04Z", "type": "commit"}, {"oid": "2c9126afe27c9c91349ae777512a648c6019d126", "url": "https://github.com/openhab/openhab-addons/commit/2c9126afe27c9c91349ae777512a648c6019d126", "message": "[miio] fix robo position + improved scrolling\n\nSigned-off-by: Marcel Verpaalen <marcel@verpaalen.com>", "committedDate": "2020-08-14T18:47:56Z", "type": "commit"}]}