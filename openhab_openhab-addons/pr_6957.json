{"pr_number": 6957, "pr_title": "[hpprinter] Some small updates to the HP binding", "pr_author": "martinvw", "pr_createdAt": "2020-02-02T19:37:11Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/6957", "timeline": [{"oid": "d969100b7962ee3c24e449dc5c72b91aee276399", "url": "https://github.com/openhab/openhab-addons/commit/d969100b7962ee3c24e449dc5c72b91aee276399", "message": "Some small updates to the HP binding\n\n- some string comparisons where using ==\n- there were some issues with the null annotations, things were passed a long as being null while that would be killing for the status\n- improved formatting\n- Made more fields immutable\n- do not recreate the status message map on every request\n- add braces for if statments\n- Use parseInt to convert int instead of using both parsing and unboxing\n- use diamond operators\n- use method references where possible\n- do not put the device OFFLINE while starting to connect\n\nSigned-off-by: Martin van Wingerden <martin@martinvw.nl>", "committedDate": "2020-02-02T19:34:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg3MzA4Ng==", "url": "https://github.com/openhab/openhab-addons/pull/6957#discussion_r373873086", "body": "No, I referred to this with that remark", "bodyText": "No, I referred to this with that remark", "bodyHTML": "<p dir=\"auto\">No, I referred to this with that remark</p>", "author": "martinvw", "createdAt": "2020-02-02T20:36:21Z", "path": "bundles/org.openhab.binding.hpprinter/src/main/java/org/openhab/binding/hpprinter/internal/binder/HPPrinterBinder.java", "diffHunk": "@@ -218,7 +225,7 @@ public void dynamicallyAddChannels(ThingUID thingUid) {\n      * Opens the connection to the Embedded Web Server\n      */\n     public void open() {\n-        goneOffline();\n+        runOfflineScheduler();", "originalCommit": "d969100b7962ee3c24e449dc5c72b91aee276399", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg3MzI4Mw==", "url": "https://github.com/openhab/openhab-addons/pull/6957#discussion_r373873283", "bodyText": "Okay thanks for the clarification.", "author": "Cossey", "createdAt": "2020-02-02T20:39:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg3MzA4Ng=="}], "type": "inlineReview"}, {"oid": "06fb6ce9d6ab95e97baa3d83f66393ec7df232a4", "url": "https://github.com/openhab/openhab-addons/commit/06fb6ce9d6ab95e97baa3d83f66393ec7df232a4", "message": "HP printer updates\n\nAdded some properties such as serial number and firmware date/version\nRemoved some duplication\nSupport some additional statuses\nShow more detailed OFFLINE status in UI\n\nSigned-off-by: Martin van Wingerden <martin@martinvw.nl>", "committedDate": "2020-02-03T09:21:24Z", "type": "commit"}, {"oid": "669520943c346a1a0114429013059c31cd7037e0", "url": "https://github.com/openhab/openhab-addons/commit/669520943c346a1a0114429013059c31cd7037e0", "message": "HP printer final spotless run\n\nSigned-off-by: Martin van Wingerden <martin@martinvw.nl>", "committedDate": "2020-02-03T14:52:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcwNDI2NA==", "url": "https://github.com/openhab/openhab-addons/pull/6957#discussion_r376704264", "body": "You can use [CoreItemFactory.NUMBER](https://github.com/openhab/openhab-core/blob/master/bundles/org.openhab.core/src/main/java/org/openhab/core/library/CoreItemFactory.java#L52) to set the item type:\r\n\r\n```suggestion\r\n                                .create(new ChannelUID(thingUid, CGROUP_USAGE, CHANNEL_COLOR_MARKING), CoreItemFactory.NUMBER)\r\n```", "bodyText": "You can use CoreItemFactory.NUMBER to set the item type:\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                                            .create(new ChannelUID(thingUid, CGROUP_USAGE, CHANNEL_COLOR_MARKING), \"Number\")\n          \n          \n            \n                                            .create(new ChannelUID(thingUid, CGROUP_USAGE, CHANNEL_COLOR_MARKING), CoreItemFactory.NUMBER)", "bodyHTML": "<p dir=\"auto\">You can use <a href=\"https://github.com/openhab/openhab-core/blob/master/bundles/org.openhab.core/src/main/java/org/openhab/core/library/CoreItemFactory.java#L52\">CoreItemFactory.NUMBER</a> to set the item type:</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                                .create(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">ChannelUID</span>(thingUid, <span class=\"pl-c1\">CGROUP_USAGE</span>, <span class=\"pl-c1\">CHANNEL_COLOR_MARKING</span>), <span class=\"pl-s\"><span class=\"pl-pds x x-first\">\"</span><span class=\"x\">Number</span><span class=\"pl-pds x x-last\">\"</span></span>)</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                                .create(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">ChannelUID</span>(thingUid, <span class=\"pl-c1\">CGROUP_USAGE</span>, <span class=\"pl-c1\">CHANNEL_COLOR_MARKING</span>), <span class=\"pl-smi x x-first\">CoreItemFactory</span><span class=\"pl-c1\"><span class=\"pl-k x\">.</span><span class=\"x x-last\">NUMBER</span></span>)</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "cweitkamp", "createdAt": "2020-02-08T11:19:47Z", "path": "bundles/org.openhab.binding.hpprinter/src/main/java/org/openhab/binding/hpprinter/internal/binder/HPPrinterBinder.java", "diffHunk": "@@ -110,74 +121,80 @@ public void dynamicallyAddChannels(ThingUID thingUid) {\n             }\n \n             switch (data.getType()) {\n-            case SINGLECOLOR:\n-                if (data.hasCumulativeMarking()) {\n+                case SINGLECOLOR:\n+                    if (data.hasCumulativeMarking()) {\n+                        channels.add(ChannelBuilder\n+                                .create(new ChannelUID(thingUid, CGROUP_USAGE, CHANNEL_COLOR_MARKING), \"Number\")", "originalCommit": "669520943c346a1a0114429013059c31cd7037e0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcwNDQ2OA==", "url": "https://github.com/openhab/openhab-addons/pull/6957#discussion_r376704468", "body": "You already set the status to `ONLINE` some lines before.", "bodyText": "You already set the status to ONLINE some lines before.", "bodyHTML": "<p dir=\"auto\">You already set the status to <code>ONLINE</code> some lines before.</p>", "author": "cweitkamp", "createdAt": "2020-02-08T11:24:20Z", "path": "bundles/org.openhab.binding.hpprinter/src/main/java/org/openhab/binding/hpprinter/internal/binder/HPPrinterBinder.java", "diffHunk": "@@ -350,6 +354,9 @@ private void goneOnline() {\n             offlineScheduler = null;\n         }\n \n+        handler.binderStatus(ThingStatus.ONLINE);", "originalCommit": "669520943c346a1a0114429013059c31cd7037e0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjcwNDU0OA==", "url": "https://github.com/openhab/openhab-addons/pull/6957#discussion_r376704548", "body": "To avoid duplicate code you can call the `close()` method here.", "bodyText": "To avoid duplicate code you can call the close() method here.", "bodyHTML": "<p dir=\"auto\">To avoid duplicate code you can call the <code>close()</code> method here.</p>", "author": "cweitkamp", "createdAt": "2020-02-08T11:26:18Z", "path": "bundles/org.openhab.binding.hpprinter/src/main/java/org/openhab/binding/hpprinter/internal/binder/HPPrinterBinder.java", "diffHunk": "@@ -245,53 +262,40 @@ public void goneOffline() {\n             offlineScheduler.cancel(true);\n             offlineScheduler = null;\n         }", "originalCommit": "669520943c346a1a0114429013059c31cd7037e0", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e0e8400d9d8130bba032545967e9705274b9dfbe", "url": "https://github.com/openhab/openhab-addons/commit/e0e8400d9d8130bba032545967e9705274b9dfbe", "message": "Review comments\n\nSigned-off-by: Martin van Wingerden <martin@martinvw.nl>", "committedDate": "2020-02-09T07:52:37Z", "type": "commit"}]}