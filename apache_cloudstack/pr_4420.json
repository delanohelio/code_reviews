{"pr_number": 4420, "pr_title": "Including instance details in KubernetesClusterResponse", "pr_author": "davidjumani", "pr_createdAt": "2020-10-22T08:52:13Z", "pr_url": "https://github.com/apache/cloudstack/pull/4420", "timeline": [{"oid": "6ccb9a3795706c9e4df1d369c41482c78dbb80dc", "url": "https://github.com/apache/cloudstack/commit/6ccb9a3795706c9e4df1d369c41482c78dbb80dc", "message": "Including instance details in KubernetesClusterResponse", "committedDate": "2020-10-22T08:47:54Z", "type": "commit"}, {"oid": "42f92f6bed26962a79da18dac97b31c7b2262dd7", "url": "https://github.com/apache/cloudstack/commit/42f92f6bed26962a79da18dac97b31c7b2262dd7", "message": "Fixing tests", "committedDate": "2020-10-22T09:02:07Z", "type": "commit"}, {"oid": "42f92f6bed26962a79da18dac97b31c7b2262dd7", "url": "https://github.com/apache/cloudstack/commit/42f92f6bed26962a79da18dac97b31c7b2262dd7", "message": "Fixing tests", "committedDate": "2020-10-22T09:02:07Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA5NTg2NA==", "url": "https://github.com/apache/cloudstack/pull/4420#discussion_r510095864", "body": "would like this string constant defined", "bodyText": "would like this string constant defined", "bodyHTML": "<p dir=\"auto\">would like this string constant defined</p>", "author": "DaanHoogland", "createdAt": "2020-10-22T11:47:30Z", "path": "plugins/integrations/kubernetes-service/src/main/java/com/cloud/kubernetes/cluster/KubernetesClusterManagerImpl.java", "diffHunk": "@@ -606,13 +610,20 @@ public KubernetesClusterResponse createKubernetesClusterResponse(long kubernetes\n         response.setEndpoint(kubernetesCluster.getEndpoint());\n         response.setNetworkId(ntwk.getUuid());\n         response.setAssociatedNetworkName(ntwk.getName());\n-        List<String> vmIds = new ArrayList<String>();\n+        List<UserVmResponse> vmIds = new ArrayList<UserVmResponse>();\n         List<KubernetesClusterVmMapVO> vmList = kubernetesClusterVmMapDao.listByClusterId(kubernetesCluster.getId());\n+        ResponseView respView = ResponseView.Restricted;\n+        Account caller = CallContext.current().getCallingAccount();\n+        if (accountService.isRootAdmin(caller.getId())) {\n+            respView = ResponseView.Full;\n+        }\n         if (vmList != null && !vmList.isEmpty()) {\n             for (KubernetesClusterVmMapVO vmMapVO : vmList) {\n-                UserVmVO userVM = userVmDao.findById(vmMapVO.getVmId());\n+                UserVmJoinVO userVM = userVmJoinDao.findById(vmMapVO.getVmId());\n                 if (userVM != null) {\n-                    vmIds.add(userVM.getUuid());\n+                    UserVmResponse vmResponse = ApiDBUtils.newUserVmResponse(respView, \"virtualmachine\", userVM,", "originalCommit": "42f92f6bed26962a79da18dac97b31c7b2262dd7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDU0NjUxMw==", "url": "https://github.com/apache/cloudstack/pull/4420#discussion_r510546513", "body": "@davidjumani considering that this variable has changed from a list of _VM IDs_ to a list of _VM Responses_ I would suggest renaming it.\r\nWhat do you think of _vmResponses_ or _vmResponseList_?", "bodyText": "@davidjumani considering that this variable has changed from a list of VM IDs to a list of VM Responses I would suggest renaming it.\nWhat do you think of vmResponses or vmResponseList?", "bodyHTML": "<p dir=\"auto\"><a class=\"user-mention\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/davidjumani/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/davidjumani\">@davidjumani</a> considering that this variable has changed from a list of <em>VM IDs</em> to a list of <em>VM Responses</em> I would suggest renaming it.<br>\nWhat do you think of <em>vmResponses</em> or <em>vmResponseList</em>?</p>", "author": "GabrielBrascher", "createdAt": "2020-10-23T01:31:56Z", "path": "plugins/integrations/kubernetes-service/src/main/java/com/cloud/kubernetes/cluster/KubernetesClusterManagerImpl.java", "diffHunk": "@@ -606,13 +610,20 @@ public KubernetesClusterResponse createKubernetesClusterResponse(long kubernetes\n         response.setEndpoint(kubernetesCluster.getEndpoint());\n         response.setNetworkId(ntwk.getUuid());\n         response.setAssociatedNetworkName(ntwk.getName());\n-        List<String> vmIds = new ArrayList<String>();\n+        List<UserVmResponse> vmIds = new ArrayList<UserVmResponse>();", "originalCommit": "42f92f6bed26962a79da18dac97b31c7b2262dd7", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "e844a1c6af9d42bceaaee4c43db923d51dc5691a", "url": "https://github.com/apache/cloudstack/commit/e844a1c6af9d42bceaaee4c43db923d51dc5691a", "message": "Refactoring", "committedDate": "2020-10-23T02:53:30Z", "type": "commit"}]}