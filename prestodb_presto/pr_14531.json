{"pr_number": 14531, "pr_title": "Fix DruidRequestBody JSON serialization error and add unit test case", "pr_author": "beinan", "pr_createdAt": "2020-05-14T20:04:19Z", "pr_url": "https://github.com/prestodb/presto/pull/14531", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxNzU3Mw==", "url": "https://github.com/prestodb/presto/pull/14531#discussion_r425417573", "body": "could we have better naming than:\r\ncolumn.1 and table-1\r\n\r\nmaybe column.field, table-name?", "bodyText": "could we have better naming than:\ncolumn.1 and table-1\nmaybe column.field, table-name?", "bodyHTML": "<p dir=\"auto\">could we have better naming than:<br>\ncolumn.1 and table-1</p>\n<p dir=\"auto\">maybe column.field, table-name?</p>", "author": "zhenxiao", "createdAt": "2020-05-14T20:41:24Z", "path": "presto-druid/src/test/java/com/facebook/presto/druid/TestDruidClient.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.druid;\n+\n+import org.testng.annotations.Test;\n+\n+import static org.testng.Assert.assertEquals;\n+\n+public class TestDruidClient\n+{\n+    @Test\n+    public void testDruidRequestBodyToJson()\n+    {\n+        DruidClient.DruidRequestBody requestBody = new DruidClient.DruidRequestBody(\n+                \"select \\\"column.1\\\" from \\\"table-1\\\"\", \"arrayLines\", false);", "originalCommit": "da0a55430c445788c7ea7d0af11efe1353d2f873", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxNzk3NQ==", "url": "https://github.com/prestodb/presto/pull/14531#discussion_r425417975", "bodyText": "format: each parameter in a separate line", "author": "zhenxiao", "createdAt": "2020-05-14T20:42:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxNzU3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ3MTc2MQ==", "url": "https://github.com/prestodb/presto/pull/14531#discussion_r425471761", "bodyText": "done", "author": "beinan", "createdAt": "2020-05-14T22:45:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxNzU3Mw=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxODI5NQ==", "url": "https://github.com/prestodb/presto/pull/14531#discussion_r425418295", "body": "format: requestBody.toJson() in a separate line", "bodyText": "format: requestBody.toJson() in a separate line", "bodyHTML": "<p dir=\"auto\">format: requestBody.toJson() in a separate line</p>", "author": "zhenxiao", "createdAt": "2020-05-14T20:42:53Z", "path": "presto-druid/src/test/java/com/facebook/presto/druid/TestDruidClient.java", "diffHunk": "@@ -0,0 +1,33 @@\n+/*\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.facebook.presto.druid;\n+\n+import org.testng.annotations.Test;\n+\n+import static org.testng.Assert.assertEquals;\n+\n+public class TestDruidClient\n+{\n+    @Test\n+    public void testDruidRequestBodyToJson()\n+    {\n+        DruidClient.DruidRequestBody requestBody = new DruidClient.DruidRequestBody(\n+                \"select \\\"column.1\\\" from \\\"table-1\\\"\", \"arrayLines\", false);\n+        assertEquals(\"{\\n\" +\n+                \"  \\\"query\\\" : \\\"select \\\\\\\"column.1\\\\\\\" from \\\\\\\"table-1\\\\\\\"\\\",\\n\" +\n+                \"  \\\"resultFormat\\\" : \\\"arrayLines\\\",\\n\" +\n+                \"  \\\"queryHeader\\\" : false\\n\" +\n+                \"}\", requestBody.toJson());", "originalCommit": "da0a55430c445788c7ea7d0af11efe1353d2f873", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQ3MTgwMw==", "url": "https://github.com/prestodb/presto/pull/14531#discussion_r425471803", "bodyText": "done", "author": "beinan", "createdAt": "2020-05-14T22:45:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTQxODI5NQ=="}], "type": "inlineReview"}, {"oid": "57f06af7005bc1945aef75be67f62c758a03f33c", "url": "https://github.com/prestodb/presto/commit/57f06af7005bc1945aef75be67f62c758a03f33c", "message": "Fix DruidRequestBody JSON serialization error and add unit test case", "committedDate": "2020-05-14T22:45:09Z", "type": "forcePushed"}, {"oid": "2f688a9f35dad9f62a80db80a2a95c8c71f1d1d5", "url": "https://github.com/prestodb/presto/commit/2f688a9f35dad9f62a80db80a2a95c8c71f1d1d5", "message": "Fix DruidRequestBody JSON serialization error and add unit test cases", "committedDate": "2020-05-15T01:43:37Z", "type": "commit"}, {"oid": "2f688a9f35dad9f62a80db80a2a95c8c71f1d1d5", "url": "https://github.com/prestodb/presto/commit/2f688a9f35dad9f62a80db80a2a95c8c71f1d1d5", "message": "Fix DruidRequestBody JSON serialization error and add unit test cases", "committedDate": "2020-05-15T01:43:37Z", "type": "forcePushed"}]}