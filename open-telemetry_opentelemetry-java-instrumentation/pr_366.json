{"pr_number": 366, "pr_title": "Normalize sql statements to elide literal numbers and strings.", "pr_author": "johnbley", "pr_createdAt": "2020-04-29T16:11:11Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/366", "timeline": [{"oid": "1052d9ba8032165b2e05ca4c08c74b284f020671", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/1052d9ba8032165b2e05ca4c08c74b284f020671", "message": "Normalize sql statements to elide literal numbers and strings.", "committedDate": "2020-04-29T16:04:46Z", "type": "commit"}, {"oid": "5a09851fd791f52bfa05ff1a1f3b7b55b9b4ddfd", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/5a09851fd791f52bfa05ff1a1f3b7b55b9b4ddfd", "message": "Missed one SlickTest sql normalization.", "committedDate": "2020-04-29T16:30:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQ4MzQ2NA==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/366#discussion_r417483464", "body": "I hear you about naming `boolean` settings so that the default maps to `false`, but I think this naming would be more consistent with the existing settings:\r\n\r\n```suggestion\r\n  public static final String SQL_NORMALIZER_ENABLED = \"sql.normalizer.enabled\";\r\n  public static final boolean DEFAULT_SQL_NORMALIZER_ENABLED = true;\r\n```\r\n", "bodyText": "I hear you about naming boolean settings so that the default maps to false, but I think this naming would be more consistent with the existing settings:\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              public static final String DISABLE_SQL_NORMALIZER = \"disable.sql.normalizer\";\n          \n          \n            \n              public static final boolean DEFAULT_DISABLE_SQL_NORMALIZER = false;\n          \n          \n            \n              public static final String SQL_NORMALIZER_ENABLED = \"sql.normalizer.enabled\";\n          \n          \n            \n              public static final boolean DEFAULT_SQL_NORMALIZER_ENABLED = true;", "bodyHTML": "<p dir=\"auto\">I hear you about naming <code>boolean</code> settings so that the default maps to <code>false</code>, but I think this naming would be more consistent with the existing settings:</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">  <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">final</span> <span class=\"pl-smi\">String</span> <span class=\"pl-c1 x x-first x-last\">DISABLE_SQL_NORMALIZER</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"x x-first x-last\">disable.</span>sql.normalizer<span class=\"pl-pds\">\"</span></span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">  <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">final</span> <span class=\"pl-k\">boolean</span> <span class=\"pl-c1 x x-first x-last\">DEFAULT_DISABLE_SQL_NORMALIZER</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1 x x-first x-last\">false</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">  <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">final</span> <span class=\"pl-smi\">String</span> <span class=\"pl-c1 x x-first x-last\">SQL_NORMALIZER_ENABLED</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>sql.normalizer<span class=\"x x-first x-last\">.enabled</span><span class=\"pl-pds\">\"</span></span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">  <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">final</span> <span class=\"pl-k\">boolean</span> <span class=\"pl-c1 x x-first x-last\">DEFAULT_SQL_NORMALIZER_ENABLED</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1 x x-first x-last\">true</span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "trask", "createdAt": "2020-04-29T17:22:14Z", "path": "agent-bootstrap/src/main/java/io/opentelemetry/auto/config/Config.java", "diffHunk": "@@ -96,6 +96,9 @@\n   private static final String DEFAULT_TRACE_EXECUTORS = \"\";\n   private static final String DEFAULT_TRACE_METHODS = null;\n \n+  public static final String DISABLE_SQL_NORMALIZER = \"disable.sql.normalizer\";\n+  public static final boolean DEFAULT_DISABLE_SQL_NORMALIZER = false;", "originalCommit": "5a09851fd791f52bfa05ff1a1f3b7b55b9b4ddfd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQ4NzU1Nw==", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/pull/366#discussion_r417487557", "bodyText": "Agreed, will turn into another commit to fix the test though \ud83d\ude04", "author": "johnbley", "createdAt": "2020-04-29T17:28:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzQ4MzQ2NA=="}], "type": "inlineReview"}, {"oid": "f5bf116c7b469d034faeb37399e650d0ebef121a", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/f5bf116c7b469d034faeb37399e650d0ebef121a", "message": "Fix muzzle order for helper classes.", "committedDate": "2020-04-29T17:25:56Z", "type": "commit"}, {"oid": "7b940b002093eaa3444250665d3f9e2817e37285", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/7b940b002093eaa3444250665d3f9e2817e37285", "message": "Change name of feature flag", "committedDate": "2020-04-29T17:40:25Z", "type": "commit"}, {"oid": "5e73cc2994d722ff0dd55e0e2ce59c07291ab219", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/5e73cc2994d722ff0dd55e0e2ce59c07291ab219", "message": "Upgrade to latest spotless version in an attempt #1 to make the circleci build work.", "committedDate": "2020-04-30T17:31:52Z", "type": "commit"}, {"oid": "bd1ee653a0abac1f1c2ec4f64a8f2390a99c3a87", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/bd1ee653a0abac1f1c2ec4f64a8f2390a99c3a87", "message": "Attempt 2 to make circleci build happy - exclude build/generated/** from spotless.", "committedDate": "2020-04-30T18:40:37Z", "type": "commit"}, {"oid": "4abbd67eeb98a94c6ba145630e5c2bd05948ce8e", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/4abbd67eeb98a94c6ba145630e5c2bd05948ce8e", "message": "Attempt 3 to get circleci build working, adding *.java to the exclude line.", "committedDate": "2020-04-30T18:52:50Z", "type": "commit"}, {"oid": "aed2c9648d23344ae2d0f018c026e97e98d78adf", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/aed2c9648d23344ae2d0f018c026e97e98d78adf", "message": "Change exclude of generated files to include of just the src/ directory.\nI confirmed that this properly failed the build if I remove a license header from a src/ directory.", "committedDate": "2020-04-30T19:04:48Z", "type": "commit"}, {"oid": "a5f7d16e302828e3fd7c7e10f05bf1f3250775fb", "url": "https://github.com/open-telemetry/opentelemetry-java-instrumentation/commit/a5f7d16e302828e3fd7c7e10f05bf1f3250775fb", "message": "Merge branch 'master' into master", "committedDate": "2020-05-04T18:43:43Z", "type": "commit"}]}