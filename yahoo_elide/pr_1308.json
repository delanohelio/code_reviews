{"pr_number": 1308, "pr_title": "Fixing bug where legacy hibernate 5 entity manager store recycles the\u2026", "pr_author": "aklish", "pr_createdAt": "2020-05-07T20:03:49Z", "pr_url": "https://github.com/yahoo/elide/pull/1308", "timeline": [{"oid": "1634b6d4773b0b438c11b4ff8f640e0e9b3de5d6", "url": "https://github.com/yahoo/elide/commit/1634b6d4773b0b438c11b4ff8f640e0e9b3de5d6", "message": "Fixing bug where legacy hibernate 5 entity manager store recycles the entity manager", "committedDate": "2020-05-07T20:01:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc2ODg3NA==", "url": "https://github.com/yahoo/elide/pull/1308#discussion_r421768874", "body": "Should we keep the deprecated function so we do not break existing code?\r\n```java\r\n    @Deprecated\r\n    public HibernateEntityManagerStore(HibernateEntityManager entityManager,\r\n                                       boolean isScrollEnabled,\r\n                                       ScrollMode scrollMode) {\r\n        this(entityManager.getEntityManagerFactory(), isScrollEnabled, scrollMode);\r\n    }\r\n```", "bodyText": "Should we keep the deprecated function so we do not break existing code?\n    @Deprecated\n    public HibernateEntityManagerStore(HibernateEntityManager entityManager,\n                                       boolean isScrollEnabled,\n                                       ScrollMode scrollMode) {\n        this(entityManager.getEntityManagerFactory(), isScrollEnabled, scrollMode);\n    }", "bodyHTML": "<p dir=\"auto\">Should we keep the deprecated function so we do not break existing code?</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"    @Deprecated\n    public HibernateEntityManagerStore(HibernateEntityManager entityManager,\n                                       boolean isScrollEnabled,\n                                       ScrollMode scrollMode) {\n        this(entityManager.getEntityManagerFactory(), isScrollEnabled, scrollMode);\n    }\n\"><pre>    <span class=\"pl-k\">@Deprecated</span>\n    <span class=\"pl-k\">public</span> HibernateEntityManagerStore(<span class=\"pl-smi\">HibernateEntityManager</span> entityManager,\n                                       <span class=\"pl-k\">boolean</span> isScrollEnabled,\n                                       <span class=\"pl-smi\">ScrollMode</span> scrollMode) {\n        <span class=\"pl-c1\">this</span>(entityManager<span class=\"pl-k\">.</span>getEntityManagerFactory(), isScrollEnabled, scrollMode);\n    }</pre></div>", "author": "wcekan", "createdAt": "2020-05-07T20:18:52Z", "path": "elide-datastore/elide-datastore-hibernate5/src/main/java/com/yahoo/elide/datastores/hibernate5/HibernateEntityManagerStore.java", "diffHunk": "@@ -10,40 +10,22 @@\n \n import org.hibernate.ScrollMode;\n import org.hibernate.Session;\n-import org.hibernate.jpa.HibernateEntityManager;\n \n import javax.persistence.EntityManager;\n+import javax.persistence.EntityManagerFactory;\n import javax.persistence.metamodel.EntityType;\n \n /**\n  * Hibernate5 store supporting the EntityManager.\n  */\n public class HibernateEntityManagerStore extends AbstractHibernateStore {\n-    protected final EntityManager entityManager;\n+    protected final EntityManagerFactory entityManagerFactory;\n \n-    @Deprecated\n-    public HibernateEntityManagerStore(HibernateEntityManager entityManager,\n+    public HibernateEntityManagerStore(EntityManagerFactory entityManagerFactory,", "originalCommit": "1634b6d4773b0b438c11b4ff8f640e0e9b3de5d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTc2OTY2Mg==", "url": "https://github.com/yahoo/elide/pull/1308#discussion_r421769662", "body": "Here too?\r\n\r\n    @Deprecated\r\n    public HibernateEntityManagerStore(EntityManager entityManager,\r\n                                       boolean isScrollEnabled,\r\n                                       ScrollMode scrollMode) {\r\n        this(entityManager.getEntityManagerFactory(), isScrollEnabled, scrollMode);\r\n    }\r\n```", "bodyText": "Here too?\n@Deprecated\npublic HibernateEntityManagerStore(EntityManager entityManager,\n                                   boolean isScrollEnabled,\n                                   ScrollMode scrollMode) {\n    this(entityManager.getEntityManagerFactory(), isScrollEnabled, scrollMode);\n}", "bodyHTML": "<p dir=\"auto\">Here too?</p>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"@Deprecated\npublic HibernateEntityManagerStore(EntityManager entityManager,\n                                   boolean isScrollEnabled,\n                                   ScrollMode scrollMode) {\n    this(entityManager.getEntityManagerFactory(), isScrollEnabled, scrollMode);\n}\n\"><pre><code>@Deprecated\npublic HibernateEntityManagerStore(EntityManager entityManager,\n                                   boolean isScrollEnabled,\n                                   ScrollMode scrollMode) {\n    this(entityManager.getEntityManagerFactory(), isScrollEnabled, scrollMode);\n}\n</code></pre></div>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"\"><pre><code></code></pre></div>", "author": "wcekan", "createdAt": "2020-05-07T20:20:21Z", "path": "elide-datastore/elide-datastore-hibernate5/src/main/java/com/yahoo/elide/datastores/hibernate5/HibernateEntityManagerStore.java", "diffHunk": "@@ -10,40 +10,22 @@\n \n import org.hibernate.ScrollMode;\n import org.hibernate.Session;\n-import org.hibernate.jpa.HibernateEntityManager;\n \n import javax.persistence.EntityManager;\n+import javax.persistence.EntityManagerFactory;\n import javax.persistence.metamodel.EntityType;\n \n /**\n  * Hibernate5 store supporting the EntityManager.\n  */\n public class HibernateEntityManagerStore extends AbstractHibernateStore {\n-    protected final EntityManager entityManager;\n+    protected final EntityManagerFactory entityManagerFactory;\n \n-    @Deprecated\n-    public HibernateEntityManagerStore(HibernateEntityManager entityManager,\n+    public HibernateEntityManagerStore(EntityManagerFactory entityManagerFactory,\n                                        boolean isScrollEnabled,\n                                        ScrollMode scrollMode) {\n         super(null, isScrollEnabled, scrollMode);\n-        this.entityManager = entityManager;\n-    }\n-\n-    public HibernateEntityManagerStore(EntityManager entityManager,", "originalCommit": "1634b6d4773b0b438c11b4ff8f640e0e9b3de5d6", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}