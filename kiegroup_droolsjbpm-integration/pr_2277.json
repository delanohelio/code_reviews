{"pr_number": 2277, "pr_title": "[DROOLS-5658] [DROOLS-4844] [DROOLS-5657] [DROOLS-2836] [DROOLS-5699] ", "pr_author": "lucamolteni", "pr_createdAt": "2020-10-12T14:33:02Z", "pr_url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzQwNzQxOA==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#discussion_r503407418", "body": "you might want to \"move up\" similarly to here: https://github.com/kiegroup/droolsjbpm-integration/blob/32f44c724770dfd3eca136d3cacdcf0b90455a1e/kie-maven-plugin/src/main/java/org/kie/maven/plugin/AbstractDMNValidationAwareMojo.java#L63-L68", "bodyText": "you might want to \"move up\" similarly to here: \n  \n    \n      droolsjbpm-integration/kie-maven-plugin/src/main/java/org/kie/maven/plugin/AbstractDMNValidationAwareMojo.java\n    \n    \n        Lines 63 to 68\n      in\n      32f44c7\n    \n    \n    \n    \n\n        \n          \n           @Parameter(property = \"validateDMN\", defaultValue = \"VALIDATE_SCHEMA,VALIDATE_MODEL,ANALYZE_DECISION_TABLE\") \n        \n\n        \n          \n           private String validateDMN; \n        \n\n        \n          \n            \n        \n\n        \n          \n           protected String getValidateDMN() { \n        \n\n        \n          \n               return validateDMN; \n        \n\n        \n          \n           }", "bodyHTML": "<p dir=\"auto\">you might want to \"move up\" similarly to here: <div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom color-bg-subtle\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/kiegroup/droolsjbpm-integration/blob/32f44c724770dfd3eca136d3cacdcf0b90455a1e/kie-maven-plugin/src/main/java/org/kie/maven/plugin/AbstractDMNValidationAwareMojo.java#L63-L68\">droolsjbpm-integration/kie-maven-plugin/src/main/java/org/kie/maven/plugin/AbstractDMNValidationAwareMojo.java</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 63 to 68\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/kiegroup/droolsjbpm-integration/commit/32f44c724770dfd3eca136d3cacdcf0b90455a1e\">32f44c7</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L63\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"63\"></td>\n          <td id=\"LC63\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">@Parameter</span>(<span class=\"pl-c1\">property</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>validateDMN<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-c1\">defaultValue</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>VALIDATE_SCHEMA,VALIDATE_MODEL,ANALYZE_DECISION_TABLE<span class=\"pl-pds\">\"</span></span>) </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L64\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"64\"></td>\n          <td id=\"LC64\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">private</span> <span class=\"pl-smi\">String</span> validateDMN; </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L65\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"65\"></td>\n          <td id=\"LC65\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L66\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"66\"></td>\n          <td id=\"LC66\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">protected</span> <span class=\"pl-smi\">String</span> <span class=\"pl-en\">getValidateDMN</span>() { </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L67\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"67\"></td>\n          <td id=\"LC67\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-k\">return</span> validateDMN; </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L68\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"68\"></td>\n          <td id=\"LC68\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> } </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n</p>", "author": "tarilabs", "createdAt": "2020-10-12T16:30:06Z", "path": "kie-maven-plugin/src/main/java/org/kie/maven/plugin/GenerateANCMojo.java", "diffHunk": "@@ -0,0 +1,192 @@\n+/*\n+ * Copyright 2020 Red Hat, Inc. and/or its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.kie.maven.plugin;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.net.URLClassLoader;\n+import java.nio.charset.StandardCharsets;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.nio.file.StandardOpenOption;\n+import java.util.Arrays;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import org.apache.maven.artifact.Artifact;\n+import org.apache.maven.artifact.DependencyResolutionRequiredException;\n+import org.apache.maven.artifact.resolver.filter.CumulativeScopeArtifactFilter;\n+import org.apache.maven.execution.MavenSession;\n+import org.apache.maven.plugin.MojoExecutionException;\n+import org.apache.maven.plugins.annotations.LifecyclePhase;\n+import org.apache.maven.plugins.annotations.Mojo;\n+import org.apache.maven.plugins.annotations.Parameter;\n+import org.apache.maven.plugins.annotations.ResolutionScope;\n+import org.apache.maven.project.MavenProject;\n+import org.drools.ancompiler.CompiledNetworkSource;\n+import org.drools.ancompiler.ObjectTypeNodeCompiler;\n+import org.drools.compiler.kproject.ReleaseIdImpl;\n+import org.drools.core.impl.InternalKnowledgeBase;\n+import org.drools.modelcompiler.CanonicalKieModule;\n+import org.kie.api.KieServices;\n+import org.kie.api.runtime.KieContainer;\n+\n+import static org.kie.maven.plugin.ExecModelMode.ancEnabled;\n+import static org.kie.maven.plugin.ExecModelMode.isModelCompilerInClassPath;\n+\n+@Mojo(name = \"generateANC\",\n+        requiresDependencyResolution = ResolutionScope.NONE,\n+        defaultPhase = LifecyclePhase.COMPILE)\n+public class GenerateANCMojo extends AbstractDMNValidationAwareMojo {\n+\n+    @Parameter(defaultValue = \"${session}\", required = true, readonly = true)\n+    private MavenSession mavenSession;\n+\n+    @Parameter(required = true, defaultValue = \"${project.build.directory}\")\n+    private File targetDirectory;\n+\n+    @Parameter(required = true, defaultValue = \"${project.basedir}\")\n+    private File projectDir;\n+\n+    @Parameter(required = true, defaultValue = \"${project.build.testSourceDirectory}\")\n+    private File testDir;\n+\n+    @Parameter\n+    private Map<String, String> properties;\n+\n+    @Parameter(required = true, defaultValue = \"${project}\")\n+    private MavenProject project;\n+\n+    @Parameter(required = true, defaultValue = \"${project.build.outputDirectory}\")\n+    private File outputDirectory;\n+\n+    @Parameter(property = \"generateModel\", defaultValue = \"YES_WITHDRL\")\n+    private String generateModel;", "originalCommit": "4f53b7e3b94f3f7fa8fc3320128ce079bb1c43b3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc1NzUxNw==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2277#discussion_r503757517", "body": "please 1 move up more. This class is called `...DMNValidationAware...`\r\nKindly consider move this stuff up to `AbstractKieMojo`", "bodyText": "please 1 move up more. This class is called ...DMNValidationAware...\nKindly consider move this stuff up to AbstractKieMojo", "bodyHTML": "<p dir=\"auto\">please 1 move up more. This class is called <code>...DMNValidationAware...</code><br>\nKindly consider move this stuff up to <code>AbstractKieMojo</code></p>", "author": "tarilabs", "createdAt": "2020-10-13T08:19:38Z", "path": "kie-maven-plugin/src/main/java/org/kie/maven/plugin/AbstractDMNValidationAwareMojo.java", "diffHunk": "@@ -63,10 +65,21 @@\n     @Parameter(property = \"validateDMN\", defaultValue = \"VALIDATE_SCHEMA,VALIDATE_MODEL,ANALYZE_DECISION_TABLE\")\n     private String validateDMN;\n \n+    @Parameter(property = \"generateModel\", defaultValue = \"YES_WITHDRL\") // DROOLS-5663 align kie-maven-plugin default value for generateModel configuration flag\n+    private String generateModel;\n+", "originalCommit": "6c8b5bf3e33c9174311569ab8153ef52892c669f", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "95b12462c084b47abd6d6a11bd0d65042a598bac", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/95b12462c084b47abd6d6a11bd0d65042a598bac", "message": "First experiment with alpha newtwork compiler", "committedDate": "2020-10-15T07:56:18Z", "type": "commit"}, {"oid": "af80dd43673a808e4289a230a6a3b862b3c1751c", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/af80dd43673a808e4289a230a6a3b862b3c1751c", "message": "Experiment with another callback to create the KieBase", "committedDate": "2020-10-15T07:56:18Z", "type": "commit"}, {"oid": "547e5a4e439730ac3fc27b13529445266e2622ae", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/547e5a4e439730ac3fc27b13529445266e2622ae", "message": "Revert \"Experiment with another callback to create the KieBase\"\n\nThis reverts commit 2dcaa1df", "committedDate": "2020-10-15T07:56:18Z", "type": "commit"}, {"oid": "17921d08d15dca88cf6a5ff50a3d087acccf5de3", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/17921d08d15dca88cf6a5ff50a3d087acccf5de3", "message": "Generation of compiled alpha network without compiling", "committedDate": "2020-10-15T07:56:18Z", "type": "commit"}, {"oid": "0e9c155bab39d8bf4ae297b1b115aa2f0a1e6306", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/0e9c155bab39d8bf4ae297b1b115aa2f0a1e6306", "message": "Also compiling", "committedDate": "2020-10-15T07:56:18Z", "type": "commit"}, {"oid": "2bfcc8896a0896480df0efcacc4a88334e1b055e", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/2bfcc8896a0896480df0efcacc4a88334e1b055e", "message": "Fixed name change", "committedDate": "2020-10-15T07:56:18Z", "type": "commit"}, {"oid": "0f33cd17f6d2a3640653579ca91c1e0389a502dc", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/0f33cd17f6d2a3640653579ca91c1e0389a502dc", "message": "Refacotr GenerateANCMojo", "committedDate": "2020-10-15T07:56:18Z", "type": "commit"}, {"oid": "a957bd142dbe044f49e8eb2f996cf359a18a0978", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/a957bd142dbe044f49e8eb2f996cf359a18a0978", "message": "First version of testing in kie-maven-plugin, test not running", "committedDate": "2020-10-15T07:56:18Z", "type": "commit"}, {"oid": "124a3ba88fc6d380f29a7d2d93702fee70982830", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/124a3ba88fc6d380f29a7d2d93702fee70982830", "message": "Fix plugin testing", "committedDate": "2020-10-15T07:56:18Z", "type": "commit"}, {"oid": "491d1ff9adcbe2e1a5bad95d15573b21799850c8", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/491d1ff9adcbe2e1a5bad95d15573b21799850c8", "message": "Reverted useless edits", "committedDate": "2020-10-15T07:56:18Z", "type": "commit"}, {"oid": "13668c91cc13ed35a1e82c548a6dd06bb0c704a0", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/13668c91cc13ed35a1e82c548a6dd06bb0c704a0", "message": "Abstract generate model option to super class to avoid default duplication", "committedDate": "2020-10-15T07:56:18Z", "type": "commit"}, {"oid": "2e24f54fb712c62d70d9720eba6f7af613413930", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/2e24f54fb712c62d70d9720eba6f7af613413930", "message": "PMMLModel after DMNModel", "committedDate": "2020-10-15T07:56:18Z", "type": "commit"}, {"oid": "2e24f54fb712c62d70d9720eba6f7af613413930", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/2e24f54fb712c62d70d9720eba6f7af613413930", "message": "PMMLModel after DMNModel", "committedDate": "2020-10-15T07:56:18Z", "type": "forcePushed"}]}