{"pr_number": 3225, "pr_title": "Added 'last login time' and 'first login time' to get when the player last/first logged in the server", "pr_author": "DeltaRays", "pr_createdAt": "2020-07-26T16:55:15Z", "pr_url": "https://github.com/SkriptLang/Skript/pull/3225", "timeline": [{"oid": "b635f85a6c13d2a758a15ec370680a61560c6ad9", "url": "https://github.com/SkriptLang/Skript/commit/b635f85a6c13d2a758a15ec370680a61560c6ad9", "message": "Added ExprLastLoginTime", "committedDate": "2020-07-26T16:39:42Z", "type": "commit"}, {"oid": "d93e6ad5a2a0119012deae0ade3267df2edb5e22", "url": "https://github.com/SkriptLang/Skript/commit/d93e6ad5a2a0119012deae0ade3267df2edb5e22", "message": "Added 'last login time' and 'first login time' to get when the player last/first logged in the server", "committedDate": "2020-07-26T16:54:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU2NDQ2OQ==", "url": "https://github.com/SkriptLang/Skript/pull/3225#discussion_r460564469", "body": "This sentence should end with a period.", "bodyText": "This sentence should end with a period.", "bodyHTML": "<p dir=\"auto\">This sentence should end with a period.</p>", "author": "ShaneBeee", "createdAt": "2020-07-26T19:31:09Z", "path": "src/main/java/ch/njol/skript/expressions/ExprLastLoginTime.java", "diffHunk": "@@ -0,0 +1,75 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.OfflinePlayer;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.Skript;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.skript.lang.Expression;\n+import ch.njol.skript.lang.SkriptParser.ParseResult;\n+import ch.njol.skript.util.Date;\n+import ch.njol.util.Kleenean;\n+\n+@Name(\"Last/First Login Time\")\n+@Description(\"When a player last/first logged in the server\")", "originalCommit": "d93e6ad5a2a0119012deae0ade3267df2edb5e22", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "91fbbdba28b485740bc2db797c9520f770f5e004", "url": "https://github.com/SkriptLang/Skript/commit/91fbbdba28b485740bc2db797c9520f770f5e004", "message": "Added a . to the end of the description and improved the examples", "committedDate": "2020-07-26T19:58:10Z", "type": "commit"}, {"oid": "142fb7f482990a3174c9146dae5baadcbd7c76f2", "url": "https://github.com/SkriptLang/Skript/commit/142fb7f482990a3174c9146dae5baadcbd7c76f2", "message": "Merge branch 'master' into ExprLastLoginTime", "committedDate": "2020-07-27T10:13:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg2NjUyNg==", "url": "https://github.com/SkriptLang/Skript/pull/3225#discussion_r460866526", "body": "The last login method requires Paper 1.13 so it may be good to mention it with the RequiredPlugins annotation. Or at least mentioning the behaviour change in the description.", "bodyText": "The last login method requires Paper 1.13 so it may be good to mention it with the RequiredPlugins annotation. Or at least mentioning the behaviour change in the description.", "bodyHTML": "<p dir=\"auto\">The last login method requires Paper 1.13 so it may be good to mention it with the RequiredPlugins annotation. Or at least mentioning the behaviour change in the description.</p>", "author": "FranKusmiruk", "createdAt": "2020-07-27T12:51:21Z", "path": "src/main/java/ch/njol/skript/expressions/ExprLastLoginTime.java", "diffHunk": "@@ -0,0 +1,75 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.OfflinePlayer;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.Skript;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.skript.lang.Expression;\n+import ch.njol.skript.lang.SkriptParser.ParseResult;\n+import ch.njol.skript.util.Date;\n+import ch.njol.util.Kleenean;\n+\n+@Name(\"Last/First Login Time\")\n+@Description(\"When a player last/first logged in the server.\")\n+@Examples({\"command /onlinefor:\",\n+\t\"\\ttrigger:\",\n+\t\"\\t\\tsend \\\"You have been online for %difference between player's last login date and now%.\\\"\",\n+\t\"\\t\\tsend \\\"You first joined the server %difference between player's first login date and now% ago.\\\"\"})\n+@Since(\"INSERT VERSION\")", "originalCommit": "142fb7f482990a3174c9146dae5baadcbd7c76f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg5MzEwNw==", "url": "https://github.com/SkriptLang/Skript/pull/3225#discussion_r460893107", "bodyText": "I'm not sure as to what getLastPlayed does, as in whether or not it gets when they last joined or when they last left the server", "author": "DeltaRays", "createdAt": "2020-07-27T13:34:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg2NjUyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg5NDYyMw==", "url": "https://github.com/SkriptLang/Skript/pull/3225#discussion_r460894623", "bodyText": "In Paper, it was replaced by OfflinePlayer#getLastLogin and OfflinePlayer#getLastSeen, since the behaviour of the method is unclear, my wild guess is that it is the time they were last seen.", "author": "FranKusmiruk", "createdAt": "2020-07-27T13:36:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg2NjUyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg2NzMwOQ==", "url": "https://github.com/SkriptLang/Skript/pull/3225#discussion_r460867309", "body": "```suggestion\r\n\t\tregister(ExprLastLoginTime.class, Date.class, \"(1\u00a6last|2\u00a6first) login\", \"offlineplayers\");\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\tregister(ExprLastLoginTime.class, Date.class, \"(1\u00a6last|2\u00a6first) login [(date|time)]\", \"offlineplayers\");\n          \n          \n            \n            \t\tregister(ExprLastLoginTime.class, Date.class, \"(1\u00a6last|2\u00a6first) login\", \"offlineplayers\");", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\tregister(<span class=\"pl-smi\">ExprLastLoginTime</span><span class=\"pl-k\">.</span>class, <span class=\"pl-smi\">Date</span><span class=\"pl-k\">.</span>class, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>(1\u00a6last|2\u00a6first) login<span class=\"x x-first x-last\"> [(date|time)]</span><span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>offlineplayers<span class=\"pl-pds\">\"</span></span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">\t\tregister(<span class=\"pl-smi\">ExprLastLoginTime</span><span class=\"pl-k\">.</span>class, <span class=\"pl-smi\">Date</span><span class=\"pl-k\">.</span>class, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>(1\u00a6last|2\u00a6first) login<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>offlineplayers<span class=\"pl-pds\">\"</span></span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "FranKusmiruk", "createdAt": "2020-07-27T12:52:45Z", "path": "src/main/java/ch/njol/skript/expressions/ExprLastLoginTime.java", "diffHunk": "@@ -0,0 +1,75 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.OfflinePlayer;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.Skript;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.skript.lang.Expression;\n+import ch.njol.skript.lang.SkriptParser.ParseResult;\n+import ch.njol.skript.util.Date;\n+import ch.njol.util.Kleenean;\n+\n+@Name(\"Last/First Login Time\")\n+@Description(\"When a player last/first logged in the server.\")\n+@Examples({\"command /onlinefor:\",\n+\t\"\\ttrigger:\",\n+\t\"\\t\\tsend \\\"You have been online for %difference between player's last login date and now%.\\\"\",\n+\t\"\\t\\tsend \\\"You first joined the server %difference between player's first login date and now% ago.\\\"\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprLastLoginTime extends SimplePropertyExpression<OfflinePlayer, Date> {\n+\t\n+\tprivate static boolean LAST_LOGIN = Skript.methodExists(OfflinePlayer.class, \"getLastLogin\");\n+\t\n+\tstatic {\n+\t\tregister(ExprLastLoginTime.class, Date.class, \"(1\u00a6last|2\u00a6first) login [(date|time)]\", \"offlineplayers\");", "originalCommit": "142fb7f482990a3174c9146dae5baadcbd7c76f2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDg2NzUxMQ==", "url": "https://github.com/SkriptLang/Skript/pull/3225#discussion_r460867511", "body": "missing new line at the end", "bodyText": "missing new line at the end", "bodyHTML": "<p dir=\"auto\">missing new line at the end</p>", "author": "FranKusmiruk", "createdAt": "2020-07-27T12:53:08Z", "path": "src/main/java/ch/njol/skript/expressions/ExprLastLoginTime.java", "diffHunk": "@@ -0,0 +1,75 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.OfflinePlayer;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.Skript;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.skript.lang.Expression;\n+import ch.njol.skript.lang.SkriptParser.ParseResult;\n+import ch.njol.skript.util.Date;\n+import ch.njol.util.Kleenean;\n+\n+@Name(\"Last/First Login Time\")\n+@Description(\"When a player last/first logged in the server.\")\n+@Examples({\"command /onlinefor:\",\n+\t\"\\ttrigger:\",\n+\t\"\\t\\tsend \\\"You have been online for %difference between player's last login date and now%.\\\"\",\n+\t\"\\t\\tsend \\\"You first joined the server %difference between player's first login date and now% ago.\\\"\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprLastLoginTime extends SimplePropertyExpression<OfflinePlayer, Date> {\n+\t\n+\tprivate static boolean LAST_LOGIN = Skript.methodExists(OfflinePlayer.class, \"getLastLogin\");\n+\t\n+\tstatic {\n+\t\tregister(ExprLastLoginTime.class, Date.class, \"(1\u00a6last|2\u00a6first) login [(date|time)]\", \"offlineplayers\");\n+\t}\n+\n+\tprivate boolean first;\n+\t\n+\t@Override\n+\tpublic boolean init(Expression<?>[] exprs, int matchedPattern, Kleenean isDelayed, ParseResult parseResult) {\n+\t\tfirst = parseResult.mark == 2;\n+\t\treturn super.init(exprs, matchedPattern, isDelayed, parseResult);\n+\t}\n+\t\n+\t@Nullable\n+\t@Override\n+\tpublic Date convert(OfflinePlayer player) {\n+\t\treturn new Date(first ? player.getFirstPlayed() : (LAST_LOGIN ? player.getLastLogin() : player.getLastPlayed()));\n+\t}\n+\t\n+\t@Override\n+\tpublic Class<? extends Date> getReturnType() {\n+\t\treturn Date.class;\n+\t}\n+\t\n+\t@Override\n+\tprotected String getPropertyName() {\n+\t\treturn \"last login date\";\n+\t}\n+\t\n+}", "originalCommit": "142fb7f482990a3174c9146dae5baadcbd7c76f2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "493ec30d62a8b0be3908d7a10db97e359463f4cd", "url": "https://github.com/SkriptLang/Skript/commit/493ec30d62a8b0be3908d7a10db97e359463f4cd", "message": "removed [(date|time)]\n\nCo-authored-by: Frank Kusmiruk <48283695+FranKusmiruk@users.noreply.github.com>", "committedDate": "2020-07-27T13:33:40Z", "type": "commit"}, {"oid": "edd05bbc6bcd76e3727e03295237cbdd4a5bbd8f", "url": "https://github.com/SkriptLang/Skript/commit/edd05bbc6bcd76e3727e03295237cbdd4a5bbd8f", "message": "Updated the example", "committedDate": "2020-07-27T13:38:20Z", "type": "commit"}, {"oid": "426f01ca1756b9ee343136b24dc96fa1949f25f1", "url": "https://github.com/SkriptLang/Skript/commit/426f01ca1756b9ee343136b24dc96fa1949f25f1", "message": "Went back to CRLF", "committedDate": "2020-07-27T13:39:01Z", "type": "commit"}, {"oid": "e1b900094bb1b386b1dd816f11df975a9278399f", "url": "https://github.com/SkriptLang/Skript/commit/e1b900094bb1b386b1dd816f11df975a9278399f", "message": "Updated the description", "committedDate": "2020-07-27T13:48:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkyMTIyOA==", "url": "https://github.com/SkriptLang/Skript/pull/3225#discussion_r460921228", "body": "Why not just return true?", "bodyText": "Why not just return true?", "bodyHTML": "<p dir=\"auto\">Why not just return true?</p>", "author": "Wealthyturtle", "createdAt": "2020-07-27T14:14:45Z", "path": "src/main/java/ch/njol/skript/expressions/ExprLastLoginTime.java", "diffHunk": "@@ -0,0 +1,75 @@\n+/**\n+ * This file is part of Skript.\n+ *\n+ * Skript is free software: you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Skript is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.OfflinePlayer;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.Skript;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.expressions.base.SimplePropertyExpression;\n+import ch.njol.skript.lang.Expression;\n+import ch.njol.skript.lang.SkriptParser.ParseResult;\n+import ch.njol.skript.util.Date;\n+import ch.njol.util.Kleenean;\n+\n+@Name(\"Last/First Login Time\")\n+@Description(\"When a player last/first logged in the server. 'last login' requires paper to get the last login, otherwise it will get the last time they were seen on the server.\")\n+@Examples({\"command /onlinefor:\",\n+\t\"\\ttrigger:\",\n+\t\"\\t\\tsend \\\"You have been online for %difference between player's last login and now%.\\\"\",\n+\t\"\\t\\tsend \\\"You first joined the server %difference between player's first login and now% ago.\\\"\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprLastLoginTime extends SimplePropertyExpression<OfflinePlayer, Date> {\n+\t\n+\tprivate static boolean LAST_LOGIN = Skript.methodExists(OfflinePlayer.class, \"getLastLogin\");\n+\t\n+\tstatic {\n+\t\tregister(ExprLastLoginTime.class, Date.class, \"(1\u00a6last|2\u00a6first) login\", \"offlineplayers\");\n+\t}\n+\t\n+\tprivate boolean first;\n+\t\n+\t@Override\n+\tpublic boolean init(Expression<?>[] exprs, int matchedPattern, Kleenean isDelayed, ParseResult parseResult) {\n+\t\tfirst = parseResult.mark == 2;\n+\t\treturn super.init(exprs, matchedPattern, isDelayed, parseResult);", "originalCommit": "e1b900094bb1b386b1dd816f11df975a9278399f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkyNjY1MQ==", "url": "https://github.com/SkriptLang/Skript/pull/3225#discussion_r460926651", "bodyText": "super calls setExpr, which he can do himself here but I actually prefer them to call super since we don't know if we are going to add more logic in the future.", "author": "FranKusmiruk", "createdAt": "2020-07-27T14:22:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDkyMTIyOA=="}], "type": "inlineReview"}]}