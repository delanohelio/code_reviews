{"pr_number": 214, "pr_title": "samples: new sample bigquery_auth_drive_scope", "pr_author": "stephaniewang526", "pr_createdAt": "2020-03-06T20:27:35Z", "pr_url": "https://github.com/googleapis/java-bigquery/pull/214", "timeline": [{"oid": "932746b78b318ecf2fad1382b10ebfe6bfaaafa6", "url": "https://github.com/googleapis/java-bigquery/commit/932746b78b318ecf2fad1382b10ebfe6bfaaafa6", "message": "samples: new sample bigquery_auth_drive_scope", "committedDate": "2020-03-06T20:25:30Z", "type": "commit"}, {"oid": "70554b3d146aab067ee45966c4dff5dae3695d17", "url": "https://github.com/googleapis/java-bigquery/commit/70554b3d146aab067ee45966c4dff5dae3695d17", "message": "nit", "committedDate": "2020-03-06T20:35:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE1MTYzMw==", "url": "https://github.com/googleapis/java-bigquery/pull/214#discussion_r389151633", "body": "Doesn't really make sense to print this multiple times. \r\n```suggestion\r\n    System.out.println(\"Auth succeeded with multiple scopes. Datasets:\");\r\n```", "bodyText": "Doesn't really make sense to print this multiple times.\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                System.out.println(\"Datasets:\");\n          \n          \n            \n                System.out.println(\"Auth succeeded with multiple scopes. Datasets:\");", "bodyHTML": "<p dir=\"auto\">Doesn't really make sense to print this multiple times.</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-smi\">System</span><span class=\"pl-k\">.</span>out<span class=\"pl-k\">.</span>println(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Datasets:<span class=\"pl-pds\">\"</span></span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-smi\">System</span><span class=\"pl-k\">.</span>out<span class=\"pl-k\">.</span>println(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"x x-first x-last\">Auth succeeded with multiple scopes. </span>Datasets:<span class=\"pl-pds\">\"</span></span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "kurtisvg", "createdAt": "2020-03-06T21:25:23Z", "path": "samples/src/main/java/com/example/bigquery/AuthDriveScope.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.bigquery;\n+\n+// [START bigquery_auth_drive_scope]\n+import com.google.auth.oauth2.GoogleCredentials;\n+import com.google.auth.oauth2.ServiceAccountCredentials;\n+import com.google.cloud.bigquery.BigQuery;\n+import com.google.cloud.bigquery.BigQueryOptions;\n+import com.google.cloud.bigquery.Dataset;\n+import com.google.common.collect.ImmutableSet;\n+import java.io.IOException;\n+\n+public class AuthDriveScope {\n+\n+  public static void setAuthDriveScope() throws IOException {\n+    // Create credentials with Drive & BigQuery API scopes.\n+    // Both APIs must be enabled for your project before running this code.\n+    GoogleCredentials credentials =\n+        ServiceAccountCredentials.getApplicationDefault()\n+            .createScoped(\n+                ImmutableSet.of(\n+                    \"https://www.googleapis.com/auth/bigquery\",\n+                    \"https://www.googleapis.com/auth/drive\"));\n+\n+    // Instantiate a client.\n+    BigQuery bigquery =\n+        BigQueryOptions.newBuilder().setCredentials(credentials).build().getService();\n+\n+    // Use the client.\n+    System.out.println(\"Datasets:\");", "originalCommit": "70554b3d146aab067ee45966c4dff5dae3695d17", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE1MTc2Nw==", "url": "https://github.com/googleapis/java-bigquery/pull/214#discussion_r389151767", "body": "```suggestion\r\n          \"Dataset: %s%n\", dataset.getDatasetId().getDataset());\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                      \"Auth succeeded with multiple scopes. Dataset %s%n\", dataset.getDatasetId().getDataset());\n          \n          \n            \n                      \"Dataset: %s%n\", dataset.getDatasetId().getDataset());", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">          <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"x x-first x-last\">Auth succeeded with multiple scopes. </span>Dataset %s%n<span class=\"pl-pds\">\"</span></span>, dataset<span class=\"pl-k\">.</span>getDatasetId()<span class=\"pl-k\">.</span>getDataset());</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">          <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Dataset<span class=\"x x-first x-last\">:</span> %s%n<span class=\"pl-pds\">\"</span></span>, dataset<span class=\"pl-k\">.</span>getDatasetId()<span class=\"pl-k\">.</span>getDataset());</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "kurtisvg", "createdAt": "2020-03-06T21:25:43Z", "path": "samples/src/main/java/com/example/bigquery/AuthDriveScope.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.bigquery;\n+\n+// [START bigquery_auth_drive_scope]\n+import com.google.auth.oauth2.GoogleCredentials;\n+import com.google.auth.oauth2.ServiceAccountCredentials;\n+import com.google.cloud.bigquery.BigQuery;\n+import com.google.cloud.bigquery.BigQueryOptions;\n+import com.google.cloud.bigquery.Dataset;\n+import com.google.common.collect.ImmutableSet;\n+import java.io.IOException;\n+\n+public class AuthDriveScope {\n+\n+  public static void setAuthDriveScope() throws IOException {\n+    // Create credentials with Drive & BigQuery API scopes.\n+    // Both APIs must be enabled for your project before running this code.\n+    GoogleCredentials credentials =\n+        ServiceAccountCredentials.getApplicationDefault()\n+            .createScoped(\n+                ImmutableSet.of(\n+                    \"https://www.googleapis.com/auth/bigquery\",\n+                    \"https://www.googleapis.com/auth/drive\"));\n+\n+    // Instantiate a client.\n+    BigQuery bigquery =\n+        BigQueryOptions.newBuilder().setCredentials(credentials).build().getService();\n+\n+    // Use the client.\n+    System.out.println(\"Datasets:\");\n+    for (Dataset dataset : bigquery.listDatasets().iterateAll()) {\n+      System.out.printf(\n+          \"Auth succeeded with multiple scopes. Dataset %s%n\", dataset.getDatasetId().getDataset());", "originalCommit": "70554b3d146aab067ee45966c4dff5dae3695d17", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE1MjYyNg==", "url": "https://github.com/googleapis/java-bigquery/pull/214#discussion_r389152626", "body": "Can we use the wording on the other samples? About reusing the client for multiple requests?", "bodyText": "Can we use the wording on the other samples? About reusing the client for multiple requests?", "bodyHTML": "<p dir=\"auto\">Can we use the wording on the other samples? About reusing the client for multiple requests?</p>", "author": "kurtisvg", "createdAt": "2020-03-06T21:27:41Z", "path": "samples/src/main/java/com/example/bigquery/AuthDriveScope.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.bigquery;\n+\n+// [START bigquery_auth_drive_scope]\n+import com.google.auth.oauth2.GoogleCredentials;\n+import com.google.auth.oauth2.ServiceAccountCredentials;\n+import com.google.cloud.bigquery.BigQuery;\n+import com.google.cloud.bigquery.BigQueryOptions;\n+import com.google.cloud.bigquery.Dataset;\n+import com.google.common.collect.ImmutableSet;\n+import java.io.IOException;\n+\n+public class AuthDriveScope {\n+\n+  public static void setAuthDriveScope() throws IOException {\n+    // Create credentials with Drive & BigQuery API scopes.\n+    // Both APIs must be enabled for your project before running this code.\n+    GoogleCredentials credentials =\n+        ServiceAccountCredentials.getApplicationDefault()\n+            .createScoped(\n+                ImmutableSet.of(\n+                    \"https://www.googleapis.com/auth/bigquery\",\n+                    \"https://www.googleapis.com/auth/drive\"));\n+\n+    // Instantiate a client.", "originalCommit": "70554b3d146aab067ee45966c4dff5dae3695d17", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg2OTAwMQ==", "url": "https://github.com/googleapis/java-bigquery/pull/214#discussion_r389869001", "bodyText": "yes - will do", "author": "stephaniewang526", "createdAt": "2020-03-09T18:07:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE1MjYyNg=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE1MjgwOA==", "url": "https://github.com/googleapis/java-bigquery/pull/214#discussion_r389152808", "body": "Shouldn't this catch the `BigQueryException` error?", "bodyText": "Shouldn't this catch the BigQueryException error?", "bodyHTML": "<p dir=\"auto\">Shouldn't this catch the <code>BigQueryException</code> error?</p>", "author": "kurtisvg", "createdAt": "2020-03-06T21:28:08Z", "path": "samples/src/main/java/com/example/bigquery/AuthDriveScope.java", "diffHunk": "@@ -0,0 +1,52 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.bigquery;\n+\n+// [START bigquery_auth_drive_scope]\n+import com.google.auth.oauth2.GoogleCredentials;\n+import com.google.auth.oauth2.ServiceAccountCredentials;\n+import com.google.cloud.bigquery.BigQuery;\n+import com.google.cloud.bigquery.BigQueryOptions;\n+import com.google.cloud.bigquery.Dataset;\n+import com.google.common.collect.ImmutableSet;\n+import java.io.IOException;\n+\n+public class AuthDriveScope {\n+\n+  public static void setAuthDriveScope() throws IOException {\n+    // Create credentials with Drive & BigQuery API scopes.\n+    // Both APIs must be enabled for your project before running this code.\n+    GoogleCredentials credentials =\n+        ServiceAccountCredentials.getApplicationDefault()\n+            .createScoped(\n+                ImmutableSet.of(\n+                    \"https://www.googleapis.com/auth/bigquery\",\n+                    \"https://www.googleapis.com/auth/drive\"));\n+\n+    // Instantiate a client.\n+    BigQuery bigquery =\n+        BigQueryOptions.newBuilder().setCredentials(credentials).build().getService();\n+\n+    // Use the client.\n+    System.out.println(\"Datasets:\");\n+    for (Dataset dataset : bigquery.listDatasets().iterateAll()) {\n+      System.out.printf(\n+          \"Auth succeeded with multiple scopes. Dataset %s%n\", dataset.getDatasetId().getDataset());\n+    }\n+  }", "originalCommit": "70554b3d146aab067ee45966c4dff5dae3695d17", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTg2OTEwNA==", "url": "https://github.com/googleapis/java-bigquery/pull/214#discussion_r389869104", "bodyText": "yes - agree", "author": "stephaniewang526", "createdAt": "2020-03-09T18:07:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE1MjgwOA=="}], "type": "inlineReview"}, {"oid": "c841991852a9a0fd7fe2a6d804afd0db99a650d9", "url": "https://github.com/googleapis/java-bigquery/commit/c841991852a9a0fd7fe2a6d804afd0db99a650d9", "message": "nit\n\nCo-Authored-By: Kurtis Van Gent <31518063+kurtisvg@users.noreply.github.com>", "committedDate": "2020-03-09T18:01:26Z", "type": "commit"}, {"oid": "6dca6bf911efb8b144dd64f7f50db72d5d318336", "url": "https://github.com/googleapis/java-bigquery/commit/6dca6bf911efb8b144dd64f7f50db72d5d318336", "message": "nit\n\nCo-Authored-By: Kurtis Van Gent <31518063+kurtisvg@users.noreply.github.com>", "committedDate": "2020-03-09T18:01:35Z", "type": "commit"}, {"oid": "26d8015103e592a0ea1a2d1ffdcd3faca072dcf2", "url": "https://github.com/googleapis/java-bigquery/commit/26d8015103e592a0ea1a2d1ffdcd3faca072dcf2", "message": "update based on comments", "committedDate": "2020-03-09T18:07:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk5NzcyOQ==", "url": "https://github.com/googleapis/java-bigquery/pull/214#discussion_r389997729", "body": "Ok, but if you aren't handling it, and not providing any useful advice, you probably should let the higher level handle.", "bodyText": "Ok, but if you aren't handling it, and not providing any useful advice, you probably should let the higher level handle.", "bodyHTML": "<p dir=\"auto\">Ok, but if you aren't handling it, and not providing any useful advice, you probably should let the higher level handle.</p>", "author": "lesv", "createdAt": "2020-03-09T22:32:17Z", "path": "samples/src/main/java/com/example/bigquery/AuthDriveScope.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Copyright 2020 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.bigquery;\n+\n+// [START bigquery_auth_drive_scope]\n+import com.google.auth.oauth2.GoogleCredentials;\n+import com.google.auth.oauth2.ServiceAccountCredentials;\n+import com.google.cloud.bigquery.BigQuery;\n+import com.google.cloud.bigquery.BigQueryException;\n+import com.google.cloud.bigquery.BigQueryOptions;\n+import com.google.cloud.bigquery.Dataset;\n+import com.google.common.collect.ImmutableSet;\n+import java.io.IOException;\n+\n+public class AuthDriveScope {\n+\n+  public static void setAuthDriveScope() throws IOException {\n+    // Create credentials with Drive & BigQuery API scopes.\n+    // Both APIs must be enabled for your project before running this code.\n+    GoogleCredentials credentials =\n+        ServiceAccountCredentials.getApplicationDefault()\n+            .createScoped(\n+                ImmutableSet.of(\n+                    \"https://www.googleapis.com/auth/bigquery\",\n+                    \"https://www.googleapis.com/auth/drive\"));\n+\n+    try {\n+      // Initialize client that will be used to send requests. This client only needs to be created\n+      // once, and can be reused for multiple requests.\n+      BigQuery bigquery =\n+          BigQueryOptions.newBuilder().setCredentials(credentials).build().getService();\n+\n+      // Use the client.\n+      System.out.println(\"Auth succeeded with multiple scopes. Datasets:\");\n+      for (Dataset dataset : bigquery.listDatasets().iterateAll()) {\n+        System.out.printf(\"Dataset: %s%n\", dataset.getDatasetId().getDataset());\n+      }\n+    } catch (BigQueryException e) {\n+      System.out.println(\"Auth failed due to error: \\n\" + e.toString());\n+    }", "originalCommit": "26d8015103e592a0ea1a2d1ffdcd3faca072dcf2", "replyToReviewId": null, "replies": null, "type": "inlineReview"}]}