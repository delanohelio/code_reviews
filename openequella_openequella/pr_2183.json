{"pr_number": 2183, "pr_title": "Add the support of whether to search attachments to Search2 API", "pr_author": "PenghaiZhang", "pr_createdAt": "2020-08-14T06:21:46Z", "pr_url": "https://github.com/openequella/openEQUELLA/pull/2183", "timeline": [{"oid": "7af4bd8081f4c6c168f7faf1050d9b56dd47250b", "url": "https://github.com/openequella/openEQUELLA/commit/7af4bd8081f4c6c168f7faf1050d9b56dd47250b", "message": "Add the support of whether to search attachments to Search2 API\n\nIn the old Search page, whether to search attachments is dependent on user\npreference. This is not compatible with the new Search page. So add new\nmethods which accept a boolean to include or exclude attachments in searches.", "committedDate": "2020-08-14T06:12:20Z", "type": "commit"}, {"oid": "cade0b77c92f90291dfba759563830e9762e4664", "url": "https://github.com/openequella/openEQUELLA/commit/cade0b77c92f90291dfba759563830e9762e4664", "message": "Let the default value of searchAttachments be true.", "committedDate": "2020-08-17T00:00:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE3NzU2MQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2183#discussion_r471177561", "body": "```suggestion\r\n   * @param searchReq A search request\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * @param searchReq An search request\n          \n          \n            \n               * @param searchReq A search request", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">   <span class=\"pl-k\">*</span> <span class=\"pl-k\">@param</span> searchReq <span class=\"pl-smi x x-first x-last\">An</span> search request</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">   <span class=\"pl-k\">*</span> <span class=\"pl-k\">@param</span> searchReq <span class=\"pl-smi x x-first x-last\">A</span> search request</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "edalex-ian", "createdAt": "2020-08-17T00:07:37Z", "path": "Source/Plugins/Core/com.equella.core/src/com/tle/core/freetext/service/FreeTextService.java", "diffHunk": "@@ -43,6 +43,18 @@\n   <T extends FreetextResult> FreetextSearchResults<T> search(\n       Search searchreq, int nStart, int nCount);\n \n+  /**\n+   * Another search method which allows users to specify if they want to search attachments.\n+   *\n+   * @param searchReq An search request", "originalCommit": "cade0b77c92f90291dfba759563830e9762e4664", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE3ODkzMA==", "url": "https://github.com/openequella/openEQUELLA/pull/2183#discussion_r471178930", "body": "```suggestion\r\n   * @param count The maximum number of results requested, or -1 for all.\r\n```\r\nActually, should this param be called `max` or `length` or `maxCount`/`maxLength`? Ooooh, perhaps not, this is meant to be an overloaded method). In that case these should probably be `nStart` and `nCount` to match the method you're overloading. (Mind you, if you wanted too you could update the other method too so as to improve the names.)", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * @param count The number of records of a search result\n          \n          \n            \n               * @param count The maximum number of results requested, or -1 for all.\n          \n      \n    \n    \n  \n\nActually, should this param be called max or length or maxCount/maxLength? Ooooh, perhaps not, this is meant to be an overloaded method). In that case these should probably be nStart and nCount to match the method you're overloading. (Mind you, if you wanted too you could update the other method too so as to improve the names.)", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">   <span class=\"pl-k\">*</span> <span class=\"pl-k\">@param</span> count <span class=\"pl-smi\">The</span> number of <span class=\"x x-first x-last\">records of a search result</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">   <span class=\"pl-k\">*</span> <span class=\"pl-k\">@param</span> count <span class=\"pl-smi\">The</span> <span class=\"x x-first x-last\">maximum </span>number of <span class=\"x x-first\">results requested, or </span><span class=\"pl-k x\">-</span><span class=\"pl-c1 x\">1</span><span class=\"x\"> </span><span class=\"pl-k x\">for</span><span class=\"x x-last\"> all.</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n\n<p dir=\"auto\">Actually, should this param be called <code>max</code> or <code>length</code> or <code>maxCount</code>/<code>maxLength</code>? Ooooh, perhaps not, this is meant to be an overloaded method). In that case these should probably be <code>nStart</code> and <code>nCount</code> to match the method you're overloading. (Mind you, if you wanted too you could update the other method too so as to improve the names.)</p>", "author": "edalex-ian", "createdAt": "2020-08-17T00:18:37Z", "path": "Source/Plugins/Core/com.equella.core/src/com/tle/core/freetext/service/FreeTextService.java", "diffHunk": "@@ -43,6 +43,18 @@\n   <T extends FreetextResult> FreetextSearchResults<T> search(\n       Search searchreq, int nStart, int nCount);\n \n+  /**\n+   * Another search method which allows users to specify if they want to search attachments.\n+   *\n+   * @param searchReq An search request\n+   * @param start The first record of a search result\n+   * @param count The number of records of a search result", "originalCommit": "cade0b77c92f90291dfba759563830e9762e4664", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE3OTE4Mw==", "url": "https://github.com/openequella/openEQUELLA/pull/2183#discussion_r471179183", "body": "The method signature already tells us this, so how about:\r\n\r\n```suggestion\r\n   * @return Search results matching the specified criteria, with a maximum length of count.\r\n```", "bodyText": "The method signature already tells us this, so how about:\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * @return An instance of SearchResults\n          \n          \n            \n               * @return Search results matching the specified criteria, with a maximum length of count.", "bodyHTML": "<p dir=\"auto\">The method signature already tells us this, so how about:</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">   <span class=\"pl-k\">*</span> <span class=\"pl-k\">@return</span> <span class=\"pl-smi x x-first\">An</span><span class=\"x x-last\"> instance </span>of <span class=\"pl-smi x x-first x-last\">SearchResults</span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">   <span class=\"pl-k\">*</span> <span class=\"pl-k\">@return</span> <span class=\"pl-smi x x-first\">Search</span><span class=\"x x-last\"> results matching the specified criteria, with a maximum length </span>of <span class=\"x x-first x-last\">count.</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "edalex-ian", "createdAt": "2020-08-17T00:20:31Z", "path": "Source/Plugins/Core/com.equella.core/src/com/tle/core/freetext/service/FreeTextService.java", "diffHunk": "@@ -43,6 +43,18 @@\n   <T extends FreetextResult> FreetextSearchResults<T> search(\n       Search searchreq, int nStart, int nCount);\n \n+  /**\n+   * Another search method which allows users to specify if they want to search attachments.\n+   *\n+   * @param searchReq An search request\n+   * @param start The first record of a search result\n+   * @param count The number of records of a search result\n+   * @param searchAttachments Whether to search attachments\n+   * @return An instance of SearchResults", "originalCommit": "cade0b77c92f90291dfba759563830e9762e4664", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE3OTY1Nw==", "url": "https://github.com/openequella/openEQUELLA/pull/2183#discussion_r471179657", "body": "Is the `f` in `fTextResults` for `free`? If so, let's just use the whole word. But then again, we do have the type here, so why not just `results`?", "bodyText": "Is the f in fTextResults for free? If so, let's just use the whole word. But then again, we do have the type here, so why not just results?", "bodyHTML": "<p dir=\"auto\">Is the <code>f</code> in <code>fTextResults</code> for <code>free</code>? If so, let's just use the whole word. But then again, we do have the type here, so why not just <code>results</code>?</p>", "author": "edalex-ian", "createdAt": "2020-08-17T00:23:34Z", "path": "Source/Plugins/Core/com.equella.core/src/com/tle/core/freetext/service/impl/FreeTextServiceImpl.java", "diffHunk": "@@ -263,6 +263,13 @@ public void indexAll() {\n     return new StdFreetextResults<T>(itemService, fTextResults, searchreq);\n   }\n \n+  @Override\n+  public <T extends FreetextResult> FreetextSearchResults<T> search(\n+      Search searchReq, int start, int count, boolean searchAttachments) {\n+    SearchResults<T> fTextResults = indexer.search(searchReq, start, count, searchAttachments);", "originalCommit": "cade0b77c92f90291dfba759563830e9762e4664", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "2a846e111bc130c2572805942e2789a4e217d0d5", "url": "https://github.com/openequella/openEQUELLA/commit/2a846e111bc130c2572805942e2789a4e217d0d5", "message": "Doco and param name tidy ups for whether to searching attachment.", "committedDate": "2020-08-17T04:48:40Z", "type": "commit"}]}