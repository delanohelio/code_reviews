{"pr_number": 1130, "pr_title": "Better messaging on broker redirect uri mismatch.", "pr_author": "AdamBJohnsonx", "pr_createdAt": "2020-08-14T20:10:39Z", "pr_url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1130", "merge_commit": "79daa98f62357b2f74d686b0b035d846af5fd528", "timeline": [{"oid": "717b3cea6436ef74be1b2a655db7bcfcffa6b24d", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/717b3cea6436ef74be1b2a655db7bcfcffa6b24d", "message": "Better messaging on redirect uri mismatch.", "committedDate": "2020-08-14T20:10:10Z", "type": "commit"}, {"oid": "3f909a0bac8886614f4720a249b72916253f104a", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/3f909a0bac8886614f4720a249b72916253f104a", "message": "Fix PMD error.", "committedDate": "2020-08-15T00:33:27Z", "type": "commit"}, {"oid": "752b57b4b9fc2e6b56ce15d20913734a077f7b7b", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/752b57b4b9fc2e6b56ce15d20913734a077f7b7b", "message": "Fix typo.", "committedDate": "2020-08-15T00:48:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTY0OTgxOQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1130#discussion_r471649819", "body": "Optionally return the entire expression?\r\n\r\n```java\r\nreturn matcher.matches() && ObjectUtils.equals(mAppContext.getPackageName(), matcher.group(1));\r\n```", "bodyText": "Optionally return the entire expression?\nreturn matcher.matches() && ObjectUtils.equals(mAppContext.getPackageName(), matcher.group(1));", "bodyHTML": "<p dir=\"auto\">Optionally return the entire expression?</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"return matcher.matches() &amp;&amp; ObjectUtils.equals(mAppContext.getPackageName(), matcher.group(1));\"><pre><span class=\"pl-k\">return</span> matcher<span class=\"pl-k\">.</span>matches() <span class=\"pl-k\">&amp;&amp;</span> <span class=\"pl-smi\">ObjectUtils</span><span class=\"pl-k\">.</span>equals(mAppContext<span class=\"pl-k\">.</span>getPackageName(), matcher<span class=\"pl-k\">.</span>group(<span class=\"pl-c1\">1</span>));</pre></div>", "author": "iambmelt", "createdAt": "2020-08-17T17:32:21Z", "path": "msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java", "diffHunk": "@@ -480,10 +483,11 @@ private void nullConfigurationCheck(String configKey, String configValue) {\n     }\n \n     private boolean isBrokerRedirectUri() {\n-        final String BROKER_REDIRECT_URI_REGEX = \"msauth://\" + mAppContext.getPackageName() + \"/.*\";\n-        final Pattern pairRegex = Pattern.compile(BROKER_REDIRECT_URI_REGEX);\n-        final Matcher matcher = pairRegex.matcher(mRedirectUri);\n-        return matcher.matches();\n+        final Matcher matcher = BROKER_REDIRECT_URI_REGEX.matcher(mRedirectUri);\n+        if (matcher.matches() && ObjectUtils.equals(mAppContext.getPackageName(), matcher.group(1))) {", "originalCommit": "752b57b4b9fc2e6b56ce15d20913734a077f7b7b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTgyNjYzMA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1130#discussion_r471826630", "bodyText": "Yes, that's better.", "author": "AdamBJohnsonx", "createdAt": "2020-08-17T23:21:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTY0OTgxOQ=="}], "type": "inlineReview", "revised_code": {"commit": "9af396dc3791a8f5a8ee3a32effeb1c078ae1419", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex e4313fb5..eab708a5 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -482,12 +484,10 @@ public class PublicClientApplicationConfiguration {\n         }\n     }\n \n-    private boolean isBrokerRedirectUri() {\n-        final Matcher matcher = BROKER_REDIRECT_URI_REGEX.matcher(mRedirectUri);\n-        if (matcher.matches() && ObjectUtils.equals(mAppContext.getPackageName(), matcher.group(1))) {\n-            return true;\n-        }\n-        return false;\n+    @VisibleForTesting\n+    public static boolean isBrokerRedirectUri(final @NonNull String redirectUri, final @Nullable String packageName) {\n+        final Matcher matcher = BROKER_REDIRECT_URI_REGEX.matcher(redirectUri);\n+        return matcher.matches() && ObjectUtils.equals(packageName, matcher.group(1));\n     }\n \n     // Verifies broker redirect URI against the app's signature, to make sure that this is legit.\n", "next_change": {"commit": "dfe076dc1dde4c9359ac0d0b8cece829f6a6a5e2", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex eab708a5..82b95fee 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -486,8 +486,8 @@ public class PublicClientApplicationConfiguration {\n \n     @VisibleForTesting\n     public static boolean isBrokerRedirectUri(final @NonNull String redirectUri, final @Nullable String packageName) {\n-        final Matcher matcher = BROKER_REDIRECT_URI_REGEX.matcher(redirectUri);\n-        return matcher.matches() && ObjectUtils.equals(packageName, matcher.group(1));\n+        final String potentialPrefix = BROKER_REDIRECT_URI_SCHEME_AND_SEPARATOR + packageName + \"/\";\n+        return redirectUri != null && redirectUri.startsWith(potentialPrefix);\n     }\n \n     // Verifies broker redirect URI against the app's signature, to make sure that this is legit.\n", "next_change": {"commit": "b2bc14daefb33709abda77ce041243f97d44e079", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 82b95fee..5bdf97a5 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -485,7 +485,7 @@ public class PublicClientApplicationConfiguration {\n     }\n \n     @VisibleForTesting\n-    public static boolean isBrokerRedirectUri(final @NonNull String redirectUri, final @Nullable String packageName) {\n+    public static boolean isBrokerRedirectUri(final @NonNull String redirectUri, final @NonNull String packageName) {\n         final String potentialPrefix = BROKER_REDIRECT_URI_SCHEME_AND_SEPARATOR + packageName + \"/\";\n         return redirectUri != null && redirectUri.startsWith(potentialPrefix);\n     }\n", "next_change": null}]}}]}}]}, "revised_code_in_main": {"commit": "79daa98f62357b2f74d686b0b035d846af5fd528", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex e4313fb5..5bdf97a5 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -482,12 +484,10 @@ public class PublicClientApplicationConfiguration {\n         }\n     }\n \n-    private boolean isBrokerRedirectUri() {\n-        final Matcher matcher = BROKER_REDIRECT_URI_REGEX.matcher(mRedirectUri);\n-        if (matcher.matches() && ObjectUtils.equals(mAppContext.getPackageName(), matcher.group(1))) {\n-            return true;\n-        }\n-        return false;\n+    @VisibleForTesting\n+    public static boolean isBrokerRedirectUri(final @NonNull String redirectUri, final @NonNull String packageName) {\n+        final String potentialPrefix = BROKER_REDIRECT_URI_SCHEME_AND_SEPARATOR + packageName + \"/\";\n+        return redirectUri != null && redirectUri.startsWith(potentialPrefix);\n     }\n \n     // Verifies broker redirect URI against the app's signature, to make sure that this is legit.\n", "next_change": {"commit": "fbb021776a0e37f8ef92117792aa7ad7bbaf523a", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 5bdf97a5..5cc6ddfa 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -494,8 +535,9 @@ public class PublicClientApplicationConfiguration {\n     private void verifyRedirectUriWithAppSignature() throws MsalClientException {\n         final String packageName = mAppContext.getPackageName();\n         try {\n-            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(packageName, PackageManager.GET_SIGNATURES);\n-            for (final Signature signature : info.signatures) {\n+            final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n+            Signature [] signatures = PackageHelper.getSignatures(info);\n+            for (final Signature signature : signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n", "next_change": {"commit": "58e1d501bf6c8d4b5ccaf634824b192ee2edb019", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 5cc6ddfa..c13ed9d0 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -535,9 +514,8 @@ public class PublicClientApplicationConfiguration {\n     private void verifyRedirectUriWithAppSignature() throws MsalClientException {\n         final String packageName = mAppContext.getPackageName();\n         try {\n-            final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n-            Signature [] signatures = PackageHelper.getSignatures(info);\n-            for (final Signature signature : signatures) {\n+            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(packageName, PackageManager.GET_SIGNATURES);\n+            for (final Signature signature : info.signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n", "next_change": {"commit": "9464c8bd97f33e910f4698a34278705fbb1e70ec", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex c13ed9d0..fd51bbc8 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -514,8 +535,9 @@ public class PublicClientApplicationConfiguration {\n     private void verifyRedirectUriWithAppSignature() throws MsalClientException {\n         final String packageName = mAppContext.getPackageName();\n         try {\n-            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(packageName, PackageManager.GET_SIGNATURES);\n-            for (final Signature signature : info.signatures) {\n+            final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n+            Signature [] signatures = PackageHelper.getSignatures(info);\n+            for (final Signature signature : signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n", "next_change": {"commit": "91fe570fc177b9cc298d2d85147cebff4f98344d", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex fd51bbc8..6d7fc7e4 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -536,7 +540,7 @@ public class PublicClientApplicationConfiguration {\n         final String packageName = mAppContext.getPackageName();\n         try {\n             final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n-            Signature [] signatures = PackageHelper.getSignatures(info);\n+            Signature[] signatures = PackageHelper.getSignatures(info);\n             for (final Signature signature : signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n", "next_change": {"commit": "77df1b7c64dc913577b319a5a80fefff16be09bc", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 6d7fc7e4..14d14581 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -539,9 +525,8 @@ public class PublicClientApplicationConfiguration {\n     private void verifyRedirectUriWithAppSignature() throws MsalClientException {\n         final String packageName = mAppContext.getPackageName();\n         try {\n-            final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n-            Signature[] signatures = PackageHelper.getSignatures(info);\n-            for (final Signature signature : signatures) {\n+            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(packageName, PackageManager.GET_SIGNATURES);\n+            for (final Signature signature : info.signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n", "next_change": {"commit": "aff959b85e80e6cb7b1342d2a6384b83edcbb1d8", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 14d14581..2a66ead4 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -525,8 +553,9 @@ public class PublicClientApplicationConfiguration {\n     private void verifyRedirectUriWithAppSignature() throws MsalClientException {\n         final String packageName = mAppContext.getPackageName();\n         try {\n-            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(packageName, PackageManager.GET_SIGNATURES);\n-            for (final Signature signature : info.signatures) {\n+            final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n+            Signature[] signatures = PackageHelper.getSignatures(info);\n+            for (final Signature signature : signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n", "next_change": {"commit": "0b7166e35c9b5147a81ef5aa4ad1beef1326fedc", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 2a66ead4..ca4d4e0b 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -553,13 +531,20 @@ public class PublicClientApplicationConfiguration {\n     private void verifyRedirectUriWithAppSignature() throws MsalClientException {\n         final String packageName = mAppContext.getPackageName();\n         try {\n-            final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n-            Signature[] signatures = PackageHelper.getSignatures(info);\n-            for (final Signature signature : signatures) {\n+            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(packageName, PackageManager.GET_SIGNATURES);\n+            for (final Signature signature : info.signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n \n+                if (packageName.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_PACKAGE_NAME)\n+                    && (signatureHash.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_RELEASE_SIGNATURE)\n+                        || signatureHash.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_DEBUG_SIGNATURE))\n+                    && mRedirectUri.equalsIgnoreCase(AuthenticationConstants.Broker.BROKER_REDIRECT_URI))\n+                {\n+                    return;\n+                }\n+\n                 final Uri.Builder builder = new Uri.Builder();\n                 final Uri uri = builder.scheme(\"msauth\")\n                         .authority(packageName)\n", "next_change": {"commit": "35ebf633d3894a7ca99828a2e24c5ce4b65283e8", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex ca4d4e0b..951ec2f1 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -536,15 +536,6 @@ public class PublicClientApplicationConfiguration {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n-\n-                if (packageName.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_PACKAGE_NAME)\n-                    && (signatureHash.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_RELEASE_SIGNATURE)\n-                        || signatureHash.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_DEBUG_SIGNATURE))\n-                    && mRedirectUri.equalsIgnoreCase(AuthenticationConstants.Broker.BROKER_REDIRECT_URI))\n-                {\n-                    return;\n-                }\n-\n                 final Uri.Builder builder = new Uri.Builder();\n                 final Uri uri = builder.scheme(\"msauth\")\n                         .authority(packageName)\n", "next_change": {"commit": "cc79774afa769f29d7e5177d7afde3ab99b36280", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 951ec2f1..8fbbc0fc 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -531,8 +559,9 @@ public class PublicClientApplicationConfiguration {\n     private void verifyRedirectUriWithAppSignature() throws MsalClientException {\n         final String packageName = mAppContext.getPackageName();\n         try {\n-            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(packageName, PackageManager.GET_SIGNATURES);\n-            for (final Signature signature : info.signatures) {\n+            final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n+            Signature[] signatures = PackageHelper.getSignatures(info);\n+            for (final Signature signature : signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n", "next_change": null}]}}]}}]}}]}}]}}]}}]}}]}}]}}]}, "commits_in_main": [{"oid": "79daa98f62357b2f74d686b0b035d846af5fd528", "message": "Merge commit", "committedDate": null}, {"oid": "e7038498484c5d3024154ca0b9ede64ae978e53f", "committedDate": "2020-09-04 11:06:25 -0700", "message": "Expose RT to broker apps (#1126)"}, {"oid": "1d14607474e0bb10de154615c3420cc1c43317b3", "committedDate": "2021-01-05 11:26:12 -0800", "message": "Beef up redirect uri messaging"}, {"oid": "6a7b17c016e0d85b1084980957a3619ff4496ca4", "committedDate": "2021-03-05 17:46:10 -0800", "message": "Ensure \"\" does not pass validation"}, {"oid": "12670de7842436407c15b9db3c96f92442cf67a0", "committedDate": "2021-03-08 17:56:49 -0800", "message": "Add tests"}, {"oid": "4cda58b9387e7ccae293ea3274452ec487f3df42", "committedDate": "2021-03-08 18:18:12 -0800", "message": "Smaller changes"}, {"oid": "8c218f0d4271e63965543b2fbeaff115d5f41e92", "committedDate": "2021-03-08 18:49:37 -0800", "message": "Tweaks"}, {"oid": "9f00f092d31d375c5deae4b22fbb80c27ca939dc", "committedDate": "2021-03-08 18:50:39 -0800", "message": "Remove string literal check"}, {"oid": "03def88467d19cc0585295d960c340175096acd1", "committedDate": "2021-03-08 19:13:23 -0800", "message": "Rename method for clarity"}, {"oid": "28c8d378525cdc5ac1ad3acef45eacae2079a502", "committedDate": "2021-04-02 18:46:42 -0700", "message": "Update Logger imports in MSAL"}, {"oid": "e9bb9d3e1bdf43ebaf06a62392c2280a8c8b6d40", "committedDate": "2021-04-05 10:25:36 -0700", "message": "changes to support null task affinity"}, {"oid": "7335d8754c99fc1bbf966e7b5c99c7af4b366ede", "committedDate": "2021-04-05 10:25:58 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "e1aa12641dc7f4714accbe0126c76cc933f5d331", "committedDate": "2021-04-05 10:25:58 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "1592b1a070a0a40f8cdbe9389184ccfc374be676", "committedDate": "2021-04-13 16:48:22 -0700", "message": "Log and throw exception if there are other apps listening for the url scheme"}, {"oid": "fbb021776a0e37f8ef92117792aa7ad7bbaf523a", "committedDate": "2021-04-15 14:02:10 -0700", "message": "merge"}, {"oid": "58e1d501bf6c8d4b5ccaf634824b192ee2edb019", "committedDate": "2021-04-16 13:20:06 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "9464c8bd97f33e910f4698a34278705fbb1e70ec", "committedDate": "2021-04-16 13:24:34 -0700", "message": "Merge branch 'dev' into shahzaibj/logUrlSchemeListener"}, {"oid": "b12bbb7236477d88a139384c5bc12ef787841ace", "committedDate": "2021-04-19 12:49:16 -0700", "message": "fix instrumented tests and merge configuration bugs"}, {"oid": "72ed05116f398f0d763544410d88d419b0040aa3", "committedDate": "2021-04-27 16:33:20 -0700", "message": "Merge branch 'dev' into shahzaibj/logUrlSchemeListener"}, {"oid": "91fe570fc177b9cc298d2d85147cebff4f98344d", "committedDate": "2021-04-28 11:57:09 -0700", "message": "Address comments"}, {"oid": "14d1c7be6f2e756427b9d41569586a107aa97993", "committedDate": "2021-04-28 12:05:54 -0700", "message": "Add method name to log tag"}, {"oid": "8235fb5ce92a7a74f904bd1d33cc3009167c98ff", "committedDate": "2021-04-28 12:12:57 -0700", "message": "Address comment"}, {"oid": "36700831510bbbe5339b7b97602a4d43d1320c83", "committedDate": "2021-04-28 12:16:18 -0700", "message": "Address comment"}, {"oid": "5456fed7e8aeddc699aa4c61e1cee1c2650b6a85", "committedDate": "2021-05-14 09:22:58 -0700", "message": "Merge branch 'dev' into adjoh/redirect-uri-beefup"}, {"oid": "77df1b7c64dc913577b319a5a80fefff16be09bc", "committedDate": "2021-05-31 16:38:12 -0700", "message": "MSAL updates to support loading launching custom tabs in current task"}, {"oid": "ff0da9db29cf605519cac602cd48109c4486720a", "committedDate": "2021-06-04 12:11:06 -0700", "message": "Code review feedback; updates for updates in common; fix unit test"}, {"oid": "aff959b85e80e6cb7b1342d2a6384b83edcbb1d8", "committedDate": "2021-07-19 10:51:50 -0700", "message": "Merge branch 'master' into adjoh/propagate-merge-of-common"}, {"oid": "405dd8ba72e915c73a77f3393bd9cb7d1f9cb2e0", "committedDate": "2021-07-29 12:18:57 -0700", "message": "Migrate Account Manager Account"}, {"oid": "832a46a6df354b5579a4dab06fad17c7c3325ec9", "committedDate": "2021-08-02 17:59:19 -0700", "message": "Migrate Strategies, Parameters, and some other stuffs"}, {"oid": "5624eccb86ecdd7df653f762e275bd529b7f2dc4", "committedDate": "2021-08-12 19:53:50 -0700", "message": "Make changes to accommodate CommandDispatcher&co migration"}, {"oid": "0b7166e35c9b5147a81ef5aa4ad1beef1326fedc", "committedDate": "2021-09-17 14:15:27 -0700", "message": "Allow authenticator to pass older format for redirect uri"}, {"oid": "35ebf633d3894a7ca99828a2e24c5ce4b65283e8", "committedDate": "2021-09-17 15:17:20 -0700", "message": "move the authenticator check up"}, {"oid": "bee9497b7465668d7495ab61c0b59e8174911128", "committedDate": "2021-09-17 16:15:08 -0700", "message": "fix in another place"}, {"oid": "fce9cbcc902a6f27a8adf8b398fac33a00860709", "committedDate": "2021-09-20 13:22:13 -0700", "message": "fix the condition"}, {"oid": "9d04d671677450ae91868391ef84379024b6c3e9", "committedDate": "2021-09-20 15:29:28 -0700", "message": "address comments"}, {"oid": "b49c4c5cb75ba0254a445739c67efb4414eb2bdf", "committedDate": "2021-09-20 15:31:12 -0700", "message": "minor format"}, {"oid": "370aa2788864ce1c7321bc2fe599681c620c0076", "committedDate": "2021-09-20 15:32:02 -0700", "message": "typo"}, {"oid": "d983c641fde4177c48ea20477f388bc9d44c3ead", "committedDate": "2021-09-20 16:18:52 -0700", "message": "minor udate"}, {"oid": "35b8e4fee2ce31d66900b18a71b55488790cf45c", "committedDate": "2021-09-20 16:45:35 -0700", "message": "fix unittest"}, {"oid": "cc79774afa769f29d7e5177d7afde3ab99b36280", "committedDate": "2021-09-27 17:07:15 -0700", "message": "Merge branch 'master' into amgusain/merge_master_2.2.1"}, {"oid": "b7a7c30f19e5fdb5fa3a6aa6fb18b40e9dbca143", "committedDate": "2021-09-28 13:14:00 -0700", "message": "fix spotbugs warning"}, {"oid": "d5f91f5ea10c599e5109cffd0bdfc03d801bdae5", "committedDate": "2022-03-30 17:41:47 +0300", "message": "Update changelog"}, {"oid": "66cfe69ec6d063b47b769f02a227b6fafc73ca9b", "committedDate": "2023-02-14 16:18:39 -0600", "message": "Add preferred browser support (#1761)"}]}, {"oid": "9af396dc3791a8f5a8ee3a32effeb1c078ae1419", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/9af396dc3791a8f5a8ee3a32effeb1c078ae1419", "message": "Take code review comments, add a unit test.", "committedDate": "2020-08-17T23:30:15Z", "type": "commit"}, {"oid": "8434d2fb9717c0d00ff9e1e0b49c5b2ab7c4c0b1", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/8434d2fb9717c0d00ff9e1e0b49c5b2ab7c4c0b1", "message": "Ass assertions to tests, correct regular expression.", "committedDate": "2020-08-18T00:10:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTg0ODM4MA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1130#discussion_r471848380", "body": "See that this was an info message previously.  We may want to warn here instead.", "bodyText": "See that this was an info message previously.  We may want to warn here instead.", "bodyHTML": "<p dir=\"auto\">See that this was an info message previously.  We may want to warn here instead.</p>", "author": "shoatman", "createdAt": "2020-08-18T00:38:27Z", "path": "msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java", "diffHunk": "@@ -551,10 +555,12 @@ public void checkIntentFilterAddedToAppManifestForBrokerFlow() throws MsalClient\n             return;\n         }\n \n-        if (!isBrokerRedirectUri()) {\n+        if (!isBrokerRedirectUri(mRedirectUri, mAppContext.getPackageName())) {\n             // This means that the app is still using the legacy local-only MSAL Redirect uri (already removed from the new portal).\n             // If this is the case, we can assume that the user doesn't need Broker support.\n-            Logger.info(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\");\n+            Logger.info(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"", "originalCommit": "8434d2fb9717c0d00ff9e1e0b49c5b2ab7c4c0b1", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "610a2637c7dda42fac06555ac1230fd781b635d9", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 93f58df7..9f008797 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -558,7 +558,7 @@ public class PublicClientApplicationConfiguration {\n         if (!isBrokerRedirectUri(mRedirectUri, mAppContext.getPackageName())) {\n             // This means that the app is still using the legacy local-only MSAL Redirect uri (already removed from the new portal).\n             // If this is the case, we can assume that the user doesn't need Broker support.\n-            Logger.info(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"\n+            Logger.warn(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"\n                 + \"  For brokered auth, the redirect URI is expected to conform to \" + BROKER_REDIRECT_URI_REGEX + \" where the authority in \"\n                 + \"that uri is the package name.\");\n             mUseBroker = false;\n", "next_change": {"commit": "dfe076dc1dde4c9359ac0d0b8cece829f6a6a5e2", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 9f008797..82b95fee 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -559,7 +559,7 @@ public class PublicClientApplicationConfiguration {\n             // This means that the app is still using the legacy local-only MSAL Redirect uri (already removed from the new portal).\n             // If this is the case, we can assume that the user doesn't need Broker support.\n             Logger.warn(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"\n-                + \"  For brokered auth, the redirect URI is expected to conform to \" + BROKER_REDIRECT_URI_REGEX + \" where the authority in \"\n+                + \"  For brokered auth, the redirect URI is expected to conform to 'msauth://<authority>/.*' where the authority in \"\n                 + \"that uri is the package name.\");\n             mUseBroker = false;\n             return;\n", "next_change": {"commit": "3219f413599785373b79e45f90719ba2bc70f924", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 82b95fee..4dac1596 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -560,7 +560,7 @@ public class PublicClientApplicationConfiguration {\n             // If this is the case, we can assume that the user doesn't need Broker support.\n             Logger.warn(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"\n                 + \"  For brokered auth, the redirect URI is expected to conform to 'msauth://<authority>/.*' where the authority in \"\n-                + \"that uri is the package name.\");\n+                + \"that uri is the package name of the app. This package name is listed as 'applicationId' in the build.gradle file.\");\n             mUseBroker = false;\n             return;\n         }\n", "next_change": null}]}}]}}]}, "revised_code_in_main": {"commit": "79daa98f62357b2f74d686b0b035d846af5fd528", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 93f58df7..5bdf97a5 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -558,9 +558,9 @@ public class PublicClientApplicationConfiguration {\n         if (!isBrokerRedirectUri(mRedirectUri, mAppContext.getPackageName())) {\n             // This means that the app is still using the legacy local-only MSAL Redirect uri (already removed from the new portal).\n             // If this is the case, we can assume that the user doesn't need Broker support.\n-            Logger.info(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"\n-                + \"  For brokered auth, the redirect URI is expected to conform to \" + BROKER_REDIRECT_URI_REGEX + \" where the authority in \"\n-                + \"that uri is the package name.\");\n+            Logger.warn(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"\n+                + \"  For brokered auth, the redirect URI is expected to conform to 'msauth://<authority>/.*' where the authority in \"\n+                + \"that uri is the package name of the app. This package name is listed as 'applicationId' in the build.gradle file.\");\n             mUseBroker = false;\n             return;\n         }\n", "next_change": {"commit": "6a7b17c016e0d85b1084980957a3619ff4496ca4", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 5bdf97a5..aeb0ef48 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -559,8 +556,8 @@ public class PublicClientApplicationConfiguration {\n             // This means that the app is still using the legacy local-only MSAL Redirect uri (already removed from the new portal).\n             // If this is the case, we can assume that the user doesn't need Broker support.\n             Logger.warn(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"\n-                + \"  For brokered auth, the redirect URI is expected to conform to 'msauth://<authority>/.*' where the authority in \"\n-                + \"that uri is the package name of the app. This package name is listed as 'applicationId' in the build.gradle file.\");\n+                    + \"  For brokered auth, the redirect URI is expected to conform to 'msauth://<authority>/.*' where the authority in \"\n+                    + \"that uri is the package name of the app. This package name is listed as 'applicationId' in the build.gradle file.\");\n             mUseBroker = false;\n             return;\n         }\n", "next_change": {"commit": "bee9497b7465668d7495ab61c0b59e8174911128", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex aeb0ef48..93ae7865 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -565,4 +623,32 @@ public class PublicClientApplicationConfiguration {\n         verifyRedirectUriWithAppSignature();\n     }\n \n+    private boolean verifyAuthenticatorRedirectUri() {\n+        try {\n+            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_PACKAGE_NAME, PackageManager.GET_SIGNATURES);\n+            if (info != null && info.signatures != null && info.signatures.length > 0) {\n+                Signature signature = info.signatures[0];\n+                MessageDigest md = MessageDigest.getInstance(\"SHA\");\n+                md.update(signature.toByteArray());\n+                final String signatureHash = Base64.encodeToString(md.digest(), Base64.NO_WRAP);\n+                if (signatureHash.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_RELEASE_SIGNATURE)\n+                    || signatureHash.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_DEBUG_SIGNATURE)\n+                ) {\n+                    final Uri.Builder builder = new Uri.Builder();\n+                    final Uri uri = builder.scheme(\"msauth\")\n+                            .authority(mAppContext.getPackageName())\n+                            .appendPath(signatureHash)\n+                            .build();\n+\n+                    if (mRedirectUri.equalsIgnoreCase(uri.toString()) || mRedirectUri.equalsIgnoreCase(AuthenticationConstants.Broker.BROKER_REDIRECT_URI)) {\n+                        return true;\n+                    }\n+                }\n+            }\n+        }\n+        catch (PackageManager.NameNotFoundException | NoSuchAlgorithmException e) {\n+            Logger.error(TAG, \"Unexpected error in getting package info/signature for Autheticator\", e);\n+        }\n+        return false;\n+    }\n }\n", "next_change": {"commit": "9d04d671677450ae91868391ef84379024b6c3e9", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 93ae7865..35c01a30 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -645,10 +648,10 @@ public class PublicClientApplicationConfiguration {\n                     }\n                 }\n             }\n-        }\n-        catch (PackageManager.NameNotFoundException | NoSuchAlgorithmException e) {\n+        } catch (final PackageManager.NameNotFoundException | NoSuchAlgorithmException e) {\n             Logger.error(TAG, \"Unexpected error in getting package info/signature for Autheticator\", e);\n         }\n+\n         return false;\n     }\n }\n", "next_change": {"commit": "370aa2788864ce1c7321bc2fe599681c620c0076", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 35c01a30..a70f90ce 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -649,7 +648,7 @@ public class PublicClientApplicationConfiguration {\n                 }\n             }\n         } catch (final PackageManager.NameNotFoundException | NoSuchAlgorithmException e) {\n-            Logger.error(TAG, \"Unexpected error in getting package info/signature for Autheticator\", e);\n+            Logger.error(TAG, \"Unexpected error in getting package info/signature for Authenticator\", e);\n         }\n \n         return false;\n", "next_change": {"commit": "d5f91f5ea10c599e5109cffd0bdfc03d801bdae5", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex a70f90ce..384d86ad 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -648,7 +744,7 @@ public class PublicClientApplicationConfiguration {\n                 }\n             }\n         } catch (final PackageManager.NameNotFoundException | NoSuchAlgorithmException e) {\n-            Logger.error(TAG, \"Unexpected error in getting package info/signature for Authenticator\", e);\n+            Logger.error(methodTag, \"Unexpected error in getting package info/signature for Authenticator\", e);\n         }\n \n         return false;\n", "next_change": null}]}}]}}]}}]}}]}}]}, "commits_in_main": [{"oid": "79daa98f62357b2f74d686b0b035d846af5fd528", "message": "Merge commit", "committedDate": null}, {"oid": "e7038498484c5d3024154ca0b9ede64ae978e53f", "committedDate": "2020-09-04 11:06:25 -0700", "message": "Expose RT to broker apps (#1126)"}, {"oid": "1d14607474e0bb10de154615c3420cc1c43317b3", "committedDate": "2021-01-05 11:26:12 -0800", "message": "Beef up redirect uri messaging"}, {"oid": "6a7b17c016e0d85b1084980957a3619ff4496ca4", "committedDate": "2021-03-05 17:46:10 -0800", "message": "Ensure \"\" does not pass validation"}, {"oid": "12670de7842436407c15b9db3c96f92442cf67a0", "committedDate": "2021-03-08 17:56:49 -0800", "message": "Add tests"}, {"oid": "4cda58b9387e7ccae293ea3274452ec487f3df42", "committedDate": "2021-03-08 18:18:12 -0800", "message": "Smaller changes"}, {"oid": "8c218f0d4271e63965543b2fbeaff115d5f41e92", "committedDate": "2021-03-08 18:49:37 -0800", "message": "Tweaks"}, {"oid": "9f00f092d31d375c5deae4b22fbb80c27ca939dc", "committedDate": "2021-03-08 18:50:39 -0800", "message": "Remove string literal check"}, {"oid": "03def88467d19cc0585295d960c340175096acd1", "committedDate": "2021-03-08 19:13:23 -0800", "message": "Rename method for clarity"}, {"oid": "28c8d378525cdc5ac1ad3acef45eacae2079a502", "committedDate": "2021-04-02 18:46:42 -0700", "message": "Update Logger imports in MSAL"}, {"oid": "e9bb9d3e1bdf43ebaf06a62392c2280a8c8b6d40", "committedDate": "2021-04-05 10:25:36 -0700", "message": "changes to support null task affinity"}, {"oid": "7335d8754c99fc1bbf966e7b5c99c7af4b366ede", "committedDate": "2021-04-05 10:25:58 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "e1aa12641dc7f4714accbe0126c76cc933f5d331", "committedDate": "2021-04-05 10:25:58 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "1592b1a070a0a40f8cdbe9389184ccfc374be676", "committedDate": "2021-04-13 16:48:22 -0700", "message": "Log and throw exception if there are other apps listening for the url scheme"}, {"oid": "fbb021776a0e37f8ef92117792aa7ad7bbaf523a", "committedDate": "2021-04-15 14:02:10 -0700", "message": "merge"}, {"oid": "58e1d501bf6c8d4b5ccaf634824b192ee2edb019", "committedDate": "2021-04-16 13:20:06 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "9464c8bd97f33e910f4698a34278705fbb1e70ec", "committedDate": "2021-04-16 13:24:34 -0700", "message": "Merge branch 'dev' into shahzaibj/logUrlSchemeListener"}, {"oid": "b12bbb7236477d88a139384c5bc12ef787841ace", "committedDate": "2021-04-19 12:49:16 -0700", "message": "fix instrumented tests and merge configuration bugs"}, {"oid": "72ed05116f398f0d763544410d88d419b0040aa3", "committedDate": "2021-04-27 16:33:20 -0700", "message": "Merge branch 'dev' into shahzaibj/logUrlSchemeListener"}, {"oid": "91fe570fc177b9cc298d2d85147cebff4f98344d", "committedDate": "2021-04-28 11:57:09 -0700", "message": "Address comments"}, {"oid": "14d1c7be6f2e756427b9d41569586a107aa97993", "committedDate": "2021-04-28 12:05:54 -0700", "message": "Add method name to log tag"}, {"oid": "8235fb5ce92a7a74f904bd1d33cc3009167c98ff", "committedDate": "2021-04-28 12:12:57 -0700", "message": "Address comment"}, {"oid": "36700831510bbbe5339b7b97602a4d43d1320c83", "committedDate": "2021-04-28 12:16:18 -0700", "message": "Address comment"}, {"oid": "5456fed7e8aeddc699aa4c61e1cee1c2650b6a85", "committedDate": "2021-05-14 09:22:58 -0700", "message": "Merge branch 'dev' into adjoh/redirect-uri-beefup"}, {"oid": "77df1b7c64dc913577b319a5a80fefff16be09bc", "committedDate": "2021-05-31 16:38:12 -0700", "message": "MSAL updates to support loading launching custom tabs in current task"}, {"oid": "ff0da9db29cf605519cac602cd48109c4486720a", "committedDate": "2021-06-04 12:11:06 -0700", "message": "Code review feedback; updates for updates in common; fix unit test"}, {"oid": "aff959b85e80e6cb7b1342d2a6384b83edcbb1d8", "committedDate": "2021-07-19 10:51:50 -0700", "message": "Merge branch 'master' into adjoh/propagate-merge-of-common"}, {"oid": "405dd8ba72e915c73a77f3393bd9cb7d1f9cb2e0", "committedDate": "2021-07-29 12:18:57 -0700", "message": "Migrate Account Manager Account"}, {"oid": "832a46a6df354b5579a4dab06fad17c7c3325ec9", "committedDate": "2021-08-02 17:59:19 -0700", "message": "Migrate Strategies, Parameters, and some other stuffs"}, {"oid": "5624eccb86ecdd7df653f762e275bd529b7f2dc4", "committedDate": "2021-08-12 19:53:50 -0700", "message": "Make changes to accommodate CommandDispatcher&co migration"}, {"oid": "0b7166e35c9b5147a81ef5aa4ad1beef1326fedc", "committedDate": "2021-09-17 14:15:27 -0700", "message": "Allow authenticator to pass older format for redirect uri"}, {"oid": "35ebf633d3894a7ca99828a2e24c5ce4b65283e8", "committedDate": "2021-09-17 15:17:20 -0700", "message": "move the authenticator check up"}, {"oid": "bee9497b7465668d7495ab61c0b59e8174911128", "committedDate": "2021-09-17 16:15:08 -0700", "message": "fix in another place"}, {"oid": "fce9cbcc902a6f27a8adf8b398fac33a00860709", "committedDate": "2021-09-20 13:22:13 -0700", "message": "fix the condition"}, {"oid": "9d04d671677450ae91868391ef84379024b6c3e9", "committedDate": "2021-09-20 15:29:28 -0700", "message": "address comments"}, {"oid": "b49c4c5cb75ba0254a445739c67efb4414eb2bdf", "committedDate": "2021-09-20 15:31:12 -0700", "message": "minor format"}, {"oid": "370aa2788864ce1c7321bc2fe599681c620c0076", "committedDate": "2021-09-20 15:32:02 -0700", "message": "typo"}, {"oid": "d983c641fde4177c48ea20477f388bc9d44c3ead", "committedDate": "2021-09-20 16:18:52 -0700", "message": "minor udate"}, {"oid": "35b8e4fee2ce31d66900b18a71b55488790cf45c", "committedDate": "2021-09-20 16:45:35 -0700", "message": "fix unittest"}, {"oid": "cc79774afa769f29d7e5177d7afde3ab99b36280", "committedDate": "2021-09-27 17:07:15 -0700", "message": "Merge branch 'master' into amgusain/merge_master_2.2.1"}, {"oid": "b7a7c30f19e5fdb5fa3a6aa6fb18b40e9dbca143", "committedDate": "2021-09-28 13:14:00 -0700", "message": "fix spotbugs warning"}, {"oid": "d5f91f5ea10c599e5109cffd0bdfc03d801bdae5", "committedDate": "2022-03-30 17:41:47 +0300", "message": "Update changelog"}, {"oid": "66cfe69ec6d063b47b769f02a227b6fafc73ca9b", "committedDate": "2023-02-14 16:18:39 -0600", "message": "Add preferred browser support (#1761)"}]}, {"oid": "610a2637c7dda42fac06555ac1230fd781b635d9", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/610a2637c7dda42fac06555ac1230fd781b635d9", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java", "committedDate": "2020-08-18T00:39:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTg1MjE1NA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1130#discussion_r471852154", "body": "Is this meant to be used outside of the context of an Android app? Because this regex seems to accept invalid android application package names", "bodyText": "Is this meant to be used outside of the context of an Android app? Because this regex seems to accept invalid android application package names", "bodyHTML": "<p dir=\"auto\">Is this meant to be used outside of the context of an Android app? Because this regex seems to accept invalid android application package names</p>", "author": "shahzaibj", "createdAt": "2020-08-18T00:52:26Z", "path": "msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java", "diffHunk": "@@ -78,6 +81,8 @@\n public class PublicClientApplicationConfiguration {\n     private static final String TAG = PublicClientApplicationConfiguration.class.getSimpleName();\n \n+    private static final Pattern BROKER_REDIRECT_URI_REGEX = Pattern.compile(\"msauth://([^/]*)/.*\");", "originalCommit": "610a2637c7dda42fac06555ac1230fd781b635d9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjMxMDM1NQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1130#discussion_r472310355", "bodyText": "Not really - it's private. But the idea is that this pulls out the authority segment of a URI with the correct scheme, and then we compare that string with equals on the package name. But there's only one usage of it...", "author": "AdamBJohnsonx", "createdAt": "2020-08-18T16:05:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTg1MjE1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM2NzI5Nw==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1130#discussion_r472367297", "bodyText": "Okay, I think it is fine as this only being used in this class....but just wanted to point out that the group 1 which is supposed to match the package name, seems to accept anything but a slash, so I think this would accept redirect uri that are formed via package names that aren't actually valid Android application ids....but I think since this is all internal it is probably okay. However, it may still be good to make it more specific.\nFYI, Application id aka \"Android app package name\" naming conventions are listed here: https://developer.android.com/studio/build/application-id", "author": "shahzaibj", "createdAt": "2020-08-18T17:34:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTg1MjE1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM2ODUxNg==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1130#discussion_r472368516", "bodyText": "Yeah, I realize what it was doing... but my mind was in the regex prison, and we don't need to use a Pattern at all, not just a dynamic one.", "author": "AdamBJohnsonx", "createdAt": "2020-08-18T17:36:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTg1MjE1NA=="}], "type": "inlineReview", "revised_code": {"commit": "dfe076dc1dde4c9359ac0d0b8cece829f6a6a5e2", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 9f008797..82b95fee 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -81,7 +81,7 @@ import static com.microsoft.identity.client.PublicClientApplicationConfiguration\n public class PublicClientApplicationConfiguration {\n     private static final String TAG = PublicClientApplicationConfiguration.class.getSimpleName();\n \n-    private static final Pattern BROKER_REDIRECT_URI_REGEX = Pattern.compile(\"msauth://([^/]*)/.*\");\n+    private static final String BROKER_REDIRECT_URI_SCHEME_AND_SEPARATOR = \"msauth://\";\n \n     public static final class SerializedNames {\n         static final String CLIENT_ID = \"client_id\";\n", "next_change": null}]}, "revised_code_in_main": {"commit": "79daa98f62357b2f74d686b0b035d846af5fd528", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 9f008797..5bdf97a5 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -81,7 +81,7 @@ import static com.microsoft.identity.client.PublicClientApplicationConfiguration\n public class PublicClientApplicationConfiguration {\n     private static final String TAG = PublicClientApplicationConfiguration.class.getSimpleName();\n \n-    private static final Pattern BROKER_REDIRECT_URI_REGEX = Pattern.compile(\"msauth://([^/]*)/.*\");\n+    private static final String BROKER_REDIRECT_URI_SCHEME_AND_SEPARATOR = \"msauth://\";\n \n     public static final class SerializedNames {\n         static final String CLIENT_ID = \"client_id\";\n", "next_change": {"commit": "8c218f0d4271e63965543b2fbeaff115d5f41e92", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 5bdf97a5..4abfd14c 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -77,11 +74,13 @@ import static com.microsoft.identity.client.PublicClientApplicationConfiguration\n import static com.microsoft.identity.client.PublicClientApplicationConfiguration.SerializedNames.USE_BROKER;\n import static com.microsoft.identity.client.PublicClientApplicationConfiguration.SerializedNames.WEB_VIEW_ZOOM_CONTROLS_ENABLED;\n import static com.microsoft.identity.client.PublicClientApplicationConfiguration.SerializedNames.WEB_VIEW_ZOOM_ENABLED;\n+import static com.microsoft.identity.client.exception.MsalClientException.APP_MANIFEST_VALIDATION_ERROR;\n \n public class PublicClientApplicationConfiguration {\n     private static final String TAG = PublicClientApplicationConfiguration.class.getSimpleName();\n \n     private static final String BROKER_REDIRECT_URI_SCHEME_AND_SEPARATOR = \"msauth://\";\n+    public static final String INVALID_REDIRECT_MSG = \"Invalid, null, or malformed redirect_uri supplied\";\n \n     public static final class SerializedNames {\n         static final String CLIENT_ID = \"client_id\";\n", "next_change": null}]}}]}, "commits_in_main": [{"oid": "79daa98f62357b2f74d686b0b035d846af5fd528", "message": "Merge commit", "committedDate": null}, {"oid": "e7038498484c5d3024154ca0b9ede64ae978e53f", "committedDate": "2020-09-04 11:06:25 -0700", "message": "Expose RT to broker apps (#1126)"}, {"oid": "1d14607474e0bb10de154615c3420cc1c43317b3", "committedDate": "2021-01-05 11:26:12 -0800", "message": "Beef up redirect uri messaging"}, {"oid": "6a7b17c016e0d85b1084980957a3619ff4496ca4", "committedDate": "2021-03-05 17:46:10 -0800", "message": "Ensure \"\" does not pass validation"}, {"oid": "12670de7842436407c15b9db3c96f92442cf67a0", "committedDate": "2021-03-08 17:56:49 -0800", "message": "Add tests"}, {"oid": "4cda58b9387e7ccae293ea3274452ec487f3df42", "committedDate": "2021-03-08 18:18:12 -0800", "message": "Smaller changes"}, {"oid": "8c218f0d4271e63965543b2fbeaff115d5f41e92", "committedDate": "2021-03-08 18:49:37 -0800", "message": "Tweaks"}, {"oid": "9f00f092d31d375c5deae4b22fbb80c27ca939dc", "committedDate": "2021-03-08 18:50:39 -0800", "message": "Remove string literal check"}, {"oid": "03def88467d19cc0585295d960c340175096acd1", "committedDate": "2021-03-08 19:13:23 -0800", "message": "Rename method for clarity"}, {"oid": "28c8d378525cdc5ac1ad3acef45eacae2079a502", "committedDate": "2021-04-02 18:46:42 -0700", "message": "Update Logger imports in MSAL"}, {"oid": "e9bb9d3e1bdf43ebaf06a62392c2280a8c8b6d40", "committedDate": "2021-04-05 10:25:36 -0700", "message": "changes to support null task affinity"}, {"oid": "7335d8754c99fc1bbf966e7b5c99c7af4b366ede", "committedDate": "2021-04-05 10:25:58 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "e1aa12641dc7f4714accbe0126c76cc933f5d331", "committedDate": "2021-04-05 10:25:58 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "1592b1a070a0a40f8cdbe9389184ccfc374be676", "committedDate": "2021-04-13 16:48:22 -0700", "message": "Log and throw exception if there are other apps listening for the url scheme"}, {"oid": "fbb021776a0e37f8ef92117792aa7ad7bbaf523a", "committedDate": "2021-04-15 14:02:10 -0700", "message": "merge"}, {"oid": "58e1d501bf6c8d4b5ccaf634824b192ee2edb019", "committedDate": "2021-04-16 13:20:06 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "9464c8bd97f33e910f4698a34278705fbb1e70ec", "committedDate": "2021-04-16 13:24:34 -0700", "message": "Merge branch 'dev' into shahzaibj/logUrlSchemeListener"}, {"oid": "b12bbb7236477d88a139384c5bc12ef787841ace", "committedDate": "2021-04-19 12:49:16 -0700", "message": "fix instrumented tests and merge configuration bugs"}, {"oid": "72ed05116f398f0d763544410d88d419b0040aa3", "committedDate": "2021-04-27 16:33:20 -0700", "message": "Merge branch 'dev' into shahzaibj/logUrlSchemeListener"}, {"oid": "91fe570fc177b9cc298d2d85147cebff4f98344d", "committedDate": "2021-04-28 11:57:09 -0700", "message": "Address comments"}, {"oid": "14d1c7be6f2e756427b9d41569586a107aa97993", "committedDate": "2021-04-28 12:05:54 -0700", "message": "Add method name to log tag"}, {"oid": "8235fb5ce92a7a74f904bd1d33cc3009167c98ff", "committedDate": "2021-04-28 12:12:57 -0700", "message": "Address comment"}, {"oid": "36700831510bbbe5339b7b97602a4d43d1320c83", "committedDate": "2021-04-28 12:16:18 -0700", "message": "Address comment"}, {"oid": "5456fed7e8aeddc699aa4c61e1cee1c2650b6a85", "committedDate": "2021-05-14 09:22:58 -0700", "message": "Merge branch 'dev' into adjoh/redirect-uri-beefup"}, {"oid": "77df1b7c64dc913577b319a5a80fefff16be09bc", "committedDate": "2021-05-31 16:38:12 -0700", "message": "MSAL updates to support loading launching custom tabs in current task"}, {"oid": "ff0da9db29cf605519cac602cd48109c4486720a", "committedDate": "2021-06-04 12:11:06 -0700", "message": "Code review feedback; updates for updates in common; fix unit test"}, {"oid": "aff959b85e80e6cb7b1342d2a6384b83edcbb1d8", "committedDate": "2021-07-19 10:51:50 -0700", "message": "Merge branch 'master' into adjoh/propagate-merge-of-common"}, {"oid": "405dd8ba72e915c73a77f3393bd9cb7d1f9cb2e0", "committedDate": "2021-07-29 12:18:57 -0700", "message": "Migrate Account Manager Account"}, {"oid": "832a46a6df354b5579a4dab06fad17c7c3325ec9", "committedDate": "2021-08-02 17:59:19 -0700", "message": "Migrate Strategies, Parameters, and some other stuffs"}, {"oid": "5624eccb86ecdd7df653f762e275bd529b7f2dc4", "committedDate": "2021-08-12 19:53:50 -0700", "message": "Make changes to accommodate CommandDispatcher&co migration"}, {"oid": "0b7166e35c9b5147a81ef5aa4ad1beef1326fedc", "committedDate": "2021-09-17 14:15:27 -0700", "message": "Allow authenticator to pass older format for redirect uri"}, {"oid": "35ebf633d3894a7ca99828a2e24c5ce4b65283e8", "committedDate": "2021-09-17 15:17:20 -0700", "message": "move the authenticator check up"}, {"oid": "bee9497b7465668d7495ab61c0b59e8174911128", "committedDate": "2021-09-17 16:15:08 -0700", "message": "fix in another place"}, {"oid": "fce9cbcc902a6f27a8adf8b398fac33a00860709", "committedDate": "2021-09-20 13:22:13 -0700", "message": "fix the condition"}, {"oid": "9d04d671677450ae91868391ef84379024b6c3e9", "committedDate": "2021-09-20 15:29:28 -0700", "message": "address comments"}, {"oid": "b49c4c5cb75ba0254a445739c67efb4414eb2bdf", "committedDate": "2021-09-20 15:31:12 -0700", "message": "minor format"}, {"oid": "370aa2788864ce1c7321bc2fe599681c620c0076", "committedDate": "2021-09-20 15:32:02 -0700", "message": "typo"}, {"oid": "d983c641fde4177c48ea20477f388bc9d44c3ead", "committedDate": "2021-09-20 16:18:52 -0700", "message": "minor udate"}, {"oid": "35b8e4fee2ce31d66900b18a71b55488790cf45c", "committedDate": "2021-09-20 16:45:35 -0700", "message": "fix unittest"}, {"oid": "cc79774afa769f29d7e5177d7afde3ab99b36280", "committedDate": "2021-09-27 17:07:15 -0700", "message": "Merge branch 'master' into amgusain/merge_master_2.2.1"}, {"oid": "b7a7c30f19e5fdb5fa3a6aa6fb18b40e9dbca143", "committedDate": "2021-09-28 13:14:00 -0700", "message": "fix spotbugs warning"}, {"oid": "d5f91f5ea10c599e5109cffd0bdfc03d801bdae5", "committedDate": "2022-03-30 17:41:47 +0300", "message": "Update changelog"}, {"oid": "66cfe69ec6d063b47b769f02a227b6fafc73ca9b", "committedDate": "2023-02-14 16:18:39 -0600", "message": "Add preferred browser support (#1761)"}]}, {"oid": "dfe076dc1dde4c9359ac0d0b8cece829f6a6a5e2", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/dfe076dc1dde4c9359ac0d0b8cece829f6a6a5e2", "message": "Change away from needless regular expression.", "committedDate": "2020-08-18T17:32:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM3MDkyNw==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1130#discussion_r472370927", "body": "```suggestion\r\n            Logger.warn(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"\r\n                + \"  For brokered auth, the redirect URI is expected to conform to 'msauth://<authority>/.*' where the authority in \"\r\n                + \"that uri is the package name of the app. This package name is listed as 'applicationId' in the build.gradle file.\");\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        Logger.warn(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"\n          \n          \n            \n                            + \"  For brokered auth, the redirect URI is expected to conform to 'msauth://<authority>/.*' where the authority in \"\n          \n          \n            \n                            + \"that uri is the package name.\");\n          \n          \n            \n                        Logger.warn(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"\n          \n          \n            \n                            + \"  For brokered auth, the redirect URI is expected to conform to 'msauth://<authority>/.*' where the authority in \"\n          \n          \n            \n                            + \"that uri is the package name of the app. This package name is listed as 'applicationId' in the build.gradle file.\");", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-smi\">Logger</span><span class=\"pl-k\">.</span>warn(<span class=\"pl-c1\">TAG</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.<span class=\"pl-pds\">\"</span></span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>  For brokered auth, the redirect URI is expected to conform to 'msauth://&lt;authority&gt;/.*' where the authority in <span class=\"pl-pds\">\"</span></span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>that uri is the package name.<span class=\"pl-pds\">\"</span></span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-smi\">Logger</span><span class=\"pl-k\">.</span>warn(<span class=\"pl-c1\">TAG</span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.<span class=\"pl-pds\">\"</span></span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>  For brokered auth, the redirect URI is expected to conform to 'msauth://&lt;authority&gt;/.*' where the authority in <span class=\"pl-pds\">\"</span></span></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>that uri is the package name<span class=\"x x-first x-last\"> of the app. This package name is listed as 'applicationId' in the build.gradle file</span>.<span class=\"pl-pds\">\"</span></span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "shahzaibj", "createdAt": "2020-08-18T17:41:05Z", "path": "msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java", "diffHunk": "@@ -551,10 +555,12 @@ public void checkIntentFilterAddedToAppManifestForBrokerFlow() throws MsalClient\n             return;\n         }\n \n-        if (!isBrokerRedirectUri()) {\n+        if (!isBrokerRedirectUri(mRedirectUri, mAppContext.getPackageName())) {\n             // This means that the app is still using the legacy local-only MSAL Redirect uri (already removed from the new portal).\n             // If this is the case, we can assume that the user doesn't need Broker support.\n-            Logger.info(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\");\n+            Logger.warn(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"\n+                + \"  For brokered auth, the redirect URI is expected to conform to 'msauth://<authority>/.*' where the authority in \"\n+                + \"that uri is the package name.\");", "originalCommit": "dfe076dc1dde4c9359ac0d0b8cece829f6a6a5e2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3219f413599785373b79e45f90719ba2bc70f924", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 82b95fee..4dac1596 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -560,7 +560,7 @@ public class PublicClientApplicationConfiguration {\n             // If this is the case, we can assume that the user doesn't need Broker support.\n             Logger.warn(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"\n                 + \"  For brokered auth, the redirect URI is expected to conform to 'msauth://<authority>/.*' where the authority in \"\n-                + \"that uri is the package name.\");\n+                + \"that uri is the package name of the app. This package name is listed as 'applicationId' in the build.gradle file.\");\n             mUseBroker = false;\n             return;\n         }\n", "next_change": null}]}, "revised_code_in_main": {"commit": "79daa98f62357b2f74d686b0b035d846af5fd528", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 82b95fee..5bdf97a5 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -560,7 +560,7 @@ public class PublicClientApplicationConfiguration {\n             // If this is the case, we can assume that the user doesn't need Broker support.\n             Logger.warn(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"\n                 + \"  For brokered auth, the redirect URI is expected to conform to 'msauth://<authority>/.*' where the authority in \"\n-                + \"that uri is the package name.\");\n+                + \"that uri is the package name of the app. This package name is listed as 'applicationId' in the build.gradle file.\");\n             mUseBroker = false;\n             return;\n         }\n", "next_change": {"commit": "6a7b17c016e0d85b1084980957a3619ff4496ca4", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 5bdf97a5..aeb0ef48 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -559,8 +556,8 @@ public class PublicClientApplicationConfiguration {\n             // This means that the app is still using the legacy local-only MSAL Redirect uri (already removed from the new portal).\n             // If this is the case, we can assume that the user doesn't need Broker support.\n             Logger.warn(TAG, \"The app is still using legacy MSAL redirect uri. Switch to MSAL local auth.\"\n-                + \"  For brokered auth, the redirect URI is expected to conform to 'msauth://<authority>/.*' where the authority in \"\n-                + \"that uri is the package name of the app. This package name is listed as 'applicationId' in the build.gradle file.\");\n+                    + \"  For brokered auth, the redirect URI is expected to conform to 'msauth://<authority>/.*' where the authority in \"\n+                    + \"that uri is the package name of the app. This package name is listed as 'applicationId' in the build.gradle file.\");\n             mUseBroker = false;\n             return;\n         }\n", "next_change": {"commit": "bee9497b7465668d7495ab61c0b59e8174911128", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex aeb0ef48..93ae7865 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -565,4 +623,32 @@ public class PublicClientApplicationConfiguration {\n         verifyRedirectUriWithAppSignature();\n     }\n \n+    private boolean verifyAuthenticatorRedirectUri() {\n+        try {\n+            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_PACKAGE_NAME, PackageManager.GET_SIGNATURES);\n+            if (info != null && info.signatures != null && info.signatures.length > 0) {\n+                Signature signature = info.signatures[0];\n+                MessageDigest md = MessageDigest.getInstance(\"SHA\");\n+                md.update(signature.toByteArray());\n+                final String signatureHash = Base64.encodeToString(md.digest(), Base64.NO_WRAP);\n+                if (signatureHash.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_RELEASE_SIGNATURE)\n+                    || signatureHash.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_DEBUG_SIGNATURE)\n+                ) {\n+                    final Uri.Builder builder = new Uri.Builder();\n+                    final Uri uri = builder.scheme(\"msauth\")\n+                            .authority(mAppContext.getPackageName())\n+                            .appendPath(signatureHash)\n+                            .build();\n+\n+                    if (mRedirectUri.equalsIgnoreCase(uri.toString()) || mRedirectUri.equalsIgnoreCase(AuthenticationConstants.Broker.BROKER_REDIRECT_URI)) {\n+                        return true;\n+                    }\n+                }\n+            }\n+        }\n+        catch (PackageManager.NameNotFoundException | NoSuchAlgorithmException e) {\n+            Logger.error(TAG, \"Unexpected error in getting package info/signature for Autheticator\", e);\n+        }\n+        return false;\n+    }\n }\n", "next_change": {"commit": "9d04d671677450ae91868391ef84379024b6c3e9", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 93ae7865..35c01a30 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -645,10 +648,10 @@ public class PublicClientApplicationConfiguration {\n                     }\n                 }\n             }\n-        }\n-        catch (PackageManager.NameNotFoundException | NoSuchAlgorithmException e) {\n+        } catch (final PackageManager.NameNotFoundException | NoSuchAlgorithmException e) {\n             Logger.error(TAG, \"Unexpected error in getting package info/signature for Autheticator\", e);\n         }\n+\n         return false;\n     }\n }\n", "next_change": {"commit": "370aa2788864ce1c7321bc2fe599681c620c0076", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 35c01a30..a70f90ce 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -649,7 +648,7 @@ public class PublicClientApplicationConfiguration {\n                 }\n             }\n         } catch (final PackageManager.NameNotFoundException | NoSuchAlgorithmException e) {\n-            Logger.error(TAG, \"Unexpected error in getting package info/signature for Autheticator\", e);\n+            Logger.error(TAG, \"Unexpected error in getting package info/signature for Authenticator\", e);\n         }\n \n         return false;\n", "next_change": {"commit": "d5f91f5ea10c599e5109cffd0bdfc03d801bdae5", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex a70f90ce..384d86ad 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -648,7 +744,7 @@ public class PublicClientApplicationConfiguration {\n                 }\n             }\n         } catch (final PackageManager.NameNotFoundException | NoSuchAlgorithmException e) {\n-            Logger.error(TAG, \"Unexpected error in getting package info/signature for Authenticator\", e);\n+            Logger.error(methodTag, \"Unexpected error in getting package info/signature for Authenticator\", e);\n         }\n \n         return false;\n", "next_change": null}]}}]}}]}}]}}]}}]}, "commits_in_main": [{"oid": "79daa98f62357b2f74d686b0b035d846af5fd528", "message": "Merge commit", "committedDate": null}, {"oid": "e7038498484c5d3024154ca0b9ede64ae978e53f", "committedDate": "2020-09-04 11:06:25 -0700", "message": "Expose RT to broker apps (#1126)"}, {"oid": "1d14607474e0bb10de154615c3420cc1c43317b3", "committedDate": "2021-01-05 11:26:12 -0800", "message": "Beef up redirect uri messaging"}, {"oid": "6a7b17c016e0d85b1084980957a3619ff4496ca4", "committedDate": "2021-03-05 17:46:10 -0800", "message": "Ensure \"\" does not pass validation"}, {"oid": "12670de7842436407c15b9db3c96f92442cf67a0", "committedDate": "2021-03-08 17:56:49 -0800", "message": "Add tests"}, {"oid": "4cda58b9387e7ccae293ea3274452ec487f3df42", "committedDate": "2021-03-08 18:18:12 -0800", "message": "Smaller changes"}, {"oid": "8c218f0d4271e63965543b2fbeaff115d5f41e92", "committedDate": "2021-03-08 18:49:37 -0800", "message": "Tweaks"}, {"oid": "9f00f092d31d375c5deae4b22fbb80c27ca939dc", "committedDate": "2021-03-08 18:50:39 -0800", "message": "Remove string literal check"}, {"oid": "03def88467d19cc0585295d960c340175096acd1", "committedDate": "2021-03-08 19:13:23 -0800", "message": "Rename method for clarity"}, {"oid": "28c8d378525cdc5ac1ad3acef45eacae2079a502", "committedDate": "2021-04-02 18:46:42 -0700", "message": "Update Logger imports in MSAL"}, {"oid": "e9bb9d3e1bdf43ebaf06a62392c2280a8c8b6d40", "committedDate": "2021-04-05 10:25:36 -0700", "message": "changes to support null task affinity"}, {"oid": "7335d8754c99fc1bbf966e7b5c99c7af4b366ede", "committedDate": "2021-04-05 10:25:58 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "e1aa12641dc7f4714accbe0126c76cc933f5d331", "committedDate": "2021-04-05 10:25:58 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "1592b1a070a0a40f8cdbe9389184ccfc374be676", "committedDate": "2021-04-13 16:48:22 -0700", "message": "Log and throw exception if there are other apps listening for the url scheme"}, {"oid": "fbb021776a0e37f8ef92117792aa7ad7bbaf523a", "committedDate": "2021-04-15 14:02:10 -0700", "message": "merge"}, {"oid": "58e1d501bf6c8d4b5ccaf634824b192ee2edb019", "committedDate": "2021-04-16 13:20:06 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "9464c8bd97f33e910f4698a34278705fbb1e70ec", "committedDate": "2021-04-16 13:24:34 -0700", "message": "Merge branch 'dev' into shahzaibj/logUrlSchemeListener"}, {"oid": "b12bbb7236477d88a139384c5bc12ef787841ace", "committedDate": "2021-04-19 12:49:16 -0700", "message": "fix instrumented tests and merge configuration bugs"}, {"oid": "72ed05116f398f0d763544410d88d419b0040aa3", "committedDate": "2021-04-27 16:33:20 -0700", "message": "Merge branch 'dev' into shahzaibj/logUrlSchemeListener"}, {"oid": "91fe570fc177b9cc298d2d85147cebff4f98344d", "committedDate": "2021-04-28 11:57:09 -0700", "message": "Address comments"}, {"oid": "14d1c7be6f2e756427b9d41569586a107aa97993", "committedDate": "2021-04-28 12:05:54 -0700", "message": "Add method name to log tag"}, {"oid": "8235fb5ce92a7a74f904bd1d33cc3009167c98ff", "committedDate": "2021-04-28 12:12:57 -0700", "message": "Address comment"}, {"oid": "36700831510bbbe5339b7b97602a4d43d1320c83", "committedDate": "2021-04-28 12:16:18 -0700", "message": "Address comment"}, {"oid": "5456fed7e8aeddc699aa4c61e1cee1c2650b6a85", "committedDate": "2021-05-14 09:22:58 -0700", "message": "Merge branch 'dev' into adjoh/redirect-uri-beefup"}, {"oid": "77df1b7c64dc913577b319a5a80fefff16be09bc", "committedDate": "2021-05-31 16:38:12 -0700", "message": "MSAL updates to support loading launching custom tabs in current task"}, {"oid": "ff0da9db29cf605519cac602cd48109c4486720a", "committedDate": "2021-06-04 12:11:06 -0700", "message": "Code review feedback; updates for updates in common; fix unit test"}, {"oid": "aff959b85e80e6cb7b1342d2a6384b83edcbb1d8", "committedDate": "2021-07-19 10:51:50 -0700", "message": "Merge branch 'master' into adjoh/propagate-merge-of-common"}, {"oid": "405dd8ba72e915c73a77f3393bd9cb7d1f9cb2e0", "committedDate": "2021-07-29 12:18:57 -0700", "message": "Migrate Account Manager Account"}, {"oid": "832a46a6df354b5579a4dab06fad17c7c3325ec9", "committedDate": "2021-08-02 17:59:19 -0700", "message": "Migrate Strategies, Parameters, and some other stuffs"}, {"oid": "5624eccb86ecdd7df653f762e275bd529b7f2dc4", "committedDate": "2021-08-12 19:53:50 -0700", "message": "Make changes to accommodate CommandDispatcher&co migration"}, {"oid": "0b7166e35c9b5147a81ef5aa4ad1beef1326fedc", "committedDate": "2021-09-17 14:15:27 -0700", "message": "Allow authenticator to pass older format for redirect uri"}, {"oid": "35ebf633d3894a7ca99828a2e24c5ce4b65283e8", "committedDate": "2021-09-17 15:17:20 -0700", "message": "move the authenticator check up"}, {"oid": "bee9497b7465668d7495ab61c0b59e8174911128", "committedDate": "2021-09-17 16:15:08 -0700", "message": "fix in another place"}, {"oid": "fce9cbcc902a6f27a8adf8b398fac33a00860709", "committedDate": "2021-09-20 13:22:13 -0700", "message": "fix the condition"}, {"oid": "9d04d671677450ae91868391ef84379024b6c3e9", "committedDate": "2021-09-20 15:29:28 -0700", "message": "address comments"}, {"oid": "b49c4c5cb75ba0254a445739c67efb4414eb2bdf", "committedDate": "2021-09-20 15:31:12 -0700", "message": "minor format"}, {"oid": "370aa2788864ce1c7321bc2fe599681c620c0076", "committedDate": "2021-09-20 15:32:02 -0700", "message": "typo"}, {"oid": "d983c641fde4177c48ea20477f388bc9d44c3ead", "committedDate": "2021-09-20 16:18:52 -0700", "message": "minor udate"}, {"oid": "35b8e4fee2ce31d66900b18a71b55488790cf45c", "committedDate": "2021-09-20 16:45:35 -0700", "message": "fix unittest"}, {"oid": "cc79774afa769f29d7e5177d7afde3ab99b36280", "committedDate": "2021-09-27 17:07:15 -0700", "message": "Merge branch 'master' into amgusain/merge_master_2.2.1"}, {"oid": "b7a7c30f19e5fdb5fa3a6aa6fb18b40e9dbca143", "committedDate": "2021-09-28 13:14:00 -0700", "message": "fix spotbugs warning"}, {"oid": "d5f91f5ea10c599e5109cffd0bdfc03d801bdae5", "committedDate": "2022-03-30 17:41:47 +0300", "message": "Update changelog"}, {"oid": "66cfe69ec6d063b47b769f02a227b6fafc73ca9b", "committedDate": "2023-02-14 16:18:39 -0600", "message": "Add preferred browser support (#1761)"}]}, {"oid": "3219f413599785373b79e45f90719ba2bc70f924", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/3219f413599785373b79e45f90719ba2bc70f924", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n\nCo-authored-by: Shahzaib <37125644+shahzaibj@users.noreply.github.com>", "committedDate": "2020-08-18T17:41:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM3MjAwNg==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1130#discussion_r472372006", "body": "Does the package name have to be nullable?", "bodyText": "Does the package name have to be nullable?", "bodyHTML": "<p dir=\"auto\">Does the package name have to be nullable?</p>", "author": "shahzaibj", "createdAt": "2020-08-18T17:42:55Z", "path": "msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java", "diffHunk": "@@ -479,11 +484,10 @@ private void nullConfigurationCheck(String configKey, String configValue) {\n         }\n     }\n \n-    private boolean isBrokerRedirectUri() {\n-        final String BROKER_REDIRECT_URI_REGEX = \"msauth://\" + mAppContext.getPackageName() + \"/.*\";\n-        final Pattern pairRegex = Pattern.compile(BROKER_REDIRECT_URI_REGEX);\n-        final Matcher matcher = pairRegex.matcher(mRedirectUri);\n-        return matcher.matches();\n+    @VisibleForTesting\n+    public static boolean isBrokerRedirectUri(final @NonNull String redirectUri, final @Nullable String packageName) {", "originalCommit": "3219f413599785373b79e45f90719ba2bc70f924", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM3MjkyNw==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1130#discussion_r472372927", "bodyText": "There's no requirement for the restriction to NonNull.", "author": "AdamBJohnsonx", "createdAt": "2020-08-18T17:44:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM3MjAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM3NDIwOQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1130#discussion_r472374209", "bodyText": "So what should be return from this method if package name is null? I don't see a null check here", "author": "shahzaibj", "createdAt": "2020-08-18T17:46:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM3MjAwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM3NDI5OQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/pull/1130#discussion_r472374299", "bodyText": "It doesn't matter, so I'm making it @nonnull", "author": "AdamBJohnsonx", "createdAt": "2020-08-18T17:46:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjM3MjAwNg=="}], "type": "inlineReview", "revised_code": {"commit": "b2bc14daefb33709abda77ce041243f97d44e079", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 4dac1596..5bdf97a5 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -485,7 +485,7 @@ public class PublicClientApplicationConfiguration {\n     }\n \n     @VisibleForTesting\n-    public static boolean isBrokerRedirectUri(final @NonNull String redirectUri, final @Nullable String packageName) {\n+    public static boolean isBrokerRedirectUri(final @NonNull String redirectUri, final @NonNull String packageName) {\n         final String potentialPrefix = BROKER_REDIRECT_URI_SCHEME_AND_SEPARATOR + packageName + \"/\";\n         return redirectUri != null && redirectUri.startsWith(potentialPrefix);\n     }\n", "next_change": null}]}, "revised_code_in_main": {"commit": "79daa98f62357b2f74d686b0b035d846af5fd528", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 4dac1596..5bdf97a5 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -485,7 +485,7 @@ public class PublicClientApplicationConfiguration {\n     }\n \n     @VisibleForTesting\n-    public static boolean isBrokerRedirectUri(final @NonNull String redirectUri, final @Nullable String packageName) {\n+    public static boolean isBrokerRedirectUri(final @NonNull String redirectUri, final @NonNull String packageName) {\n         final String potentialPrefix = BROKER_REDIRECT_URI_SCHEME_AND_SEPARATOR + packageName + \"/\";\n         return redirectUri != null && redirectUri.startsWith(potentialPrefix);\n     }\n", "next_change": {"commit": "fbb021776a0e37f8ef92117792aa7ad7bbaf523a", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 5bdf97a5..5cc6ddfa 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -494,8 +535,9 @@ public class PublicClientApplicationConfiguration {\n     private void verifyRedirectUriWithAppSignature() throws MsalClientException {\n         final String packageName = mAppContext.getPackageName();\n         try {\n-            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(packageName, PackageManager.GET_SIGNATURES);\n-            for (final Signature signature : info.signatures) {\n+            final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n+            Signature [] signatures = PackageHelper.getSignatures(info);\n+            for (final Signature signature : signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n", "next_change": {"commit": "58e1d501bf6c8d4b5ccaf634824b192ee2edb019", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 5cc6ddfa..c13ed9d0 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -535,9 +514,8 @@ public class PublicClientApplicationConfiguration {\n     private void verifyRedirectUriWithAppSignature() throws MsalClientException {\n         final String packageName = mAppContext.getPackageName();\n         try {\n-            final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n-            Signature [] signatures = PackageHelper.getSignatures(info);\n-            for (final Signature signature : signatures) {\n+            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(packageName, PackageManager.GET_SIGNATURES);\n+            for (final Signature signature : info.signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n", "next_change": {"commit": "9464c8bd97f33e910f4698a34278705fbb1e70ec", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex c13ed9d0..fd51bbc8 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -514,8 +535,9 @@ public class PublicClientApplicationConfiguration {\n     private void verifyRedirectUriWithAppSignature() throws MsalClientException {\n         final String packageName = mAppContext.getPackageName();\n         try {\n-            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(packageName, PackageManager.GET_SIGNATURES);\n-            for (final Signature signature : info.signatures) {\n+            final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n+            Signature [] signatures = PackageHelper.getSignatures(info);\n+            for (final Signature signature : signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n", "next_change": {"commit": "91fe570fc177b9cc298d2d85147cebff4f98344d", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex fd51bbc8..6d7fc7e4 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -536,7 +540,7 @@ public class PublicClientApplicationConfiguration {\n         final String packageName = mAppContext.getPackageName();\n         try {\n             final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n-            Signature [] signatures = PackageHelper.getSignatures(info);\n+            Signature[] signatures = PackageHelper.getSignatures(info);\n             for (final Signature signature : signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n", "next_change": {"commit": "77df1b7c64dc913577b319a5a80fefff16be09bc", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 6d7fc7e4..14d14581 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -539,9 +525,8 @@ public class PublicClientApplicationConfiguration {\n     private void verifyRedirectUriWithAppSignature() throws MsalClientException {\n         final String packageName = mAppContext.getPackageName();\n         try {\n-            final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n-            Signature[] signatures = PackageHelper.getSignatures(info);\n-            for (final Signature signature : signatures) {\n+            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(packageName, PackageManager.GET_SIGNATURES);\n+            for (final Signature signature : info.signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n", "next_change": {"commit": "aff959b85e80e6cb7b1342d2a6384b83edcbb1d8", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 14d14581..2a66ead4 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -525,8 +553,9 @@ public class PublicClientApplicationConfiguration {\n     private void verifyRedirectUriWithAppSignature() throws MsalClientException {\n         final String packageName = mAppContext.getPackageName();\n         try {\n-            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(packageName, PackageManager.GET_SIGNATURES);\n-            for (final Signature signature : info.signatures) {\n+            final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n+            Signature[] signatures = PackageHelper.getSignatures(info);\n+            for (final Signature signature : signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n", "next_change": {"commit": "0b7166e35c9b5147a81ef5aa4ad1beef1326fedc", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 2a66ead4..ca4d4e0b 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -553,13 +531,20 @@ public class PublicClientApplicationConfiguration {\n     private void verifyRedirectUriWithAppSignature() throws MsalClientException {\n         final String packageName = mAppContext.getPackageName();\n         try {\n-            final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n-            Signature[] signatures = PackageHelper.getSignatures(info);\n-            for (final Signature signature : signatures) {\n+            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(packageName, PackageManager.GET_SIGNATURES);\n+            for (final Signature signature : info.signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n \n+                if (packageName.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_PACKAGE_NAME)\n+                    && (signatureHash.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_RELEASE_SIGNATURE)\n+                        || signatureHash.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_DEBUG_SIGNATURE))\n+                    && mRedirectUri.equalsIgnoreCase(AuthenticationConstants.Broker.BROKER_REDIRECT_URI))\n+                {\n+                    return;\n+                }\n+\n                 final Uri.Builder builder = new Uri.Builder();\n                 final Uri uri = builder.scheme(\"msauth\")\n                         .authority(packageName)\n", "next_change": {"commit": "35ebf633d3894a7ca99828a2e24c5ce4b65283e8", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex ca4d4e0b..951ec2f1 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -536,15 +536,6 @@ public class PublicClientApplicationConfiguration {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n-\n-                if (packageName.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_PACKAGE_NAME)\n-                    && (signatureHash.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_RELEASE_SIGNATURE)\n-                        || signatureHash.equalsIgnoreCase(AuthenticationConstants.Broker.AZURE_AUTHENTICATOR_APP_DEBUG_SIGNATURE))\n-                    && mRedirectUri.equalsIgnoreCase(AuthenticationConstants.Broker.BROKER_REDIRECT_URI))\n-                {\n-                    return;\n-                }\n-\n                 final Uri.Builder builder = new Uri.Builder();\n                 final Uri uri = builder.scheme(\"msauth\")\n                         .authority(packageName)\n", "next_change": {"commit": "cc79774afa769f29d7e5177d7afde3ab99b36280", "changed_code": [{"header": "diff --git a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\nindex 951ec2f1..8fbbc0fc 100644\n--- a/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n+++ b/msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java\n", "chunk": "@@ -531,8 +559,9 @@ public class PublicClientApplicationConfiguration {\n     private void verifyRedirectUriWithAppSignature() throws MsalClientException {\n         final String packageName = mAppContext.getPackageName();\n         try {\n-            final PackageInfo info = mAppContext.getPackageManager().getPackageInfo(packageName, PackageManager.GET_SIGNATURES);\n-            for (final Signature signature : info.signatures) {\n+            final PackageInfo info = PackageHelper.getPackageInfo(mAppContext.getPackageManager(), packageName);\n+            Signature[] signatures = PackageHelper.getSignatures(info);\n+            for (final Signature signature : signatures) {\n                 final MessageDigest messageDigest = MessageDigest.getInstance(\"SHA\");\n                 messageDigest.update(signature.toByteArray());\n                 final String signatureHash = Base64.encodeToString(messageDigest.digest(), Base64.NO_WRAP);\n", "next_change": null}]}}]}}]}}]}}]}}]}}]}}]}}]}}]}, "commits_in_main": [{"oid": "79daa98f62357b2f74d686b0b035d846af5fd528", "message": "Merge commit", "committedDate": null}, {"oid": "e7038498484c5d3024154ca0b9ede64ae978e53f", "committedDate": "2020-09-04 11:06:25 -0700", "message": "Expose RT to broker apps (#1126)"}, {"oid": "1d14607474e0bb10de154615c3420cc1c43317b3", "committedDate": "2021-01-05 11:26:12 -0800", "message": "Beef up redirect uri messaging"}, {"oid": "6a7b17c016e0d85b1084980957a3619ff4496ca4", "committedDate": "2021-03-05 17:46:10 -0800", "message": "Ensure \"\" does not pass validation"}, {"oid": "12670de7842436407c15b9db3c96f92442cf67a0", "committedDate": "2021-03-08 17:56:49 -0800", "message": "Add tests"}, {"oid": "4cda58b9387e7ccae293ea3274452ec487f3df42", "committedDate": "2021-03-08 18:18:12 -0800", "message": "Smaller changes"}, {"oid": "8c218f0d4271e63965543b2fbeaff115d5f41e92", "committedDate": "2021-03-08 18:49:37 -0800", "message": "Tweaks"}, {"oid": "9f00f092d31d375c5deae4b22fbb80c27ca939dc", "committedDate": "2021-03-08 18:50:39 -0800", "message": "Remove string literal check"}, {"oid": "03def88467d19cc0585295d960c340175096acd1", "committedDate": "2021-03-08 19:13:23 -0800", "message": "Rename method for clarity"}, {"oid": "28c8d378525cdc5ac1ad3acef45eacae2079a502", "committedDate": "2021-04-02 18:46:42 -0700", "message": "Update Logger imports in MSAL"}, {"oid": "e9bb9d3e1bdf43ebaf06a62392c2280a8c8b6d40", "committedDate": "2021-04-05 10:25:36 -0700", "message": "changes to support null task affinity"}, {"oid": "7335d8754c99fc1bbf966e7b5c99c7af4b366ede", "committedDate": "2021-04-05 10:25:58 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "e1aa12641dc7f4714accbe0126c76cc933f5d331", "committedDate": "2021-04-05 10:25:58 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "1592b1a070a0a40f8cdbe9389184ccfc374be676", "committedDate": "2021-04-13 16:48:22 -0700", "message": "Log and throw exception if there are other apps listening for the url scheme"}, {"oid": "fbb021776a0e37f8ef92117792aa7ad7bbaf523a", "committedDate": "2021-04-15 14:02:10 -0700", "message": "merge"}, {"oid": "58e1d501bf6c8d4b5ccaf634824b192ee2edb019", "committedDate": "2021-04-16 13:20:06 -0700", "message": "Update msal/src/main/java/com/microsoft/identity/client/PublicClientApplicationConfiguration.java"}, {"oid": "9464c8bd97f33e910f4698a34278705fbb1e70ec", "committedDate": "2021-04-16 13:24:34 -0700", "message": "Merge branch 'dev' into shahzaibj/logUrlSchemeListener"}, {"oid": "b12bbb7236477d88a139384c5bc12ef787841ace", "committedDate": "2021-04-19 12:49:16 -0700", "message": "fix instrumented tests and merge configuration bugs"}, {"oid": "72ed05116f398f0d763544410d88d419b0040aa3", "committedDate": "2021-04-27 16:33:20 -0700", "message": "Merge branch 'dev' into shahzaibj/logUrlSchemeListener"}, {"oid": "91fe570fc177b9cc298d2d85147cebff4f98344d", "committedDate": "2021-04-28 11:57:09 -0700", "message": "Address comments"}, {"oid": "14d1c7be6f2e756427b9d41569586a107aa97993", "committedDate": "2021-04-28 12:05:54 -0700", "message": "Add method name to log tag"}, {"oid": "8235fb5ce92a7a74f904bd1d33cc3009167c98ff", "committedDate": "2021-04-28 12:12:57 -0700", "message": "Address comment"}, {"oid": "36700831510bbbe5339b7b97602a4d43d1320c83", "committedDate": "2021-04-28 12:16:18 -0700", "message": "Address comment"}, {"oid": "5456fed7e8aeddc699aa4c61e1cee1c2650b6a85", "committedDate": "2021-05-14 09:22:58 -0700", "message": "Merge branch 'dev' into adjoh/redirect-uri-beefup"}, {"oid": "77df1b7c64dc913577b319a5a80fefff16be09bc", "committedDate": "2021-05-31 16:38:12 -0700", "message": "MSAL updates to support loading launching custom tabs in current task"}, {"oid": "ff0da9db29cf605519cac602cd48109c4486720a", "committedDate": "2021-06-04 12:11:06 -0700", "message": "Code review feedback; updates for updates in common; fix unit test"}, {"oid": "aff959b85e80e6cb7b1342d2a6384b83edcbb1d8", "committedDate": "2021-07-19 10:51:50 -0700", "message": "Merge branch 'master' into adjoh/propagate-merge-of-common"}, {"oid": "405dd8ba72e915c73a77f3393bd9cb7d1f9cb2e0", "committedDate": "2021-07-29 12:18:57 -0700", "message": "Migrate Account Manager Account"}, {"oid": "832a46a6df354b5579a4dab06fad17c7c3325ec9", "committedDate": "2021-08-02 17:59:19 -0700", "message": "Migrate Strategies, Parameters, and some other stuffs"}, {"oid": "5624eccb86ecdd7df653f762e275bd529b7f2dc4", "committedDate": "2021-08-12 19:53:50 -0700", "message": "Make changes to accommodate CommandDispatcher&co migration"}, {"oid": "0b7166e35c9b5147a81ef5aa4ad1beef1326fedc", "committedDate": "2021-09-17 14:15:27 -0700", "message": "Allow authenticator to pass older format for redirect uri"}, {"oid": "35ebf633d3894a7ca99828a2e24c5ce4b65283e8", "committedDate": "2021-09-17 15:17:20 -0700", "message": "move the authenticator check up"}, {"oid": "bee9497b7465668d7495ab61c0b59e8174911128", "committedDate": "2021-09-17 16:15:08 -0700", "message": "fix in another place"}, {"oid": "fce9cbcc902a6f27a8adf8b398fac33a00860709", "committedDate": "2021-09-20 13:22:13 -0700", "message": "fix the condition"}, {"oid": "9d04d671677450ae91868391ef84379024b6c3e9", "committedDate": "2021-09-20 15:29:28 -0700", "message": "address comments"}, {"oid": "b49c4c5cb75ba0254a445739c67efb4414eb2bdf", "committedDate": "2021-09-20 15:31:12 -0700", "message": "minor format"}, {"oid": "370aa2788864ce1c7321bc2fe599681c620c0076", "committedDate": "2021-09-20 15:32:02 -0700", "message": "typo"}, {"oid": "d983c641fde4177c48ea20477f388bc9d44c3ead", "committedDate": "2021-09-20 16:18:52 -0700", "message": "minor udate"}, {"oid": "35b8e4fee2ce31d66900b18a71b55488790cf45c", "committedDate": "2021-09-20 16:45:35 -0700", "message": "fix unittest"}, {"oid": "cc79774afa769f29d7e5177d7afde3ab99b36280", "committedDate": "2021-09-27 17:07:15 -0700", "message": "Merge branch 'master' into amgusain/merge_master_2.2.1"}, {"oid": "b7a7c30f19e5fdb5fa3a6aa6fb18b40e9dbca143", "committedDate": "2021-09-28 13:14:00 -0700", "message": "fix spotbugs warning"}, {"oid": "d5f91f5ea10c599e5109cffd0bdfc03d801bdae5", "committedDate": "2022-03-30 17:41:47 +0300", "message": "Update changelog"}, {"oid": "66cfe69ec6d063b47b769f02a227b6fafc73ca9b", "committedDate": "2023-02-14 16:18:39 -0600", "message": "Add preferred browser support (#1761)"}]}, {"oid": "b2bc14daefb33709abda77ce041243f97d44e079", "url": "https://github.com/AzureAD/microsoft-authentication-library-for-android/commit/b2bc14daefb33709abda77ce041243f97d44e079", "message": "Change nullability annotation.", "committedDate": "2020-08-18T17:46:14Z", "type": "commit"}]}