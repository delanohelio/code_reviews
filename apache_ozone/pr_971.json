{"pr_number": 971, "pr_title": "HDDS-2566. Handle InterruptedException in ContainerDataScanner", "pr_author": "dineshchitlangia", "pr_createdAt": "2020-05-27T03:36:40Z", "pr_url": "https://github.com/apache/ozone/pull/971", "timeline": [{"oid": "954d569c8a0df2da21abfffa5e70665b3305e1c3", "url": "https://github.com/apache/ozone/commit/954d569c8a0df2da21abfffa5e70665b3305e1c3", "message": "HDDS-2566. Handle InterruptedException in ContainerDataScanner", "committedDate": "2020-05-27T03:34:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM1OTE3MQ==", "url": "https://github.com/apache/ozone/pull/971#discussion_r431359171", "body": "Can we use String format here?\r\n```suggestion\r\n  private static final String NAME_FORMAT = \"ContainerDataScanner(%s)\";\r\n```", "bodyText": "Can we use String format here?\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private static final String NAME = \"ContainerDataScanner(\";\n          \n          \n            \n              private static final String NAME_FORMAT = \"ContainerDataScanner(%s)\";", "bodyHTML": "<p dir=\"auto\">Can we use String format here?</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">  <span class=\"pl-k\">private</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">final</span> <span class=\"pl-smi\">String</span> <span class=\"pl-c1 x x-first x-last\">NAME</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>ContainerDataScanner(<span class=\"pl-pds\">\"</span></span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">  <span class=\"pl-k\">private</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">final</span> <span class=\"pl-smi\">String</span> <span class=\"pl-c1 x x-first x-last\">NAME_FORMAT</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>ContainerDataScanner(<span class=\"x x-first x-last\">%s)</span><span class=\"pl-pds\">\"</span></span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "vivekratnavel", "createdAt": "2020-05-27T18:35:02Z", "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java", "diffHunk": "@@ -49,6 +49,7 @@\n   private final Canceler canceler;\n   private final ContainerDataScrubberMetrics metrics;\n   private final long dataScanInterval;\n+  private static final String NAME = \"ContainerDataScanner(\";", "originalCommit": "954d569c8a0df2da21abfffa5e70665b3305e1c3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM1OTgyNw==", "url": "https://github.com/apache/ozone/pull/971#discussion_r431359827", "body": "```suggestion\r\n    setName(String.format(NAME_FORMAT, volume));\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                setName(NAME + volume + \")\");\n          \n          \n            \n                setName(String.format(NAME_FORMAT, volume));", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    setName(<span class=\"pl-c1 x x-first\">NAME</span><span class=\"x\"> </span><span class=\"pl-k x\">+</span><span class=\"x x-last\"> </span>volume<span class=\"x x-first\"> </span><span class=\"pl-k x\">+</span><span class=\"x\"> </span><span class=\"pl-s\"><span class=\"pl-pds x\">\"</span><span class=\"x\">)</span><span class=\"pl-pds x x-last\">\"</span></span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    setName(<span class=\"pl-smi x x-first\">String</span><span class=\"pl-k x\">.</span><span class=\"x\">format(</span><span class=\"pl-c1 x\">NAME_FORMAT</span><span class=\"x x-last\">, </span>volume<span class=\"x x-first x-last\">)</span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "vivekratnavel", "createdAt": "2020-05-27T18:36:11Z", "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java", "diffHunk": "@@ -66,7 +67,7 @@ public ContainerDataScanner(ContainerScrubberConfiguration conf,\n     throttler = new HddsDataTransferThrottler(conf.getBandwidthPerVolume());\n     canceler = new Canceler();\n     metrics = ContainerDataScrubberMetrics.create(volume.toString());\n-    setName(\"ContainerDataScanner(\" + volume + \")\");\n+    setName(NAME + volume + \")\");", "originalCommit": "954d569c8a0df2da21abfffa5e70665b3305e1c3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM2MDQ5NA==", "url": "https://github.com/apache/ozone/pull/971#discussion_r431360494", "body": "```suggestion\r\n    this.canceler.cancel(String.format(NAME_FORMAT, volume) + \" is shutting down\");\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                this.canceler.cancel(NAME + volume + \") is shutting down\");\n          \n          \n            \n                this.canceler.cancel(String.format(NAME_FORMAT, volume) + \" is shutting down\");", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-c1\">this</span><span class=\"pl-k\">.</span>canceler<span class=\"pl-k\">.</span>cancel(<span class=\"pl-c1 x x-first\">NAME</span><span class=\"x\"> </span><span class=\"pl-k x\">+</span><span class=\"x x-last\"> </span>volume <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"x x-first x-last\">)</span> is shutting down<span class=\"pl-pds\">\"</span></span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-c1\">this</span><span class=\"pl-k\">.</span>canceler<span class=\"pl-k\">.</span>cancel(<span class=\"pl-smi x x-first\">String</span><span class=\"pl-k x\">.</span><span class=\"x\">format(</span><span class=\"pl-c1 x\">NAME_FORMAT</span><span class=\"x x-last\">, </span>volume<span class=\"x x-first x-last\">)</span> <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span> is shutting down<span class=\"pl-pds\">\"</span></span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "vivekratnavel", "createdAt": "2020-05-27T18:37:22Z", "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java", "diffHunk": "@@ -162,13 +165,14 @@ private static void logScanCompleted(\n \n   public synchronized void shutdown() {\n     this.stopping = true;\n-    this.canceler.cancel(\"ContainerDataScanner(\"+volume+\") is shutting down\");\n+    this.canceler.cancel(NAME + volume + \") is shutting down\");", "originalCommit": "954d569c8a0df2da21abfffa5e70665b3305e1c3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM2MDkxOQ==", "url": "https://github.com/apache/ozone/pull/971#discussion_r431360919", "body": "```suggestion\r\n    return String.format(NAME_FORMAT, volume + \", \" + volume.getStorageID());\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                return NAME + volume + \", \" + volume.getStorageID() + \")\";\n          \n          \n            \n                return String.format(NAME_FORMAT, volume + \", \" + volume.getStorageID());", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">return</span> <span class=\"pl-c1 x x-first\">NAME</span><span class=\"x\"> </span><span class=\"pl-k x\">+</span><span class=\"x x-last\"> </span>volume <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>, <span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">+</span> volume<span class=\"pl-k\">.</span>getStorageID()<span class=\"x x-first\"> </span><span class=\"pl-k x\">+</span><span class=\"x\"> </span><span class=\"pl-s\"><span class=\"pl-pds x\">\"</span><span class=\"x\">)</span><span class=\"pl-pds x x-last\">\"</span></span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">return</span> <span class=\"pl-smi x x-first\">String</span><span class=\"pl-k x\">.</span><span class=\"x\">format(</span><span class=\"pl-c1 x\">NAME_FORMAT</span><span class=\"x x-last\">, </span>volume <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>, <span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">+</span> volume<span class=\"pl-k\">.</span>getStorageID()<span class=\"x x-first x-last\">)</span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "vivekratnavel", "createdAt": "2020-05-27T18:38:12Z", "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java", "diffHunk": "@@ -179,8 +183,7 @@ public ContainerDataScrubberMetrics getMetrics() {\n \n   @Override\n   public String toString() {\n-    return \"ContainerDataScanner(\" + volume +\n-        \", \" + volume.getStorageID() + \")\";\n+    return NAME + volume + \", \" + volume.getStorageID() + \")\";", "originalCommit": "954d569c8a0df2da21abfffa5e70665b3305e1c3", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "d5a0cac20784c3071f2ba311a9e668bb92ec455c", "url": "https://github.com/apache/ozone/commit/d5a0cac20784c3071f2ba311a9e668bb92ec455c", "message": "Update hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n\nCo-authored-by: Vivek Ratnavel Subramanian <vivekratnavel90@gmail.com>", "committedDate": "2020-05-27T18:40:15Z", "type": "commit"}, {"oid": "b7990798d024a16d5bcb69bd4849c30d872dba0c", "url": "https://github.com/apache/ozone/commit/b7990798d024a16d5bcb69bd4849c30d872dba0c", "message": "Update hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n\nCo-authored-by: Vivek Ratnavel Subramanian <vivekratnavel90@gmail.com>", "committedDate": "2020-05-27T18:40:24Z", "type": "commit"}, {"oid": "6679237038e68fd6b4dfc1c87dfe9814af6eaa18", "url": "https://github.com/apache/ozone/commit/6679237038e68fd6b4dfc1c87dfe9814af6eaa18", "message": "Update hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n\nCo-authored-by: Vivek Ratnavel Subramanian <vivekratnavel90@gmail.com>", "committedDate": "2020-05-27T18:40:33Z", "type": "commit"}, {"oid": "64c602aa8689235aa9557a6e35601c98cb75cc7a", "url": "https://github.com/apache/ozone/commit/64c602aa8689235aa9557a6e35601c98cb75cc7a", "message": "Update hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n\nCo-authored-by: Vivek Ratnavel Subramanian <vivekratnavel90@gmail.com>", "committedDate": "2020-05-27T18:40:39Z", "type": "commit"}, {"oid": "a106cca745d0eb4d05f844789494141fc50b2a22", "url": "https://github.com/apache/ozone/commit/a106cca745d0eb4d05f844789494141fc50b2a22", "message": "fixed checkstyle", "committedDate": "2020-05-27T19:26:29Z", "type": "commit"}]}