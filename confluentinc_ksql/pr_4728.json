{"pr_number": 4728, "pr_title": "feat: add REGEXP_EXTRACT UDF", "pr_author": "stevenpyzhang", "pr_createdAt": "2020-03-06T21:00:43Z", "pr_url": "https://github.com/confluentinc/ksql/pull/4728", "timeline": [{"oid": "2afc198910e536cd7e986bdd8ea4b8680b3a0f1c", "url": "https://github.com/confluentinc/ksql/commit/2afc198910e536cd7e986bdd8ea4b8680b3a0f1c", "message": "feat: add REGEXP_EXTRACT UDF", "committedDate": "2020-03-06T22:37:59Z", "type": "forcePushed"}, {"oid": "698178d4e3cd001e3ecc97ba735d43234cc534ae", "url": "https://github.com/confluentinc/ksql/commit/698178d4e3cd001e3ecc97ba735d43234cc534ae", "message": "feat: add REGEXP_EXTRACT UDF", "committedDate": "2020-03-09T23:13:56Z", "type": "forcePushed"}, {"oid": "6c10e30beffd9d05ee4062a2513025a56a4e2364", "url": "https://github.com/confluentinc/ksql/commit/6c10e30beffd9d05ee4062a2513025a56a4e2364", "message": "feat: add REGEXP_EXTRACT UDF", "committedDate": "2020-03-11T20:52:16Z", "type": "forcePushed"}, {"oid": "06b6b22f0d30f2ce3865667e8a07df2164096a2f", "url": "https://github.com/confluentinc/ksql/commit/06b6b22f0d30f2ce3865667e8a07df2164096a2f", "message": "feat: add REGEXP_EXTRACT UDF", "committedDate": "2020-03-11T20:57:01Z", "type": "forcePushed"}, {"oid": "2b330a1ccbd971b5291c8c0a219d0d7599aa37fc", "url": "https://github.com/confluentinc/ksql/commit/2b330a1ccbd971b5291c8c0a219d0d7599aa37fc", "message": "feat: add REGEXP_EXTRACT UDF", "committedDate": "2020-03-11T21:53:05Z", "type": "forcePushed"}, {"oid": "fd1a29695263160302b2a499213afc45434a40b8", "url": "https://github.com/confluentinc/ksql/commit/fd1a29695263160302b2a499213afc45434a40b8", "message": "feat: add REGEXP_EXTRACT UDF", "committedDate": "2020-03-11T22:12:09Z", "type": "forcePushed"}, {"oid": "7f5d3f75de1ecbf814764daa2a6762e6d7def6e8", "url": "https://github.com/confluentinc/ksql/commit/7f5d3f75de1ecbf814764daa2a6762e6d7def6e8", "message": "feat: add REGEXP_EXTRACT udf", "committedDate": "2020-03-12T18:35:55Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc5NDQ2OQ==", "url": "https://github.com/confluentinc/ksql/pull/4728#discussion_r391794469", "body": "```suggestion\r\n      @UdfParameter(description = \"The regex pattern\") final String pattern,\r\n```\r\nsuper nit \ud83d\ude02 to keep it consistent", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                  @UdfParameter(description = \"The regex pattern.\") final String pattern,\n          \n          \n            \n                  @UdfParameter(description = \"The regex pattern\") final String pattern,\n          \n      \n    \n    \n  \n\nsuper nit \ud83d\ude02 to keep it consistent", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">      <span class=\"pl-k\">@UdfParameter</span>(<span class=\"pl-c1\">description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>The regex pattern<span class=\"x x-first x-last\">.</span><span class=\"pl-pds\">\"</span></span>) <span class=\"pl-k\">final</span> <span class=\"pl-smi\">String</span> pattern,</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">      <span class=\"pl-k\">@UdfParameter</span>(<span class=\"pl-c1\">description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>The regex pattern<span class=\"pl-pds\">\"</span></span>) <span class=\"pl-k\">final</span> <span class=\"pl-smi\">String</span> pattern,</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n\n<p dir=\"auto\">super nit <g-emoji class=\"g-emoji\" alias=\"joy\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/1f602.png\">\ud83d\ude02</g-emoji> to keep it consistent</p>", "author": "agavra", "createdAt": "2020-03-12T17:54:38Z", "path": "ksql-engine/src/main/java/io/confluent/ksql/function/udf/string/RegexpExtract.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Copyright 2020 Confluent Inc.\n+ *\n+ * Licensed under the Confluent Community License (the \"License\"); you may not use\n+ * this file except in compliance with the License.  You may obtain a copy of the\n+ * License at\n+ *\n+ * http://www.confluent.io/confluent-community-license\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OF ANY KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package io.confluent.ksql.function.udf.string;\n+\n+import io.confluent.ksql.function.udf.Udf;\n+import io.confluent.ksql.function.udf.UdfDescription;\n+import io.confluent.ksql.function.udf.UdfParameter;\n+import io.confluent.ksql.util.KsqlConstants;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+@UdfDescription(\n+    name = \"regexp_extract\",\n+    author = KsqlConstants.CONFLUENT_AUTHOR,\n+    description = \"extract the first subtring matched by a regex pattern\")\n+public class RegexpExtract {\n+  @Udf(description = \"Returns first substring of the input that matches the given regex pattern\")\n+  public String regexpExtract(\n+      @UdfParameter(description = \"The regex pattern.\") final String pattern,", "originalCommit": "fd1a29695263160302b2a499213afc45434a40b8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc5NTk1NQ==", "url": "https://github.com/confluentinc/ksql/pull/4728#discussion_r391795955", "body": "should we return `null` or `\"\"` - I think to be consistent with other UDFs `null` might be a better option here, and that also differentiates a result that couldn't find it with an empty result", "bodyText": "should we return null or \"\" - I think to be consistent with other UDFs null might be a better option here, and that also differentiates a result that couldn't find it with an empty result", "bodyHTML": "<p dir=\"auto\">should we return <code>null</code> or <code>\"\"</code> - I think to be consistent with other UDFs <code>null</code> might be a better option here, and that also differentiates a result that couldn't find it with an empty result</p>", "author": "agavra", "createdAt": "2020-03-12T17:57:11Z", "path": "ksql-engine/src/main/java/io/confluent/ksql/function/udf/string/RegexpExtract.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Copyright 2020 Confluent Inc.\n+ *\n+ * Licensed under the Confluent Community License (the \"License\"); you may not use\n+ * this file except in compliance with the License.  You may obtain a copy of the\n+ * License at\n+ *\n+ * http://www.confluent.io/confluent-community-license\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OF ANY KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package io.confluent.ksql.function.udf.string;\n+\n+import io.confluent.ksql.function.udf.Udf;\n+import io.confluent.ksql.function.udf.UdfDescription;\n+import io.confluent.ksql.function.udf.UdfParameter;\n+import io.confluent.ksql.util.KsqlConstants;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+@UdfDescription(\n+    name = \"regexp_extract\",\n+    author = KsqlConstants.CONFLUENT_AUTHOR,\n+    description = \"extract the first subtring matched by a regex pattern\")\n+public class RegexpExtract {\n+  @Udf(description = \"Returns first substring of the input that matches the given regex pattern\")\n+  public String regexpExtract(\n+      @UdfParameter(description = \"The regex pattern.\") final String pattern,\n+      @UdfParameter(description = \"The input string to apply regex on\") final String input\n+  ) {\n+    if (pattern == null || input == null) {\n+      return null;\n+    }\n+    final Pattern p = Pattern.compile(pattern);\n+    final Matcher m = p.matcher(input);\n+    return m.find() ? m.group(0) : \"\";", "originalCommit": "fd1a29695263160302b2a499213afc45434a40b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTg5MDQ4NQ==", "url": "https://github.com/confluentinc/ksql/pull/4728#discussion_r391890485", "bodyText": "sounds good", "author": "stevenpyzhang", "createdAt": "2020-03-12T20:59:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc5NTk1NQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc5NjI5Ng==", "url": "https://github.com/confluentinc/ksql/pull/4728#discussion_r391796296", "body": "nit: the above method should call this method with `0` as the group", "bodyText": "nit: the above method should call this method with 0 as the group", "bodyHTML": "<p dir=\"auto\">nit: the above method should call this method with <code>0</code> as the group</p>", "author": "agavra", "createdAt": "2020-03-12T17:57:47Z", "path": "ksql-engine/src/main/java/io/confluent/ksql/function/udf/string/RegexpExtract.java", "diffHunk": "@@ -0,0 +1,63 @@\n+/*\n+ * Copyright 2020 Confluent Inc.\n+ *\n+ * Licensed under the Confluent Community License (the \"License\"); you may not use\n+ * this file except in compliance with the License.  You may obtain a copy of the\n+ * License at\n+ *\n+ * http://www.confluent.io/confluent-community-license\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n+ * WARRANTIES OF ANY KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ */\n+\n+package io.confluent.ksql.function.udf.string;\n+\n+import io.confluent.ksql.function.udf.Udf;\n+import io.confluent.ksql.function.udf.UdfDescription;\n+import io.confluent.ksql.function.udf.UdfParameter;\n+import io.confluent.ksql.util.KsqlConstants;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+@UdfDescription(\n+    name = \"regexp_extract\",\n+    author = KsqlConstants.CONFLUENT_AUTHOR,\n+    description = \"extract the first subtring matched by a regex pattern\")\n+public class RegexpExtract {\n+  @Udf(description = \"Returns first substring of the input that matches the given regex pattern\")\n+  public String regexpExtract(\n+      @UdfParameter(description = \"The regex pattern.\") final String pattern,\n+      @UdfParameter(description = \"The input string to apply regex on\") final String input\n+  ) {\n+    if (pattern == null || input == null) {\n+      return null;\n+    }\n+    final Pattern p = Pattern.compile(pattern);\n+    final Matcher m = p.matcher(input);\n+    return m.find() ? m.group(0) : \"\";\n+  }\n+\n+  @Udf(description = \"Returns the first substring of the \"\n+      + \"input that matches the regex pattern and the capturing group number specified\")\n+  public String regexpExtract(", "originalCommit": "fd1a29695263160302b2a499213afc45434a40b8", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "1d62dddedacc36992279b33aa4d30b7672324523", "url": "https://github.com/confluentinc/ksql/commit/1d62dddedacc36992279b33aa4d30b7672324523", "message": "feat: add REGEXP_EXTRACT udf", "committedDate": "2020-03-12T21:02:01Z", "type": "forcePushed"}, {"oid": "0d227af2c88c3a70971fe5ac748959fc35dc5bf5", "url": "https://github.com/confluentinc/ksql/commit/0d227af2c88c3a70971fe5ac748959fc35dc5bf5", "message": "feat: add REGEXP_EXTRACT udf", "committedDate": "2020-03-13T21:31:40Z", "type": "forcePushed"}, {"oid": "e2455d2f59db06de2ac8d39f3d67a3aa62056935", "url": "https://github.com/confluentinc/ksql/commit/e2455d2f59db06de2ac8d39f3d67a3aa62056935", "message": "feat: add REGEXP_EXTRACT udf", "committedDate": "2020-03-13T22:28:48Z", "type": "forcePushed"}, {"oid": "c5cac52dbb4dd400cce00b635548a367b605a2d7", "url": "https://github.com/confluentinc/ksql/commit/c5cac52dbb4dd400cce00b635548a367b605a2d7", "message": "feat add REGEXP_EXTRACT UDF", "committedDate": "2020-03-13T22:37:04Z", "type": "commit"}, {"oid": "b909c326e9b0846dd357b3eb8450b69ad90ebe04", "url": "https://github.com/confluentinc/ksql/commit/b909c326e9b0846dd357b3eb8450b69ad90ebe04", "message": "plans", "committedDate": "2020-03-13T22:51:00Z", "type": "forcePushed"}, {"oid": "1133a47e7f611583877cf673cf39ebadb1836816", "url": "https://github.com/confluentinc/ksql/commit/1133a47e7f611583877cf673cf39ebadb1836816", "message": "plans", "committedDate": "2020-03-13T22:52:04Z", "type": "commit"}, {"oid": "1133a47e7f611583877cf673cf39ebadb1836816", "url": "https://github.com/confluentinc/ksql/commit/1133a47e7f611583877cf673cf39ebadb1836816", "message": "plans", "committedDate": "2020-03-13T22:52:04Z", "type": "forcePushed"}]}