{"pr_number": 19191, "pr_title": "#19189 : A list with an empty String representing an empty value in t\u2026", "pr_author": "jcastro-dotcms", "pr_createdAt": "2020-08-28T18:05:12Z", "pr_url": "https://github.com/dotCMS/core/pull/19191", "merge_commit": "e383862f69fde011161c816cb73474b22b325287", "timeline": [{"oid": "444dfb7f70f681a0b4dc7d2840d6d433920d02a5", "url": "https://github.com/dotCMS/core/commit/444dfb7f70f681a0b4dc7d2840d6d433920d02a5", "message": "#19189 : A list with an empty String representing an empty value in the Tag field is being sent from the Edit Mode in Angular. This is causing problems in our current Java code, as passing down an empty String to the `CategoryAPI.find` method returns a null value, which causes a Null Pointer Exception during the checkin process.", "committedDate": "2020-08-28T18:04:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ1OTg0OA==", "url": "https://github.com/dotCMS/core/pull/19191#discussion_r479459848", "body": "Should the condition be:\r\n\r\n```\r\nif (UtilMethods.isSet(categoriesList) && categoriesList.size() > 0){\r\n```", "bodyText": "Should the condition be:\nif (UtilMethods.isSet(categoriesList) && categoriesList.size() > 0){", "bodyHTML": "<p dir=\"auto\">Should the condition be:</p>\n<div class=\"snippet-clipboard-content position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"if (UtilMethods.isSet(categoriesList) &amp;&amp; categoriesList.size() &gt; 0){\"><pre><code>if (UtilMethods.isSet(categoriesList) &amp;&amp; categoriesList.size() &gt; 0){\n</code></pre></div>", "author": "wezell", "createdAt": "2020-08-28T18:07:47Z", "path": "dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java", "diffHunk": "@@ -423,11 +423,12 @@ private void saveWebAsset(Map<String, Object> contentletFormData,\n \t\t\t}\r\n \t\t }\r\n \r\n-\t\tif (categoriesList != null && categoriesList.size() > 0) {\r\n-\t\t\tfor (final Iterator iterator = categoriesList.iterator(); iterator.hasNext();) {\r\n-\r\n-\t\t\t\tfinal String tmpString = (String) iterator.next();\r\n-\t\t\t\tcategories.add(catAPI.find(tmpString, user, false));\r\n+\t\tif (UtilMethods.isSet(categoriesList)) {\r", "originalCommit": "444dfb7f70f681a0b4dc7d2840d6d433920d02a5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ2MzE2NA==", "url": "https://github.com/dotCMS/core/pull/19191#discussion_r479463164", "bodyText": "@wezell the isSet method already checks for both null and empty list scenarios:\npublic static final boolean isSet(final Collection<?> collection) {\n    return null != collection && !collection.isEmpty();\n}", "author": "jcastro-dotcms", "createdAt": "2020-08-28T18:14:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ1OTg0OA=="}], "type": "inlineReview", "revised_code": null, "revised_code_in_main": {"commit": "f4af01244b1a6b358190e153d958aa278524fe84", "changed_code": [{"header": "diff --git a/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java b/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java\nindex e3d09392ec..15ff081edf 100644\n--- a/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java\n+++ b/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java\n", "chunk": "@@ -423,12 +425,11 @@ public class ContentletWebAPIImpl implements ContentletWebAPI {\n \t\t\t}\n \t\t }\n \n-\t\tif (UtilMethods.isSet(categoriesList)) {\n-\t\t\tfor (final Iterator<String> iterator = categoriesList.iterator(); iterator.hasNext();) {\n-\t\t\t\tfinal String categoryId = iterator.next();\n-\t\t\t\tif (UtilMethods.isSet(categoryId)) {\n-\t\t\t\t\tcategories.add(catAPI.find(categoryId, user, PageMode.get().respectAnonPerms));\n-\t\t\t\t}\n+\t\tif (categoriesList != null && categoriesList.size() > 0) {\n+\t\t\tfor (final Iterator iterator = categoriesList.iterator(); iterator.hasNext();) {\n+\n+\t\t\t\tfinal String tmpString = (String) iterator.next();\n+\t\t\t\tcategories.add(catAPI.find(tmpString, user, false));\n \t\t\t}\n \t\t}\n \n", "next_change": {"commit": "e3b58b3694d7059cf3bdb1075634fb92d22dae67", "changed_code": [{"header": "diff --git a/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java b/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java\nindex 15ff081edf..e7fb6222a3 100644\n--- a/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java\n+++ b/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java\n", "chunk": "@@ -425,11 +425,12 @@ public class ContentletWebAPIImpl implements ContentletWebAPI {\n \t\t\t}\n \t\t }\n \n-\t\tif (categoriesList != null && categoriesList.size() > 0) {\n-\t\t\tfor (final Iterator iterator = categoriesList.iterator(); iterator.hasNext();) {\n-\n-\t\t\t\tfinal String tmpString = (String) iterator.next();\n-\t\t\t\tcategories.add(catAPI.find(tmpString, user, false));\n+\t\tif (UtilMethods.isSet(categoriesList)) {\n+\t\t\tfor (final Iterator<String> iterator = categoriesList.iterator(); iterator.hasNext();) {\n+\t\t\t\tfinal String categoryId = iterator.next();\n+\t\t\t\tif (UtilMethods.isSet(categoryId)) {\n+\t\t\t\t\tcategories.add(catAPI.find(categoryId, user, PageMode.get().respectAnonPerms));\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \n", "next_change": null}]}}]}, "commits_in_main": [{"oid": "e383862f69fde011161c816cb73474b22b325287", "message": "Merge commit", "committedDate": null}, {"oid": "f4af01244b1a6b358190e153d958aa278524fe84", "committedDate": "2020-09-01 14:59:24 -0500", "message": "Issue 18780 container error using templates from different sites (#19122)"}, {"oid": "e3b58b3694d7059cf3bdb1075634fb92d22dae67", "committedDate": "2020-09-16 09:22:11 -0600", "message": "merge release to master"}, {"oid": "41fe830ca455b1bb2809bc26b41f1aa31f0ad0c8", "committedDate": "2020-09-17 09:46:53 -0600", "message": "dotCMS/core#19133 Can't push publish from old dialog (#19277)"}, {"oid": "af9abc8f44e59d32a4e2887b63d7f4a06c679e02", "committedDate": "2020-09-18 12:41:25 -0600", "message": "Merge branch 'master' into release-5.3.8"}, {"oid": "a3cda524b8220ca5801bfd8b402ed274b6cb8145", "committedDate": "2020-10-14 17:55:06 -0500", "message": "Issue 18550 migrate cvi away from hibernate (#19294)"}, {"oid": "b90cafa9d58eb915088abe2a461974e081842df4", "committedDate": "2020-10-29 12:30:50 -0600", "message": "#19509 use proper db columm in query (#19510)"}, {"oid": "992e2ef76d17276c0982b040085017631bb27aea", "committedDate": "2020-11-04 08:34:27 -0600", "message": "Merge branch 'master' into release-20.10.1"}, {"oid": "6b30542c30851af883995f6048ebbe74b6197e93", "committedDate": "2021-03-01 10:28:17 -0500", "message": "#19597 Consider license when using routes to edit a piece of content (#20019)"}, {"oid": "6dcd44f676c260bb464fbd4aad989758da151345", "committedDate": "2021-03-03 09:09:28 -0600", "message": "#19831 : There are two main changes in this PR, beyond the usual Java\u2026 (#19833)"}, {"oid": "1ed0ccf46ad65193746fd73f25e5d47611f30851", "committedDate": "2021-04-12 15:14:11 -0600", "message": "dotCMS/core#20071 System Template"}, {"oid": "ef9522389fcabf4b4eb540db1f903e76af324e5c", "committedDate": "2021-05-18 11:20:02 -0600", "message": "dotCMS/core#20354 RelationshipFactory is being used by other API - db connection leak"}, {"oid": "2725e53f1c75a1136d1d62b8377924b93d02af5c", "committedDate": "2021-06-28 18:22:28 -0500", "message": "Issues 19398 19399 Implement a ContentletDBTransformer and get rid of Hibernate (#20036)"}, {"oid": "9f95d3ae35c3fddbce85d448b1f71a02493f874c", "committedDate": "2021-07-19 11:48:33 -0600", "message": "dotCMS/core#20504 Create a \"Bulk Move\" Action for Content"}, {"oid": "99c17c27870101a1f2fcf8fa0575251d281b10e2", "committedDate": "2022-02-02 14:30:35 -0600", "message": "Merge 22.02 into master (#21650)"}, {"oid": "09826d3592090cd85e19dc68c38389c5bc4601f4", "committedDate": "2022-09-13 16:16:01 -0500", "message": "Issue 22882 get save contentlet version info using variant (#22933)"}, {"oid": "639ef463f44d9774412895edb9272b8dc884768d", "committedDate": "2022-09-16 11:56:14 -0500", "message": "Renaming variant field (#23001)"}, {"oid": "8dd5b7ac2159bf3e50909dca3c47e3f9eac069d6", "committedDate": "2022-10-06 15:31:45 -0500", "message": "Issue 22791 render pagee with variant (#23022)"}]}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ2NTcyMQ==", "url": "https://github.com/dotCMS/core/pull/19191#discussion_r479465721", "body": "I would replace the iterator with a normal `for` over `categoriesList` \r\n```for (final String categoryId : categoriesList)```", "bodyText": "I would replace the iterator with a normal for over categoriesList\nfor (final String categoryId : categoriesList)", "bodyHTML": "<p dir=\"auto\">I would replace the iterator with a normal <code>for</code> over <code>categoriesList</code><br>\n<code>for (final String categoryId : categoriesList)</code></p>", "author": "dsilvam", "createdAt": "2020-08-28T18:20:31Z", "path": "dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java", "diffHunk": "@@ -423,11 +423,12 @@ private void saveWebAsset(Map<String, Object> contentletFormData,\n \t\t\t}\r\n \t\t }\r\n \r\n-\t\tif (categoriesList != null && categoriesList.size() > 0) {\r\n-\t\t\tfor (final Iterator iterator = categoriesList.iterator(); iterator.hasNext();) {\r\n-\r\n-\t\t\t\tfinal String tmpString = (String) iterator.next();\r\n-\t\t\t\tcategories.add(catAPI.find(tmpString, user, false));\r\n+\t\tif (UtilMethods.isSet(categoriesList)) {\r\n+\t\t\tfor (final Iterator<String> iterator = categoriesList.iterator(); iterator.hasNext();) {\r", "originalCommit": "444dfb7f70f681a0b4dc7d2840d6d433920d02a5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ4MTIyMA==", "url": "https://github.com/dotCMS/core/pull/19191#discussion_r479481220", "bodyText": "Yes, I thought about it too. But didn't add many changes as this is very old code that will be moved over to a REST Endpoint, hopefully soon.", "author": "jcastro-dotcms", "createdAt": "2020-08-28T18:55:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ2NTcyMQ=="}], "type": "inlineReview", "revised_code": null, "revised_code_in_main": {"commit": "f4af01244b1a6b358190e153d958aa278524fe84", "changed_code": [{"header": "diff --git a/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java b/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java\nindex e3d09392ec..15ff081edf 100644\n--- a/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java\n+++ b/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java\n", "chunk": "@@ -423,12 +425,11 @@ public class ContentletWebAPIImpl implements ContentletWebAPI {\n \t\t\t}\n \t\t }\n \n-\t\tif (UtilMethods.isSet(categoriesList)) {\n-\t\t\tfor (final Iterator<String> iterator = categoriesList.iterator(); iterator.hasNext();) {\n-\t\t\t\tfinal String categoryId = iterator.next();\n-\t\t\t\tif (UtilMethods.isSet(categoryId)) {\n-\t\t\t\t\tcategories.add(catAPI.find(categoryId, user, PageMode.get().respectAnonPerms));\n-\t\t\t\t}\n+\t\tif (categoriesList != null && categoriesList.size() > 0) {\n+\t\t\tfor (final Iterator iterator = categoriesList.iterator(); iterator.hasNext();) {\n+\n+\t\t\t\tfinal String tmpString = (String) iterator.next();\n+\t\t\t\tcategories.add(catAPI.find(tmpString, user, false));\n \t\t\t}\n \t\t}\n \n", "next_change": {"commit": "e3b58b3694d7059cf3bdb1075634fb92d22dae67", "changed_code": [{"header": "diff --git a/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java b/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java\nindex 15ff081edf..e7fb6222a3 100644\n--- a/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java\n+++ b/dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/business/web/ContentletWebAPIImpl.java\n", "chunk": "@@ -425,11 +425,12 @@ public class ContentletWebAPIImpl implements ContentletWebAPI {\n \t\t\t}\n \t\t }\n \n-\t\tif (categoriesList != null && categoriesList.size() > 0) {\n-\t\t\tfor (final Iterator iterator = categoriesList.iterator(); iterator.hasNext();) {\n-\n-\t\t\t\tfinal String tmpString = (String) iterator.next();\n-\t\t\t\tcategories.add(catAPI.find(tmpString, user, false));\n+\t\tif (UtilMethods.isSet(categoriesList)) {\n+\t\t\tfor (final Iterator<String> iterator = categoriesList.iterator(); iterator.hasNext();) {\n+\t\t\t\tfinal String categoryId = iterator.next();\n+\t\t\t\tif (UtilMethods.isSet(categoryId)) {\n+\t\t\t\t\tcategories.add(catAPI.find(categoryId, user, PageMode.get().respectAnonPerms));\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \n", "next_change": null}]}}]}, "commits_in_main": [{"oid": "e383862f69fde011161c816cb73474b22b325287", "message": "Merge commit", "committedDate": null}, {"oid": "f4af01244b1a6b358190e153d958aa278524fe84", "committedDate": "2020-09-01 14:59:24 -0500", "message": "Issue 18780 container error using templates from different sites (#19122)"}, {"oid": "e3b58b3694d7059cf3bdb1075634fb92d22dae67", "committedDate": "2020-09-16 09:22:11 -0600", "message": "merge release to master"}, {"oid": "41fe830ca455b1bb2809bc26b41f1aa31f0ad0c8", "committedDate": "2020-09-17 09:46:53 -0600", "message": "dotCMS/core#19133 Can't push publish from old dialog (#19277)"}, {"oid": "af9abc8f44e59d32a4e2887b63d7f4a06c679e02", "committedDate": "2020-09-18 12:41:25 -0600", "message": "Merge branch 'master' into release-5.3.8"}, {"oid": "a3cda524b8220ca5801bfd8b402ed274b6cb8145", "committedDate": "2020-10-14 17:55:06 -0500", "message": "Issue 18550 migrate cvi away from hibernate (#19294)"}, {"oid": "b90cafa9d58eb915088abe2a461974e081842df4", "committedDate": "2020-10-29 12:30:50 -0600", "message": "#19509 use proper db columm in query (#19510)"}, {"oid": "992e2ef76d17276c0982b040085017631bb27aea", "committedDate": "2020-11-04 08:34:27 -0600", "message": "Merge branch 'master' into release-20.10.1"}, {"oid": "6b30542c30851af883995f6048ebbe74b6197e93", "committedDate": "2021-03-01 10:28:17 -0500", "message": "#19597 Consider license when using routes to edit a piece of content (#20019)"}, {"oid": "6dcd44f676c260bb464fbd4aad989758da151345", "committedDate": "2021-03-03 09:09:28 -0600", "message": "#19831 : There are two main changes in this PR, beyond the usual Java\u2026 (#19833)"}, {"oid": "1ed0ccf46ad65193746fd73f25e5d47611f30851", "committedDate": "2021-04-12 15:14:11 -0600", "message": "dotCMS/core#20071 System Template"}, {"oid": "ef9522389fcabf4b4eb540db1f903e76af324e5c", "committedDate": "2021-05-18 11:20:02 -0600", "message": "dotCMS/core#20354 RelationshipFactory is being used by other API - db connection leak"}, {"oid": "2725e53f1c75a1136d1d62b8377924b93d02af5c", "committedDate": "2021-06-28 18:22:28 -0500", "message": "Issues 19398 19399 Implement a ContentletDBTransformer and get rid of Hibernate (#20036)"}, {"oid": "9f95d3ae35c3fddbce85d448b1f71a02493f874c", "committedDate": "2021-07-19 11:48:33 -0600", "message": "dotCMS/core#20504 Create a \"Bulk Move\" Action for Content"}, {"oid": "99c17c27870101a1f2fcf8fa0575251d281b10e2", "committedDate": "2022-02-02 14:30:35 -0600", "message": "Merge 22.02 into master (#21650)"}, {"oid": "09826d3592090cd85e19dc68c38389c5bc4601f4", "committedDate": "2022-09-13 16:16:01 -0500", "message": "Issue 22882 get save contentlet version info using variant (#22933)"}, {"oid": "639ef463f44d9774412895edb9272b8dc884768d", "committedDate": "2022-09-16 11:56:14 -0500", "message": "Renaming variant field (#23001)"}, {"oid": "8dd5b7ac2159bf3e50909dca3c47e3f9eac069d6", "committedDate": "2022-10-06 15:31:45 -0500", "message": "Issue 22791 render pagee with variant (#23022)"}]}]}