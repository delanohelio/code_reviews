{"pr_number": 3957, "pr_title": "Fix category links in media detail", "pr_author": "FliegendeWurst", "pr_createdAt": "2020-10-09T10:52:49Z", "pr_url": "https://github.com/commons-app/apps-android-commons/pull/3957", "timeline": [{"oid": "3d0d35585e42e516b7f6f47e7474049231e214b7", "url": "https://github.com/commons-app/apps-android-commons/commit/3d0d35585e42e516b7f6f47e7474049231e214b7", "message": "Fix category links in media detail", "committedDate": "2020-10-17T19:28:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkyNTg0Nw==", "url": "https://github.com/commons-app/apps-android-commons/pull/3957#discussion_r512925847", "body": "The `CategoryClientKt.CATEGORY_PREFIX` static import in this file is not necessary anymore. So, it can be removed.", "bodyText": "The CategoryClientKt.CATEGORY_PREFIX static import in this file is not necessary anymore. So, it can be removed.", "bodyHTML": "<p dir=\"auto\">The <code>CategoryClientKt.CATEGORY_PREFIX</code> static import in this file is not necessary anymore. So, it can be removed.</p>", "author": "sivaraam", "createdAt": "2020-10-27T18:17:44Z", "path": "app/src/main/java/fr/free/nrw/commons/media/MediaDetailFragment.java", "diffHunk": "@@ -837,9 +840,8 @@ private View buildCatLabel(final String catName, ViewGroup categoryContainer) {\n         if(!getString(R.string.detail_panel_cats_none).equals(catName)) {\n             textView.setOnClickListener(view -> {\n                 // Open Category Details page\n-                String selectedCategoryTitle = CATEGORY_PREFIX + catName;", "originalCommit": "3d0d35585e42e516b7f6f47e7474049231e214b7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "71d200ee41591be3e27f2a0c21de91609cc755fa", "changed_code": [{"header": "diff --git a/app/src/main/java/fr/free/nrw/commons/media/MediaDetailFragment.java b/app/src/main/java/fr/free/nrw/commons/media/MediaDetailFragment.java\nindex 5e75cd19e..18cdf2cbc 100644\n--- a/app/src/main/java/fr/free/nrw/commons/media/MediaDetailFragment.java\n+++ b/app/src/main/java/fr/free/nrw/commons/media/MediaDetailFragment.java\n", "chunk": "@@ -840,8 +838,9 @@ public class MediaDetailFragment extends CommonsDaggerSupportFragment implements\n         if(!getString(R.string.detail_panel_cats_none).equals(catName)) {\n             textView.setOnClickListener(view -> {\n                 // Open Category Details page\n+                String selectedCategoryTitle = CATEGORY_PREFIX + catName;\n                 Intent intent = new Intent(getContext(), CategoryDetailsActivity.class);\n-                intent.putExtra(\"categoryName\", catName);\n+                intent.putExtra(\"categoryName\", selectedCategoryTitle);\n                 getContext().startActivity(intent);\n             });\n         }\n", "next_change": {"commit": "174db88ae86686035892e5541561daf447c55f35", "changed_code": [{"header": "diff --git a/app/src/main/java/fr/free/nrw/commons/media/MediaDetailFragment.java b/app/src/main/java/fr/free/nrw/commons/media/MediaDetailFragment.java\nindex 18cdf2cbc..4c4c5cf67 100644\n--- a/app/src/main/java/fr/free/nrw/commons/media/MediaDetailFragment.java\n+++ b/app/src/main/java/fr/free/nrw/commons/media/MediaDetailFragment.java\n", "chunk": "@@ -838,9 +838,8 @@ public class MediaDetailFragment extends CommonsDaggerSupportFragment implements\n         if(!getString(R.string.detail_panel_cats_none).equals(catName)) {\n             textView.setOnClickListener(view -> {\n                 // Open Category Details page\n-                String selectedCategoryTitle = CATEGORY_PREFIX + catName;\n                 Intent intent = new Intent(getContext(), CategoryDetailsActivity.class);\n-                intent.putExtra(\"categoryName\", selectedCategoryTitle);\n+                intent.putExtra(\"categoryName\", catName);\n                 getContext().startActivity(intent);\n             });\n         }\n", "next_change": null}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkyNzc5Mw==", "url": "https://github.com/commons-app/apps-android-commons/pull/3957#discussion_r512927793", "body": "I believe it's better to use the `CATEGORY_PREFIX` variable from `CategoryClient` here rather than hard coding the prefix.", "bodyText": "I believe it's better to use the CATEGORY_PREFIX variable from CategoryClient here rather than hard coding the prefix.", "bodyHTML": "<p dir=\"auto\">I believe it's better to use the <code>CATEGORY_PREFIX</code> variable from <code>CategoryClient</code> here rather than hard coding the prefix.</p>", "author": "sivaraam", "createdAt": "2020-10-27T18:20:41Z", "path": "app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java", "diffHunk": "@@ -181,7 +182,8 @@ public boolean onOptionsItemSelected(MenuItem item) {\n         // Handle item selection\n         switch (item.getItemId()) {\n             case R.id.menu_browser_current_category:\n-                Utils.handleWebUrl(this, Uri.parse(Utils.getPageTitle(categoryName).getCanonicalUri()));\n+                PageTitle title = Utils.getPageTitle(String.format(\"Category:%s\", categoryName));", "originalCommit": "3d0d35585e42e516b7f6f47e7474049231e214b7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTc5NDQzNQ==", "url": "https://github.com/commons-app/apps-android-commons/pull/3957#discussion_r515794435", "bodyText": "You're right, I have done that now.", "author": "FliegendeWurst", "createdAt": "2020-11-02T08:02:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkyNzc5Mw=="}], "type": "inlineReview", "revised_code": {"commit": "71d200ee41591be3e27f2a0c21de91609cc755fa", "changed_code": [{"header": "diff --git a/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java b/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\nindex 3e54914e9..23786d974 100644\n--- a/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\n+++ b/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\n", "chunk": "@@ -182,8 +179,7 @@ public class CategoryDetailsActivity extends NavigationBaseActivity\n         // Handle item selection\n         switch (item.getItemId()) {\n             case R.id.menu_browser_current_category:\n-                PageTitle title = Utils.getPageTitle(String.format(\"Category:%s\", categoryName));\n-                Utils.handleWebUrl(this, Uri.parse(title.getCanonicalUri()));\n+                Utils.handleWebUrl(this, Uri.parse(Utils.getPageTitle(categoryName).getCanonicalUri()));\n                 return true;\n             default:\n                 return super.onOptionsItemSelected(item);\n", "next_change": {"commit": "174db88ae86686035892e5541561daf447c55f35", "changed_code": [{"header": "diff --git a/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java b/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\nindex 23786d974..87704bf35 100644\n--- a/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\n+++ b/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\n", "chunk": "@@ -179,7 +182,8 @@ public class CategoryDetailsActivity extends BaseActivity\n         // Handle item selection\n         switch (item.getItemId()) {\n             case R.id.menu_browser_current_category:\n-                Utils.handleWebUrl(this, Uri.parse(Utils.getPageTitle(categoryName).getCanonicalUri()));\n+                PageTitle title = Utils.getPageTitle(CATEGORY_PREFIX + categoryName);\n+                Utils.handleWebUrl(this, Uri.parse(title.getCanonicalUri()));\n                 return true;\n             default:\n                 return super.onOptionsItemSelected(item);\n", "next_change": {"commit": "a4bdd237181a32d790b6186068ad8135587c0186", "changed_code": [{"header": "diff --git a/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java b/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\nindex 87704bf35..749221547 100644\n--- a/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\n+++ b/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\n", "chunk": "@@ -185,6 +188,9 @@ public class CategoryDetailsActivity extends BaseActivity\n                 PageTitle title = Utils.getPageTitle(CATEGORY_PREFIX + categoryName);\n                 Utils.handleWebUrl(this, Uri.parse(title.getCanonicalUri()));\n                 return true;\n+            case android.R.id.home:\n+                onBackPressed();\n+                return true;\n             default:\n                 return super.onOptionsItemSelected(item);\n         }\n", "next_change": null}]}}]}}]}}, {"oid": "2b3eac99ba9b75def1f8113f6018b277c6ca3f46", "url": "https://github.com/commons-app/apps-android-commons/commit/2b3eac99ba9b75def1f8113f6018b277c6ca3f46", "message": "Fix category links in media detail", "committedDate": "2020-11-02T07:49:26Z", "type": "forcePushed"}, {"oid": "6276621b1576c5327129eecae22324c4df690c0d", "url": "https://github.com/commons-app/apps-android-commons/commit/6276621b1576c5327129eecae22324c4df690c0d", "message": "Fix category links in media detail", "committedDate": "2020-11-02T08:01:43Z", "type": "commit"}, {"oid": "6276621b1576c5327129eecae22324c4df690c0d", "url": "https://github.com/commons-app/apps-android-commons/commit/6276621b1576c5327129eecae22324c4df690c0d", "message": "Fix category links in media detail", "committedDate": "2020-11-02T08:01:43Z", "type": "forcePushed"}]}