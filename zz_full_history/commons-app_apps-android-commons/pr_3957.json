{"pr_number": 3957, "pr_title": "Fix category links in media detail", "pr_author": "FliegendeWurst", "pr_createdAt": "2020-10-09T10:52:49Z", "pr_url": "https://github.com/commons-app/apps-android-commons/pull/3957", "merge_commit": "174db88ae86686035892e5541561daf447c55f35", "timeline": [{"oid": "3d0d35585e42e516b7f6f47e7474049231e214b7", "url": "https://github.com/commons-app/apps-android-commons/commit/3d0d35585e42e516b7f6f47e7474049231e214b7", "message": "Fix category links in media detail", "committedDate": "2020-10-17T19:28:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkyNTg0Nw==", "url": "https://github.com/commons-app/apps-android-commons/pull/3957#discussion_r512925847", "body": "The `CategoryClientKt.CATEGORY_PREFIX` static import in this file is not necessary anymore. So, it can be removed.", "bodyText": "The CategoryClientKt.CATEGORY_PREFIX static import in this file is not necessary anymore. So, it can be removed.", "bodyHTML": "<p dir=\"auto\">The <code>CategoryClientKt.CATEGORY_PREFIX</code> static import in this file is not necessary anymore. So, it can be removed.</p>", "author": "sivaraam", "createdAt": "2020-10-27T18:17:44Z", "path": "app/src/main/java/fr/free/nrw/commons/media/MediaDetailFragment.java", "diffHunk": "@@ -837,9 +840,8 @@ private View buildCatLabel(final String catName, ViewGroup categoryContainer) {\n         if(!getString(R.string.detail_panel_cats_none).equals(catName)) {\n             textView.setOnClickListener(view -> {\n                 // Open Category Details page\n-                String selectedCategoryTitle = CATEGORY_PREFIX + catName;", "originalCommit": "3d0d35585e42e516b7f6f47e7474049231e214b7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null, "revised_code_in_main": null, "commits_in_main": [{"oid": "174db88ae86686035892e5541561daf447c55f35", "message": "Merge commit", "committedDate": null}, {"oid": "b8cdc5a5378ab7e4d2514abd8870dd36718917dc", "committedDate": "2021-02-19 10:48:39 +0900", "message": "Fixes #4229 - App Crashes while trying to nominate an item for deletion, When User is not logged in (#4237)"}, {"oid": "0ec62170fc4b3e08586aeb5bf13d55a8287783b6", "committedDate": "2021-02-23 18:53:03 +0900", "message": "Removed category editing accessibility when user not logged in (#4251)"}, {"oid": "93cd89a34be58736fc609dbd4240699270dc76bd", "committedDate": "2021-03-01 20:50:09 +1000", "message": "Fixes #4255 - Media details activity shows depictions in random languages, rather than in the user's locale (#4275)"}, {"oid": "9cf59f78010691b49ec582a4c5defdd534d325d7", "committedDate": "2021-03-01 23:37:44 +0900", "message": "fixes #4266 'Image Dimensions should be reduced if too large\" (#4279)"}, {"oid": "f8a8f9207028a6fb5a35483c040821f22daf755e", "committedDate": "2021-04-19 17:19:27 +0300", "message": "Fixes #4329 \"Back button in edit categories triggers back of media details.\" (#4346)"}, {"oid": "0c8b92c7aadc0e2d684f1f61cfe1aad3706faffc", "committedDate": "2021-05-10 19:07:28 +0300", "message": "Show media details fragment when on clicking image of  Peer Review (#4374)"}, {"oid": "ca18763e4f4898e9725a0d79de0690e32fe58b85", "committedDate": "2021-06-04 11:15:39 +0900", "message": "Fixes #2815 - Nominating for deletion is cancelled on leaving the media details (#4295)"}, {"oid": "20f74a90c423552776c3d038a4d317606ec0512e", "committedDate": "2021-06-13 12:36:47 +0900", "message": "Added a feature for editing coordinates (#4418)"}, {"oid": "22f61195b2f88431b940e9f72658c3df184fcc14", "committedDate": "2021-06-17 21:49:09 +0900", "message": "fix edit categories ui (#4414)"}, {"oid": "b202f553f0dde95bdd263ef121290ac220d284e6", "committedDate": "2021-06-18 22:30:14 +0900", "message": "Ability to show captions and descriptions in all entered languages (#4355)"}, {"oid": "e9a2c32527fd9c50397a6fab392da83145076f4f", "committedDate": "2021-06-29 18:02:20 +0900", "message": "Added option to show and modify location while uploading (#4475)"}, {"oid": "a584c8f2393aaec8aeb81f94337c107f1fe24ead", "committedDate": "2021-08-02 19:25:07 +1000", "message": "Add nullcheck (#4530)"}, {"oid": "7476b0a24d1dd14683ee2d775ad7d5a2b8968683", "committedDate": "2021-09-16 23:09:29 +1000", "message": "Merge changes from 3.1-release (#4629)"}, {"oid": "07d170a79c9496fea0326e2284b5fe56ea2b01a8", "committedDate": "2021-09-20 17:00:27 +1000", "message": "Add MediaDetailFragment Unit Tests (#4632)"}, {"oid": "a687046c025f17868f508b0dd98ecef37685a73e", "committedDate": "2021-10-07 12:54:39 +0300", "message": "fixed issue #4500 coordinate edit button should be hidden if login skipped (#4662)"}, {"oid": "88b21a678ef3a45786acf1063863504d4e38a8b5", "committedDate": "2021-10-25 23:40:08 +0300", "message": "Fixes #3389 - Show  User profiles (#4678)"}, {"oid": "0269894c64078a42337efa1c487a3f7e0b2c2b96", "committedDate": "2021-12-06 22:50:54 +0300", "message": "Fix 4615: Option for editing caption and description (#4672)"}, {"oid": "38ed364423749d902cf271bacc0f1edfe447662a", "committedDate": "2021-12-28 20:15:09 +0900", "message": "Added bookmark Wikidata items option (#4515)"}, {"oid": "c2bc5b4f23671650587b2ca886085ea0e6dbb904", "committedDate": "2022-02-16 00:44:46 +0530", "message": "Show Last Known Location in LocationPickerActivity (#4816)"}, {"oid": "755b216507786f32999f9141536f78d3f1379298", "committedDate": "2022-02-16 23:13:23 +0900", "message": "Show user current location (#4825)"}, {"oid": "d81587b85a624022e090cbbd080e6579b04b6354", "committedDate": "2022-02-22 11:45:35 +0900", "message": "Deletion Language is in english (#4841)"}, {"oid": "bd9531b969d843edf00cfe72c97b7f3a12071e26", "committedDate": "2022-03-22 14:33:43 +0900", "message": "Fixed 4616 : Option for editing depictions (#4725)"}, {"oid": "11292ab514aca061bced0ff5a92401e068febaec", "committedDate": "2022-04-11 19:30:21 +0900", "message": "Fixes 4620 : Editing categories of an existing picture: Reuse categories selection UI from the Upload Wizard (#4928)"}, {"oid": "7655562272bee387cdd6a25dffdc455fae43f074", "committedDate": "2022-04-11 21:14:26 +0900", "message": "Fixes 4922 : Crash when trying to edit description (in Media details) (#4929)"}, {"oid": "bf82fcc8d3e6025de2eef587d46a75684926bcbd", "committedDate": "2022-04-28 17:34:02 +1000", "message": "change description extraction algorithm (#4938)"}, {"oid": "d647c0674e296685a2e15dbdca9e3c539e83d33c", "committedDate": "2022-05-13 17:50:35 +0900", "message": "disable dialog display (#4954)"}, {"oid": "c5b527f4500b687f66f90c9e75707d59f5c92f3b", "committedDate": "2022-05-29 12:01:03 +0900", "message": "fix #4971 (#4974)"}, {"oid": "191186a474108813cfd72b546b57e63454696488", "committedDate": "2023-01-30 22:41:41 +0900", "message": "Fix #5104: popup shown when tapping an already uploaded image in Medi\u2026 (#5127)"}, {"oid": "23ee2b60d8ca26945dff6c6dbe2100db4d1551a0", "committedDate": "2023-02-25 15:34:57 +0900", "message": "Fix #5151: Use DialogUtil for MediaDetailFragment (#5153)"}]}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkyNzc5Mw==", "url": "https://github.com/commons-app/apps-android-commons/pull/3957#discussion_r512927793", "body": "I believe it's better to use the `CATEGORY_PREFIX` variable from `CategoryClient` here rather than hard coding the prefix.", "bodyText": "I believe it's better to use the CATEGORY_PREFIX variable from CategoryClient here rather than hard coding the prefix.", "bodyHTML": "<p dir=\"auto\">I believe it's better to use the <code>CATEGORY_PREFIX</code> variable from <code>CategoryClient</code> here rather than hard coding the prefix.</p>", "author": "sivaraam", "createdAt": "2020-10-27T18:20:41Z", "path": "app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java", "diffHunk": "@@ -181,7 +182,8 @@ public boolean onOptionsItemSelected(MenuItem item) {\n         // Handle item selection\n         switch (item.getItemId()) {\n             case R.id.menu_browser_current_category:\n-                Utils.handleWebUrl(this, Uri.parse(Utils.getPageTitle(categoryName).getCanonicalUri()));\n+                PageTitle title = Utils.getPageTitle(String.format(\"Category:%s\", categoryName));", "originalCommit": "3d0d35585e42e516b7f6f47e7474049231e214b7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTc5NDQzNQ==", "url": "https://github.com/commons-app/apps-android-commons/pull/3957#discussion_r515794435", "bodyText": "You're right, I have done that now.", "author": "FliegendeWurst", "createdAt": "2020-11-02T08:02:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjkyNzc5Mw=="}], "type": "inlineReview", "revised_code": {"commit": "2b3eac99ba9b75def1f8113f6018b277c6ca3f46", "changed_code": [{"header": "diff --git a/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java b/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\nindex 3e54914e9..5e180c50f 100644\n--- a/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\n+++ b/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\n", "chunk": "@@ -182,7 +184,7 @@ public class CategoryDetailsActivity extends NavigationBaseActivity\n         // Handle item selection\n         switch (item.getItemId()) {\n             case R.id.menu_browser_current_category:\n-                PageTitle title = Utils.getPageTitle(String.format(\"Category:%s\", categoryName));\n+                PageTitle title = Utils.getPageTitle(CATEGORY_PREFIX + categoryName);\n                 Utils.handleWebUrl(this, Uri.parse(title.getCanonicalUri()));\n                 return true;\n             default:\n", "next_change": null}]}, "revised_code_in_main": {"commit": "174db88ae86686035892e5541561daf447c55f35", "changed_code": [{"header": "diff --git a/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java b/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\nindex 3e54914e9..87704bf35 100644\n--- a/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\n+++ b/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\n", "chunk": "@@ -182,7 +182,7 @@ public class CategoryDetailsActivity extends NavigationBaseActivity\n         // Handle item selection\n         switch (item.getItemId()) {\n             case R.id.menu_browser_current_category:\n-                PageTitle title = Utils.getPageTitle(String.format(\"Category:%s\", categoryName));\n+                PageTitle title = Utils.getPageTitle(CATEGORY_PREFIX + categoryName);\n                 Utils.handleWebUrl(this, Uri.parse(title.getCanonicalUri()));\n                 return true;\n             default:\n", "next_change": {"commit": "a4bdd237181a32d790b6186068ad8135587c0186", "changed_code": [{"header": "diff --git a/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java b/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\nindex 87704bf35..749221547 100644\n--- a/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\n+++ b/app/src/main/java/fr/free/nrw/commons/category/CategoryDetailsActivity.java\n", "chunk": "@@ -185,6 +188,9 @@ public class CategoryDetailsActivity extends BaseActivity\n                 PageTitle title = Utils.getPageTitle(CATEGORY_PREFIX + categoryName);\n                 Utils.handleWebUrl(this, Uri.parse(title.getCanonicalUri()));\n                 return true;\n+            case android.R.id.home:\n+                onBackPressed();\n+                return true;\n             default:\n                 return super.onOptionsItemSelected(item);\n         }\n", "next_change": null}]}}]}, "commits_in_main": [{"oid": "174db88ae86686035892e5541561daf447c55f35", "message": "Merge commit", "committedDate": null}, {"oid": "38f80687b16ababa0c57d501f71c34853a85f069", "committedDate": "2021-02-15 21:50:30 +0900", "message": "Remove duplicate ViewPagerAdapter (#4222)"}, {"oid": "6293f909506ad96cd309c4cb55793981c966d447", "committedDate": "2021-02-17 16:37:29 +0900", "message": "fix app crash in CategoryDetailsActivity (#4233)"}, {"oid": "a4bdd237181a32d790b6186068ad8135587c0186", "committedDate": "2021-03-03 15:39:42 +0300", "message": "fix:Explore Search: No title bar for item, non-existent menu for item, wrongly-worded menu for category  (#4274)"}, {"oid": "f8a8f9207028a6fb5a35483c040821f22daf755e", "committedDate": "2021-04-19 17:19:27 +0300", "message": "Fixes #4329 \"Back button in edit categories triggers back of media details.\" (#4346)"}, {"oid": "ca18763e4f4898e9725a0d79de0690e32fe58b85", "committedDate": "2021-06-04 11:15:39 +0900", "message": "Fixes #2815 - Nominating for deletion is cancelled on leaving the media details (#4295)"}, {"oid": "11292ab514aca061bced0ff5a92401e068febaec", "committedDate": "2022-04-11 19:30:21 +0900", "message": "Fixes 4620 : Editing categories of an existing picture: Reuse categories selection UI from the Upload Wizard (#4928)"}]}, {"oid": "2b3eac99ba9b75def1f8113f6018b277c6ca3f46", "url": "https://github.com/commons-app/apps-android-commons/commit/2b3eac99ba9b75def1f8113f6018b277c6ca3f46", "message": "Fix category links in media detail", "committedDate": "2020-11-02T07:49:26Z", "type": "forcePushed"}, {"oid": "6276621b1576c5327129eecae22324c4df690c0d", "url": "https://github.com/commons-app/apps-android-commons/commit/6276621b1576c5327129eecae22324c4df690c0d", "message": "Fix category links in media detail", "committedDate": "2020-11-02T08:01:43Z", "type": "commit"}, {"oid": "6276621b1576c5327129eecae22324c4df690c0d", "url": "https://github.com/commons-app/apps-android-commons/commit/6276621b1576c5327129eecae22324c4df690c0d", "message": "Fix category links in media detail", "committedDate": "2020-11-02T08:01:43Z", "type": "forcePushed"}]}