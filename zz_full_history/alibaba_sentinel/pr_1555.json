{"pr_number": 1555, "pr_title": "Customized handler parser in Dubbo provider filter.", "pr_author": "cityiron", "pr_createdAt": "2020-06-17T06:42:23Z", "pr_url": "https://github.com/alibaba/Sentinel/pull/1555", "merge_commit": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "timeline": [{"oid": "4bb9590653ed2c4f6e36f874d26b02e7354ff914", "url": "https://github.com/alibaba/Sentinel/commit/4bb9590653ed2c4f6e36f874d26b02e7354ff914", "message": "Customized handler parser in Dubbo provider filter.", "committedDate": "2020-06-17T06:19:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTMyMTEwMQ==", "url": "https://github.com/alibaba/Sentinel/pull/1555#discussion_r441321101", "body": "We may need to check null here (and replace with empty string).", "bodyText": "We may need to check null here (and replace with empty string).", "bodyHTML": "<p dir=\"auto\">We may need to check null here (and replace with empty string).</p>", "author": "sczyh30", "createdAt": "2020-06-17T06:56:42Z", "path": "sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java", "diffHunk": "@@ -55,14 +56,14 @@ public SentinelDubboProviderFilter() {\n     @Override\n     public Result invoke(Invoker<?> invoker, Invocation invocation) throws RpcException {\n         // Get origin caller.\n-        String application = DubboUtils.getApplication(invocation, \"\");\n+        String origin = DubboOriginRegistry.getDubboOrigin().handler(invoker, invocation);", "originalCommit": "4bb9590653ed2c4f6e36f874d26b02e7354ff914", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f2b7759828729e3e5f9a156924ae93fc1c1e0d53", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java\nindex ff2fb4c6..959281ac 100755\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java\n", "chunk": "@@ -56,7 +56,10 @@ public class SentinelDubboProviderFilter extends AbstractDubboFilter implements\n     @Override\n     public Result invoke(Invoker<?> invoker, Invocation invocation) throws RpcException {\n         // Get origin caller.\n-        String origin = DubboOriginRegistry.getDubboOrigin().handler(invoker, invocation);\n+        String origin = DubboOriginParserRegistry.getDubboOriginParser().parse(invoker, invocation);\n+        if (null == origin) {\n+            origin = \"\";\n+        }\n \n         Entry interfaceEntry = null;\n         Entry methodEntry = null;\n", "next_change": null}]}, "revised_code_in_main": {"commit": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java\nindex ff2fb4c6..959281ac 100755\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java\n", "chunk": "@@ -56,7 +56,10 @@ public class SentinelDubboProviderFilter extends AbstractDubboFilter implements\n     @Override\n     public Result invoke(Invoker<?> invoker, Invocation invocation) throws RpcException {\n         // Get origin caller.\n-        String origin = DubboOriginRegistry.getDubboOrigin().handler(invoker, invocation);\n+        String origin = DubboOriginParserRegistry.getDubboOriginParser().parse(invoker, invocation);\n+        if (null == origin) {\n+            origin = \"\";\n+        }\n \n         Entry interfaceEntry = null;\n         Entry methodEntry = null;\n", "next_change": {"commit": "58ff01e39b34162c177cff4005b772c415e75caf", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java\nindex 959281ac..405706e0 100755\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java\n", "chunk": "@@ -56,7 +53,7 @@ public class SentinelDubboProviderFilter extends AbstractDubboFilter implements\n     @Override\n     public Result invoke(Invoker<?> invoker, Invocation invocation) throws RpcException {\n         // Get origin caller.\n-        String origin = DubboOriginParserRegistry.getDubboOriginParser().parse(invoker, invocation);\n+        String origin = DubboAdapterGlobalConfig.getOriginParser().parse(invoker, invocation);\n         if (null == origin) {\n             origin = \"\";\n         }\n", "next_change": null}, {"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java\nindex 959281ac..405706e0 100755\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/SentinelDubboProviderFilter.java\n", "chunk": "@@ -64,11 +61,12 @@ public class SentinelDubboProviderFilter extends AbstractDubboFilter implements\n         Entry interfaceEntry = null;\n         Entry methodEntry = null;\n         try {\n-            String resourceName = getResourceName(invoker, invocation, DubboConfig.getDubboProviderPrefix());\n-            String interfaceName = invoker.getInterface().getName();\n-            ContextUtil.enter(resourceName, origin);\n+            String prefix = DubboAdapterGlobalConfig.getDubboProviderPrefix();\n+            String methodResourceName = getMethodResourceName(invoker, invocation, prefix);\n+            String interfaceName = getInterfaceName(invoker, prefix);\n+            ContextUtil.enter(methodResourceName, origin);\n             interfaceEntry = SphU.entry(interfaceName, ResourceTypeConstants.COMMON_RPC, EntryType.IN);\n-            methodEntry = SphU.entry(resourceName, ResourceTypeConstants.COMMON_RPC,\n+            methodEntry = SphU.entry(methodResourceName, ResourceTypeConstants.COMMON_RPC,\n                 EntryType.IN, invocation.getArguments());\n \n             Result result = invoker.invoke(invocation);\n", "next_change": null}]}}]}, "commits_in_main": [{"oid": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "message": "Merge commit", "committedDate": null}, {"oid": "58ff01e39b34162c177cff4005b772c415e75caf", "committedDate": "2020-08-19 10:09:24 +0800", "message": "Polish Dubbo 2.6.x adapter and unify callback registry into DubboAdapterGlobalConfig (#1572)"}]}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTMyMTQ0Nw==", "url": "https://github.com/alibaba/Sentinel/pull/1555#discussion_r441321447", "body": "Maybe DubboOriginParser is better?", "bodyText": "Maybe DubboOriginParser is better?", "bodyHTML": "<p dir=\"auto\">Maybe DubboOriginParser is better?</p>", "author": "sczyh30", "createdAt": "2020-06-17T06:57:21Z", "path": "sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOrigin.java", "diffHunk": "@@ -0,0 +1,24 @@\n+package com.alibaba.csp.sentinel.adapter.dubbo.origin;\n+\n+import com.alibaba.csp.sentinel.context.Context;\n+import com.alibaba.dubbo.rpc.Invocation;\n+import com.alibaba.dubbo.rpc.Invoker;\n+\n+/**\n+ * Customized handler parser in Dubbo provider filter. {@link Context#getOrigin()}\n+ *\n+ * @author tc\n+ * @date 2020/6/10\n+ */\n+public interface DubboOrigin {", "originalCommit": "4bb9590653ed2c4f6e36f874d26b02e7354ff914", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTMyNTQyOA==", "url": "https://github.com/alibaba/Sentinel/pull/1555#discussion_r441325428", "bodyText": "Yes, I think too.", "author": "cityiron", "createdAt": "2020-06-17T07:05:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTMyMTQ0Nw=="}], "type": "inlineReview", "revised_code": {"commit": "f2b7759828729e3e5f9a156924ae93fc1c1e0d53", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOrigin.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParser.java\nsimilarity index 58%\nrename from sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOrigin.java\nrename to sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParser.java\nindex 6b69a37d..d11d5bdd 100644\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOrigin.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParser.java\n", "chunk": "@@ -5,20 +5,20 @@ import com.alibaba.dubbo.rpc.Invocation;\n import com.alibaba.dubbo.rpc.Invoker;\n \n /**\n- * Customized handler parser in Dubbo provider filter. {@link Context#getOrigin()}\n+ * Customized origin parse in Dubbo provider filter. {@link Context#getOrigin()}\n  *\n  * @author tc\n  * @date 2020/6/10\n  */\n-public interface DubboOrigin {\n+public interface DubboOriginParser {\n \n     /**\n-     * Handle the handler parser.\n+     * Handle the origin parse.\n      *\n      * @param invoker    Dubbo invoker\n      * @param invocation Dubbo invocation\n-     * @return handler result\n+     * @return parse result\n      */\n-    String handler(Invoker<?> invoker, Invocation invocation);\n+    String parse(Invoker<?> invoker, Invocation invocation);\n \n }\n", "next_change": null}]}, "revised_code_in_main": {"commit": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOrigin.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOrigin.java\ndeleted file mode 100644\nindex 6b69a37d..00000000\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOrigin.java\n+++ /dev/null\n", "chunk": "@@ -1,24 +0,0 @@\n-package com.alibaba.csp.sentinel.adapter.dubbo.origin;\n-\n-import com.alibaba.csp.sentinel.context.Context;\n-import com.alibaba.dubbo.rpc.Invocation;\n-import com.alibaba.dubbo.rpc.Invoker;\n-\n-/**\n- * Customized handler parser in Dubbo provider filter. {@link Context#getOrigin()}\n- *\n- * @author tc\n- * @date 2020/6/10\n- */\n-public interface DubboOrigin {\n-\n-    /**\n-     * Handle the handler parser.\n-     *\n-     * @param invoker    Dubbo invoker\n-     * @param invocation Dubbo invocation\n-     * @return handler result\n-     */\n-    String handler(Invoker<?> invoker, Invocation invocation);\n-\n-}\n", "next_change": null}]}, "commits_in_main": [{"oid": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "message": "Merge commit", "committedDate": null}]}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTMyMTU1Nw==", "url": "https://github.com/alibaba/Sentinel/pull/1555#discussion_r441321557", "body": "Maybe `parseOrigin` is better?", "bodyText": "Maybe parseOrigin is better?", "bodyHTML": "<p dir=\"auto\">Maybe <code>parseOrigin</code> is better?</p>", "author": "sczyh30", "createdAt": "2020-06-17T06:57:35Z", "path": "sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOrigin.java", "diffHunk": "@@ -0,0 +1,24 @@\n+package com.alibaba.csp.sentinel.adapter.dubbo.origin;\n+\n+import com.alibaba.csp.sentinel.context.Context;\n+import com.alibaba.dubbo.rpc.Invocation;\n+import com.alibaba.dubbo.rpc.Invoker;\n+\n+/**\n+ * Customized handler parser in Dubbo provider filter. {@link Context#getOrigin()}\n+ *\n+ * @author tc\n+ * @date 2020/6/10\n+ */\n+public interface DubboOrigin {\n+\n+    /**\n+     * Handle the handler parser.\n+     *\n+     * @param invoker    Dubbo invoker\n+     * @param invocation Dubbo invocation\n+     * @return handler result\n+     */\n+    String handler(Invoker<?> invoker, Invocation invocation);", "originalCommit": "4bb9590653ed2c4f6e36f874d26b02e7354ff914", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTMyNTU3MQ==", "url": "https://github.com/alibaba/Sentinel/pull/1555#discussion_r441325571", "bodyText": "I think parse is better", "author": "cityiron", "createdAt": "2020-06-17T07:06:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTMyMTU1Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ1ODI2NQ==", "url": "https://github.com/alibaba/Sentinel/pull/1555#discussion_r441458265", "bodyText": "Both are okay.", "author": "sczyh30", "createdAt": "2020-06-17T10:52:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTMyMTU1Nw=="}], "type": "inlineReview", "revised_code": {"commit": "f2b7759828729e3e5f9a156924ae93fc1c1e0d53", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOrigin.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParser.java\nsimilarity index 58%\nrename from sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOrigin.java\nrename to sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParser.java\nindex 6b69a37d..d11d5bdd 100644\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOrigin.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParser.java\n", "chunk": "@@ -5,20 +5,20 @@ import com.alibaba.dubbo.rpc.Invocation;\n import com.alibaba.dubbo.rpc.Invoker;\n \n /**\n- * Customized handler parser in Dubbo provider filter. {@link Context#getOrigin()}\n+ * Customized origin parse in Dubbo provider filter. {@link Context#getOrigin()}\n  *\n  * @author tc\n  * @date 2020/6/10\n  */\n-public interface DubboOrigin {\n+public interface DubboOriginParser {\n \n     /**\n-     * Handle the handler parser.\n+     * Handle the origin parse.\n      *\n      * @param invoker    Dubbo invoker\n      * @param invocation Dubbo invocation\n-     * @return handler result\n+     * @return parse result\n      */\n-    String handler(Invoker<?> invoker, Invocation invocation);\n+    String parse(Invoker<?> invoker, Invocation invocation);\n \n }\n", "next_change": null}]}, "revised_code_in_main": {"commit": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOrigin.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOrigin.java\ndeleted file mode 100644\nindex 6b69a37d..00000000\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOrigin.java\n+++ /dev/null\n", "chunk": "@@ -1,24 +0,0 @@\n-package com.alibaba.csp.sentinel.adapter.dubbo.origin;\n-\n-import com.alibaba.csp.sentinel.context.Context;\n-import com.alibaba.dubbo.rpc.Invocation;\n-import com.alibaba.dubbo.rpc.Invoker;\n-\n-/**\n- * Customized handler parser in Dubbo provider filter. {@link Context#getOrigin()}\n- *\n- * @author tc\n- * @date 2020/6/10\n- */\n-public interface DubboOrigin {\n-\n-    /**\n-     * Handle the handler parser.\n-     *\n-     * @param invoker    Dubbo invoker\n-     * @param invocation Dubbo invocation\n-     * @return handler result\n-     */\n-    String handler(Invoker<?> invoker, Invocation invocation);\n-\n-}\n", "next_change": null}]}, "commits_in_main": [{"oid": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "message": "Merge commit", "committedDate": null}]}, {"oid": "f2b7759828729e3e5f9a156924ae93fc1c1e0d53", "url": "https://github.com/alibaba/Sentinel/commit/f2b7759828729e3e5f9a156924ae93fc1c1e0d53", "message": "1. rename to DubboOriginParser#parse\n2. add DubboOriginParser feature to README.md", "committedDate": "2020-06-17T10:55:21Z", "type": "commit"}, {"oid": "9396092a185935d3de29f1097dabf477a26b6ff2", "url": "https://github.com/alibaba/Sentinel/commit/9396092a185935d3de29f1097dabf477a26b6ff2", "message": "1. rename to DubboOriginParser#parse\n2. add DubboOriginParser feature to README.md", "committedDate": "2020-06-17T10:57:03Z", "type": "commit"}, {"oid": "6dcf059322174f25e4070c7a84abfe9927f490a1", "url": "https://github.com/alibaba/Sentinel/commit/6dcf059322174f25e4070c7a84abfe9927f490a1", "message": "Merge remote-tracking branch 'origin/dubbo_origin' into dubbo_origin\n\n# Conflicts:\n#\tsentinel-adapter/sentinel-dubbo-adapter/README.md", "committedDate": "2020-06-17T10:58:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ3ODQ3Nw==", "url": "https://github.com/alibaba/Sentinel/pull/1555#discussion_r441478477", "body": "Could you please add the license header?", "bodyText": "Could you please add the license header?", "bodyHTML": "<p dir=\"auto\">Could you please add the license header?</p>", "author": "sczyh30", "createdAt": "2020-06-17T11:35:00Z", "path": "sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java", "diffHunk": "@@ -0,0 +1,20 @@\n+package com.alibaba.csp.sentinel.adapter.dubbo.origin;", "originalCommit": "6dcf059322174f25e4070c7a84abfe9927f490a1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUzNTk3Mg==", "url": "https://github.com/alibaba/Sentinel/pull/1555#discussion_r441535972", "bodyText": "Yes, I will do. ^_^", "author": "cityiron", "createdAt": "2020-06-17T13:16:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ3ODQ3Nw=="}], "type": "inlineReview", "revised_code": {"commit": "0ade21b47d932eda4385db27506cb71cbfc45776", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\nindex 6c0ddea2..015fd2ef 100644\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\n", "chunk": "@@ -1,3 +1,18 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n package com.alibaba.csp.sentinel.adapter.dubbo.origin;\n \n import com.alibaba.csp.sentinel.adapter.dubbo.DubboUtils;\n", "next_change": null}]}, "revised_code_in_main": {"commit": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\nindex 6c0ddea2..015fd2ef 100644\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\n", "chunk": "@@ -1,3 +1,18 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n package com.alibaba.csp.sentinel.adapter.dubbo.origin;\n \n import com.alibaba.csp.sentinel.adapter.dubbo.DubboUtils;\n", "next_change": {"commit": "58ff01e39b34162c177cff4005b772c415e75caf", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\nindex 015fd2ef..82760793 100644\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\n", "chunk": "@@ -20,9 +20,10 @@ import com.alibaba.dubbo.rpc.Invocation;\n import com.alibaba.dubbo.rpc.Invoker;\n \n /**\n- * Default Dubbo origin parse.\n+ * Default Dubbo origin parser.\n  *\n  * @author tiecheng\n+ * @since 1.8.0\n  */\n public class DefaultDubboOriginParser implements DubboOriginParser {\n \n", "next_change": null}]}}]}, "commits_in_main": [{"oid": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "message": "Merge commit", "committedDate": null}, {"oid": "58ff01e39b34162c177cff4005b772c415e75caf", "committedDate": "2020-08-19 10:09:24 +0800", "message": "Polish Dubbo 2.6.x adapter and unify callback registry into DubboAdapterGlobalConfig (#1572)"}]}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ3ODU5Mg==", "url": "https://github.com/alibaba/Sentinel/pull/1555#discussion_r441478592", "body": "We may remove the date here.", "bodyText": "We may remove the date here.", "bodyHTML": "<p dir=\"auto\">We may remove the date here.</p>", "author": "sczyh30", "createdAt": "2020-06-17T11:35:13Z", "path": "sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java", "diffHunk": "@@ -0,0 +1,20 @@\n+package com.alibaba.csp.sentinel.adapter.dubbo.origin;\n+\n+import com.alibaba.csp.sentinel.adapter.dubbo.DubboUtils;\n+import com.alibaba.dubbo.rpc.Invocation;\n+import com.alibaba.dubbo.rpc.Invoker;\n+\n+/**\n+ * Default Dubbo origin parse.\n+ *\n+ * @author tc\n+ * @date 2020/6/10", "originalCommit": "6dcf059322174f25e4070c7a84abfe9927f490a1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTUzNTg3NQ==", "url": "https://github.com/alibaba/Sentinel/pull/1555#discussion_r441535875", "bodyText": "I will remove it.", "author": "cityiron", "createdAt": "2020-06-17T13:16:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ3ODU5Mg=="}], "type": "inlineReview", "revised_code": {"commit": "0ade21b47d932eda4385db27506cb71cbfc45776", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\nindex 6c0ddea2..015fd2ef 100644\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\n", "chunk": "@@ -7,8 +22,7 @@ import com.alibaba.dubbo.rpc.Invoker;\n /**\n  * Default Dubbo origin parse.\n  *\n- * @author tc\n- * @date 2020/6/10\n+ * @author tiecheng\n  */\n public class DefaultDubboOriginParser implements DubboOriginParser {\n \n", "next_change": null}]}, "revised_code_in_main": {"commit": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\nindex 6c0ddea2..015fd2ef 100644\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\n", "chunk": "@@ -7,8 +22,7 @@ import com.alibaba.dubbo.rpc.Invoker;\n /**\n  * Default Dubbo origin parse.\n  *\n- * @author tc\n- * @date 2020/6/10\n+ * @author tiecheng\n  */\n public class DefaultDubboOriginParser implements DubboOriginParser {\n \n", "next_change": {"commit": "58ff01e39b34162c177cff4005b772c415e75caf", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\nindex 015fd2ef..82760793 100644\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DefaultDubboOriginParser.java\n", "chunk": "@@ -20,9 +20,10 @@ import com.alibaba.dubbo.rpc.Invocation;\n import com.alibaba.dubbo.rpc.Invoker;\n \n /**\n- * Default Dubbo origin parse.\n+ * Default Dubbo origin parser.\n  *\n  * @author tiecheng\n+ * @since 1.8.0\n  */\n public class DefaultDubboOriginParser implements DubboOriginParser {\n \n", "next_change": null}]}}]}, "commits_in_main": [{"oid": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "message": "Merge commit", "committedDate": null}, {"oid": "58ff01e39b34162c177cff4005b772c415e75caf", "committedDate": "2020-08-19 10:09:24 +0800", "message": "Polish Dubbo 2.6.x adapter and unify callback registry into DubboAdapterGlobalConfig (#1572)"}]}, {"oid": "0ade21b47d932eda4385db27506cb71cbfc45776", "url": "https://github.com/alibaba/Sentinel/commit/0ade21b47d932eda4385db27506cb71cbfc45776", "message": "1. add license header\n2. remove date", "committedDate": "2020-06-17T13:17:38Z", "type": "commit"}, {"oid": "d2e5f51894dd3c7a6a502d2127c24d209624bf02", "url": "https://github.com/alibaba/Sentinel/commit/d2e5f51894dd3c7a6a502d2127c24d209624bf02", "message": "effect on SentinelDubboProviderFilterTest when mvn integration-test, so set default parser when run testCustomOriginParser.", "committedDate": "2020-06-19T01:53:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjcwNjI0Nw==", "url": "https://github.com/alibaba/Sentinel/pull/1555#discussion_r442706247", "body": "It may better that we use uniform clean method before and after each test case.\r\nsuch as:\r\n\r\n```java\r\n@Before\r\npublic void setUp() {\r\n    DubboOriginParserRegistry.setDubboOriginParser(new DefaultDubboOriginParser());\r\n}\r\n\r\n@After\r\npublic void cleanUp() {\r\n    DubboOriginParserRegistry.setDubboOriginParser(new DefaultDubboOriginParser());\r\n}\r\n```", "bodyText": "It may better that we use uniform clean method before and after each test case.\nsuch as:\n@Before\npublic void setUp() {\n    DubboOriginParserRegistry.setDubboOriginParser(new DefaultDubboOriginParser());\n}\n\n@After\npublic void cleanUp() {\n    DubboOriginParserRegistry.setDubboOriginParser(new DefaultDubboOriginParser());\n}", "bodyHTML": "<p dir=\"auto\">It may better that we use uniform clean method before and after each test case.<br>\nsuch as:</p>\n<div class=\"highlight highlight-source-java position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"@Before\npublic void setUp() {\n    DubboOriginParserRegistry.setDubboOriginParser(new DefaultDubboOriginParser());\n}\n\n@After\npublic void cleanUp() {\n    DubboOriginParserRegistry.setDubboOriginParser(new DefaultDubboOriginParser());\n}\n\"><pre><span class=\"pl-k\">@Before</span>\n<span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> setUp() {\n    <span class=\"pl-smi\">DubboOriginParserRegistry</span><span class=\"pl-k\">.</span>setDubboOriginParser(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">DefaultDubboOriginParser</span>());\n}\n\n<span class=\"pl-k\">@After</span>\n<span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> cleanUp() {\n    <span class=\"pl-smi\">DubboOriginParserRegistry</span><span class=\"pl-k\">.</span>setDubboOriginParser(<span class=\"pl-k\">new</span> <span class=\"pl-smi\">DefaultDubboOriginParser</span>());\n}</pre></div>", "author": "cdfive", "createdAt": "2020-06-19T08:27:07Z", "path": "sentinel-adapter/sentinel-dubbo-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginRegistryTest.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.alibaba.csp.sentinel.adapter.dubbo.origin;\n+\n+import com.alibaba.csp.sentinel.adapter.dubbo.DubboUtils;\n+import com.alibaba.dubbo.rpc.Invocation;\n+import com.alibaba.dubbo.rpc.Invoker;\n+import com.alibaba.dubbo.rpc.RpcInvocation;\n+import org.junit.Assert;\n+import org.junit.Test;\n+\n+/**\n+ * @author tiecheng\n+ */\n+public class DubboOriginRegistryTest {\n+\n+    @Test(expected = IllegalArgumentException.class)\n+    public void testDefaultOriginParserFail() {\n+        DubboOriginParserRegistry.getDubboOriginParser().parse(null, null);\n+    }\n+\n+    @Test\n+    public void testDefaultOriginParserSuccess() {\n+        RpcInvocation invocation = new RpcInvocation();\n+        String dubboName = \"sentinel\";\n+        invocation.setAttachment(DubboUtils.DUBBO_APPLICATION_KEY, dubboName);\n+        String origin = DubboOriginParserRegistry.getDubboOriginParser().parse(null, invocation);\n+        Assert.assertEquals(dubboName, origin);\n+    }\n+\n+    @Test\n+    public void testCustomOriginParser() {\n+        DubboOriginParserRegistry.setDubboOriginParser(new DubboOriginParser() {\n+            @Override\n+            public String parse(Invoker<?> invoker, Invocation invocation) {\n+                return invocation.getAttachment(DubboUtils.DUBBO_APPLICATION_KEY, \"default\") + \"_\" + invocation\n+                    .getMethodName();\n+            }\n+        });\n+\n+        RpcInvocation invocation = new RpcInvocation();\n+        String origin = DubboOriginParserRegistry.getDubboOriginParser().parse(null, invocation);\n+        Assert.assertEquals(\"default_null\", origin);\n+\n+        String dubboName = \"sentinel\";\n+        invocation.setAttachment(DubboUtils.DUBBO_APPLICATION_KEY, dubboName);\n+        origin = DubboOriginParserRegistry.getDubboOriginParser().parse(null, invocation);\n+        Assert.assertEquals(dubboName + \"_null\", origin);\n+\n+        invocation.setMethodName(\"hello\");\n+        origin = DubboOriginParserRegistry.getDubboOriginParser().parse(null, invocation);\n+        Assert.assertEquals(dubboName + \"_hello\", origin);\n+\n+        // if not set default, effect on SentinelDubboProviderFilterTest when mvn integration-test\n+        DubboOriginParserRegistry.setDubboOriginParser(new DefaultDubboOriginParser());\n+    }", "originalCommit": "d2e5f51894dd3c7a6a502d2127c24d209624bf02", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "aa5e8f6eb7fa36dba6a25452a2eb089ce361fbf0", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginRegistryTest.java b/sentinel-adapter/sentinel-dubbo-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginRegistryTest.java\nindex a826886f..e5a1eff1 100644\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginRegistryTest.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginRegistryTest.java\n", "chunk": "@@ -63,9 +69,6 @@ public class DubboOriginRegistryTest {\n         invocation.setMethodName(\"hello\");\n         origin = DubboOriginParserRegistry.getDubboOriginParser().parse(null, invocation);\n         Assert.assertEquals(dubboName + \"_hello\", origin);\n-\n-        // if not set default, effect on SentinelDubboProviderFilterTest when mvn integration-test\n-        DubboOriginParserRegistry.setDubboOriginParser(new DefaultDubboOriginParser());\n     }\n \n }\n", "next_change": null}]}, "revised_code_in_main": {"commit": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginRegistryTest.java b/sentinel-adapter/sentinel-dubbo-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginRegistryTest.java\nindex a826886f..e5a1eff1 100644\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginRegistryTest.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginRegistryTest.java\n", "chunk": "@@ -63,9 +69,6 @@ public class DubboOriginRegistryTest {\n         invocation.setMethodName(\"hello\");\n         origin = DubboOriginParserRegistry.getDubboOriginParser().parse(null, invocation);\n         Assert.assertEquals(dubboName + \"_hello\", origin);\n-\n-        // if not set default, effect on SentinelDubboProviderFilterTest when mvn integration-test\n-        DubboOriginParserRegistry.setDubboOriginParser(new DefaultDubboOriginParser());\n     }\n \n }\n", "next_change": {"commit": "58ff01e39b34162c177cff4005b772c415e75caf", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginRegistryTest.java b/sentinel-adapter/sentinel-dubbo-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginRegistryTest.java\nindex e5a1eff1..ab253c26 100644\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginRegistryTest.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/test/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginRegistryTest.java\n", "chunk": "@@ -58,16 +60,16 @@ public class DubboOriginRegistryTest {\n         });\n \n         RpcInvocation invocation = new RpcInvocation();\n-        String origin = DubboOriginParserRegistry.getDubboOriginParser().parse(null, invocation);\n+        String origin = DubboAdapterGlobalConfig.getOriginParser().parse(null, invocation);\n         Assert.assertEquals(\"default_null\", origin);\n \n         String dubboName = \"sentinel\";\n         invocation.setAttachment(DubboUtils.DUBBO_APPLICATION_KEY, dubboName);\n-        origin = DubboOriginParserRegistry.getDubboOriginParser().parse(null, invocation);\n+        origin = DubboAdapterGlobalConfig.getOriginParser().parse(null, invocation);\n         Assert.assertEquals(dubboName + \"_null\", origin);\n \n         invocation.setMethodName(\"hello\");\n-        origin = DubboOriginParserRegistry.getDubboOriginParser().parse(null, invocation);\n+        origin = DubboAdapterGlobalConfig.getOriginParser().parse(null, invocation);\n         Assert.assertEquals(dubboName + \"_hello\", origin);\n     }\n \n", "next_change": null}]}}]}, "commits_in_main": [{"oid": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "message": "Merge commit", "committedDate": null}, {"oid": "58ff01e39b34162c177cff4005b772c415e75caf", "committedDate": "2020-08-19 10:09:24 +0800", "message": "Polish Dubbo 2.6.x adapter and unify callback registry into DubboAdapterGlobalConfig (#1572)"}]}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjcwNzM1MA==", "url": "https://github.com/alibaba/Sentinel/pull/1555#discussion_r442707350", "body": "The parameter name such as `dubboOriginParser` is clearer semantically.\r\n\r\n ", "bodyText": "The parameter name such as dubboOriginParser is clearer semantically.", "bodyHTML": "<p dir=\"auto\">The parameter name such as <code>dubboOriginParser</code> is clearer semantically.</p>", "author": "cdfive", "createdAt": "2020-06-19T08:29:21Z", "path": "sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParserRegistry.java", "diffHunk": "@@ -0,0 +1,37 @@\n+/*\n+ * Copyright 1999-2020 Alibaba Group Holding Ltd.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      https://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package com.alibaba.csp.sentinel.adapter.dubbo.origin;\n+\n+/**\n+ * Global origin parser registry for Dubbo.\n+ *\n+ * @author tiecheng\n+ */\n+public final class DubboOriginParserRegistry {\n+\n+    private static volatile DubboOriginParser dubboOriginParser = new DefaultDubboOriginParser();\n+\n+    public static DubboOriginParser getDubboOriginParser() {\n+        return dubboOriginParser;\n+    }\n+\n+    public static void setDubboOriginParser(DubboOriginParser dubboOrigin) {", "originalCommit": "d2e5f51894dd3c7a6a502d2127c24d209624bf02", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "aa5e8f6eb7fa36dba6a25452a2eb089ce361fbf0", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParserRegistry.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParserRegistry.java\nindex b07a8f92..a25a9c0a 100644\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParserRegistry.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParserRegistry.java\n", "chunk": "@@ -28,8 +28,8 @@ public final class DubboOriginParserRegistry {\n         return dubboOriginParser;\n     }\n \n-    public static void setDubboOriginParser(DubboOriginParser dubboOrigin) {\n-        DubboOriginParserRegistry.dubboOriginParser = dubboOrigin;\n+    public static void setDubboOriginParser(DubboOriginParser dubboOriginParser) {\n+        DubboOriginParserRegistry.dubboOriginParser = dubboOriginParser;\n     }\n \n     private DubboOriginParserRegistry() {}\n", "next_change": null}]}, "revised_code_in_main": {"commit": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParserRegistry.java b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParserRegistry.java\nindex b07a8f92..a25a9c0a 100644\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParserRegistry.java\n+++ b/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParserRegistry.java\n", "chunk": "@@ -28,8 +28,8 @@ public final class DubboOriginParserRegistry {\n         return dubboOriginParser;\n     }\n \n-    public static void setDubboOriginParser(DubboOriginParser dubboOrigin) {\n-        DubboOriginParserRegistry.dubboOriginParser = dubboOrigin;\n+    public static void setDubboOriginParser(DubboOriginParser dubboOriginParser) {\n+        DubboOriginParserRegistry.dubboOriginParser = dubboOriginParser;\n     }\n \n     private DubboOriginParserRegistry() {}\n", "next_change": {"commit": "58ff01e39b34162c177cff4005b772c415e75caf", "changed_code": [{"header": "diff --git a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParserRegistry.java b/sentinel-core/src/main/java/com/alibaba/csp/sentinel/slots/block/degrade/circuitbreaker/CircuitBreakerStrategy.java\nsimilarity index 50%\nrename from sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParserRegistry.java\nrename to sentinel-core/src/main/java/com/alibaba/csp/sentinel/slots/block/degrade/circuitbreaker/CircuitBreakerStrategy.java\nindex a25a9c0a..79d3b12a 100644\n--- a/sentinel-adapter/sentinel-dubbo-adapter/src/main/java/com/alibaba/csp/sentinel/adapter/dubbo/origin/DubboOriginParserRegistry.java\n+++ b/sentinel-core/src/main/java/com/alibaba/csp/sentinel/slots/block/degrade/circuitbreaker/CircuitBreakerStrategy.java\n", "chunk": "@@ -13,25 +13,34 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n-package com.alibaba.csp.sentinel.adapter.dubbo.origin;\n+package com.alibaba.csp.sentinel.slots.block.degrade.circuitbreaker;\n \n /**\n- * Global origin parser registry for Dubbo.\n- *\n- * @author tiecheng\n+ * @author Eric Zhao\n+ * @since 1.8.0\n  */\n-public final class DubboOriginParserRegistry {\n+public enum CircuitBreakerStrategy {\n \n-    private static volatile DubboOriginParser dubboOriginParser = new DefaultDubboOriginParser();\n+    /**\n+     * Circuit breaker opens (cuts off) when slow request ratio exceeds the threshold.\n+     */\n+    SLOW_REQUEST_RATIO(0),\n+    /**\n+     * Circuit breaker opens (cuts off) when error ratio exceeds the threshold.\n+     */\n+    ERROR_RATIO(1),\n+    /**\n+     * Circuit breaker opens (cuts off) when error count exceeds the threshold.\n+     */\n+    ERROR_COUNT(2);\n \n-    public static DubboOriginParser getDubboOriginParser() {\n-        return dubboOriginParser;\n-    }\n+    private int type;\n \n-    public static void setDubboOriginParser(DubboOriginParser dubboOriginParser) {\n-        DubboOriginParserRegistry.dubboOriginParser = dubboOriginParser;\n+    CircuitBreakerStrategy(int type) {\n+        this.type = type;\n     }\n \n-    private DubboOriginParserRegistry() {}\n-\n+    public int getType() {\n+        return type;\n+    }\n }\n", "next_change": null}]}}]}, "commits_in_main": [{"oid": "d8714cacebeafd3adb463a58573d5b7940f4fab8", "message": "Merge commit", "committedDate": null}, {"oid": "58ff01e39b34162c177cff4005b772c415e75caf", "committedDate": "2020-08-19 10:09:24 +0800", "message": "Polish Dubbo 2.6.x adapter and unify callback registry into DubboAdapterGlobalConfig (#1572)"}]}, {"oid": "aa5e8f6eb7fa36dba6a25452a2eb089ce361fbf0", "url": "https://github.com/alibaba/Sentinel/commit/aa5e8f6eb7fa36dba6a25452a2eb089ce361fbf0", "message": "make code clearer.", "committedDate": "2020-06-19T10:03:40Z", "type": "commit"}]}