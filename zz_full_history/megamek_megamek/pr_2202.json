{"pr_number": 2202, "pr_title": "Inconsistent combat log sprites", "pr_author": "Krashner", "pr_createdAt": "2020-09-07T14:08:01Z", "pr_url": "https://github.com/MegaMek/megamek/pull/2202", "timeline": [{"oid": "0ae73d3698b754a4e2dea0097a87cc224d71df80", "url": "https://github.com/MegaMek/megamek/commit/0ae73d3698b754a4e2dea0097a87cc224d71df80", "message": "Fixed bug that caused sprites to be disabled for all clients when one toggled option", "committedDate": "2020-09-07T13:06:42Z", "type": "commit"}, {"oid": "7c8668d723c44f186dc802f2c3b46dc9dc429beb", "url": "https://github.com/MegaMek/megamek/commit/7c8668d723c44f186dc802f2c3b46dc9dc429beb", "message": "Fixed a string index out of bounds error when inserting image code", "committedDate": "2020-09-07T13:24:57Z", "type": "commit"}, {"oid": "cf1e3add4d87fc05edc242089d412e9789011368", "url": "https://github.com/MegaMek/megamek/commit/cf1e3add4d87fc05edc242089d412e9789011368", "message": "Fixed a string index out of bounds error when inserting image code", "committedDate": "2020-09-07T14:01:33Z", "type": "commit"}, {"oid": "3dd662c2f7b48dc9e3b2cc07e7610ffb5cd56b1f", "url": "https://github.com/MegaMek/megamek/commit/3dd662c2f7b48dc9e3b2cc07e7610ffb5cd56b1f", "message": "Merge branch 'inconsistentCombatLogSprites' of https://github.com/Krashner/megamek into inconsistentCombatLogSprites", "committedDate": "2020-09-07T14:01:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUwNjUxMw==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r484506513", "body": "Is `text.startsWith(\"\\n\")` not an option? Simpler than a length check and first char check.", "bodyText": "Is text.startsWith(\"\\n\") not an option? Simpler than a length check and first char check.", "bodyHTML": "<p dir=\"auto\">Is <code>text.startsWith(\"\\n\")</code> not an option? Simpler than a length check and first char check.</p>", "author": "sixlettervariables", "createdAt": "2020-09-07T16:02:48Z", "path": "megamek/src/megamek/common/Report.java", "diffHunk": "@@ -489,7 +487,7 @@ public String getText() {\n             }\n             //draw the sprite at the beginning of the line\n             if(imageCode != null && imageCode.length() > 0){\n-                if(text.substring(0,1).equals(\"\\n\")){\n+                if(text.length() >= 2 && text.substring(0,1).equals(\"\\n\")){", "originalCommit": "3dd662c2f7b48dc9e3b2cc07e7610ffb5cd56b1f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDgyMzU0Mg==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r484823542", "bodyText": "Ah, good call. That flew right past me.", "author": "Krashner", "createdAt": "2020-09-08T10:44:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUwNjUxMw=="}], "type": "inlineReview", "revised_code": {"commit": "a8661baf39ba5132071a85163c54905b8a6ac856", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex c3bed89619..fa09cd5ba2 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -485,9 +485,9 @@ public class Report implements Serializable {\n                 }\n                 i++;\n             }\n-            //draw the sprite at the beginning of the line\n-            if(imageCode != null && imageCode.length() > 0){\n-                if(text.length() >= 2 && text.substring(0,1).equals(\"\\n\")){\n+            //add the sprite code at the beginning of the line\n+            if(!imageCode.isEmpty()){\n+                if(text.toString().startsWith(\"\\n\")){\n                     text.insert(1, imageCode);\n                 }\n                 else {\n", "next_change": {"commit": "df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex fa09cd5ba2..9b31b48b1a 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -486,8 +486,8 @@ public class Report implements Serializable {\n                 i++;\n             }\n             //add the sprite code at the beginning of the line\n-            if(!imageCode.isEmpty()){\n-                if(text.toString().startsWith(\"\\n\")){\n+            if (!imageCode.isEmpty()) {\n+                if (text.toString().startsWith(\"\\n\")) {\n                     text.insert(1, imageCode);\n                 }\n                 else {\n", "next_change": {"commit": "6a950a5947b58f5b5a284a6130d6ccf54e6c7bbf", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex 9b31b48b1a..1926865cb0 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -486,7 +486,7 @@ public class Report implements Serializable {\n                 i++;\n             }\n             //add the sprite code at the beginning of the line\n-            if (!imageCode.isEmpty()) {\n+            if (imageCode != null && !imageCode.isEmpty()) {\n                 if (text.toString().startsWith(\"\\n\")) {\n                     text.insert(1, imageCode);\n                 }\n", "next_change": {"commit": "2f31805840da3aec87ab248e781265acb449600a", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex 1926865cb0..39342e9fa3 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -473,19 +484,18 @@ public class Report implements Serializable {\n                                     raw.indexOf(',', i) + 1, endTagIdx)));\n                         }\n                         tagCounter++;\n-                    } else if (raw.substring(i + 1, endTagIdx)\n-                            .equals(\"newline\")) {\n+                    } else if (raw.substring(i + 1, endTagIdx).equals(\"newline\")) {\n                         text.append(\"\\n\");\n                     } else {\n                         // not a special tag, so treat as literal text\n-                        text.append(raw.substring(i, endTagIdx + 1));\n+                        text.append(raw, i, endTagIdx + 1);\n                     }\n                     mark = endTagIdx + 1;\n                     i = endTagIdx;\n                 }\n                 i++;\n             }\n-            //add the sprite code at the beginning of the line\n+            // add the sprite code at the beginning of the line\n             if (imageCode != null && !imageCode.isEmpty()) {\n                 if (text.toString().startsWith(\"\\n\")) {\n                     text.insert(1, imageCode);\n", "next_change": {"commit": "f25b35cf7a952d903500cab543aaa4d8f89e4b67", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex 39342e9fa3..0b5fedea85 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -495,7 +494,7 @@ public class Report implements Serializable {\n                 }\n                 i++;\n             }\n-            // add the sprite code at the beginning of the line\n+            //add the sprite code at the beginning of the line\n             if (imageCode != null && !imageCode.isEmpty()) {\n                 if (text.toString().startsWith(\"\\n\")) {\n                     text.insert(1, imageCode);\n", "next_change": {"commit": "83da84722acade26b94667d0e6e1007ae31ac978", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex 0b5fedea85..58036819b7 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -494,7 +495,7 @@ public class Report implements Serializable {\n                 }\n                 i++;\n             }\n-            //add the sprite code at the beginning of the line\n+            // add the sprite code at the beginning of the line\n             if (imageCode != null && !imageCode.isEmpty()) {\n                 if (text.toString().startsWith(\"\\n\")) {\n                     text.insert(1, imageCode);\n", "next_change": null}]}}]}}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUwNzM1OA==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r484507358", "body": "Are we leaking these BAIS? Or do we need them held open for the BufferedImage's.", "bodyText": "Are we leaking these BAIS? Or do we need them held open for the BufferedImage's.", "bodyHTML": "<p dir=\"auto\">Are we leaking these BAIS? Or do we need them held open for the BufferedImage's.</p>", "author": "sixlettervariables", "createdAt": "2020-09-07T16:05:12Z", "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -51,25 +51,31 @@ private void populateImage() {\n             cache = new Hashtable<>();\n             getDocument().putProperty(\"imageCache\", cache);\n         }\n-\n         URL src = getImageURL();\n-        cache.put(src, loadImage());\n-\n+        Image image = loadImage();\n+        if(image != null) {\n+            cache.put(src, image);\n+        }\n     }\n \n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        BufferedImage newImage = null;\n-        ByteArrayInputStream bais = null;\n-        try {\n-            bais = new ByteArrayInputStream(\n-                    Base64.getDecoder().decode(b64.getBytes()));\n-            newImage = ImageIO.read(bais);\n-        } catch (Throwable ex) {\n-            ex.printStackTrace();\n+        if(b64 != null) {\n+            BufferedImage newImage = null;\n+            ByteArrayInputStream bais = null;", "originalCommit": "3dd662c2f7b48dc9e3b2cc07e7610ffb5cd56b1f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDgyMjEyMQ==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r484822121", "bodyText": "They should be closed, I'll fix that.", "author": "Krashner", "createdAt": "2020-09-08T10:42:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDUwNzM1OA=="}], "type": "inlineReview", "revised_code": {"commit": "a8661baf39ba5132071a85163c54905b8a6ac856", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 0542b71ea2..1b28787742 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,6 +68,7 @@ public class BASE64ImageView extends ImageView {\n                 bais = new ByteArrayInputStream(\n                         Base64.getDecoder().decode(b64.getBytes()));\n                 newImage = ImageIO.read(bais);\n+                bais.close();\n             } catch (Throwable ex) {\n                 ex.printStackTrace();\n             }\n", "next_change": {"commit": "58b8c9cc3431375b3c8a877637fef5719c20e7c2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 1b28787742..a7fa0e71af 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -63,12 +63,9 @@ public class BASE64ImageView extends ImageView {\n         String b64 = getBASE64Image();\n         if(b64 != null) {\n             BufferedImage newImage = null;\n-            ByteArrayInputStream bais = null;\n-            try {\n-                bais = new ByteArrayInputStream(\n-                        Base64.getDecoder().decode(b64.getBytes()));\n+            try (ByteArrayInputStream bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n-                bais.close();\n             } catch (Throwable ex) {\n                 ex.printStackTrace();\n             }\n", "next_change": {"commit": "df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex a7fa0e71af..8efa395cea 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -61,18 +61,17 @@ public class BASE64ImageView extends ImageView {\n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        if(b64 != null) {\n+        if (b64 != null) {\n             BufferedImage newImage = null;\n             try (ByteArrayInputStream bais = new ByteArrayInputStream(\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n-            } catch (Throwable ex) {\n-                ex.printStackTrace();\n+            } catch (Exception ex) {\n+                MegaMek.getLogger(getClass(), \"loadImage\", ex);\n             }\n             return newImage;\n-        }\n-        else{\n-            return  null;\n+        } else {\n+            return null;\n         }\n     }\n \n", "next_change": {"commit": "c6ca70022320199f2c8075cf223638273f363818", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 8efa395cea..1ec9fac414 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -67,7 +69,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger(getClass(), \"loadImage\", ex);\n+                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "60cb19974d8a2c3188151f1e06227c7484c4d333", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 1ec9fac414..416157868a 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -69,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n+                MegaMek.getLogger().error(this, ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "a3705404f7857df886e37a668af2234d7d48ef6e", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 416157868a..79e9f09bdd 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(this, ex);\n+                MegaMek.getLogger().error(ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "eaaefe2f38ec268d385ab361225b918182e0693d", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 79e9f09bdd..2f97254111 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(ex);\n+                LogManager.getLogger().error(ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "77c3784bc07718bf23af8fc439af5e467ec0fb04", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 2f97254111..1e3be9cd9b 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                LogManager.getLogger().error(ex);\n+                LogManager.getLogger().error(\"\", ex);\n             }\n             return newImage;\n         } else {\n", "next_change": null}]}}]}}]}}]}}]}}]}}]}}]}}, {"oid": "a8661baf39ba5132071a85163c54905b8a6ac856", "url": "https://github.com/MegaMek/megamek/commit/a8661baf39ba5132071a85163c54905b8a6ac856", "message": "Cleaned up report text check and closed bais", "committedDate": "2020-09-08T10:57:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzMjQ5OQ==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487232499", "body": "```suggestion\r\n        if (!GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(!GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)\n          \n          \n            \n                    if (!GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span>(<span class=\"pl-k\">!</span><span class=\"pl-smi\">GUIPreferences</span><span class=\"pl-k\">.</span>getInstance()<span class=\"pl-k\">.</span>getBoolean(<span class=\"pl-smi\">GUIPreferences</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>ADVANCED_ROUND_REPORT_SPRITES</span>)</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(<span class=\"pl-k\">!</span><span class=\"pl-smi\">GUIPreferences</span><span class=\"pl-k\">.</span>getInstance()<span class=\"pl-k\">.</span>getBoolean(<span class=\"pl-smi\">GUIPreferences</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>ADVANCED_ROUND_REPORT_SPRITES</span>)</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-09-11T19:00:21Z", "path": "megamek/src/megamek/client/Client.java", "diffHunk": "@@ -1139,7 +1140,8 @@ public String receiveReport(Vector<Report> v) {\n      * returns the stored <img> tag for given unit id\n      */\n     private String getCachedImgTag(int id){\n-        if(imgCache == null || !imgCache.containsKey(id)) {\n+        if(!GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)", "originalCommit": "a8661baf39ba5132071a85163c54905b8a6ac856", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex 055fd093cf..bbf172513d 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1140,8 +1140,8 @@ public class Client implements IClientCommandHandler {\n      * returns the stored <img> tag for given unit id\n      */\n     private String getCachedImgTag(int id){\n-        if(!GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)\n-                || imgCache == null || !imgCache.containsKey(id)) {\n+        if (!GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)\n+                || (imgCache == null) || !imgCache.containsKey(id)) {\n             return null;\n         }\n         return imgCache.get(id);\n", "next_change": {"commit": "26025434b5fac88760e9cdcf0c6308f8a28ca3e3", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex bbf172513d..eb80630f71 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1150,10 +1262,8 @@ public class Client implements IClientCommandHandler {\n     /**\n      * Hashtable for storing <img> tags containing base64Text src.\n      */\n-    private void cacheImgTag(Entity entity){\n-\n+    private void cacheImgTag(Entity entity) {\n         if(entity == null) {\n-            MegaMek.getLogger().error(this, \"Null entity reference\");\n             return;\n         }\n \n", "next_change": {"commit": "bb37d25aaa03ac72413d007f9e827fd13c66a322", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex eb80630f71..567247237e 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1262,7 +1262,7 @@ public class Client implements IClientCommandHandler {\n     /**\n      * Hashtable for storing <img> tags containing base64Text src.\n      */\n-    private void cacheImgTag(Entity entity) {\n+    protected void cacheImgTag(Entity entity) {\n         if(entity == null) {\n             return;\n         }\n", "next_change": {"commit": "cd93d149815865aef558382e7e8fc99f7e8411ef", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex 567247237e..27f16841dd 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1263,19 +1256,19 @@ public class Client implements IClientCommandHandler {\n      * Hashtable for storing <img> tags containing base64Text src.\n      */\n     protected void cacheImgTag(Entity entity) {\n-        if(entity == null) {\n+        if (entity == null) {\n             return;\n         }\n \n+        // remove images that should be refreshed\n         if (imgCache == null) {\n             imgCache = new Hashtable<>();\n-        } else if (imgCache.containsKey(entity.getId())) {\n-            //remove images that should be refreshed\n+        } else {\n             imgCache.remove(entity.getId());\n         }\n \n         if (getTargetImage(entity) != null) {\n-            //convert image to base64, add to to <img> tag and store in cache\n+            //convert image to base64, add to the <img> tag and store in cache\n             Image image = ImageUtil.getScaledImage(getTargetImage(entity), 56, 48);\n             try {\n                 String base64Text;\n", "next_change": {"commit": "5a06c5f191be279f1152f475f7d1a77a1b5b1c31", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex 27f16841dd..ee30168f33 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1256,19 +1256,19 @@ public class Client implements IClientCommandHandler {\n      * Hashtable for storing <img> tags containing base64Text src.\n      */\n     protected void cacheImgTag(Entity entity) {\n-        if (entity == null) {\n+        if(entity == null) {\n             return;\n         }\n \n-        // remove images that should be refreshed\n         if (imgCache == null) {\n             imgCache = new Hashtable<>();\n-        } else {\n+        } else if (imgCache.containsKey(entity.getId())) {\n+            //remove images that should be refreshed\n             imgCache.remove(entity.getId());\n         }\n \n         if (getTargetImage(entity) != null) {\n-            //convert image to base64, add to the <img> tag and store in cache\n+            //convert image to base64, add to to <img> tag and store in cache\n             Image image = ImageUtil.getScaledImage(getTargetImage(entity), 56, 48);\n             try {\n                 String base64Text;\n", "next_change": {"commit": "f304af7f7111e13d2177c65a0f76cf7533af12b3", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex ee30168f33..0122516e92 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1256,19 +1256,19 @@ public class Client implements IClientCommandHandler {\n      * Hashtable for storing <img> tags containing base64Text src.\n      */\n     protected void cacheImgTag(Entity entity) {\n-        if(entity == null) {\n+        if (entity == null) {\n             return;\n         }\n \n+        // remove images that should be refreshed\n         if (imgCache == null) {\n             imgCache = new Hashtable<>();\n-        } else if (imgCache.containsKey(entity.getId())) {\n-            //remove images that should be refreshed\n+        } else {\n             imgCache.remove(entity.getId());\n         }\n \n         if (getTargetImage(entity) != null) {\n-            //convert image to base64, add to to <img> tag and store in cache\n+            //convert image to base64, add to the <img> tag and store in cache\n             Image image = ImageUtil.getScaledImage(getTargetImage(entity), 56, 48);\n             try {\n                 String base64Text;\n", "next_change": {"commit": "2f31805840da3aec87ab248e781265acb449600a", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex 0122516e92..8e40eea15b 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1268,7 +1256,7 @@ public class Client implements IClientCommandHandler {\n         }\n \n         if (getTargetImage(entity) != null) {\n-            //convert image to base64, add to the <img> tag and store in cache\n+            // convert image to base64, add to the <img> tag and store in cache\n             Image image = ImageUtil.getScaledImage(getTargetImage(entity), 56, 48);\n             try {\n                 String base64Text;\n", "next_change": {"commit": "f25b35cf7a952d903500cab543aaa4d8f89e4b67", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex 8e40eea15b..350108348c 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1256,7 +1256,7 @@ public class Client implements IClientCommandHandler {\n         }\n \n         if (getTargetImage(entity) != null) {\n-            // convert image to base64, add to the <img> tag and store in cache\n+            //convert image to base64, add to the <img> tag and store in cache\n             Image image = ImageUtil.getScaledImage(getTargetImage(entity), 56, 48);\n             try {\n                 String base64Text;\n", "next_change": {"commit": "8e5d88919fee983ad68f8f1d8a30fa8a0dde12ca", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex 350108348c..e2275628a2 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1256,7 +1256,7 @@ public class Client implements IClientCommandHandler {\n         }\n \n         if (getTargetImage(entity) != null) {\n-            //convert image to base64, add to the <img> tag and store in cache\n+            // convert image to base64, add to the <img> tag and store in cache\n             Image image = ImageUtil.getScaledImage(getTargetImage(entity), 56, 48);\n             try {\n                 String base64Text;\n", "next_change": null}]}}]}}]}}]}}]}}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzMjYwNQ==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487232605", "body": "```suggestion\r\n                || (imgCache == null) || !imgCache.containsKey(id)) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            || imgCache == null || !imgCache.containsKey(id)) {\n          \n          \n            \n                            || (imgCache == null) || !imgCache.containsKey(id)) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-k\">||</span> imgCache <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span> <span class=\"pl-k\">||</span> <span class=\"pl-k\">!</span>imgCache<span class=\"pl-k\">.</span>containsKey(id)) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">||</span> <span class=\"x x-first x-last\">(</span>imgCache <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span><span class=\"x x-first x-last\">)</span> <span class=\"pl-k\">||</span> <span class=\"pl-k\">!</span>imgCache<span class=\"pl-k\">.</span>containsKey(id)) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-09-11T19:00:35Z", "path": "megamek/src/megamek/client/Client.java", "diffHunk": "@@ -1139,7 +1140,8 @@ public String receiveReport(Vector<Report> v) {\n      * returns the stored <img> tag for given unit id\n      */\n     private String getCachedImgTag(int id){\n-        if(imgCache == null || !imgCache.containsKey(id)) {\n+        if(!GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)\n+                || imgCache == null || !imgCache.containsKey(id)) {", "originalCommit": "a8661baf39ba5132071a85163c54905b8a6ac856", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex 055fd093cf..bbf172513d 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1140,8 +1140,8 @@ public class Client implements IClientCommandHandler {\n      * returns the stored <img> tag for given unit id\n      */\n     private String getCachedImgTag(int id){\n-        if(!GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)\n-                || imgCache == null || !imgCache.containsKey(id)) {\n+        if (!GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)\n+                || (imgCache == null) || !imgCache.containsKey(id)) {\n             return null;\n         }\n         return imgCache.get(id);\n", "next_change": {"commit": "26025434b5fac88760e9cdcf0c6308f8a28ca3e3", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex bbf172513d..eb80630f71 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1150,10 +1262,8 @@ public class Client implements IClientCommandHandler {\n     /**\n      * Hashtable for storing <img> tags containing base64Text src.\n      */\n-    private void cacheImgTag(Entity entity){\n-\n+    private void cacheImgTag(Entity entity) {\n         if(entity == null) {\n-            MegaMek.getLogger().error(this, \"Null entity reference\");\n             return;\n         }\n \n", "next_change": {"commit": "bb37d25aaa03ac72413d007f9e827fd13c66a322", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex eb80630f71..567247237e 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1262,7 +1262,7 @@ public class Client implements IClientCommandHandler {\n     /**\n      * Hashtable for storing <img> tags containing base64Text src.\n      */\n-    private void cacheImgTag(Entity entity) {\n+    protected void cacheImgTag(Entity entity) {\n         if(entity == null) {\n             return;\n         }\n", "next_change": {"commit": "cd93d149815865aef558382e7e8fc99f7e8411ef", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex 567247237e..27f16841dd 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1263,19 +1256,19 @@ public class Client implements IClientCommandHandler {\n      * Hashtable for storing <img> tags containing base64Text src.\n      */\n     protected void cacheImgTag(Entity entity) {\n-        if(entity == null) {\n+        if (entity == null) {\n             return;\n         }\n \n+        // remove images that should be refreshed\n         if (imgCache == null) {\n             imgCache = new Hashtable<>();\n-        } else if (imgCache.containsKey(entity.getId())) {\n-            //remove images that should be refreshed\n+        } else {\n             imgCache.remove(entity.getId());\n         }\n \n         if (getTargetImage(entity) != null) {\n-            //convert image to base64, add to to <img> tag and store in cache\n+            //convert image to base64, add to the <img> tag and store in cache\n             Image image = ImageUtil.getScaledImage(getTargetImage(entity), 56, 48);\n             try {\n                 String base64Text;\n", "next_change": {"commit": "5a06c5f191be279f1152f475f7d1a77a1b5b1c31", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex 27f16841dd..ee30168f33 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1256,19 +1256,19 @@ public class Client implements IClientCommandHandler {\n      * Hashtable for storing <img> tags containing base64Text src.\n      */\n     protected void cacheImgTag(Entity entity) {\n-        if (entity == null) {\n+        if(entity == null) {\n             return;\n         }\n \n-        // remove images that should be refreshed\n         if (imgCache == null) {\n             imgCache = new Hashtable<>();\n-        } else {\n+        } else if (imgCache.containsKey(entity.getId())) {\n+            //remove images that should be refreshed\n             imgCache.remove(entity.getId());\n         }\n \n         if (getTargetImage(entity) != null) {\n-            //convert image to base64, add to the <img> tag and store in cache\n+            //convert image to base64, add to to <img> tag and store in cache\n             Image image = ImageUtil.getScaledImage(getTargetImage(entity), 56, 48);\n             try {\n                 String base64Text;\n", "next_change": {"commit": "f304af7f7111e13d2177c65a0f76cf7533af12b3", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex ee30168f33..0122516e92 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1256,19 +1256,19 @@ public class Client implements IClientCommandHandler {\n      * Hashtable for storing <img> tags containing base64Text src.\n      */\n     protected void cacheImgTag(Entity entity) {\n-        if(entity == null) {\n+        if (entity == null) {\n             return;\n         }\n \n+        // remove images that should be refreshed\n         if (imgCache == null) {\n             imgCache = new Hashtable<>();\n-        } else if (imgCache.containsKey(entity.getId())) {\n-            //remove images that should be refreshed\n+        } else {\n             imgCache.remove(entity.getId());\n         }\n \n         if (getTargetImage(entity) != null) {\n-            //convert image to base64, add to to <img> tag and store in cache\n+            //convert image to base64, add to the <img> tag and store in cache\n             Image image = ImageUtil.getScaledImage(getTargetImage(entity), 56, 48);\n             try {\n                 String base64Text;\n", "next_change": {"commit": "2f31805840da3aec87ab248e781265acb449600a", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex 0122516e92..8e40eea15b 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1268,7 +1256,7 @@ public class Client implements IClientCommandHandler {\n         }\n \n         if (getTargetImage(entity) != null) {\n-            //convert image to base64, add to the <img> tag and store in cache\n+            // convert image to base64, add to the <img> tag and store in cache\n             Image image = ImageUtil.getScaledImage(getTargetImage(entity), 56, 48);\n             try {\n                 String base64Text;\n", "next_change": {"commit": "f25b35cf7a952d903500cab543aaa4d8f89e4b67", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex 8e40eea15b..350108348c 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1256,7 +1256,7 @@ public class Client implements IClientCommandHandler {\n         }\n \n         if (getTargetImage(entity) != null) {\n-            // convert image to base64, add to the <img> tag and store in cache\n+            //convert image to base64, add to the <img> tag and store in cache\n             Image image = ImageUtil.getScaledImage(getTargetImage(entity), 56, 48);\n             try {\n                 String base64Text;\n", "next_change": {"commit": "8e5d88919fee983ad68f8f1d8a30fa8a0dde12ca", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/Client.java b/megamek/src/megamek/client/Client.java\nindex 350108348c..e2275628a2 100644\n--- a/megamek/src/megamek/client/Client.java\n+++ b/megamek/src/megamek/client/Client.java\n", "chunk": "@@ -1256,7 +1256,7 @@ public class Client implements IClientCommandHandler {\n         }\n \n         if (getTargetImage(entity) != null) {\n-            //convert image to base64, add to the <img> tag and store in cache\n+            // convert image to base64, add to the <img> tag and store in cache\n             Image image = ImageUtil.getScaledImage(getTargetImage(entity), 56, 48);\n             try {\n                 String base64Text;\n", "next_change": null}]}}]}}]}}]}}]}}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzMjY4MQ==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487232681", "body": "```suggestion\r\n        if (image != null) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(image != null) {\n          \n          \n            \n                    if (image != null) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span>(image <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(image <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-09-11T19:00:45Z", "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -51,25 +51,32 @@ private void populateImage() {\n             cache = new Hashtable<>();\n             getDocument().putProperty(\"imageCache\", cache);\n         }\n-\n         URL src = getImageURL();\n-        cache.put(src, loadImage());\n-\n+        Image image = loadImage();\n+        if(image != null) {", "originalCommit": "a8661baf39ba5132071a85163c54905b8a6ac856", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 1b28787742..8efa395cea 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -53,7 +53,7 @@ public class BASE64ImageView extends ImageView {\n         }\n         URL src = getImageURL();\n         Image image = loadImage();\n-        if(image != null) {\n+        if (image != null) {\n             cache.put(src, image);\n         }\n     }\n", "next_change": {"commit": "2f31805840da3aec87ab248e781265acb449600a", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 8efa395cea..036bef0252 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -58,7 +59,7 @@ public class BASE64ImageView extends ImageView {\n         }\n     }\n \n-    //decodes the Base64 string into an image and returns it\n+    // decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n         if (b64 != null) {\n", "next_change": null}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzMjc1Ng==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487232756", "body": "```suggestion\r\n        if (b64 != null) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    if(b64 != null) {\n          \n          \n            \n                    if (b64 != null) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">if</span>(b64 <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(b64 <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-09-11T19:00:54Z", "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -51,25 +51,32 @@ private void populateImage() {\n             cache = new Hashtable<>();\n             getDocument().putProperty(\"imageCache\", cache);\n         }\n-\n         URL src = getImageURL();\n-        cache.put(src, loadImage());\n-\n+        Image image = loadImage();\n+        if(image != null) {\n+            cache.put(src, image);\n+        }\n     }\n \n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        BufferedImage newImage = null;\n-        ByteArrayInputStream bais = null;\n-        try {\n-            bais = new ByteArrayInputStream(\n-                    Base64.getDecoder().decode(b64.getBytes()));\n-            newImage = ImageIO.read(bais);\n-        } catch (Throwable ex) {\n-            ex.printStackTrace();\n+        if(b64 != null) {", "originalCommit": "a8661baf39ba5132071a85163c54905b8a6ac856", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "58b8c9cc3431375b3c8a877637fef5719c20e7c2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 1b28787742..a7fa0e71af 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -63,12 +63,9 @@ public class BASE64ImageView extends ImageView {\n         String b64 = getBASE64Image();\n         if(b64 != null) {\n             BufferedImage newImage = null;\n-            ByteArrayInputStream bais = null;\n-            try {\n-                bais = new ByteArrayInputStream(\n-                        Base64.getDecoder().decode(b64.getBytes()));\n+            try (ByteArrayInputStream bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n-                bais.close();\n             } catch (Throwable ex) {\n                 ex.printStackTrace();\n             }\n", "next_change": {"commit": "df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex a7fa0e71af..8efa395cea 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -61,18 +61,17 @@ public class BASE64ImageView extends ImageView {\n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        if(b64 != null) {\n+        if (b64 != null) {\n             BufferedImage newImage = null;\n             try (ByteArrayInputStream bais = new ByteArrayInputStream(\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n-            } catch (Throwable ex) {\n-                ex.printStackTrace();\n+            } catch (Exception ex) {\n+                MegaMek.getLogger(getClass(), \"loadImage\", ex);\n             }\n             return newImage;\n-        }\n-        else{\n-            return  null;\n+        } else {\n+            return null;\n         }\n     }\n \n", "next_change": {"commit": "c6ca70022320199f2c8075cf223638273f363818", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 8efa395cea..1ec9fac414 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -67,7 +69,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger(getClass(), \"loadImage\", ex);\n+                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "60cb19974d8a2c3188151f1e06227c7484c4d333", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 1ec9fac414..416157868a 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -69,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n+                MegaMek.getLogger().error(this, ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "a3705404f7857df886e37a668af2234d7d48ef6e", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 416157868a..79e9f09bdd 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(this, ex);\n+                MegaMek.getLogger().error(ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "eaaefe2f38ec268d385ab361225b918182e0693d", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 79e9f09bdd..2f97254111 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(ex);\n+                LogManager.getLogger().error(ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "77c3784bc07718bf23af8fc439af5e467ec0fb04", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 2f97254111..1e3be9cd9b 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                LogManager.getLogger().error(ex);\n+                LogManager.getLogger().error(\"\", ex);\n             }\n             return newImage;\n         } else {\n", "next_change": null}]}}]}}]}}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzNDQ5Nw==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487234497", "body": "```suggestion\r\n            } catch (Exception ex) {\r\n                MegaMek.getLogger(getClass(), \"loadImage\", ex);\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        } catch (Throwable ex) {\n          \n          \n            \n                            ex.printStackTrace();\n          \n          \n            \n                        } catch (Exception ex) {\n          \n          \n            \n                            MegaMek.getLogger(getClass(), \"loadImage\", ex);", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            } <span class=\"pl-k\">catch</span> (<span class=\"pl-smi x x-first x-last\">Throwable</span> ex) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"x x-first\">ex</span><span class=\"pl-k x\">.</span><span class=\"x x-last\">printStackTrace(</span>);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            } <span class=\"pl-k\">catch</span> (<span class=\"pl-smi x x-first x-last\">Exception</span> ex) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-smi x x-first\">MegaMek</span><span class=\"pl-k x\">.</span><span class=\"x\">getLogger(getClass(), </span><span class=\"pl-s\"><span class=\"pl-pds x\">\"</span><span class=\"x\">loadImage</span><span class=\"pl-pds x\">\"</span></span><span class=\"x x-last\">, ex</span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-09-11T19:04:38Z", "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -51,25 +51,32 @@ private void populateImage() {\n             cache = new Hashtable<>();\n             getDocument().putProperty(\"imageCache\", cache);\n         }\n-\n         URL src = getImageURL();\n-        cache.put(src, loadImage());\n-\n+        Image image = loadImage();\n+        if(image != null) {\n+            cache.put(src, image);\n+        }\n     }\n \n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        BufferedImage newImage = null;\n-        ByteArrayInputStream bais = null;\n-        try {\n-            bais = new ByteArrayInputStream(\n-                    Base64.getDecoder().decode(b64.getBytes()));\n-            newImage = ImageIO.read(bais);\n-        } catch (Throwable ex) {\n-            ex.printStackTrace();\n+        if(b64 != null) {\n+            BufferedImage newImage = null;\n+            ByteArrayInputStream bais = null;\n+            try {\n+                bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()));\n+                newImage = ImageIO.read(bais);\n+                bais.close();\n+            } catch (Throwable ex) {\n+                ex.printStackTrace();", "originalCommit": "a8661baf39ba5132071a85163c54905b8a6ac856", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "58b8c9cc3431375b3c8a877637fef5719c20e7c2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 1b28787742..a7fa0e71af 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -63,12 +63,9 @@ public class BASE64ImageView extends ImageView {\n         String b64 = getBASE64Image();\n         if(b64 != null) {\n             BufferedImage newImage = null;\n-            ByteArrayInputStream bais = null;\n-            try {\n-                bais = new ByteArrayInputStream(\n-                        Base64.getDecoder().decode(b64.getBytes()));\n+            try (ByteArrayInputStream bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n-                bais.close();\n             } catch (Throwable ex) {\n                 ex.printStackTrace();\n             }\n", "next_change": {"commit": "df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex a7fa0e71af..8efa395cea 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -61,18 +61,17 @@ public class BASE64ImageView extends ImageView {\n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        if(b64 != null) {\n+        if (b64 != null) {\n             BufferedImage newImage = null;\n             try (ByteArrayInputStream bais = new ByteArrayInputStream(\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n-            } catch (Throwable ex) {\n-                ex.printStackTrace();\n+            } catch (Exception ex) {\n+                MegaMek.getLogger(getClass(), \"loadImage\", ex);\n             }\n             return newImage;\n-        }\n-        else{\n-            return  null;\n+        } else {\n+            return null;\n         }\n     }\n \n", "next_change": {"commit": "c6ca70022320199f2c8075cf223638273f363818", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 8efa395cea..1ec9fac414 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -67,7 +69,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger(getClass(), \"loadImage\", ex);\n+                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "60cb19974d8a2c3188151f1e06227c7484c4d333", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 1ec9fac414..416157868a 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -69,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n+                MegaMek.getLogger().error(this, ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "a3705404f7857df886e37a668af2234d7d48ef6e", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 416157868a..79e9f09bdd 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(this, ex);\n+                MegaMek.getLogger().error(ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "eaaefe2f38ec268d385ab361225b918182e0693d", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 79e9f09bdd..2f97254111 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(ex);\n+                LogManager.getLogger().error(ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "77c3784bc07718bf23af8fc439af5e467ec0fb04", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 2f97254111..1e3be9cd9b 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                LogManager.getLogger().error(ex);\n+                LogManager.getLogger().error(\"\", ex);\n             }\n             return newImage;\n         } else {\n", "next_change": null}]}}]}}]}}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzNDU2Nw==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487234567", "body": "```suggestion\r\n        } else {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    }\n          \n          \n            \n                    else{\n          \n          \n            \n                    } else {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        }</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        <span class=\"pl-k\">else</span>{</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        } <span class=\"pl-k\">else</span> {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-09-11T19:04:48Z", "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -51,25 +51,32 @@ private void populateImage() {\n             cache = new Hashtable<>();\n             getDocument().putProperty(\"imageCache\", cache);\n         }\n-\n         URL src = getImageURL();\n-        cache.put(src, loadImage());\n-\n+        Image image = loadImage();\n+        if(image != null) {\n+            cache.put(src, image);\n+        }\n     }\n \n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        BufferedImage newImage = null;\n-        ByteArrayInputStream bais = null;\n-        try {\n-            bais = new ByteArrayInputStream(\n-                    Base64.getDecoder().decode(b64.getBytes()));\n-            newImage = ImageIO.read(bais);\n-        } catch (Throwable ex) {\n-            ex.printStackTrace();\n+        if(b64 != null) {\n+            BufferedImage newImage = null;\n+            ByteArrayInputStream bais = null;\n+            try {\n+                bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()));\n+                newImage = ImageIO.read(bais);\n+                bais.close();\n+            } catch (Throwable ex) {\n+                ex.printStackTrace();\n+            }\n+            return newImage;\n+        }\n+        else{", "originalCommit": "a8661baf39ba5132071a85163c54905b8a6ac856", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "58b8c9cc3431375b3c8a877637fef5719c20e7c2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 1b28787742..a7fa0e71af 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -63,12 +63,9 @@ public class BASE64ImageView extends ImageView {\n         String b64 = getBASE64Image();\n         if(b64 != null) {\n             BufferedImage newImage = null;\n-            ByteArrayInputStream bais = null;\n-            try {\n-                bais = new ByteArrayInputStream(\n-                        Base64.getDecoder().decode(b64.getBytes()));\n+            try (ByteArrayInputStream bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n-                bais.close();\n             } catch (Throwable ex) {\n                 ex.printStackTrace();\n             }\n", "next_change": {"commit": "df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex a7fa0e71af..8efa395cea 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -61,18 +61,17 @@ public class BASE64ImageView extends ImageView {\n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        if(b64 != null) {\n+        if (b64 != null) {\n             BufferedImage newImage = null;\n             try (ByteArrayInputStream bais = new ByteArrayInputStream(\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n-            } catch (Throwable ex) {\n-                ex.printStackTrace();\n+            } catch (Exception ex) {\n+                MegaMek.getLogger(getClass(), \"loadImage\", ex);\n             }\n             return newImage;\n-        }\n-        else{\n-            return  null;\n+        } else {\n+            return null;\n         }\n     }\n \n", "next_change": {"commit": "c6ca70022320199f2c8075cf223638273f363818", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 8efa395cea..1ec9fac414 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -67,7 +69,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger(getClass(), \"loadImage\", ex);\n+                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "60cb19974d8a2c3188151f1e06227c7484c4d333", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 1ec9fac414..416157868a 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -69,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n+                MegaMek.getLogger().error(this, ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "a3705404f7857df886e37a668af2234d7d48ef6e", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 416157868a..79e9f09bdd 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(this, ex);\n+                MegaMek.getLogger().error(ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "eaaefe2f38ec268d385ab361225b918182e0693d", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 79e9f09bdd..2f97254111 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(ex);\n+                LogManager.getLogger().error(ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "77c3784bc07718bf23af8fc439af5e467ec0fb04", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 2f97254111..1e3be9cd9b 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                LogManager.getLogger().error(ex);\n+                LogManager.getLogger().error(\"\", ex);\n             }\n             return newImage;\n         } else {\n", "next_change": null}]}}]}}]}}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzNDYzNg==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487234636", "body": "```suggestion\r\n            return null;\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        return  null;\n          \n          \n            \n                        return null;", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">return</span> <span class=\"x x-first x-last\"> </span><span class=\"pl-c1\">null</span>;</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">return</span> <span class=\"pl-c1\">null</span>;</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-09-11T19:04:54Z", "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -51,25 +51,32 @@ private void populateImage() {\n             cache = new Hashtable<>();\n             getDocument().putProperty(\"imageCache\", cache);\n         }\n-\n         URL src = getImageURL();\n-        cache.put(src, loadImage());\n-\n+        Image image = loadImage();\n+        if(image != null) {\n+            cache.put(src, image);\n+        }\n     }\n \n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        BufferedImage newImage = null;\n-        ByteArrayInputStream bais = null;\n-        try {\n-            bais = new ByteArrayInputStream(\n-                    Base64.getDecoder().decode(b64.getBytes()));\n-            newImage = ImageIO.read(bais);\n-        } catch (Throwable ex) {\n-            ex.printStackTrace();\n+        if(b64 != null) {\n+            BufferedImage newImage = null;\n+            ByteArrayInputStream bais = null;\n+            try {\n+                bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()));\n+                newImage = ImageIO.read(bais);\n+                bais.close();\n+            } catch (Throwable ex) {\n+                ex.printStackTrace();\n+            }\n+            return newImage;\n+        }\n+        else{\n+            return  null;", "originalCommit": "a8661baf39ba5132071a85163c54905b8a6ac856", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "58b8c9cc3431375b3c8a877637fef5719c20e7c2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 1b28787742..a7fa0e71af 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -63,12 +63,9 @@ public class BASE64ImageView extends ImageView {\n         String b64 = getBASE64Image();\n         if(b64 != null) {\n             BufferedImage newImage = null;\n-            ByteArrayInputStream bais = null;\n-            try {\n-                bais = new ByteArrayInputStream(\n-                        Base64.getDecoder().decode(b64.getBytes()));\n+            try (ByteArrayInputStream bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n-                bais.close();\n             } catch (Throwable ex) {\n                 ex.printStackTrace();\n             }\n", "next_change": {"commit": "df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex a7fa0e71af..8efa395cea 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -61,18 +61,17 @@ public class BASE64ImageView extends ImageView {\n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        if(b64 != null) {\n+        if (b64 != null) {\n             BufferedImage newImage = null;\n             try (ByteArrayInputStream bais = new ByteArrayInputStream(\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n-            } catch (Throwable ex) {\n-                ex.printStackTrace();\n+            } catch (Exception ex) {\n+                MegaMek.getLogger(getClass(), \"loadImage\", ex);\n             }\n             return newImage;\n-        }\n-        else{\n-            return  null;\n+        } else {\n+            return null;\n         }\n     }\n \n", "next_change": {"commit": "c6ca70022320199f2c8075cf223638273f363818", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 8efa395cea..1ec9fac414 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -67,7 +69,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger(getClass(), \"loadImage\", ex);\n+                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "60cb19974d8a2c3188151f1e06227c7484c4d333", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 1ec9fac414..416157868a 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -69,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n+                MegaMek.getLogger().error(this, ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "a3705404f7857df886e37a668af2234d7d48ef6e", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 416157868a..79e9f09bdd 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(this, ex);\n+                MegaMek.getLogger().error(ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "eaaefe2f38ec268d385ab361225b918182e0693d", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 79e9f09bdd..2f97254111 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(ex);\n+                LogManager.getLogger().error(ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "77c3784bc07718bf23af8fc439af5e467ec0fb04", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 2f97254111..1e3be9cd9b 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                LogManager.getLogger().error(ex);\n+                LogManager.getLogger().error(\"\", ex);\n             }\n             return newImage;\n         } else {\n", "next_change": null}]}}]}}]}}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzNTE0NQ==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487235145", "body": "Can this be done through try with properties?", "bodyText": "Can this be done through try with properties?", "bodyHTML": "<p dir=\"auto\">Can this be done through try with properties?</p>", "author": "Windchild292", "createdAt": "2020-09-11T19:06:00Z", "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -51,25 +51,32 @@ private void populateImage() {\n             cache = new Hashtable<>();\n             getDocument().putProperty(\"imageCache\", cache);\n         }\n-\n         URL src = getImageURL();\n-        cache.put(src, loadImage());\n-\n+        Image image = loadImage();\n+        if(image != null) {\n+            cache.put(src, image);\n+        }\n     }\n \n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        BufferedImage newImage = null;\n-        ByteArrayInputStream bais = null;\n-        try {\n-            bais = new ByteArrayInputStream(\n-                    Base64.getDecoder().decode(b64.getBytes()));\n-            newImage = ImageIO.read(bais);\n-        } catch (Throwable ex) {\n-            ex.printStackTrace();\n+        if(b64 != null) {\n+            BufferedImage newImage = null;\n+            ByteArrayInputStream bais = null;\n+            try {\n+                bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()));\n+                newImage = ImageIO.read(bais);\n+                bais.close();", "originalCommit": "a8661baf39ba5132071a85163c54905b8a6ac856", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgyNTcyMA==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r488825720", "bodyText": "That's a good call, I'll write it in.", "author": "Krashner", "createdAt": "2020-09-15T17:07:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzNTE0NQ=="}], "type": "inlineReview", "revised_code": {"commit": "58b8c9cc3431375b3c8a877637fef5719c20e7c2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 1b28787742..a7fa0e71af 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -63,12 +63,9 @@ public class BASE64ImageView extends ImageView {\n         String b64 = getBASE64Image();\n         if(b64 != null) {\n             BufferedImage newImage = null;\n-            ByteArrayInputStream bais = null;\n-            try {\n-                bais = new ByteArrayInputStream(\n-                        Base64.getDecoder().decode(b64.getBytes()));\n+            try (ByteArrayInputStream bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n-                bais.close();\n             } catch (Throwable ex) {\n                 ex.printStackTrace();\n             }\n", "next_change": {"commit": "df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex a7fa0e71af..8efa395cea 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -61,18 +61,17 @@ public class BASE64ImageView extends ImageView {\n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        if(b64 != null) {\n+        if (b64 != null) {\n             BufferedImage newImage = null;\n             try (ByteArrayInputStream bais = new ByteArrayInputStream(\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n-            } catch (Throwable ex) {\n-                ex.printStackTrace();\n+            } catch (Exception ex) {\n+                MegaMek.getLogger(getClass(), \"loadImage\", ex);\n             }\n             return newImage;\n-        }\n-        else{\n-            return  null;\n+        } else {\n+            return null;\n         }\n     }\n \n", "next_change": {"commit": "c6ca70022320199f2c8075cf223638273f363818", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 8efa395cea..1ec9fac414 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -67,7 +69,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger(getClass(), \"loadImage\", ex);\n+                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "60cb19974d8a2c3188151f1e06227c7484c4d333", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 1ec9fac414..416157868a 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -69,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n+                MegaMek.getLogger().error(this, ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "a3705404f7857df886e37a668af2234d7d48ef6e", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 416157868a..79e9f09bdd 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(this, ex);\n+                MegaMek.getLogger().error(ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "eaaefe2f38ec268d385ab361225b918182e0693d", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 79e9f09bdd..2f97254111 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(ex);\n+                LogManager.getLogger().error(ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "77c3784bc07718bf23af8fc439af5e467ec0fb04", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 2f97254111..1e3be9cd9b 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                LogManager.getLogger().error(ex);\n+                LogManager.getLogger().error(\"\", ex);\n             }\n             return newImage;\n         } else {\n", "next_change": null}]}}]}}]}}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzNTQzNg==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487235436", "body": "```suggestion\r\n            if ((indentation <= Report.DEFAULT_INDENTATION) || showImage) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if(indentation <= Report.DEFAULT_INDENTATION || showImage) {\n          \n          \n            \n                        if ((indentation <= Report.DEFAULT_INDENTATION) || showImage) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">if</span><span class=\"x x-first x-last\">(</span>indentation <span class=\"pl-k\">&lt;=</span> <span class=\"pl-smi\">Report</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>DEFAULT_INDENTATION</span> <span class=\"pl-k\">||</span> showImage) {</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> ((</span>indentation <span class=\"pl-k\">&lt;=</span> <span class=\"pl-smi\">Report</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>DEFAULT_INDENTATION</span><span class=\"x x-first x-last\">)</span> <span class=\"pl-k\">||</span> showImage) {</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-09-11T19:06:34Z", "path": "megamek/src/megamek/common/Report.java", "diffHunk": "@@ -314,9 +313,8 @@ public void choose(boolean choice) {\n      */\n     public void addDesc(Entity entity) {\n         if (entity != null) {\n-            if(GUIPreferences.getInstance().getBoolean(GUIPreferences.ADVANCED_ROUND_REPORT_SPRITES)\n-                    && (indentation <= Report.DEFAULT_INDENTATION || showImage)) {\n-                imageCode = \"<span id='\" +entity.getId() + \"'></span>\";\n+            if(indentation <= Report.DEFAULT_INDENTATION || showImage) {", "originalCommit": "a8661baf39ba5132071a85163c54905b8a6ac856", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex fa09cd5ba2..9b31b48b1a 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -313,7 +313,7 @@ public class Report implements Serializable {\n      */\n     public void addDesc(Entity entity) {\n         if (entity != null) {\n-            if(indentation <= Report.DEFAULT_INDENTATION || showImage) {\n+            if ((indentation <= Report.DEFAULT_INDENTATION) || showImage) {\n                 imageCode = \"<span id='\" + entity.getId() + \"'></span>\";\n             }\n             add(\"<font color='0xffffff'><a href=\\\"#entity:\" + entity.getId()\n", "next_change": {"commit": "444fc4eb49ba82071111ee113356d22eb378aed8", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex 9b31b48b1a..7245c279a1 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -318,9 +315,7 @@ public class Report implements Serializable {\n             }\n             add(\"<font color='0xffffff'><a href=\\\"#entity:\" + entity.getId()\n                     + \"\\\">\" + entity.getShortName() + \"</a></font>\", true);\n-            String colorcode = Integer.toHexString(PlayerColors.getColor(\n-                    entity.getOwner().getColorIndex()).getRGB() & 0x00f0f0f0);\n-            add(\"<B><font color='\" + colorcode + \"'>\"\n+            add(\"<B><font color='\" + entity.getOwner().getColour().getHexString() + \"'>\"\n                     + entity.getOwner().getName() + \"</font></B>\");\n         }\n     }\n", "next_change": {"commit": "68a23ae3076d0f06f5f3667ecb1d35ee03f8a978", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex 7245c279a1..c373ff825e 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -315,7 +315,7 @@ public class Report implements Serializable {\n             }\n             add(\"<font color='0xffffff'><a href=\\\"#entity:\" + entity.getId()\n                     + \"\\\">\" + entity.getShortName() + \"</a></font>\", true);\n-            add(\"<B><font color='\" + entity.getOwner().getColour().getHexString() + \"'>\"\n+            add(\"<B><font color='\" + entity.getOwner().getColour().getHexString(0x00F0F0F0) + \"'>\"\n                     + entity.getOwner().getName() + \"</font></B>\");\n         }\n     }\n", "next_change": {"commit": "e02ab980e68ec00403b16f6d5d4ba680393c8ddc", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex c373ff825e..2c940813c3 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -313,7 +323,7 @@ public class Report implements Serializable {\n             if ((indentation <= Report.DEFAULT_INDENTATION) || showImage) {\n                 imageCode = \"<span id='\" + entity.getId() + \"'></span>\";\n             }\n-            add(\"<font color='0xffffff'><a href=\\\"#entity:\" + entity.getId()\n+            add(\"<font color='0xffffff'><a href=\\\"\" + ENTITY_LINK + entity.getId()\n                     + \"\\\">\" + entity.getShortName() + \"</a></font>\", true);\n             add(\"<B><font color='\" + entity.getOwner().getColour().getHexString(0x00F0F0F0) + \"'>\"\n                     + entity.getOwner().getName() + \"</font></B>\");\n", "next_change": {"commit": "688a032d9ed3934a235722a20c3245dd3fec27f1", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex 2c940813c3..db832eb93b 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -323,17 +334,23 @@ public class Report implements Serializable {\n             if ((indentation <= Report.DEFAULT_INDENTATION) || showImage) {\n                 imageCode = \"<span id='\" + entity.getId() + \"'></span>\";\n             }\n-            add(\"<font color='0xffffff'><a href=\\\"\" + ENTITY_LINK + entity.getId()\n-                    + \"\\\">\" + entity.getShortName() + \"</a></font>\", true);\n-            add(\"<B><font color='\" + entity.getOwner().getColour().getHexString(0x00F0F0F0) + \"'>\"\n-                    + entity.getOwner().getName() + \"</font></B>\");\n+            String name = \"<font color='0xffffff'><a href=\\\"\" + ENTITY_LINK + entity.getId()\n+                    + \"\\\">\" + entity.getShortName() + \"</a></font>\";\n+            String color = entity.getOwner().getColour().getHexString(0x00F0F0F0);\n+\n+            if ((entity.getCrew().getSize() >= 1) && !entity.getCrew().getNickname().isBlank()) {\n+                // pilot nickname, also known as callsign\n+                name += \" <font color='\"+color+\"'>\\\"\" + entity.getCrew().getNickname().toUpperCase() + \"\\\"</font>\";\n+            }\n+            add(name, true);\n+            add(\"<B><font color='\" + color + \"'>\" + entity.getOwner().getName() + \"</font></B>\");\n         }\n     }\n \n     /**\n      * Manually Toggle if the report should show an image of the entity\n     */\n-    public void setShowImage(boolean showImage){\n+    public void setShowImage(boolean showImage) {\n         this.showImage = showImage;\n     }\n \n", "next_change": null}]}}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzIzNTY4MA==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r487235680", "body": "```suggestion\r\n            if (!imageCode.isEmpty()) {\r\n                if (text.toString().startsWith(\"\\n\")) {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if(!imageCode.isEmpty()){\n          \n          \n            \n                            if(text.toString().startsWith(\"\\n\")){\n          \n          \n            \n                        if (!imageCode.isEmpty()) {\n          \n          \n            \n                            if (text.toString().startsWith(\"\\n\")) {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">            <span class=\"pl-k\">if</span>(<span class=\"pl-k\">!</span>imageCode<span class=\"pl-k\">.</span>isEmpty()){</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-k\">if</span>(text<span class=\"pl-k\">.</span>toString()<span class=\"pl-k\">.</span>startsWith(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-cce\">\\n</span><span class=\"pl-pds\">\"</span></span>)){</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">            <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(<span class=\"pl-k\">!</span>imageCode<span class=\"pl-k\">.</span>isEmpty())<span class=\"x x-first x-last\"> </span>{</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(text<span class=\"pl-k\">.</span>toString()<span class=\"pl-k\">.</span>startsWith(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-cce\">\\n</span><span class=\"pl-pds\">\"</span></span>))<span class=\"x x-first x-last\"> </span>{</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-09-11T19:07:03Z", "path": "megamek/src/megamek/common/Report.java", "diffHunk": "@@ -487,9 +485,9 @@ public String getText() {\n                 }\n                 i++;\n             }\n-            //draw the sprite at the beginning of the line\n-            if(imageCode != null && imageCode.length() > 0){\n-                if(text.substring(0,1).equals(\"\\n\")){\n+            //add the sprite code at the beginning of the line\n+            if(!imageCode.isEmpty()){\n+                if(text.toString().startsWith(\"\\n\")){", "originalCommit": "a8661baf39ba5132071a85163c54905b8a6ac856", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex fa09cd5ba2..9b31b48b1a 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -486,8 +486,8 @@ public class Report implements Serializable {\n                 i++;\n             }\n             //add the sprite code at the beginning of the line\n-            if(!imageCode.isEmpty()){\n-                if(text.toString().startsWith(\"\\n\")){\n+            if (!imageCode.isEmpty()) {\n+                if (text.toString().startsWith(\"\\n\")) {\n                     text.insert(1, imageCode);\n                 }\n                 else {\n", "next_change": {"commit": "6a950a5947b58f5b5a284a6130d6ccf54e6c7bbf", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex 9b31b48b1a..1926865cb0 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -486,7 +486,7 @@ public class Report implements Serializable {\n                 i++;\n             }\n             //add the sprite code at the beginning of the line\n-            if (!imageCode.isEmpty()) {\n+            if (imageCode != null && !imageCode.isEmpty()) {\n                 if (text.toString().startsWith(\"\\n\")) {\n                     text.insert(1, imageCode);\n                 }\n", "next_change": {"commit": "2f31805840da3aec87ab248e781265acb449600a", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex 1926865cb0..39342e9fa3 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -473,19 +484,18 @@ public class Report implements Serializable {\n                                     raw.indexOf(',', i) + 1, endTagIdx)));\n                         }\n                         tagCounter++;\n-                    } else if (raw.substring(i + 1, endTagIdx)\n-                            .equals(\"newline\")) {\n+                    } else if (raw.substring(i + 1, endTagIdx).equals(\"newline\")) {\n                         text.append(\"\\n\");\n                     } else {\n                         // not a special tag, so treat as literal text\n-                        text.append(raw.substring(i, endTagIdx + 1));\n+                        text.append(raw, i, endTagIdx + 1);\n                     }\n                     mark = endTagIdx + 1;\n                     i = endTagIdx;\n                 }\n                 i++;\n             }\n-            //add the sprite code at the beginning of the line\n+            // add the sprite code at the beginning of the line\n             if (imageCode != null && !imageCode.isEmpty()) {\n                 if (text.toString().startsWith(\"\\n\")) {\n                     text.insert(1, imageCode);\n", "next_change": {"commit": "f25b35cf7a952d903500cab543aaa4d8f89e4b67", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex 39342e9fa3..0b5fedea85 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -495,7 +494,7 @@ public class Report implements Serializable {\n                 }\n                 i++;\n             }\n-            // add the sprite code at the beginning of the line\n+            //add the sprite code at the beginning of the line\n             if (imageCode != null && !imageCode.isEmpty()) {\n                 if (text.toString().startsWith(\"\\n\")) {\n                     text.insert(1, imageCode);\n", "next_change": {"commit": "83da84722acade26b94667d0e6e1007ae31ac978", "changed_code": [{"header": "diff --git a/megamek/src/megamek/common/Report.java b/megamek/src/megamek/common/Report.java\nindex 0b5fedea85..58036819b7 100755\n--- a/megamek/src/megamek/common/Report.java\n+++ b/megamek/src/megamek/common/Report.java\n", "chunk": "@@ -494,7 +495,7 @@ public class Report implements Serializable {\n                 }\n                 i++;\n             }\n-            //add the sprite code at the beginning of the line\n+            // add the sprite code at the beginning of the line\n             if (imageCode != null && !imageCode.isEmpty()) {\n                 if (text.toString().startsWith(\"\\n\")) {\n                     text.insert(1, imageCode);\n", "next_change": null}]}}]}}]}}]}}]}}, {"oid": "58b8c9cc3431375b3c8a877637fef5719c20e7c2", "url": "https://github.com/MegaMek/megamek/commit/58b8c9cc3431375b3c8a877637fef5719c20e7c2", "message": "Added requested change to loadImage", "committedDate": "2020-09-15T17:05:17Z", "type": "commit"}, {"oid": "df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "url": "https://github.com/MegaMek/megamek/commit/df19b0fd53cbd3f31123fa74f9ff85abdc26dfb2", "message": "Apply suggestions from code review\n\nCo-authored-by: Justin Bowen <39067288+Windchild292@users.noreply.github.com>", "committedDate": "2020-09-15T17:06:01Z", "type": "commit"}, {"oid": "c6ca70022320199f2c8075cf223638273f363818", "url": "https://github.com/MegaMek/megamek/commit/c6ca70022320199f2c8075cf223638273f363818", "message": "Added missing reference and slight code change", "committedDate": "2020-09-15T17:14:08Z", "type": "commit"}, {"oid": "e50b4ae6a4f3d1be4d0375a63bbf116017f6d8b7", "url": "https://github.com/MegaMek/megamek/commit/e50b4ae6a4f3d1be4d0375a63bbf116017f6d8b7", "message": "Removed line", "committedDate": "2020-09-15T17:16:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODgzMjM4NQ==", "url": "https://github.com/MegaMek/megamek/pull/2202#discussion_r488832385", "body": "```suggestion\r\n                MegaMek.getLogger().error(this, ex);\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n          \n          \n            \n                            MegaMek.getLogger().error(this, ex);", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-smi\">MegaMek</span><span class=\"pl-k\">.</span>getLogger()<span class=\"pl-k\">.</span>error(<span class=\"pl-c1\">this</span><span class=\"pl-k x x-first\">.</span><span class=\"x\">getClass(), </span><span class=\"pl-s\"><span class=\"pl-pds x\">\"</span><span class=\"x\">loadImage()</span><span class=\"pl-pds x x-last\">\"</span></span>, ex);</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-smi\">MegaMek</span><span class=\"pl-k\">.</span>getLogger()<span class=\"pl-k\">.</span>error(<span class=\"pl-c1\">this</span>, ex);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "Windchild292", "createdAt": "2020-09-15T17:19:41Z", "path": "megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java", "diffHunk": "@@ -53,29 +54,25 @@ private void populateImage() {\n         }\n         URL src = getImageURL();\n         Image image = loadImage();\n-        if(image != null) {\n+        if (image != null) {\n             cache.put(src, image);\n         }\n     }\n \n     //decodes the Base64 string into an image and returns it\n     private Image loadImage() {\n         String b64 = getBASE64Image();\n-        if(b64 != null) {\n+        if (b64 != null) {\n             BufferedImage newImage = null;\n-            ByteArrayInputStream bais = null;\n-            try {\n-                bais = new ByteArrayInputStream(\n-                        Base64.getDecoder().decode(b64.getBytes()));\n+            try (ByteArrayInputStream bais = new ByteArrayInputStream(\n+                        Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n-                bais.close();\n-            } catch (Throwable ex) {\n-                ex.printStackTrace();\n+            } catch (Exception ex) {\n+                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);", "originalCommit": "e50b4ae6a4f3d1be4d0375a63bbf116017f6d8b7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "60cb19974d8a2c3188151f1e06227c7484c4d333", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 45a353dea8..416157868a 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(this.getClass(), \"loadImage()\", ex);\n+                MegaMek.getLogger().error(this, ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "a3705404f7857df886e37a668af2234d7d48ef6e", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 416157868a..79e9f09bdd 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(this, ex);\n+                MegaMek.getLogger().error(ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "eaaefe2f38ec268d385ab361225b918182e0693d", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 79e9f09bdd..2f97254111 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                MegaMek.getLogger().error(ex);\n+                LogManager.getLogger().error(ex);\n             }\n             return newImage;\n         } else {\n", "next_change": {"commit": "77c3784bc07718bf23af8fc439af5e467ec0fb04", "changed_code": [{"header": "diff --git a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\nindex 2f97254111..1e3be9cd9b 100644\n--- a/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n+++ b/megamek/src/megamek/client/ui/swing/util/BASE64ImageView.java\n", "chunk": "@@ -68,7 +68,7 @@ public class BASE64ImageView extends ImageView {\n                         Base64.getDecoder().decode(b64.getBytes()))) {\n                 newImage = ImageIO.read(bais);\n             } catch (Exception ex) {\n-                LogManager.getLogger().error(ex);\n+                LogManager.getLogger().error(\"\", ex);\n             }\n             return newImage;\n         } else {\n", "next_change": null}]}}]}}]}}]}}, {"oid": "60cb19974d8a2c3188151f1e06227c7484c4d333", "url": "https://github.com/MegaMek/megamek/commit/60cb19974d8a2c3188151f1e06227c7484c4d333", "message": "Add suggested change\n\nCo-authored-by: Justin Bowen <39067288+Windchild292@users.noreply.github.com>", "committedDate": "2020-09-15T18:34:03Z", "type": "commit"}]}