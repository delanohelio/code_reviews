{"pr_number": 3360, "pr_title": "TRUNK-5816: Migrate api package tests to Junit5 4", "pr_author": "achilep", "pr_createdAt": "2020-07-14T23:19:47Z", "pr_url": "https://github.com/openmrs/openmrs-core/pull/3360", "timeline": [{"oid": "5e4dce59f2f8c99d4da50d973360263c9c73e02d", "url": "https://github.com/openmrs/openmrs-core/commit/5e4dce59f2f8c99d4da50d973360263c9c73e02d", "message": "TRUNK-5816: Migrate api package tests to Junit5", "committedDate": "2020-07-15T07:03:31Z", "type": "forcePushed"}, {"oid": "f9f817d4a1ebe3de33fdbb58f38999269a46f407", "url": "https://github.com/openmrs/openmrs-core/commit/f9f817d4a1ebe3de33fdbb58f38999269a46f407", "message": "TRUNK-5816: Migrate api package tests to Junit5", "committedDate": "2020-07-15T07:12:31Z", "type": "forcePushed"}, {"oid": "a86e3246359b44a78a1754fa8c2beecb3221f41d", "url": "https://github.com/openmrs/openmrs-core/commit/a86e3246359b44a78a1754fa8c2beecb3221f41d", "message": "TRUNK-5816: Migrate api package tests to Junit5", "committedDate": "2020-07-15T16:03:31Z", "type": "forcePushed"}, {"oid": "53a415746f2362a5951a7e122952d366a09c3051", "url": "https://github.com/openmrs/openmrs-core/commit/53a415746f2362a5951a7e122952d366a09c3051", "message": "TRUNK-5816: Migrate api package tests to Junit 5", "committedDate": "2020-07-15T16:51:00Z", "type": "commit"}, {"oid": "53a415746f2362a5951a7e122952d366a09c3051", "url": "https://github.com/openmrs/openmrs-core/commit/53a415746f2362a5951a7e122952d366a09c3051", "message": "TRUNK-5816: Migrate api package tests to Junit 5", "committedDate": "2020-07-15T16:51:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxMzg5Nw==", "url": "https://github.com/openmrs/openmrs-core/pull/3360#discussion_r455213897", "body": "You seem to be going back to JUnit 4. Was that intentional?", "bodyText": "You seem to be going back to JUnit 4. Was that intentional?", "bodyHTML": "<p dir=\"auto\">You seem to be going back to JUnit 4. Was that intentional?</p>", "author": "teleivo", "createdAt": "2020-07-15T17:26:44Z", "path": "api/src/test/java/org/openmrs/api/UserServiceTest.java", "diffHunk": "@@ -11,13 +11,12 @@\n \n import static org.hamcrest.CoreMatchers.is;\n import static org.hamcrest.MatcherAssert.assertThat;\n-import static org.junit.jupiter.api.Assertions.assertEquals;\n-import static org.junit.jupiter.api.Assertions.assertFalse;\n-import static org.junit.jupiter.api.Assertions.assertNotNull;\n-import static org.junit.jupiter.api.Assertions.assertNotSame;\n-import static org.junit.jupiter.api.Assertions.assertNull;\n-import static org.junit.jupiter.api.Assertions.assertThrows;\n-import static org.junit.jupiter.api.Assertions.assertTrue;\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertNotNull;\n+import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertThrows;\n+import static org.junit.Assert.assertTrue;", "originalCommit": "53a415746f2362a5951a7e122952d366a09c3051", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIzOTIwOQ==", "url": "https://github.com/openmrs/openmrs-core/pull/3360#discussion_r455239209", "bodyText": "yes is to correct this Error UserServiceTest.getAllUsers_shouldNotContainsAnyDuplicateUsers:680 expected: <11> but was: <12>\nfor now", "author": "achilep", "createdAt": "2020-07-15T18:00:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxMzg5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI0MjIyMg==", "url": "https://github.com/openmrs/openmrs-core/pull/3360#discussion_r455242222", "bodyText": "Do you mean that we get this error on JUnit 5 but not JUnit 4?", "author": "teleivo", "createdAt": "2020-07-15T18:05:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxMzg5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI1Nzg5Nw==", "url": "https://github.com/openmrs/openmrs-core/pull/3360#discussion_r455257897", "bodyText": "please remove this file from the PR. tests for it on JUnit 5 are green on Bamboo and the Travis CI build on master https://travis-ci.org/github/openmrs/openmrs-core/builds/708421471", "author": "teleivo", "createdAt": "2020-07-15T18:30:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxMzg5Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI1OTA4NA==", "url": "https://github.com/openmrs/openmrs-core/pull/3360#discussion_r455259084", "bodyText": "also see my suggestions you added some lines that have to be removed.", "author": "teleivo", "createdAt": "2020-07-15T18:32:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTIxMzg5Nw=="}], "type": "inlineReview", "revised_code": {"commit": "357e320dce7f237381cd06f604dcf7aeb8304861", "changed_code": [{"header": "diff --git a/api/src/test/java/org/openmrs/api/UserServiceTest.java b/api/src/test/java/org/openmrs/api/UserServiceTest.java\nindex fde46fbab..252121fff 100644\n--- a/api/src/test/java/org/openmrs/api/UserServiceTest.java\n+++ b/api/src/test/java/org/openmrs/api/UserServiceTest.java\n", "chunk": "@@ -11,12 +11,13 @@ package org.openmrs.api;\n \n import static org.hamcrest.CoreMatchers.is;\n import static org.hamcrest.MatcherAssert.assertThat;\n-import static org.junit.Assert.assertEquals;\n-import static org.junit.Assert.assertFalse;\n-import static org.junit.Assert.assertNotNull;\n-import static org.junit.Assert.assertNull;\n-import static org.junit.Assert.assertThrows;\n-import static org.junit.Assert.assertTrue;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertFalse;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+import static org.junit.jupiter.api.Assertions.assertNotSame;\n+import static org.junit.jupiter.api.Assertions.assertNull;\n+import static org.junit.jupiter.api.Assertions.assertThrows;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n import static org.openmrs.test.TestUtil.containsId;\n \n import java.sql.SQLException;\n", "next_change": {"commit": "f469f2c5d501ccb5032618ccbb6e53c007838aab", "changed_code": [{"header": "diff --git a/api/src/test/java/org/openmrs/api/UserServiceTest.java b/api/src/test/java/org/openmrs/api/UserServiceTest.java\nindex 252121fff..c102e799e 100644\n--- a/api/src/test/java/org/openmrs/api/UserServiceTest.java\n+++ b/api/src/test/java/org/openmrs/api/UserServiceTest.java\n", "chunk": "@@ -26,6 +26,7 @@ import java.util.Collections;\n import java.util.HashMap;\n import java.util.HashSet;\n import java.util.List;\n+import java.util.Locale;\n import java.util.Map;\n import java.util.Set;\n \n", "next_change": {"commit": "155aec64bc7f631e35ed5f12f74eb75dbf5dbde8", "changed_code": [{"header": "diff --git a/api/src/test/java/org/openmrs/api/UserServiceTest.java b/api/src/test/java/org/openmrs/api/UserServiceTest.java\nindex c102e799e..9e0a9bbc0 100644\n--- a/api/src/test/java/org/openmrs/api/UserServiceTest.java\n+++ b/api/src/test/java/org/openmrs/api/UserServiceTest.java\n", "chunk": "@@ -31,6 +31,7 @@ import java.util.Map;\n import java.util.Set;\n \n import org.apache.commons.lang3.reflect.FieldUtils;\n+import org.junit.Ignore;\n import org.junit.jupiter.api.AfterAll;\n import org.junit.jupiter.api.BeforeEach;\n import org.junit.jupiter.api.Disabled;\n", "next_change": {"commit": "8486acd739bf92998e81c5c3ab078d51b4a11658", "changed_code": [{"header": "diff --git a/api/src/test/java/org/openmrs/api/UserServiceTest.java b/api/src/test/java/org/openmrs/api/UserServiceTest.java\nindex 9e0a9bbc0..2a40adb51 100644\n--- a/api/src/test/java/org/openmrs/api/UserServiceTest.java\n+++ b/api/src/test/java/org/openmrs/api/UserServiceTest.java\n", "chunk": "@@ -31,7 +31,6 @@ import java.util.Map;\n import java.util.Set;\n \n import org.apache.commons.lang3.reflect.FieldUtils;\n-import org.junit.Ignore;\n import org.junit.jupiter.api.AfterAll;\n import org.junit.jupiter.api.BeforeEach;\n import org.junit.jupiter.api.Disabled;\n", "next_change": null}]}}]}}]}}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI1NDkwMg==", "url": "https://github.com/openmrs/openmrs-core/pull/3360#discussion_r455254902", "body": "```suggestion\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n            \t\t\tassertTrue(order.getAction() == Action.DISCONTINUE);", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t\tassertTrue(order<span class=\"pl-k\">.</span>getAction() <span class=\"pl-k\">==</span> <span class=\"pl-smi\">Action</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>DISCONTINUE</span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "teleivo", "createdAt": "2020-07-15T18:25:27Z", "path": "api/src/test/java/org/openmrs/api/OrderServiceTest.java", "diffHunk": "@@ -2268,6 +2238,9 @@ public void getOrders_shouldreturnDiscontinuedOrders() {\n \t\tassertEquals(2, orders.size());\n \t\tfor (Order order : orders) {\n \t\t\tassertEquals(DISCONTINUE, order.getAction());\n+\n+\t\t\tassertTrue(order.getAction() == Action.DISCONTINUE);\n+", "originalCommit": "53a415746f2362a5951a7e122952d366a09c3051", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "72a584d0a3b07712be7bc4431b997fbafbc1fe28", "changed_code": [{"header": "diff --git a/api/src/test/java/org/openmrs/api/OrderServiceTest.java b/api/src/test/java/org/openmrs/api/OrderServiceTest.java\nindex b86763c63..cb5ad93ae 100644\n--- a/api/src/test/java/org/openmrs/api/OrderServiceTest.java\n+++ b/api/src/test/java/org/openmrs/api/OrderServiceTest.java\n", "chunk": "@@ -2238,9 +2235,6 @@ public class OrderServiceTest extends BaseContextSensitiveTest {\n \t\tassertEquals(2, orders.size());\n \t\tfor (Order order : orders) {\n \t\t\tassertEquals(DISCONTINUE, order.getAction());\n-\n-\t\t\tassertTrue(order.getAction() == Action.DISCONTINUE);\n-\n \t\t}\n \t}\n \n", "next_change": null}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI1NTE5Ng==", "url": "https://github.com/openmrs/openmrs-core/pull/3360#discussion_r455255196", "body": "```suggestion\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \n          \n          \n            \n            \t\t\tassertTrue(order.getFulfillerStatus() == Order.FulfillerStatus.COMPLETED);", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"></td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">\t\t\tassertTrue(order<span class=\"pl-k\">.</span>getFulfillerStatus() <span class=\"pl-k\">==</span> <span class=\"pl-smi\">Order</span><span class=\"pl-k\">.</span><span class=\"pl-smi\">FulfillerStatus</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>COMPLETED</span>);</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "teleivo", "createdAt": "2020-07-15T18:25:48Z", "path": "api/src/test/java/org/openmrs/api/OrderServiceTest.java", "diffHunk": "@@ -2215,7 +2181,10 @@ public void getOrders_shouldreturnOrdersWithFulfillerStatusCompleted() {\n \t\tList<Order> orders = orderService.getOrders(orderSearchCriteria);\n \t\tassertEquals(1, orders.size());\n \t\tfor (Order order : orders) {\n+\n \t\t\tassertEquals(COMPLETED, order.getFulfillerStatus());\n+\n+\t\t\tassertTrue(order.getFulfillerStatus() == Order.FulfillerStatus.COMPLETED);", "originalCommit": "53a415746f2362a5951a7e122952d366a09c3051", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "72a584d0a3b07712be7bc4431b997fbafbc1fe28", "changed_code": [{"header": "diff --git a/api/src/test/java/org/openmrs/api/OrderServiceTest.java b/api/src/test/java/org/openmrs/api/OrderServiceTest.java\nindex b86763c63..cb5ad93ae 100644\n--- a/api/src/test/java/org/openmrs/api/OrderServiceTest.java\n+++ b/api/src/test/java/org/openmrs/api/OrderServiceTest.java\n", "chunk": "@@ -2181,10 +2181,7 @@ public class OrderServiceTest extends BaseContextSensitiveTest {\n \t\tList<Order> orders = orderService.getOrders(orderSearchCriteria);\n \t\tassertEquals(1, orders.size());\n \t\tfor (Order order : orders) {\n-\n \t\t\tassertEquals(COMPLETED, order.getFulfillerStatus());\n-\n-\t\t\tassertTrue(order.getFulfillerStatus() == Order.FulfillerStatus.COMPLETED);\n \t\t}\n \t}\n \n", "next_change": null}]}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTI1NTI1NQ==", "url": "https://github.com/openmrs/openmrs-core/pull/3360#discussion_r455255255", "body": "```suggestion\r\n```", "bodyText": "Suggested change", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "teleivo", "createdAt": "2020-07-15T18:25:54Z", "path": "api/src/test/java/org/openmrs/api/OrderServiceTest.java", "diffHunk": "@@ -2215,7 +2181,10 @@ public void getOrders_shouldreturnOrdersWithFulfillerStatusCompleted() {\n \t\tList<Order> orders = orderService.getOrders(orderSearchCriteria);\n \t\tassertEquals(1, orders.size());\n \t\tfor (Order order : orders) {\n+", "originalCommit": "53a415746f2362a5951a7e122952d366a09c3051", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "72a584d0a3b07712be7bc4431b997fbafbc1fe28", "changed_code": [{"header": "diff --git a/api/src/test/java/org/openmrs/api/OrderServiceTest.java b/api/src/test/java/org/openmrs/api/OrderServiceTest.java\nindex b86763c63..cb5ad93ae 100644\n--- a/api/src/test/java/org/openmrs/api/OrderServiceTest.java\n+++ b/api/src/test/java/org/openmrs/api/OrderServiceTest.java\n", "chunk": "@@ -2181,10 +2181,7 @@ public class OrderServiceTest extends BaseContextSensitiveTest {\n \t\tList<Order> orders = orderService.getOrders(orderSearchCriteria);\n \t\tassertEquals(1, orders.size());\n \t\tfor (Order order : orders) {\n-\n \t\t\tassertEquals(COMPLETED, order.getFulfillerStatus());\n-\n-\t\t\tassertTrue(order.getFulfillerStatus() == Order.FulfillerStatus.COMPLETED);\n \t\t}\n \t}\n \n", "next_change": null}]}}, {"oid": "e67f20099b2b6ac3ead3f62758ba6f1f87693065", "url": "https://github.com/openmrs/openmrs-core/commit/e67f20099b2b6ac3ead3f62758ba6f1f87693065", "message": "Update api/src/test/java/org/openmrs/api/OrderServiceTest.java", "committedDate": "2020-07-15T18:34:32Z", "type": "commit"}, {"oid": "0d18e8327a30dd0e161cbd5c9ffe215fddf5e022", "url": "https://github.com/openmrs/openmrs-core/commit/0d18e8327a30dd0e161cbd5c9ffe215fddf5e022", "message": "Update api/src/test/java/org/openmrs/api/OrderServiceTest.java", "committedDate": "2020-07-15T18:34:40Z", "type": "commit"}, {"oid": "326d720326ad08462965fbe5193d374ee19f5b33", "url": "https://github.com/openmrs/openmrs-core/commit/326d720326ad08462965fbe5193d374ee19f5b33", "message": "Update api/src/test/java/org/openmrs/api/OrderServiceTest.java", "committedDate": "2020-07-15T18:34:54Z", "type": "commit"}]}