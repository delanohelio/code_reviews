{"pr_number": 5879, "pr_title": "Fixes making paths of linked files relative (web urls will not be touched anymore)", "pr_author": "systemoperator", "pr_createdAt": "2020-01-27T19:28:00Z", "pr_url": "https://github.com/JabRef/jabref/pull/5879", "timeline": [{"oid": "8ad6f233e647a0d6d246ce044c6760fe8ab73818", "url": "https://github.com/JabRef/jabref/commit/8ad6f233e647a0d6d246ce044c6760fe8ab73818", "message": "Fixes #5861\nDescription:\n- Cleanup entries: \"Make paths of linked files relative (if possible)\" broke web URLs and resulted in various other issues subsequently. This PR fixes this issue.\nIt has been tested for local files and web urls.", "committedDate": "2020-01-27T18:57:02Z", "type": "commit"}, {"oid": "f033dbfbba9d04165577493b2ad0ac9aaca30e37", "url": "https://github.com/JabRef/jabref/commit/f033dbfbba9d04165577493b2ad0ac9aaca30e37", "message": "changelog updated", "committedDate": "2020-01-28T10:38:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTkxMjkwMQ==", "url": "https://github.com/JabRef/jabref/pull/5879#discussion_r371912901", "body": "The class `LinkedFile` already contains a method that does this job:\r\nhttps://github.com/JabRef/jabref/blob/8520833e684aa9e305dd8745e45696ffd6d984fb/src/main/java/org/jabref/model/entry/LinkedFile.java#L162-L164\r\nCan you please use it. I would also suggest to add the normalization `trim().toLowerCase()` there, which I find a nice addition.", "bodyText": "The class LinkedFile already contains a method that does this job:\n\n  \n    \n      jabref/src/main/java/org/jabref/model/entry/LinkedFile.java\n    \n    \n        Lines 162 to 164\n      in\n      8520833\n    \n    \n    \n    \n\n        \n          \n           public boolean isOnlineLink() { \n        \n\n        \n          \n               return isOnlineLink(link.get()); \n        \n\n        \n          \n           } \n        \n    \n  \n\n\nCan you please use it. I would also suggest to add the normalization trim().toLowerCase() there, which I find a nice addition.", "bodyHTML": "<p dir=\"auto\">The class <code>LinkedFile</code> already contains a method that does this job:<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom color-bg-subtle\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/JabRef/jabref/blob/8520833e684aa9e305dd8745e45696ffd6d984fb/src/main/java/org/jabref/model/entry/LinkedFile.java#L162-L164\">jabref/src/main/java/org/jabref/model/entry/LinkedFile.java</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 162 to 164\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/JabRef/jabref/commit/8520833e684aa9e305dd8745e45696ffd6d984fb\">8520833</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L162\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"162\"></td>\n          <td id=\"LC162\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">public</span> <span class=\"pl-k\">boolean</span> <span class=\"pl-en\">isOnlineLink</span>() { </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L163\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"163\"></td>\n          <td id=\"LC163\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-k\">return</span> isOnlineLink(link<span class=\"pl-k\">.</span>get()); </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L164\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"164\"></td>\n          <td id=\"LC164\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> } </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<br>\nCan you please use it. I would also suggest to add the normalization <code>trim().toLowerCase()</code> there, which I find a nice addition.</p>", "author": "tobiasdiez", "createdAt": "2020-01-28T16:28:47Z", "path": "src/main/java/org/jabref/logic/cleanup/RelativePathsCleanup.java", "diffHunk": "@@ -57,4 +64,21 @@ public RelativePathsCleanup(BibDatabaseContext databaseContext, FilePreferences\n         return Collections.emptyList();\n     }\n \n+    /**\n+     * Checks, if the given file path is a well-formed web url\n+     *\n+     * @param filePath file path to check\n+     * @return <code>true</code>, if the given file path is a web url, <code>false</code> otherwise\n+     */\n+    private static boolean isWebUrl(String filePath)", "originalCommit": "f033dbfbba9d04165577493b2ad0ac9aaca30e37", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTkyNDY0Mw==", "url": "https://github.com/JabRef/jabref/pull/5879#discussion_r371924643", "bodyText": "Concerning isOnlineLink(): I would recommend removing \"toCheck.contains(\"www.\")\", because a path to a local file might contain this pattern coincidentally. What do you say?", "author": "systemoperator", "createdAt": "2020-01-28T16:47:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTkxMjkwMQ=="}], "type": "inlineReview"}, {"oid": "4adfdc5b0833e2f3a4a131d0c3ec11087d208bd8", "url": "https://github.com/JabRef/jabref/commit/4adfdc5b0833e2f3a4a131d0c3ec11087d208bd8", "message": "refactoring: use existing method isOnlineLink() for checking whether a file link is an online link; improving isOnlineLink()", "committedDate": "2020-01-28T21:13:13Z", "type": "commit"}]}