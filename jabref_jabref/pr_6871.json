{"pr_number": 6871, "pr_title": "fixed 'copy key and link'", "pr_author": "PremKolar", "pr_createdAt": "2020-09-04T11:19:36Z", "pr_url": "https://github.com/JabRef/jabref/pull/6871", "timeline": [{"oid": "865c8f28d6d3467e98f5f4034f4119776d3663b3", "url": "https://github.com/JabRef/jabref/commit/865c8f28d6d3467e98f5f4034f4119776d3663b3", "message": "'copy key and link' from right-click menu creates a string that is not a url. it includes the url, but it also includes the key... it works now", "committedDate": "2020-09-04T11:12:43Z", "type": "commit"}, {"oid": "04843f02cb3eedbcd08f1e283806c42a56903c4d", "url": "https://github.com/JabRef/jabref/commit/04843f02cb3eedbcd08f1e283806c42a56903c4d", "message": "updated authorlist", "committedDate": "2020-09-04T15:16:23Z", "type": "commit"}, {"oid": "e7e3a172694c75de918b95c50cbec59480d264c7", "url": "https://github.com/JabRef/jabref/commit/e7e3a172694c75de918b95c50cbec59480d264c7", "message": "added entry to change log", "committedDate": "2020-09-04T15:26:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDM5OQ==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r483840399", "body": "This really puts the html string into the clipboard, so if you paste it into say notepad you get `<a href=\"url\">key</a>`. Instead, its better to add the html, and in addition also a fallback string of the format `key - url`. In this way, you get the desired behavior also when you paste in applications that do understand html (e.g onenote).\r\n\r\nIn order for this to work, you probably need to add a second fallback argument to\r\nhttps://github.com/JabRef/jabref/blob/3db431321186535cc9a05ceae8b1fa580585a9c0/src/main/java/org/jabref/gui/ClipBoardManager.java#L140-L145\r\nwhich is then added to the ClipboardContent via `putString`.  ", "bodyText": "This really puts the html string into the clipboard, so if you paste it into say notepad you get <a href=\"url\">key</a>. Instead, its better to add the html, and in addition also a fallback string of the format key - url. In this way, you get the desired behavior also when you paste in applications that do understand html (e.g onenote).\nIn order for this to work, you probably need to add a second fallback argument to\n\n  \n    \n      jabref/src/main/java/org/jabref/gui/ClipBoardManager.java\n    \n    \n        Lines 140 to 145\n      in\n      3db4313\n    \n    \n    \n    \n\n        \n          \n           public void setHtmlContent(String html) { \n        \n\n        \n          \n               final ClipboardContent content = new ClipboardContent(); \n        \n\n        \n          \n               content.putHtml(html); \n        \n\n        \n          \n               clipboard.setContent(content); \n        \n\n        \n          \n               setPrimaryClipboardContent(content); \n        \n\n        \n          \n           } \n        \n    \n  \n\n\nwhich is then added to the ClipboardContent via putString.", "bodyHTML": "<p dir=\"auto\">This really puts the html string into the clipboard, so if you paste it into say notepad you get <code>&lt;a href=\"url\"&gt;key&lt;/a&gt;</code>. Instead, its better to add the html, and in addition also a fallback string of the format <code>key - url</code>. In this way, you get the desired behavior also when you paste in applications that do understand html (e.g onenote).</p>\n<p dir=\"auto\">In order for this to work, you probably need to add a second fallback argument to<br>\n<div class=\"border rounded-1 my-2\">\n  <div class=\"f6 px-3 py-2 lh-condensed border-bottom color-bg-subtle\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/JabRef/jabref/blob/3db431321186535cc9a05ceae8b1fa580585a9c0/src/main/java/org/jabref/gui/ClipBoardManager.java#L140-L145\">jabref/src/main/java/org/jabref/gui/ClipBoardManager.java</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 140 to 145\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/JabRef/jabref/commit/3db431321186535cc9a05ceae8b1fa580585a9c0\">3db4313</a>\n    </p>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L140\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"140\"></td>\n          <td id=\"LC140\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"pl-en\">setHtmlContent</span>(<span class=\"pl-smi\">String</span> <span class=\"pl-v\">html</span>) { </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L141\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"141\"></td>\n          <td id=\"LC141\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-k\">final</span> <span class=\"pl-smi\">ClipboardContent</span> content <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">ClipboardContent</span>(); </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L142\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"142\"></td>\n          <td id=\"LC142\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     content<span class=\"pl-k\">.</span>putHtml(html); </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L143\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"143\"></td>\n          <td id=\"LC143\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     clipboard<span class=\"pl-k\">.</span>setContent(content); </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L144\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"144\"></td>\n          <td id=\"LC144\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     setPrimaryClipboardContent(content); </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L145\" class=\"blob-num border-0 px-3 py-0 color-bg-default js-line-number\" data-line-number=\"145\"></td>\n          <td id=\"LC145\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> } </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<br>\nwhich is then added to the ClipboardContent via <code>putString</code>.</p>", "author": "tobiasdiez", "createdAt": "2020-09-04T20:55:45Z", "path": "src/main/java/org/jabref/gui/edit/CopyMoreAction.java", "diffHunk": "@@ -224,7 +224,7 @@ private void copyKeyAndLink() {\n             keyAndLink.append(OS.NEWLINE);\n         }\n \n-        clipBoardManager.setHtmlContent(keyAndLink.toString());\n+        clipBoardManager.setContent(keyAndLink.toString());", "originalCommit": "e7e3a172694c75de918b95c50cbec59480d264c7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzkyMTM1NA==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r483921354", "bodyText": "Hi @tobiasdiez !\nAh ok that makes sense.. I guess I should have looked deeper into what setHtmlContent() actually does.. I assumed it would be applicable for url's on their own only. So that means, both, setContent() and setHtmlContent() should be called?\nSorry for my noobness! This was my first open-source contribution ever :D\nCan I fix the issue tonight (German time) and commit the changes?\nthanks,\nNiko", "author": "PremKolar", "createdAt": "2020-09-05T07:13:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDM5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzkyMzU2OQ==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r483923569", "bodyText": "No worries, you were on the right track. Calling setContent and setHtmlContent is the right idea, but I suspect that this will push two different clipboard items. Instead, the setHtmlContent should be modified as follows:\npublic void setHtmlContent(String html, String fallbackPlain) { \n     final ClipboardContent content = new ClipboardContent(); \n     content.putHtml(html);\n     content.putString(fallbackPlain);\n     clipboard.setContent(content); \n     setPrimaryClipboardContent(content); \n }\n\nThis should add one clipboard item, containing both the html as well as the normal string. (I hope)\nLet me know if you encounter any further questions. There is not such a thing as noobness. We all can learn more. And learning in a relaxed environment is one of the main points of open source, so don't worry. Happy coding!", "author": "tobiasdiez", "createdAt": "2020-09-05T07:41:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDM5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk4MDE4NA==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r483980184", "bodyText": "but I suspect that this will push two different clipboard items.\n\nThat was exactly my next thought :)\nOk, I will try..\nThanks for the kind words!", "author": "PremKolar", "createdAt": "2020-09-05T19:24:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDM5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk4OTM4Nw==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r483989387", "bodyText": "alright, i hope i did what you meant. I have to say, I still don't understand why copyKeyAndLink() creates html content for the clipboard, but e.g. copyKeyAndTitle() does not?\ncheers,\nNiko", "author": "PremKolar", "createdAt": "2020-09-05T20:58:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0MDM5OQ=="}], "type": "inlineReview"}, {"oid": "77fed3145e408143ab76930aba5173ba46897436", "url": "https://github.com/JabRef/jabref/commit/77fed3145e408143ab76930aba5173ba46897436", "message": "'copy key and link' now sets html content again and also sets a fallback string", "committedDate": "2020-09-05T20:55:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQyMzAzOQ==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r488423039", "body": "Please remove the comment", "bodyText": "Please remove the comment", "bodyHTML": "<p dir=\"auto\">Please remove the comment</p>", "author": "koppor", "createdAt": "2020-09-15T06:43:19Z", "path": "src/main/java/org/jabref/gui/ClipBoardManager.java", "diffHunk": "@@ -144,6 +144,15 @@ public void setHtmlContent(String html) {\n         setPrimaryClipboardContent(content);\n     }\n \n+    //@overload", "originalCommit": "77fed3145e408143ab76930aba5173ba46897436", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDc1ODU0Mw==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r490758543", "bodyText": "Can the old setHtmlContent method be removed? If it's still used by other code, it might be a good idea to provide a fallback string in these cases as well. What do you think?", "author": "tobiasdiez", "createdAt": "2020-09-18T07:35:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQyMzAzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDg5NzI2Mw==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r490897263", "bodyText": "Hi Tobias,\nIf I am not mistaken, there is no usage of setHtmlContent(String html) anywhere...\nOnly setHtmlContent(String html, String fallbackPlain) is used once on line 230 of CopyMoreAction.java.\nShould I remove the unused version?", "author": "PremKolar", "createdAt": "2020-09-18T11:52:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQyMzAzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTY1NzU5OQ==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r491657599", "bodyText": "Yes, just remove the the unused method.", "author": "koppor", "createdAt": "2020-09-20T06:10:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQyMzAzOQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQyMzQ4Mw==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r488423483", "body": "Please fix checkstyle\r\n\r\n```suggestion\r\n        clipBoardManager.setHtmlContent(keyAndLink.toString(), fallbackString.toString());\r\n```", "bodyText": "Please fix checkstyle\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    clipBoardManager.setHtmlContent(keyAndLink.toString(),fallbackString.toString());\n          \n          \n            \n                    clipBoardManager.setHtmlContent(keyAndLink.toString(), fallbackString.toString());", "bodyHTML": "<p dir=\"auto\">Please fix checkstyle</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">        clipBoardManager<span class=\"pl-k\">.</span>setHtmlContent(keyAndLink<span class=\"pl-k\">.</span>toString(),fallbackString<span class=\"pl-k\">.</span>toString());</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">        clipBoardManager<span class=\"pl-k\">.</span>setHtmlContent(keyAndLink<span class=\"pl-k\">.</span>toString(),<span class=\"x x-first x-last\"> </span>fallbackString<span class=\"pl-k\">.</span>toString());</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "koppor", "createdAt": "2020-09-15T06:44:18Z", "path": "src/main/java/org/jabref/gui/edit/CopyMoreAction.java", "diffHunk": "@@ -222,9 +223,11 @@ private void copyKeyAndLink() {\n             String url = entry.getField(StandardField.URL).orElse(\"\");\n             keyAndLink.append(url.isEmpty() ? key : String.format(\"<a href=\\\"%s\\\">%s</a>\", url, key));\n             keyAndLink.append(OS.NEWLINE);\n+            fallbackString.append(url.isEmpty() ? key : String.format(\"%s - %s\", key, url));\n+            fallbackString.append(OS.NEWLINE);\n         }\n \n-        clipBoardManager.setHtmlContent(keyAndLink.toString());\n+        clipBoardManager.setHtmlContent(keyAndLink.toString(),fallbackString.toString());", "originalCommit": "77fed3145e408143ab76930aba5173ba46897436", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDUwMDYzNg==", "url": "https://github.com/JabRef/jabref/pull/6871#discussion_r490500636", "bodyText": "Hi Koppor,\nI implemented your change requests!\nOne question:\nHow can check the \"checkstyle\" myself?", "author": "PremKolar", "createdAt": "2020-09-17T19:23:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODQyMzQ4Mw=="}], "type": "inlineReview"}, {"oid": "409a4162c7189165d92886fc8d9b8e2c29fc0946", "url": "https://github.com/JabRef/jabref/commit/409a4162c7189165d92886fc8d9b8e2c29fc0946", "message": "Update src/main/java/org/jabref/gui/edit/CopyMoreAction.java\n\nCo-authored-by: Oliver Kopp <kopp.dev@gmail.com>", "committedDate": "2020-09-15T07:43:23Z", "type": "commit"}, {"oid": "d022875ba0e9e02e16722b73897126c8fd79946b", "url": "https://github.com/JabRef/jabref/commit/d022875ba0e9e02e16722b73897126c8fd79946b", "message": "Merge branch 'master' into #5835_copyKeyAndLink", "committedDate": "2020-09-17T19:25:29Z", "type": "commit"}, {"oid": "2449d2a56e73290a6465177f679301888b768315", "url": "https://github.com/JabRef/jabref/commit/2449d2a56e73290a6465177f679301888b768315", "message": "CHANGELOG.md", "committedDate": "2020-09-29T06:32:47Z", "type": "commit"}, {"oid": "ce505364e44b9e97bb894773c98cc100af862013", "url": "https://github.com/JabRef/jabref/commit/ce505364e44b9e97bb894773c98cc100af862013", "message": "Remove obsolete method\n\nRemove obsolete method", "committedDate": "2020-09-29T06:48:21Z", "type": "commit"}]}