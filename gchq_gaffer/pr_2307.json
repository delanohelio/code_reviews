{"pr_number": 2307, "pr_title": "Gh 2306 fix serialisation issue", "pr_author": "d47853", "pr_createdAt": "2020-09-16T09:36:08Z", "pr_url": "https://github.com/gchq/Gaffer/pull/2307", "timeline": [{"oid": "a97ea68bb2fb9ec75ca1737c52dc8a9d47bb1a5d", "url": "https://github.com/gchq/Gaffer/commit/a97ea68bb2fb9ec75ca1737c52dc8a9d47bb1a5d", "message": "gh-2306 fixed failing tests in federated store", "committedDate": "2020-09-15T09:29:00Z", "type": "commit"}, {"oid": "ed7672c678d9f2ffb6aff2bf0beef7c3d2719d96", "url": "https://github.com/gchq/Gaffer/commit/ed7672c678d9f2ffb6aff2bf0beef7c3d2719d96", "message": "gh-2306 improved serialisation logic for NamedOperationDetail", "committedDate": "2020-09-15T16:24:23Z", "type": "commit"}, {"oid": "0022baa66d616abe3b1c8ac36a77747077d92286", "url": "https://github.com/gchq/Gaffer/commit/0022baa66d616abe3b1c8ac36a77747077d92286", "message": "gh-2306 applied fix to NamedOperationDetail and FederatedAccess", "committedDate": "2020-09-16T07:53:21Z", "type": "commit"}, {"oid": "b76dfe2320b0987cfd4728119f1935c9ac7fbdd7", "url": "https://github.com/gchq/Gaffer/commit/b76dfe2320b0987cfd4728119f1935c9ac7fbdd7", "message": "Fixed tests and checkstyle", "committedDate": "2020-09-16T09:34:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA3NzgwOA==", "url": "https://github.com/gchq/Gaffer/pull/2307#discussion_r490077808", "body": "This isn't used\r\n```suggestion\r\n```", "bodyText": "This isn't used\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            import com.google.common.collect.Maps;", "bodyHTML": "<p dir=\"auto\">This isn't used</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"25\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"><span class=\"pl-k x x-first\">import</span><span class=\"x\"> </span><span class=\"pl-smi x\">com.google.common.collect.Maps</span><span class=\"x x-last\">;</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "m29827", "createdAt": "2020-09-17T08:49:13Z", "path": "core/data/src/main/java/uk/gov/gchq/gaffer/data/elementdefinition/view/NamedViewDetail.java", "diffHunk": "@@ -18,7 +18,10 @@\n \n import com.fasterxml.jackson.annotation.JsonIgnore;\n import com.fasterxml.jackson.annotation.JsonInclude;\n+import com.fasterxml.jackson.annotation.JsonProperty;\n import com.fasterxml.jackson.annotation.JsonPropertyOrder;\n+import com.fasterxml.jackson.databind.annotation.JsonDeserialize;\n+import com.fasterxml.jackson.databind.annotation.JsonPOJOBuilder;\n import com.google.common.collect.Maps;", "originalCommit": "e31cff0ce6528c310d9acca6c113f1b4d5ac6d2f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA4MjkyNQ==", "url": "https://github.com/gchq/Gaffer/pull/2307#discussion_r490082925", "bodyText": "I just pushed up a commit that reverted the removal of the Maps.newHashMap() call so the import is now used", "author": "d47853", "createdAt": "2020-09-17T08:56:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA3NzgwOA=="}], "type": "inlineReview"}, {"oid": "154ec2712772f045bd510356030317bcf47ebd23", "url": "https://github.com/gchq/Gaffer/commit/154ec2712772f045bd510356030317bcf47ebd23", "message": "gh-2306 fixed tests", "committedDate": "2020-09-17T08:50:23Z", "type": "commit"}, {"oid": "154ec2712772f045bd510356030317bcf47ebd23", "url": "https://github.com/gchq/Gaffer/commit/154ec2712772f045bd510356030317bcf47ebd23", "message": "gh-2306 fixed tests", "committedDate": "2020-09-17T08:50:23Z", "type": "forcePushed"}, {"oid": "d7dd226ce73cf7e4fe2a27f3e41fced6152fd792", "url": "https://github.com/gchq/Gaffer/commit/d7dd226ce73cf7e4fe2a27f3e41fced6152fd792", "message": "gh-2306 fixed failing test", "committedDate": "2020-09-17T09:31:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDEyOTc1NQ==", "url": "https://github.com/gchq/Gaffer/pull/2307#discussion_r490129755", "body": "Maybe remove this\r\n```suggestion\r\n```", "bodyText": "Maybe remove this\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    System.out.println(new String(JSONSerialiser.serialise(allowBlankUserAndTestUserReadAccess, true)));", "bodyHTML": "<p dir=\"auto\">Maybe remove this</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\"><span class=\"x x-first\">        </span><span class=\"pl-smi x\">System</span><span class=\"pl-k x\">.</span><span class=\"x\">out</span><span class=\"pl-k x\">.</span><span class=\"x\">println(</span><span class=\"pl-k x\">new</span><span class=\"x\"> </span><span class=\"pl-smi x\">String</span><span class=\"x\">(</span><span class=\"pl-smi x\">JSONSerialiser</span><span class=\"pl-k x\">.</span><span class=\"x\">serialise(allowBlankUserAndTestUserReadAccess, </span><span class=\"pl-c1 x\">true</span><span class=\"x x-last\">)));</span></td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "m29827", "createdAt": "2020-09-17T10:12:21Z", "path": "store-implementation/federated-store/src/test/java/uk/gov/gchq/gaffer/federatedstore/operation/handler/impl/FederatedAddGraphWithHooksHandlerTest.java", "diffHunk": "@@ -388,10 +393,12 @@ public void shouldAddGraphWithCustomReadAccessPredicate() throws Exception {\n \n         assertEquals(0, store.getGraphs(testUser, null, ignore).size());\n \n-        final AccessPredicate allowBlankUserAndTestUserReadAccess = new AccessPredicate((user) -> {\n-            return user.getUserId().equals(blankUser.getUserId()) || user.getUserId().equals(testUser.getUserId());\n-        });\n+        final AccessPredicate allowBlankUserAndTestUserReadAccess = new AccessPredicate(new AdaptedPredicate(\n+                new CallMethod(\"getUserId\"),\n+                new Or<>(new IsEqual(testUser.getUserId()), new IsEqual(blankUser.getUserId()))\n+        ));\n \n+        System.out.println(new String(JSONSerialiser.serialise(allowBlankUserAndTestUserReadAccess, true)));", "originalCommit": "154ec2712772f045bd510356030317bcf47ebd23", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"oid": "dc8d90e14b71029d59515d2881d47dda179a23d4", "url": "https://github.com/gchq/Gaffer/commit/dc8d90e14b71029d59515d2881d47dda179a23d4", "message": "Apply suggestions from code review\n\nCo-authored-by: m29827 <62667809+m29827@users.noreply.github.com>", "committedDate": "2020-09-17T11:01:11Z", "type": "commit"}, {"oid": "1a09daf9a1b994f5c9a372ff698c554fd364ca96", "url": "https://github.com/gchq/Gaffer/commit/1a09daf9a1b994f5c9a372ff698c554fd364ca96", "message": "Merge branch 'develop' into gh-2306-fix-serialisation-issue", "committedDate": "2020-09-17T11:02:42Z", "type": "commit"}, {"oid": "917105ce03d238e0ffc1906b745540216d1e9db2", "url": "https://github.com/gchq/Gaffer/commit/917105ce03d238e0ffc1906b745540216d1e9db2", "message": "gh-2306 removed unused import", "committedDate": "2020-09-17T11:29:47Z", "type": "commit"}]}