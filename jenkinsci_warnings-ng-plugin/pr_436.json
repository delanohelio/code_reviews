{"pr_number": 436, "pr_title": "[JENKINS-56594] - Hide empty trend charts", "pr_author": "ColinWlodkowski", "pr_createdAt": "2020-04-07T19:06:17Z", "pr_url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436", "timeline": [{"oid": "f28e21f94b95a9e3dd9c501f2368e6cf15b40546", "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/f28e21f94b95a9e3dd9c501f2368e6cf15b40546", "message": "Candidate Solution for Jenkins-56594. Displays congratulation if no warnings", "committedDate": "2020-04-07T18:59:03Z", "type": "commit"}, {"oid": "898b4e0b65b8e9c00226de35c450a1b58b869075", "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/898b4e0b65b8e9c00226de35c450a1b58b869075", "message": "Update floatingBox.jelly", "committedDate": "2020-04-08T19:00:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMDcxNg==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406100716", "body": "```suggestion\r\n    public boolean hasNoIssues() {\r\n```", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                public boolean noWarnings(){\n          \n          \n            \n                public boolean hasNoIssues() {", "bodyHTML": "  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">boolean</span> <span class=\"x x-first x-last\">noWarnings()</span>{</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">boolean</span> <span class=\"x x-first x-last\">hasNoIssues() </span>{</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "uhafner", "createdAt": "2020-04-09T10:11:32Z", "path": "plugin/src/main/java/io/jenkins/plugins/analysis/core/model/JobAction.java", "diffHunk": "@@ -202,6 +206,20 @@ public boolean isTrendVisible() {\n         return trendChartType != TrendChartType.NONE && createBuildHistory().hasMultipleResults();\n     }\n \n+    public boolean noWarnings(){", "originalCommit": "898b4e0b65b8e9c00226de35c450a1b58b869075", "replyToReviewId": null, "replies": null, "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMTUyNQ==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406101525", "body": "This check should not be necessary ", "bodyText": "This check should not be necessary", "bodyHTML": "<p dir=\"auto\">This check should not be necessary</p>", "author": "uhafner", "createdAt": "2020-04-09T10:12:56Z", "path": "plugin/src/main/java/io/jenkins/plugins/analysis/core/model/JobAction.java", "diffHunk": "@@ -202,6 +206,20 @@ public boolean isTrendVisible() {\n         return trendChartType != TrendChartType.NONE && createBuildHistory().hasMultipleResults();\n     }\n \n+    public boolean noWarnings(){\n+        History results =createBuildHistory(); //Get past build history\n+        if(results instanceof AnalysisHistory){", "originalCommit": "898b4e0b65b8e9c00226de35c450a1b58b869075", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI4MDIzNg==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406280236", "bodyText": "As far as I understand, createBuildHistory() could return two types of objects: NullAnalysisHistory or AnalysisHistory. When NullAnalysisHistory is returned, it means there is no build history, so we are going to return true directly. If it's AnalysisHistory, we will start iterating through it.", "author": "Allancgx", "createdAt": "2020-04-09T15:16:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMTUyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjMxMTkyOQ==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406311929", "bodyText": "But this is the clue of the NullObjectPattern, you really do not need to care: your algorithm will terminate with true anyway since there are no build results.", "author": "uhafner", "createdAt": "2020-04-09T16:03:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMTUyNQ=="}], "type": "inlineReview"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMzY3MA==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406103670", "body": "All warnings are included in total. Or what exactly do you want to achieve with the subtraction?\r\n```suggestion\r\n                if (nextResult.getResult().getTotalSize() > 0) {\r\n```", "bodyText": "All warnings are included in total. Or what exactly do you want to achieve with the subtraction?\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            if(nextResult.getResult().getTotalSize() - nextResult.getResult().getTotalSizeOf(Severity.ERROR) != 0){\n          \n          \n            \n                            if (nextResult.getResult().getTotalSize() > 0) {", "bodyHTML": "<p dir=\"auto\">All warnings are included in total. Or what exactly do you want to achieve with the subtraction?</p>\n  <div class=\"my-2 border rounded-1 js-suggested-changes-blob diff-view js-check-bidi\" id=\"\">\n    <div class=\"f6 p-2 lh-condensed border-bottom d-flex\">\n      <div class=\"flex-auto flex-items-center color-fg-muted\">\n        Suggested change\n        <span class=\"tooltipped tooltipped-multiline tooltipped-s\" aria-label=\"This code change can be committed by users with write permissions.\">\n          <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-info hide-sm\">\n    <path fill-rule=\"evenodd\" d=\"M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z\"></path>\n</svg>\n        </span>\n      </div>\n    </div>\n    <div itemprop=\"text\" class=\"blob-wrapper data file\" style=\"margin: 0; border: none; overflow-y: visible; overflow-x: auto;\">\n      <table class=\"d-table tab-size mb-0 width-full\" data-paste-markdown-skip=\"\">\n          <tbody><tr class=\"border-0\">\n            <td class=\"blob-num blob-num-deletion text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-deletion js-blob-code-deletion blob-code-marker-deletion\">                <span class=\"pl-k\">if</span>(nextResult<span class=\"pl-k\">.</span>getResult()<span class=\"pl-k\">.</span>getTotalSize() <span class=\"pl-k x x-first\">-</span><span class=\"x\"> nextResult</span><span class=\"pl-k x\">.</span><span class=\"x\">getResult()</span><span class=\"pl-k x\">.</span><span class=\"x\">getTotalSizeOf(</span><span class=\"pl-smi x\">Severity</span><span class=\"pl-c1\"><span class=\"pl-k x\">.</span><span class=\"x\">ERROR</span></span><span class=\"x\">) </span><span class=\"pl-k x\">!=</span><span class=\"x\"> </span><span class=\"pl-c1 x\">0</span><span class=\"x x-last\">)</span>{</td>\n          </tr>\n          <tr class=\"border-0\">\n            <td class=\"blob-num blob-num-addition text-right border-0 px-2 py-1 lh-default\" data-line-number=\"\"></td>\n            <td class=\"border-0 px-2 py-1 blob-code-inner blob-code-addition js-blob-code-addition blob-code-marker-addition\">                <span class=\"pl-k\">if</span><span class=\"x x-first x-last\"> </span>(nextResult<span class=\"pl-k\">.</span>getResult()<span class=\"pl-k\">.</span>getTotalSize() <span class=\"pl-k x x-first\">&gt;</span><span class=\"x\"> </span><span class=\"pl-c1 x\">0</span><span class=\"x x-last\">) </span>{</td>\n          </tr>\n      </tbody></table>\n    </div>\n    <div class=\"js-apply-changes\"></div>\n  </div>\n", "author": "uhafner", "createdAt": "2020-04-09T10:16:54Z", "path": "plugin/src/main/java/io/jenkins/plugins/analysis/core/model/JobAction.java", "diffHunk": "@@ -202,6 +206,20 @@ public boolean isTrendVisible() {\n         return trendChartType != TrendChartType.NONE && createBuildHistory().hasMultipleResults();\n     }\n \n+    public boolean noWarnings(){\n+        History results =createBuildHistory(); //Get past build history\n+        if(results instanceof AnalysisHistory){\n+            Iterator<BuildResult<AnalysisBuildResult>> it = results.iterator();\n+            while(it.hasNext()) {\n+                BuildResult<AnalysisBuildResult> nextResult = it.next();\n+                if(nextResult.getResult().getTotalSize() - nextResult.getResult().getTotalSizeOf(Severity.ERROR) != 0){", "originalCommit": "898b4e0b65b8e9c00226de35c450a1b58b869075", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI4MTI5MQ==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406281291", "bodyText": "Doesn't nextResult.getResult() returns the total number of warnings+errors? If we are only checking the number of warnings, shouldn't we subtract the number of errors from the total number?", "author": "Allancgx", "createdAt": "2020-04-09T15:18:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMzY3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI4MTkwMg==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406281902", "bodyText": "In case there is one error but no warnings, this new method is expected to return true, right?", "author": "Allancgx", "createdAt": "2020-04-09T15:19:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMzY3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjI4MzkzOQ==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406283939", "bodyText": "I noticed that you changed the method name to hasNoIssues(). Are we including errors then? I thought the graph only displayed the number of warnings\ud83d\ude05.", "author": "Allancgx", "createdAt": "2020-04-09T15:22:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMzY3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjMxNDMwMA==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406314300", "bodyText": "No, the chart draws \"everything\": actually the individual tools decide which things should be shown (I called them issues since these items can be warnings, errors, code duplications, TODO tags, unit test failures, etc.). So if at least one build has number of issues > 0, then the chart should be shown.", "author": "uhafner", "createdAt": "2020-04-09T16:07:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMzY3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjMxNzkzMg==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/436#discussion_r406317932", "bodyText": "Thank you for the clarification!", "author": "Allancgx", "createdAt": "2020-04-09T16:13:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjEwMzY3MA=="}], "type": "inlineReview"}, {"oid": "9dbd6843ff6045bb138acf204b17853c2a90dab0", "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/9dbd6843ff6045bb138acf204b17853c2a90dab0", "message": "Update plugin/src/main/java/io/jenkins/plugins/analysis/core/model/JobAction.java\r\n\r\nClarifying name change\n\nCo-Authored-By: Ullrich Hafner <ullrich.hafner@gmail.com>", "committedDate": "2020-04-17T17:43:59Z", "type": "commit"}, {"oid": "28a80b04bf1d001f5c96e64829d312853dac09c7", "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/28a80b04bf1d001f5c96e64829d312853dac09c7", "message": "Updated Commit for hasNoIssues\n\nRemoved Instance check and updated to check size of all issues, not just warnings.", "committedDate": "2020-04-17T17:51:28Z", "type": "commit"}, {"oid": "6678b79594c85073f32579bcb1b2cd6b2b8387ed", "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/6678b79594c85073f32579bcb1b2cd6b2b8387ed", "message": "Updated Java Function Name\n\nUpdated Java function name in jelly file to updated name in JobAction from noWarnings() to hasNoIssues().", "committedDate": "2020-04-17T17:56:13Z", "type": "commit"}]}